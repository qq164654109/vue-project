!function(Q,m,D){"use strict";var d="ht",i=Q[d],t=i.Default,p=i.graph,y=t.getInternal(),n=y.ui(),V=n.NodeUI.prototype,N=n.ShapeUI.prototype,b=p.GraphView,M=b.prototype,R=n.EdgeUI.prototype,H=i.Node,s=i.Shape,O=i.Edge,g=i.Group,P=t.isTouchable,A=t.preventDefault,r=Q.setTimeout,l=t.grow,S=t.isDragging,U=t.getDistance,C=null,T=i.List,c="undefined"!=typeof Float32Array?Float32Array:Array,u=Math,W=u.PI,x="Crossing",f="No Crossing",$=W/2,w=2*W,v=u.atan2,F=u.sqrt,X=u.pow,L=u.sin,j=u.cos,Y=u.min,e=u.max,B=u.abs,q=u.ceil,J=u.round,_=t.unionPoint,k=t.unionRect,h=t.containsPoint,Z=t.clone,I="rgb(52, 152, 219)",K="red",E={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},o={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var B=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],d=0;d<B.length;d++){var $=B[d];$=0===d%2?$/400*o.width:$/100*o.height,B[d]=$}return o.width>120&&(B[4]=o.width-26,B[6]=o.width-40,B[10]=o.width-40,B[12]=o.width-26,B[18]=33),B}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},G={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:I,rotation:.61},{type:"circle",rect:[200,120,70,70],background:I,rotation:.61},{type:"circle",rect:[200,220,70,70],background:I,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:I},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:I}]},a={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:K,rotation:.61}]},z={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:I},{type:"circle",rect:[0,210,90,90],background:I},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:I}]},js={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:K},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:K}]},pd={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:I}]},hf={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:K}]},Lq={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Wr={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Gn=function(J){var s=J.touches[0];return s?s:J.changedTouches[0]},kh=function(W,X,u,n){return v(n-X,u-W)},Ge=function(A,Q){return{x:A.x*Q,y:A.y*Q}},fd=function(Z,l){Z.each(function(V){return Z.isSelected(V)?l(V):void 0})},Aq=function(u,m){u.reverseEach(function(z){return u.isSelected(z)?m(z):void 0})},fe=function(g,C,A){var P,S,G,p,N,i=this,$=C,a=i.gv;if(g instanceof s){G=g.getSegments();var R=a.getDataUI(g);N=R._55O.$15l,G&&G.size()||(G=nn(N)),g.isClosePath()&&G.indexOf(5)<0&&(G=new T(G._as),G.add(5)),P=hs(g,R,$),S=N[P]}else{var c=a.getDataUI(g);N=Hb(c,g.s("edge.points")),G=g.s("edge.segments"),G&&G.size()||(G=nn(N)),N=N._as,P=hs(g,c,$),S=N[P]}if(G&&(p=G.get($)),2===p||1===p||5===p){var K=N[P+1];5===p&&(K=N[0]);var J=jd(S,A,K);return J}return A},yj=function($,i,u,d){var c=i/2,E=u/2,H=Tf($,-c,-E,d),K=Tf($,c,-E,d),r=Tf($,-c,E,d),n=Tf($,c,E,d),J=Tf($,0,-E,d),j=Tf($,c,0,d),k=Tf($,0,E,d),R=Tf($,-c,0,d);return[H,K,r,n,J,j,k,R]},jd=function(Z,V,q){var L={x:V.x-Z.x,y:V.y-Z.y},f={x:q.x-Z.x,y:q.y-Z.y},C=F(X(q.x-Z.x,2)+X(q.y-Z.y,2)),A={x:f.x/C,y:f.y/C},j=L.x*A.x+L.y*A.y,R={x:A.x*j,y:A.y*j};return{x:Z.x+R.x,y:Z.y+R.y}},Tf=function(b,t,Z,i){var $=j(i)*t-L(i)*Z,Y=L(i)*t+j(i)*Z;return b?{x:b.x+$,y:b.y+Y}:{x:$,y:Y}},Jd=function(P,I){return I>2*P?P:I/2},Fo=function(F,y,K,e){var i=U(F,y);return K=e?Y(K,i):Jd(K,i),i?K/=i:K=0,{x:F.x+(y.x-F.x)*K,y:F.y+(y.y-F.y)*K}},vi=function(u,q){var A,f,Q=u.gv,J=u._data,K=J._40I,e=J._41I,E=J.s("edge.offset"),X=J.s("edge.source.position"),V=J.s("edge.target.position"),d=J.s("edge.source.offset.x"),z=J.s("edge.source.offset.y"),D=J.s("edge.target.offset.x"),F=J.s("edge.target.offset.y"),H=J.s("edge.source.anchor.x"),k=J.s("edge.source.anchor.y"),_=J.s("edge.target.anchor.x"),g=J.s("edge.target.anchor.y");if(q?(A=y.getEdgeAgentPosition(Q,K,X,d,z,H,k),f=y.getEdgeAgentPosition(Q,e,V,D,F,_,g)):(A=y.getEdgeAgentPosition(Q,K,X,0,0,H,k),f=y.getEdgeAgentPosition(Q,e,V,0,0,_,g)),"points"===J.s("edge.type")&&E&&!J.s("edge.center")&&A){var n=J.s("edge.points")||new T,C=n.size(),r=Fo(A,C?n.get(0):f,E,C),O=Fo(f,C?n.get(C-1):A,E,C);A=r,f=O}return[A,f]},Hb=function(k,I,Z){var V=k._78o,L=k._data,s=L.s("edge.type"),j=[V.sourcePoint,V.targetPoint];return"points"===s?Z&&(j=vi(k)):j=V.center?s?Z?vi(k):vi(k,!0):Z?vi(k):[V.c1,V.c2]:Z?vi(k):vi(k,!0),I=new T(I?I._as:C),I.add(j[0],0),I.add(j[1]),I},di=function(c){return c=new T(c._as),c.removeAt(0),c.removeAt(c.size()-1),c},nn=function(K){K._as||(K=new T(K));var Y=new T;Y.add(1);for(var o=1;o<K.size();o++)Y.add(2);return Y},zc=function(i,Q){return{x:(i.x+Q.x)/2,y:(i.y+Q.y)/2}},Jp=function(m,V){return{x:m.x+1*(V.x-m.x)/4,y:m.y+1*(V.y-m.y)/4}},Fr=function(Q,w){return{x:Q.x+3*(w.x-Q.x)/4,y:Q.y+3*(w.y-Q.y)/4}},sn=function(g,G,n,Z){var P=G.x+G.width/2,e=G.y+G.height/2,I=F(P*P+e*e),H=v(e,P)+n;return{x:Z.x+I*j(H),y:Z.y+I*L(H)}},Tc=M.validateImpl,pm=M.isRectEditable,Zp=M.isPointEditable,Jk=M._42,eg=N._79o,Uc=R._79o,ar=N._48O,ws=N._47O,wl=V._48O,jh=V._80o,vs=N._80o,Df=V.getSelectWidth,Eo=V._47O,ch=R._47O,Ln=M.isEditable,Td=["northwest","north","northeast","east","southeast","south","southwest","west"],fp=function(D,F,x,b,A,N,s,r,P,Z){var p=D.x,V=D.y,L=D.width,g=D.height,J={x:p+L/2,y:V+g/2};b=b||0,F=Tf(J,F.x-J.x,F.y-J.y,-b),s&&!r&&(F.x+=P,F.y+=Z);var z=.01;if("northwest"===x?(F.x+A>p+L-z&&(F.x=p+L-A-z),F.y+A>V+g-z&&(F.y=V+g-A-z),D=_(F,{x:p+L,y:V+g})):"north"===x?(F.y+A>V+g-z&&(F.y=V+g-A-z),D=_({x:p,y:F.y},{x:p+L,y:V+g})):"northeast"===x?(F.x<p+A+z&&(F.x=p+A+z),F.y+A>V+g-z&&(F.y=V+g-A-z),D=_({x:p,y:F.y},{x:F.x,y:V+g})):"west"===x?(F.x+A>p+L-z&&(F.x=p+L-A-z),D=_({x:F.x,y:V},{x:p+L,y:V+g})):"east"===x?(F.x<p+A+z&&(F.x=p+A+z),D=_({x:p,y:V},{x:F.x,y:V+g})):"southwest"===x?(F.x+A>p+L-z&&(F.x=p+L-A-z),F.y<V+A+z&&(F.y=V+A+z),D=_({x:F.x,y:V},{x:p+L,y:F.y})):"south"===x?(F.y<V+A+z&&(F.y=V+A+z),D=_({x:p,y:V},{x:p+L,y:F.y})):"southeast"===x&&(F.x<p+A+z&&(F.x=p+A+z),F.y<V+A+z&&(F.y=V+A+z),D=_({x:p,y:V},F)),"keepRatio"===N&&(!s&&r||s&&!r)&&("northeast"===x||"southeast"===x||"northwest"===x||"southwest"===x)){var c=D.width,T=D.height,Q=c/L,O=T/g,W=Y(Q,O);D.width=L*W,D.height=g*W,"northeast"===x?D.y=V+(g-D.height):"northwest"===x?(D.y=V+(g-D.height),D.x=p+(L-D.width)):"southwest"===x&&(D.x=p+(L-D.width))}D.x-=J.x,D.y-=J.y;var X=sn(C,D,b,J);return D.x=X.x-D.width/2,D.y=X.y-D.height/2,D},Cd=function(G,R,h,c){var k=G.getRotation(),x=R,o=x.x,I=x.y,B=x.width,O=x.height,p={x:o+x.width/2,y:I+x.height/2};c=Tf(p,c.x-p.x,c.y-p.y,-k),"northwest"===h?x=_(c,{x:o+B,y:I+O}):"north"===h?x=_({x:o,y:c.y},{x:o+B,y:I+O}):"northeast"===h?x=_({x:o,y:c.y},{x:c.x,y:I+O}):"west"===h?x=_({x:c.x,y:I},{x:o+B,y:I+O}):"east"===h?x=_({x:o,y:I},{x:c.x,y:I+O}):"southwest"===h?x=_({x:c.x,y:I},{x:o+B,y:c.y}):"south"===h?x=_({x:o,y:I},{x:o+B,y:c.y}):"southeast"===h&&(x=_({x:o,y:I},c)),G.setRect(x),x.x-=p.x,x.y-=p.y;var L=sn(G,x,k,p);G.p(L.x,L.y)},lc=function(Q,o,N,f,X,M,k,e){var b=C;M?(b=Tf(C,X.x-o.x,X.y-o.y,-N),b.x-=k.x,b.y-=k.y):b=Tf(C,X.x-o.x,X.y-o.y,0);var U={x:o.x+b.x,y:o.y+b.y};e&&(U=e(U.x,U.y)),U.e=Q.getPoints().get(f).e,Q.setPoint(f,U);var Z=Q.getWidth(),$=Q.getHeight(),m=Q.p().x-Z/2,u=Q.p().y-$/2;m-=o.x,u-=o.y;var d=sn(Q,{x:m,y:u,width:Z,height:$},N,o);Q.p(d.x,d.y)},hs=function(t,k,G){var x,J;if(t instanceof s?(x=t.getPoints(),J=t.getSegments()):t instanceof O&&"points"===t.s("edge.type")&&(x=t.s("edge.points"),J=t.s("edge.segments"),x=Hb(k,x)),J&&J.size()||(J=nn(x)),t instanceof s&&t.isClosePath()&&J.indexOf(5)<0&&(J=new T(J._as),J.add(5)),J)for(var q=-1,P=0;P<J.size();P++){if(P===G)return q;var C=J.get(P);1===C?q+=1:2===C?q+=1:3===C?q+=2:4===C&&(q+=3)}},Jf=function(Z,y,b){var p,f;if(Z instanceof s?(p=Z.getPoints(),f=Z.getSegments()):Z instanceof O&&"points"===Z.s("edge.type")&&(p=Z.s("edge.points"),f=Z.s("edge.segments"),p=Hb(y,p)),f&&f.size()||(f=nn(p)),f)for(var k=-1,e=0;e<f.size();e++){var E=f.get(e);if(1===E?k+=1:2===E?k+=1:3===E?k+=2:4===E&&(k+=3),k===b)return e}},im=function(k,l){var m=[k[0]-l[0],k[1]-l[1],k[2]-l[2]];return m},qo=function(){var k=new c(16);return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k},yr=function(A,h){var G=A[0],t=A[1],r=A[2];return A[0]=h[0]*G+h[4]*t+h[8]*r+h[12],A[1]=h[1]*G+h[5]*t+h[9]*r+h[13],A[2]=h[2]*G+h[6]*t+h[10]*r+h[14],A},Ve=function(N,X){if(X){var n=L(X),D=j(X),y=N[0],P=N[1],G=N[2],O=N[3],k=N[8],x=N[9],M=N[10],B=N[11];N[0]=y*D-k*n,N[1]=P*D-x*n,N[2]=G*D-M*n,N[3]=O*D-B*n,N[8]=y*n+k*D,N[9]=P*n+x*D,N[10]=G*n+M*D,N[11]=O*n+B*D}},Mi=function(J,L){for(var A=J.s("grid.row.count"),v=J.s("grid.column.count"),V=0;A>V;V++)for(var z=0;v>z;z++){var _=J.getCellRect(V,z);if(h(_,L))return{rowIndex:V,columnIndex:z,rect:_,grid:J}}return null},Rl=function(I,J,B,b,F,t){var f={},P=B-I,N=b-J,M=u.sqrt(P*P+N*N),x=P/M,c=N/M,z=(-I+F)*x+(-J+t)*c;return 0>=z?(f.x=I,f.y=J):z>=M?(f.x=B,f.y=b):(f.x=I+z*x,f.y=J+z*c),P=F-f.x,N=t-f.y,f.z=u.sqrt(P*P+N*N),f},Ke=function(f,w){var F,G,l,p,_,t,T,L,e=f.getPoints(),R=f.getSegments(),S=f.p(),m=f.getRotation();if(!R||!(R.indexOf(3)>0||R.indexOf(4)>0)){for(L=0;L<=e.size()-1;L++)if(L===e.size()-1?(_=e.get(0),p=e.get(L)):(p=e.get(L),_=e.get(L+1)),p=Tf(S,p.x-S.x,p.y-S.y,m),_=Tf(S,_.x-S.x,_.y-S.y,m),t=Rl(p.x,p.y,_.x,_.y,w.x,w.y),T=t.z,T<(f.s("shape.border.width")||10)){G=p,l=_,F=L;break}if(F!=C){var h=Rl(G.x,G.y,l.x,l.y,w.x,w.y),J=U(G,h);return{attachIndex:F,attachOffset:J}}}},_j=function($){for(var Y=$._data,J=Y.p(),k=Y.getRotation(),Z=Y.getPoints(),A=C,m=[],z=0;z<Z.size();z++)A=Z.get(z),m.push(Tf(J,A.x-J.x,A.y-J.y,k));$._55O.$15l=m};t.setImage("xeditinteractor_parentIcon",G),t.setImage("xeditinteractor_hostIcon",a),t.setImage("xeditinteractor_edgeIcon",z),t.setImage("xeditinteractor_removeIcon",js),t.setImage("xeditinteractor_sourceIcon",pd),t.setImage("xeditinteractor_targetIcon",hf),t.setImage("xeditinteractor_elevationIcon",Lq),t.setImage("xeditinteractor_tallIcon",Wr),M._editPointSize=P?24:9,M._edgeHelpers=["parent","remove","source","target"],M._leftTopHelpers=["parent"],M._rightTopHelpers=["host"],M._leftBottomHelpers=["edge"],M._rightBottomHelpers=["remove"],Td=Td.concat(Td).concat(Td),R._79o=function(){var n=this,Q=n.gv,o=Q.getZoom(),h=Q._editInteractor,s=Uc.call(n);if(!s)return null;var M=vi(n,!0),x=M[0],T=M[1],g={x:s.x,y:s.y,width:s.width,height:s.height},K=_(x,T);if(h instanceof p.XEditInteractor){g=k(g,K);var R=n._55O,D=Q.getEditPointSize()/o+2,d=0;R&&R._43O&&(d+=D/2,l(g,d))}return g},R._47O=function(I){var L=this,G=L.gv,s=G._editInteractor;s instanceof p.XEditInteractor||ch.call(L,I)},R.rectIntersects=function(V){var O=this,Q=O._data,f=O.gv,W=f.getZoom(),l=O._55O,F=f._editInteractor;if(F instanceof p.XEditInteractor&&f.isEditable(Q)&&l&&l._43O&&"points"===Q.s("edge.type")){var z=Q.s("edge.points"),Y=Q.s("edge.segments");z=Hb(O,z),Y&&Y.size()||(Y=nn(z)),z=z._as;var U=!1,v=P?5:1,$=V.x+v,A=V.y+v,u={x:$,y:A};if(F._edge===Q&&F._hoverSegmentIndex>=0){var J=f._editInteractor._hoverSegmentIndex,g=Y.get(J),w=hs(Q,O,J),K=C;if(w!=C&&w>=0){var o=z[w],j=f.getSegmentHoverWidth()/W;if(2===g||1===g){var D=z[w+1];K=lr(new ui(o.x,o.y),new ui(D.x,D.y),new ui(u.x-j,u.y-j),new ui(u.x+2*j,u.y+2*j)),K.$62l===x&&(U=!0)}else if(3===g){var N=z[w+1],D=z[w+2];K=mr(new ui(o.x,o.y),new ui(N.x,N.y),new ui(D.x,D.y),new ui(u.x-j,u.y-j),new ui(u.x+2*j,u.y+2*j)),K.$62l===x&&(U=!0)}else if(4===g){var c=z[w+1],h=z[w+2];D=z[w+3],K=Yi(new ui(o.x,o.y),new ui(c.x,c.y),new ui(h.x,h.y),new ui(D.x,D.y),new ui(u.x-j,u.y-j),new ui(u.x+2*j,u.y+2*j)),K.$62l===x&&(U=!0)}}}if(U)return!0}return C},N._47O=function(L){var C=this,O=C.gv,Z=O._editInteractor;Z instanceof p.XEditInteractor||ws.call(C,L)},N.rectIntersects=function(y){var O=this,j=O._data,K=O.gv,W=K.getZoom(),N=O._55O,S=K._editInteractor;if(S instanceof p.XEditInteractor&&K.isEditable(j)&&N&&N._43O){var M=N.$15l,m=!1,A=P?5:1,F=y.x+A,r=y.y+A,I={x:F,y:r};if(M&&M.length===j.getPoints().size()||(_j(O),M=N.$15l),S._shape===j&&S._hoverSegmentIndex>=0){var d=j.getSegments();d&&d.size()||(d=nn(M));var n=K._editInteractor._hoverSegmentIndex,Z=d.get(n),s=hs(j,O,n),R=C;if(s!=C&&s>=0){var D=M[s],g=K.getSegmentHoverWidth()/W;if(2===Z||1===Z){var e=M[s+1];R=lr(new ui(D.x,D.y),new ui(e.x,e.y),new ui(I.x-g,I.y-g),new ui(I.x+2*g,I.y+2*g)),R.$62l===x&&(m=!0)}else if(3===Z){var l=M[s+1],e=M[s+2];R=mr(new ui(D.x,D.y),new ui(l.x,l.y),new ui(e.x,e.y),new ui(I.x-g,I.y-g),new ui(I.x+2*g,I.y+2*g)),R.$62l===x&&(m=!0)}else if(4===Z){var G=M[s+1],q=M[s+2];e=M[s+3],R=Yi(new ui(D.x,D.y),new ui(G.x,G.y),new ui(q.x,q.y),new ui(e.x,e.y),new ui(I.x-g,I.y-g),new ui(I.x+2*g,I.y+2*g)),R.$62l===x&&(m=!0)}}}if(m)return!0}return C},N._48O=function(){var B=this,Z=B.gv,x=Z._editInteractor;x instanceof p.XEditInteractor?(V._48O.call(B),B._55O._43O&&_j(B)):ar.call(B)},N._79o=function(){var G=this,_=G.gv,j=_.getZoom(),Y=_._editInteractor,T=eg.call(G);if(T){var e={x:T.x,y:T.y,width:T.width,height:T.height};if(Y instanceof p.XEditInteractor){var F=G._55O,t=_.getEditPointSize()/j+2,A=0;F&&F._43O&&(A+=t/2,l(e,A))}return e}},V._47O=function(N){var n=this,$=n.gv,k=$._editInteractor;if(k instanceof p.XEditInteractor);else{var f=n._55O;f&&f._98o&&Eo.call(n,N)}},V.getSelectWidth=function(){var c=this,w=c.gv,C=w._editInteractor,F=c._data;return w.isEditable(F)&&C instanceof p.XEditInteractor?0:Df.call(c)},V._80o=function(e){var b=this,f=b.gv._editInteractor;if(jh.call(b,e),f&&f._debug){e.save(),e.beginPath(),e.lineWidth=1,e.strokeStyle="green";var N=b._79o();N&&(e.rect(N.x,N.y,N.width,N.height),e.stroke()),e.restore()}},N._80o=function($){var F=this,e=F.gv._editInteractor;if(vs.call(F,$),e&&e._debug){$.save(),$.beginPath(),$.lineWidth=1,$.strokeStyle="green";var T=F._79o();$.rect(T.x,T.y,T.width,T.height),$.stroke(),$.restore()}},V._48O=function(){var N=this,m=N.gv,r=N._data,O=m._editInteractor,$=N._55O,k=r.p(),t=r.getRotation();if(O instanceof p.XEditInteractor){if($._42O){var j=yj(k,r.getWidth(),r.getHeight(),t),M=j[0],v=j[1],I=j[2],S=j[3],n=j[4],s=j[5],u=j[6],H=j[7];$.$45l=[M,n,v,s,S,u,I,H]}}else wl.call(N)},M.getResizeMode=function(){return this.$25l||"normal"},M.setResizeMode=function(n){var Y=this.$25l;this.$25l=n,this.fp("resizeMode",Y,n)},M.getSnapAngle=function(){return this.$26l||Math.PI/36},M.setSnapAngle=function(z){var h=this.$26l;this.$26l=z,this.fp("snapAngle",h,z)},M.getSnapSpacing=function(){return this.$27l},M.setSnapSpacing=function(D){var y=this.$27l;this.$27l=D,this.fp("snapSpacing",y,D)},M.getPointSnapSpacing=function(){return this._pointSnapSpacing},M.setPointSnapSpacing=function(c){var _=this._pointSnapSpacing;this._pointSnapSpacing=c,this.fp("pointSnapSpacing",_,c)},M.setHelperEditableFunc=function(B){var s=this._helperEditableFunc;this._helperEditableFunc=B,this.fp("helperEditableFunc",s,B)},M.getHelperEditableFunc=function(){return this._helperEditableFunc},M.setLeftTopHelpers=function(x){var Z=this._leftTopHelpers;this._leftTopHelpers=x,this.fp("leftTopHelpers",Z,x)},M.getLeftTopHelpers=function(){return this._leftTopHelpers},M.setLeftTopHelpersAlign=function(y){var k=this._leftTopHelpersAlign;this._leftTopHelpersAlign=y,this.fp("leftTopHelpersAlign",k,y)},M.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},M.setRightTopHelpers=function(F){var X=this._rightTopHelpers;this._rightTopHelpers=F,this.fp("rightTopHelpers",X,F)},M.getRightTopHelpers=function(){return this._rightTopHelpers},M.setRightTopHelpersAlign=function(r){var s=this._rightTopHelpersAlign;this._rightTopHelpersAlign=r,this.fp("rightTopHelpersAlign",s,r)},M.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},M.setLeftBottomHelpers=function(r){var t=this._leftBottomHelpers;this._leftBottomHelpers=r,this.fp("leftBottomHelpers",t,r)},M.getLeftBottomHelpers=function(){return this._leftBottomHelpers},M.setLeftBottomHelpersAlign=function(i){var Y=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=i,this.fp("leftBottomHelpersAlign",Y,i)},M.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},M.setRightBottomHelpers=function(Z){var G=this._rightBottomHelpers;this._rightBottomHelpers=Z,this.fp("rightBottomHelpers",G,Z)},M.getRightBottomHelpers=function(){return this._rightBottomHelpers},M.setRightBottomHelpersAlign=function(L){var Y=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=L,this.fp("rightBottomHelpersAlign",Y,L)},M.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},M.setEdgeHelpers=function(R){var A=this._edgeHelpers;this._edgeHelpers=R,this.fp("edgeHelpers",A,R)},M.getEdgeHelpers=function(){return this._edgeHelpers},M.isHelperEditable=function(h,o){return h instanceof O&&("host"===o||"edge"===o||"elevation"===o||"tall"===o)?!1:h instanceof H&&("source"===o||"target"===o)?!1:"pointElevation"===o?this._helperEditableFunc?this._helperEditableFunc(h,o):!1:this._helperEditableFunc?this._helperEditableFunc(h,o):!0},M.getEditHelperSize=function(){return this._editHelperSize||(P?28:16)},M.setEditHelperSize=function(l){var W=this._editHelperSize;this._editHelperSize=l,this.fp("editHelperSize",W,l)},M.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},M.setEditRectBorderColor=function(Q){var _=this.$28l;this.$28l=Q,this.fp("editRectBorderColor",_,Q)},M.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},M.setNodeBorderColor=function(A){var z=this.$29l;this.$29l=A,this.fp("nodeBorderColor",z,A)},M.getEditRectBorderStyle=function(){return this.$30l||"dashed"},M.setEditRectBorderStyle=function($){var K=this.$30l;this.$30l=$,this.fp("editRectBorderStyle",K,$)},M.getControlPointBackground=function(){return this.$31l||"#ff0"},M.setControlPointBackground=function(b){var O=this.$31l;this.$31l=b,this.fp("controlPointBackground",O,b)},M.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},M.setControlPointBorderColor=function(X){var M=this.$32l;this.$32l=X,this.fp("controlPointBorderColor",M,X)},M.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},M.setJoinPointBackground=function(R){var X=this.$33l;this.$33l=R,this.fp("joinPointBackground",X,R)},M.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},M.setJoinPointBorderColor=function(y){var G=this.$34l;this.$34l=y,this.fp("joinPointBorderColor",G,y)},M.getDirectionLineColor=function(){return this.$35l||"#888"},M.setDirectionLineColor=function(k){var v=this.$35l;this.$35l=k,this.fp("directionLineColor",v,k)},M.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},M.setSegmentHoverColor=function(v){var X=this.$36l;this.$36l=v,this.fp("segmentHoverColor",X,v)},M.getSegmentHoverWidth=function(){return this.$22l||(P?16:8)},M.setSegmentHoverWidth=function(r){var T=this.$22l;this.$22l=r,this.fp("segmentHoverWidth",T,r)},M.getSnapPointBorderColor=function(){return this.$38l||"#f00"},M.setSnapPointBorderColor=function(x){var u=this.$38l;this.$38l=x,this.fp("snapPointBorderColor",u,x)},M.getEditRectPadding=function(){return this.$39l!=C?this.$39l:6},M.setEditRectPadding=function(y){var S=this.$39l;this.$39l=y,this.fp("editRectPading",S,y)},M.isRectEditable=function(A){var c=this,R=c._editInteractor;return R instanceof p.XEditInteractor?c._rectEditableFunc?c._rectEditableFunc(A):!0:pm.call(c,A)},M.isPointEditable=function(s){var k=this,t=k._editInteractor;return t instanceof p.XEditInteractor?k._pointEditableFunc?k._pointEditableFunc(s):!0:Zp.call(k,s)},M.validateImpl=function(){var k=this,T=k.$14l,R=k._editInteractor;if(T){var l=k.getWidth(),N=k.getHeight();(l!==T.clientWidth||N!==T.clientHeight)&&(R&&(R._68I=1),y.setCanvas(T,l,N),k._32I=1)}Tc.call(this)},M.isEditable=function(k){var K=Ln.call(this,k),x=this._editInteractor;if(x instanceof p.XEditInteractor&&k instanceof O){if(!k.s("2d.editable"))return!1;var D=this.getEditableFunc();K=D?D(k):!0}return K},M._42=function(B,M){var E=this,a=E._editInteractor;Jk.call(E,B,M),a instanceof p.XEditInteractor&&a._68I&&a._42()},M.isSnapPoint=function(){return!0};var bb=function(e){arguments.length>0&&this.$58l(e)},kn=bb.prototype;kn.$58l=function(v){this.$62l=v,this.points=new Array},kn.$56l=function(s){this.points.push(s)},kn.$57l=function(m){this.points=this.points.concat(m)};var ui=function(P,b){arguments.length>0&&this.$58l(P,b)},Wm=ui.prototype;Wm.$58l=function(T,Z){this.x=T,this.y=Z},Wm.add=function(N){return new ui(this.x+N.x,this.y+N.y)},Wm.addEquals=function(T){return this.x+=T.x,this.y+=T.y,this},Wm.$55l=function(o){return new ui(this.x*o,this.y*o)},Wm.eq=function(Q){return this.x==Q.x&&this.y==Q.y},Wm.lt=function(O){return this.x<O.x&&this.y<O.y},Wm.lte=function(O){return this.x<=O.x&&this.y<=O.y},Wm.gt=function(A){return this.x>A.x&&this.y>A.y},Wm.gte=function(y){return this.x>=y.x&&this.y>=y.y},Wm.lerp=function(p,d){return new ui(this.x+(p.x-this.x)*d,this.y+(p.y-this.y)*d)},Wm.distanceFrom=function(o){var S=this.x-o.x,b=this.y-o.y;return F(S*S+b*b)},Wm.min=function(L){return new ui(Y(this.x,L.x),Y(this.y,L.y))},Wm.max=function(n){return new ui(e(this.x,n.x),e(this.y,n.y))},Wm.toString=function(){return this.x+","+this.y};var Ze=function(){this.$58l(arguments)},hi=Ze.prototype;Ze.TO=1e-6,Ze.AC=6,hi.$58l=function(l){this.co=new Array;for(var w=l.length-1;w>=0;w--)this.co.push(l[w])},hi.$55l=function(j){for(var y=new Ze,K=0;K<=this.$50l()+j.$50l();K++)y.co.push(0);for(var K=0;K<=this.$50l();K++)for(var W=0;W<=j.$50l();W++)y.co[K+W]+=this.co[K]*j.co[W];return y},hi.$59l=function(){for(var p=this.$50l();p>=0&&B(this.co[p])<=Ze.TO;p--)this.co.pop()},hi.$50l=function(){return this.co.length-1},hi.$51l=function(){var k;switch(this.$59l(),this.$50l()){case 0:k=new Array;break;case 1:k=this.$52l();break;case 2:k=this.$53l();break;case 3:k=this.$54l();break;case 4:k=this.$63l();break;default:k=new Array}return k},hi.$52l=function(){var x=new Array,b=this.co[1];return 0!=b&&x.push(-this.co[0]/b),x},hi.$53l=function(){var L=new Array;if(2==this.$50l()){var c=this.co[2],U=this.co[1]/c,o=this.co[0]/c,t=U*U-4*o;if(t>0){var Z=F(t);L.push(.5*(-U+Z)),L.push(.5*(-U-Z))}else 0==t&&L.push(.5*-U)}return L},hi.$63l=function(){var d=new Array;if(4==this.$50l()){var k=this.co[4],h=this.co[3]/k,Y=this.co[2]/k,Q=this.co[1]/k,Z=this.co[0]/k,v=new Ze(1,-Y,h*Q-4*Z,-h*h*Z+4*Y*Z-Q*Q).$54l(),y=v[0],U=h*h/4-Y+y;if(B(U)<=Ze.TO&&(U=0),U>0){var u=F(U),m=3*h*h/4-u*u-2*Y,l=(4*h*Y-8*Q-h*h*h)/(4*u),x=m+l,f=m-l;if(B(x)<=Ze.TO&&(x=0),B(f)<=Ze.TO&&(f=0),x>=0){var H=F(x);d.push(-h/4+(u+H)/2),d.push(-h/4+(u-H)/2)}if(f>=0){var H=F(f);d.push(-h/4+(H-u)/2),d.push(-h/4-(H+u)/2)}}else if(0>U);else{var l=y*y-4*Z;if(l>=-Ze.TO){if(0>l&&(l=0),l=2*F(l),m=3*h*h/4-2*Y,m+l>=Ze.TO){var t=F(m+l);d.push(-h/4+t/2),d.push(-h/4-t/2)}if(m-l>=Ze.TO){var t=F(m-l);d.push(-h/4+t/2),d.push(-h/4-t/2)}}}}return d},hi.$54l=function(){var N=new Array;if(3==this.$50l()){var f=this.co[3],D=this.co[2]/f,s=this.co[1]/f,S=this.co[0]/f,x=(3*s-D*D)/3,Q=(2*D*D*D-9*s*D+27*S)/27,C=D/3,q=Q*Q/4+x*x*x/27,e=Q/2;if(B(q)<=Ze.TO&&(q=0),q>0){var W,i,u=F(q);W=-e+u,i=W>=0?X(W,1/3):-X(-W,1/3),W=-e-u,W>=0?i+=X(W,1/3):i-=X(-W,1/3),N.push(i-C)}else if(0>q){var k=F(-x/3),O=v(F(-q),-e)/3,P=j(O),E=L(O),z=F(3);N.push(2*k*P-C),N.push(-k*(P+z*E)-C),N.push(-k*(P-z*E)-C)}else{var W;W=e>=0?-X(e,1/3):X(-e,1/3),N.push(2*W-C),N.push(-W-C)}}return N};var Cs=function(o,b){arguments.length>0&&this.$58l(o,b)},Ym=Cs.prototype;Ym.$58l=function(R,m){this.x=R,this.y=m},Ym.length=function(){return F(this.x*this.x+this.y*this.y)},Ym.$60l=function(l){return this.x*l.x+this.y*l.y};var ic=function(U,Z,B,y){var v,h=(y.x-B.x)*(U.y-B.y)-(y.y-B.y)*(U.x-B.x),T=(Z.x-U.x)*(U.y-B.y)-(Z.y-U.y)*(U.x-B.x),K=(y.y-B.y)*(Z.x-U.x)-(y.x-B.x)*(Z.y-U.y);if(0!=K){var o=h/K,d=T/K;o>=0&&1>=o&&d>=0&&1>=d?(v=new bb(x),v.points.push(new ui(U.x+o*(Z.x-U.x),U.y+o*(Z.y-U.y)))):v=new bb(f)}else v=0==h||0==T?new bb("C"):new bb("P");return v},Gl=function(v,D,e,p,A){var s,b,U,y,H,a,u,g=p.min(A),k=p.max(A),Y=new bb(f);s=D.$55l(-2),U=v.add(s.add(e)),s=v.$55l(-2),b=D.$55l(2),y=s.add(b),H=new ui(v.x,v.y),u=new Cs(p.y-A.y,A.x-p.x),a=p.x*A.y-A.x*p.y;for(var P=new Ze(u.$60l(U),u.$60l(y),u.$60l(H)+a).$51l(),B=0;B<P.length;B++){var R=P[B];if(R>=0&&1>=R){var l=v.lerp(D,R),O=D.lerp(e,R),r=l.lerp(O,R);p.x==A.x?g.y<=r.y&&r.y<=k.y&&(Y.$62l=x,Y.$56l(r)):p.y==A.y?g.x<=r.x&&r.x<=k.x&&(Y.$62l=x,Y.$56l(r)):r.gte(g)&&r.lte(k)&&(Y.$62l=x,Y.$56l(r))}}return Y},mr=function(A,$,Y,q,J){var C=q.min(J),E=q.max(J),O=new ui(E.x,C.y),P=new ui(C.x,E.y),g=Gl(A,$,Y,C,O),h=Gl(A,$,Y,O,E),V=Gl(A,$,Y,E,P),w=Gl(A,$,Y,P,C),y=new bb(f);return y.$57l(g.points),y.$57l(h.points),y.$57l(V.points),y.$57l(w.points),y.points.length>0&&(y.$62l=x),y},Ob=function(c,y,Q,t,K,C){var P,k,H,i,J,S,V,n,R,z,A=K.min(C),W=K.max(C),l=new bb(f);P=c.$55l(-1),k=y.$55l(3),H=Q.$55l(-3),i=P.add(k.add(H.add(t))),J=new Cs(i.x,i.y),P=c.$55l(3),k=y.$55l(-6),H=Q.$55l(3),i=P.add(k.add(H)),S=new Cs(i.x,i.y),P=c.$55l(-3),k=y.$55l(3),H=P.add(k),V=new Cs(H.x,H.y),n=new Cs(c.x,c.y),z=new Cs(K.y-C.y,C.x-K.x),R=K.x*C.y-C.x*K.y;for(var $=new Ze(z.$60l(J),z.$60l(S),z.$60l(V),z.$60l(n)+R).$51l(),I=0;I<$.length;I++){var D=$[I];if(D>=0&&1>=D){var s=c.lerp(y,D),F=y.lerp(Q,D),_=Q.lerp(t,D),Z=s.lerp(F,D),M=F.lerp(_,D),O=Z.lerp(M,D);K.x==C.x?A.y<=O.y&&O.y<=W.y&&(l.$62l=x,l.$56l(O)):K.y==C.y?A.x<=O.x&&O.x<=W.x&&(l.$62l=x,l.$56l(O)):O.gte(A)&&O.lte(W)&&(l.$62l=x,l.$56l(O))}}return l},Yi=function(G,Q,h,M,b,W){var O=b.min(W),z=b.max(W),u=new ui(z.x,O.y),t=new ui(O.x,z.y),w=Ob(G,Q,h,M,O,u),C=Ob(G,Q,h,M,u,z),D=Ob(G,Q,h,M,z,t),i=Ob(G,Q,h,M,t,O),c=new bb(f);return c.$57l(w.points),c.$57l(C.points),c.$57l(D.points),c.$57l(i.points),c.points.length>0&&(c.$62l=x),c},lr=function(t,G,$,j){var E=$.min(j),Y=$.max(j),Z=new ui(Y.x,E.y),R=new ui(E.x,Y.y),n=ic(E,Z,t,G),h=ic(Z,Y,t,G),J=ic(Y,R,t,G),p=ic(R,E,t,G),A=new bb(f);return A.$57l(n.points),A.$57l(h.points),A.$57l(J.points),A.$57l(p.points),A.points.length>0&&(A.$62l=x),A},tj=p.XEditInteractor=function(D){var T=this,$=T._view=document.createElement("canvas");$.className="editCanvas",$.style.position="absolute",tj.superClass.constructor.call(T,D)};t.def(tj,p.Interactor,{ms_edit:1,setUp:function(){var S=this,N=S.gv,O=N.getView(),p=S._view;tj.superClass.setUp.call(S),N.setEditInteractor(S),N.$14l=p,N._79O?O.insertBefore(p,N._79O):O.appendChild(p);var M=S.$49l=S.$11l.bind(S);N.dm().md(M),N.sm().ms(M),N.mp(M)},tearDown:function(){var L=this,q=L.gv,h=q.getView(),k=L.$49l;tj.superClass.tearDown.call(L),q.setEditInteractor(C),q.$14l=C,h.removeChild(L._view),q.dm().umd(k),q.sm().ums(k),q.ump(k)},clear:function(){var w=this,O=w.gv;delete w._hoverSegmentIndex,delete w._edge,delete w._shape,delete O._editing,delete w.$10l,delete w.$13l,delete w.$9l,delete w._removePointIndex,delete w._lp,w.$12l="",delete w.$40l,delete w.$67l,delete w.$72l,delete w.$73l,delete w.$75l,delete w.$1l,delete w.$3l,delete w.$2l,delete w.$92l,delete w.$93l,delete w.$94l,w.clearDragging()},handle_keydown:function(t){this.$48l!==t.shiftKey&&(this.$48l=t.shiftKey,this.handle_mousemove(t,D,!0))},handle_keyup:function(s){this.$48l!==s.shiftKey&&(this.$48l=s.shiftKey,this.handle_mousemove(s,D,!0))},handle_touchstart:function(Y){this.handle_mousemove(Y),this.handle_mousedown(Y)},handle_mousedown:function(_){A(_);var T=this,L=T.$13l,z=T.gv,m=z.dm(),N=z.sm(),k=z.getZoom(),M=z.lp(_),R=t.isDoubleClick(_),e=t.isLeftButton(_),y=T.$7l,P=T._shape,x=T._hoverSegmentIndex,Y=T._edge,h=T.$87l,j=T.$88l,s=function(){T._68I||h===T.$87l&&j===T.$88l||T.$43l()};if(7!==T.$67l&&(delete T.$87l,delete T.$88l),e&&(P||Y)&&x>=0&&R&&(P&&N.contains(P)||Y&&N.contains(Y))){var Q=fe.call(T,P||Y,x,M);return T.addShapePoint(P||Y,x,Q),r(function(){T.handle_mousemove(_)},40),void 0}if(e&&(P||Y)&&T._removePointIndex>=0&&R)return T.removeShapePoint(),T.$5l=1,r(function(){T.handle_mousemove(_)},40),void 0;if(!e||!z._editing)return s(),void 0;if(P&&L>=0){var u=P.getPoints().get(L),J=P.p(),I=Tf(J,u.x-J.x,u.y-J.y,-y+P.getRotation());C=Tf(J,M.x-J.x,M.y-J.y,-y),T.$24l={x:C.x-I.x,y:C.y-I.y},T.startDragging(_),m.beginTransaction(),T.fi({kind:"beginEditPoint",event:_,data:P,index:L}),T.$88l=L,T.$87l=P}else if(T.$10l){var b=z.sm().getSelection(),n=T.$6l,W=T.$1l={},q=T.$3l={},g=T.$16l[E[T.$10l]],o={x:n.x,y:n.y},O={x:n.x+n.width/2,y:n.y+n.height/2};T.$24l={x:M.x-g.x/k,y:M.y-g.y/k},T.$2l=Z(T.$8l),T.$4l=Z(n),b.each(function(v){if(v instanceof H){var U=v.p(),V=v.getWidth(),g=v.getHeight(),B=Tf(O,U.x-O.x,U.y-O.y,-y);W[v.getId()]={x:U.x-V/2,y:U.y-g/2,width:V,height:g},q[v.getId()]={x:(B.x-o.x)/n.width,y:(B.y-o.y)/n.height}}}),T.startDragging(_),m.beginTransaction(),T.fi({kind:"beginEditRect",event:_,direction:T.$10l})}else if(Y&&L>=0){var F=Hb(z.getDataUI(Y),Y.s("edge.points")),u=F.get(L);T.$24l={x:M.x-u.x,y:M.y-u.y},T.startDragging(_),m.beginTransaction(),T.fi({kind:"beginEditPoint",event:_,data:Y,index:L}),T.$88l=L,T.$87l=Y}else if(T.$40l){var n=T.$6l,O={x:n.x+n.width/2,y:n.y+n.height/2},p=Z(T.$23l);p.x/=k,p.y/=k;var K=Tf(O,p.x-O.x,p.y-O.y,-y),C=Tf(O,M.x-O.x,M.y-O.y,-y);T.$24l={x:C.x-K.x,y:C.y-K.y},T.startDragging(_),m.beginTransaction(),T.fi({kind:"beginEditRotation",event:_,data:T._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(T.$67l)>=0){var D=T.$67l;(7===D||8===D||9===D)&&m.beginTransaction(),T.startDragging(_)}else if(T.$71l&&R&&T.$79l(T.$71l,M)){var f=N.toSelection();m.beginTransaction(),f.each(function(l){m.remove(l)}),m.endTransaction()}s()},$11l:function(){var Y=this,c=Y.gv;c._editing&&(Y.$13l==C||Y._shape==C&&Y._edge==C)&&(Y.$73l==C||1!==Y.$67l&&5!==Y.$67l&&6!==Y.$67l)||(Y.$5l=1),Y._68I=1},$46l:function(O){var r=this,Y=r.gv,a=Y.lp(O),L=[];return Aq(Y,function(t){var X=Y.getDataUI(t);if(X){var q=X._79o();h(q,a)&&L.push(t)}}),L},$47l:function(Z){var c=this,s=c.$13l,y=c.gv.dm();c.$10l?(c.fi({kind:"endEditRect",event:Z,direction:c.$10l}),y.endTransaction()):c._shape&&s>=0?(c.fi({kind:"endEditPoint",event:Z,data:c._shape,index:s}),y.endTransaction()):c._edge&&s>=0?(c.fi({kind:"endEditPoint",event:Z,data:c._edge,index:s}),y.endTransaction()):c.$23l&&c.$40l&&(c.fi({kind:"endEditRotation",event:Z}),y.endTransaction())},handleWindowTouchEnd:function(W){this.handleWindowMouseUp(W)},handleWindowMouseUp:function(Y){var v=this,V=v.gv,o=V.dm(),Z=v._shape,m=v._edge,U=v.$13l,y=v.$40l,a=v.$9l,u=v.$10l,d=v.$67l;if((Z||m)&&U>=0&&a>=0){var G,q;if(Z){var _=Z.p(),A=Z.getRotation();G=Z.getPoints(),q=G.get(a),lc(Z,_,A,U,q,!1)}else if(G=Hb(V.getDataUI(m),m.s("edge.points"),!0),q=G.get(a),0===U){var I=G.get(0);m.s("edge.source.offset.x",q.x-I.x),m.s("edge.source.offset.y",q.y-I.y)}else if(U===G.size()-1){var h=G.get(G.size()-1);m.s("edge.target.offset.x",q.x-h.x),m.s("edge.target.offset.y",q.y-h.y)}else"points"===m.s("edge.type")&&(G.set(U,q),m.s("edge.points",di(G)))}v.$47l(Y);var c=v.$73l;1===d?(o.beginTransaction(),c?V.sm().each(function(e){if(e.setHost&&V.isHelperEditable(e,"host")){e.setHost(c);
var Q=v.$75l,o=v.$74l;Q&&(e.s("attach.row.index",Q.rowIndex),e.s("attach.column.index",Q.columnIndex)),o&&(e.s("attach.index",o.attachIndex),e.s("attach.offset",o.attachOffset),e.s("attach.offset.relative",!1),e.s("attach.offset.opposite",!1))}}):V.sm().each(function(I){I.setHost&&V.isHelperEditable(I,"host")&&(I.setHost(C),I.s("attach.row.index",D),I.s("attach.column.index",D),I.s("attach.index",D),I.s("attach.offset",D),I.s("attach.offset.relative",!1),I.s("attach.offset.opposite",!1))}),o.endTransaction()):2===d?(o.beginTransaction(),c?V.sm().each(function(P){P.setParent&&V.isHelperEditable(P,"parent")&&P.setParent(c)}):V.sm().each(function(S){S.setParent&&V.isHelperEditable(S,"parent")&&S.setParent(C)}),o.endTransaction()):3===d?c&&(o.beginTransaction(),V.sm().each(function(Q){if(V.isHelperEditable(Q,"edge")&&Q instanceof H&&c instanceof H){var R=new i.Edge;o.add(R),R.setSource(Q),R.setTarget(c),v.onEdgeCreated&&v.onEdgeCreated(Y,R)}}),o.endTransaction()):5===d||6===d?c&&(o.beginTransaction(),V.sm().each(function(r){r instanceof O&&c instanceof H&&(5===d&&V.isHelperEditable(r,"source")?r.setSource(c):6===d&&V.isHelperEditable(r,"source")&&r.setTarget(c))}),o.endTransaction()):(7===d||8===d||9===d)&&o.endTransaction(),(u||y)&&v.$43l(!0),P?(v.clear(),delete v.$64l,v._68I||v.$43l()):(v.handle_mousemove(Y,!0),d&&!v._68I&&v.$43l())},handleWindowTouchMove:function(n){this.handleWindowMouseMove(n)},handleWindowMouseMove:function(R){this._78I(R)},handle_mousemove:function(z,j,D){if(!this._pause){if(!D){var Q=P?Gn(z):z;this.$61l={clientX:Q.clientX,clientY:Q.clientY}}if(j===!0||!S()){var d=this,q=d.gv,L=!1,F=C;d.clear(),q.sm().size()>0&&(F=q.lp(D?d.$61l:z),L=d._79I(z,F)),L&&(q._editing=1),d.$12l!==d.$65l&&(d.$65l=d.$12l,d.setCursor(d.$12l)),d.$40l!==d.$64l&&(d.$64l=d.$40l,d._68I||d.$43l()),d._hoverSegmentIndex!==d.$66l&&(d.$66l=d._hoverSegmentIndex,d._68I||d.$43l())}}},_78I:function(j){this.autoScroll(j);var Q=this,S=Q.gv,o=S.lp(j),a=S.getZoom(),V=Q.$13l;if((Q._shape||Q._edge)&&V>=0){var c,x,E,l=Q._shape,N=Q._edge,Y=Q.$24l,D=S.getPointSnapSpacing(),R=function(Z,B){return D==C||isNaN(D)?{x:Z,y:B}:{x:J(Z/D)*D,y:J(B/D)*D}};if(l){c=l.getPoints();var i=l.p(),I=l.getRotation(),h=0;x=Tf(i,o.x-i.x,o.y-i.y,-I),lc(l,i,I,V,o,!0,Y,R),Q.fi({kind:"betweenEditPoint",event:j,data:l,index:V})}else if(N){c=Hb(S.getDataUI(N),N.s("edge.points"),!0),o.x-=Y.x,o.y-=Y.y,x=o;var m,K,_=N.s("edge.offset"),z=c.size(),k=z>2;if(0===V){var g=c.get(0);_&&(g=Fo(g,c.get(1),-_,k),o=Fo(o,c.get(1),-_,k)),m=o.x-g.x,K=o.y-g.y,E=R(m,K),N.s("edge.source.offset.x",E.x),N.s("edge.source.offset.y",E.y)}else if(V===z-1){var u=c.get(z-1);_&&(u=Fo(u,c.get(z-2),-_,k),o=Fo(o,c.get(z-2),-_,k)),m=o.x-u.x,K=o.y-u.y,E=R(m,K),N.s("edge.target.offset.x",E.x),N.s("edge.target.offset.y",E.y)}else"points"===N.s("edge.type")&&(E=R(o.x,o.y),E.e=c.get(V).e,c.set(V,E),N.s("edge.points",di(c)));Q.fi({kind:"betweenEditPoint",event:j,data:N,index:V})}if(delete Q.$9l,S.isSnapPoint(l)||S.isSnapPoint(N))for(h=0;h<c.size();h++)if(h!==V){var n=c.get(h);if(U(n,x)<S.getEditPointSize()/a){Q.$9l=h;break}}}else if(Q.$10l){var Y=Q.$24l;o.x-=Y.x,o.y-=Y.y;var X=S.sm().getSelection(),y=Q.$1l,e=Q.$7l,Z=Q.$10l,P=Q.$4l,d=Q.$2l,T=S.getEditRectPadding()/a,p=2*T,q=S.getSnapSpacing(),f=q!=C&&!isNaN(q),b=fp(d,o,Z,e,2*T,S.getResizeMode(),f,!0),L=Q.$6l;if(f){var G=b.width-p,A=b.height-p,M=J(G/q)*q,fo=J(A/q)*q,Rd=M-G,Ln=fo-A;("west"===Z||"northwest"===Z||"southwest"===Z)&&(Rd=-Rd),("north"===Z||"northwest"===Z||"northeast"===Z)&&(Ln=-Ln),b=fp(d,o,Z,e,2*T,S.getResizeMode(),f,!1,Rd,Ln)}Q.$8l=b,L.x=b.x+T,L.y=b.y+T,L.width=b.width-p,L.height=b.height-p;var Lc=b.x+b.width/2,hq=b.y+b.height/2,ms=L.x,ed=L.y,zn=L.width/P.width,tk=L.height/P.height;X.each(function(J){if(J instanceof H&&S.isEditable(J)&&S.isRectEditable(J)){var F=y[J.getId()],N=Q.$3l[J.getId()],s={x:F.x+F.width/2,y:F.y+F.height/2},X=0,T=0,l=Z,D=180*B(e-J.getRotation())/W;"northeast"===Z?D>=315||45>D?(X=F.width*zn+F.x,T=F.height*(1-tk)+F.y,l="northeast"):D>=45&&135>D?(X=F.width*(1-tk)+F.x,T=F.height*(1-zn)+F.y,l="northwest"):D>=135&&225>D?(X=F.width*(1-zn)+F.x,T=F.height*tk+F.y,l="southwest"):(X=F.width*tk+F.x,T=F.height*zn+F.y,l="southeast"):"north"===Z?D>=315||45>D?(T=F.height*(1-tk)+F.y,l="north"):D>=45&&135>D?(X=F.width*(1-tk)+F.x,l="west"):D>=135&&225>D?(T=F.height*tk+F.y,l="south"):(X=F.width*tk+F.x,l="east"):"northwest"===Z?D>=315||45>D?(X=F.width*(1-zn)+F.x,T=F.height*(1-tk)+F.y,l="northwest"):D>=45&&135>D?(X=F.width*(1-tk)+F.x,T=F.height*zn+F.y,l="southwest"):D>=135&&225>D?(X=F.width*zn+F.x,T=F.height*tk+F.y,l="southeast"):(X=F.width*tk+F.x,T=F.height*(1-zn)+F.y,l="northeast"):"west"===Z?D>=315||45>D?(X=F.width*(1-zn)+F.x,l="west"):D>=45&&135>D?(T=F.height*zn+F.y,l="south"):D>=135&&225>D?(X=F.width*zn+F.x,l="east"):(T=F.height*(1-zn)+F.y,l="north"):"southwest"===Z?D>=315||45>D?(X=F.width*(1-zn)+F.x,T=F.height*tk+F.y,l="southwest"):D>=45&&135>D?(X=F.width*tk+F.x,T=F.height*zn+F.y,l="southeast"):D>=135&&225>D?(X=F.width*zn+F.x,T=F.height*(1-tk)+F.y,l="northeast"):(X=F.width*(1-tk)+F.x,T=F.height*(1-zn)+F.y,l="northwest"):"east"===Z?D>=315||45>D?(X=F.width*zn+F.x,l="east"):D>=45&&135>D?(T=F.height*(1-zn)+F.y,l="north"):D>=135&&225>D?(X=F.width*(1-zn)+F.x,l="west"):(T=F.height*zn+F.y,l="south"):"south"===Z?D>=315||45>D?(T=F.height*tk+F.y,l="south"):D>=45&&135>D?(X=F.width*tk+F.x,l="east"):D>=135&&225>D?(T=F.height*(1-tk)+F.y,l="north"):(X=F.width*(1-tk)+F.x,l="west"):"southeast"===Z&&(D>=315||45>D?(X=F.width*zn+F.x,T=F.height*tk+F.y,l="southeast"):D>=45&&135>D?(X=F.width*tk+F.x,T=F.height*(1-zn)+F.y,l="northeast"):D>=135&&225>D?(X=F.width*(1-zn)+F.x,T=F.height*(1-tk)+F.y,l="northwest"):(X=F.width*(1-tk)+F.x,T=F.height*zn+F.y,l="southwest"));var E=Tf(s,X-s.x,T-s.y,J.getRotation());Cd(J,F,l,{x:E.x,y:E.y});var f=ms+L.width*N.x,t=ed+L.height*N.y,x={x:f,y:t};x=Tf({x:Lc,y:hq},x.x-Lc,x.y-hq,e),J.p(x.x,x.y)}}),Q.fi({kind:"betweenEditRect",event:j,direction:Z})}else if(Q.$23l&&Q.$40l){var ek=Q.$8l,Wj=ek.width,Ub=ek.height,i={x:ek.x+Wj/2,y:ek.y+Ub/2},Y=Q.$24l,Pk=Q.$23l,en=Pk.x/a-i.x,br=Pk.y/a-i.y,Gr=F(en*en+br*br),pc=Math.asin(Y.x/Gr),vo=S.sm().getSelection(),Bb=$+v(o.y-i.y,o.x-i.x)-pc,is=S.getSnapAngle(),Bb=J(Bb/is)*is;0>Bb&&(Bb+=w);var pp=Bb-Q.$7l,Fm=[i.x,0,i.y];vo.each(function(z){if(S.isEditable(z)&&S.isRotationEditable(z)&&S.isVisible(z)){var N=im(z.p3(),Fm),V=qo();Ve(V,-pp),z.setRotation(z.getRotation()+pp),yr(N,V),z.p3(Fm[0]+N[0],Fm[1]+N[1],Fm[2]+N[2])}}),Q.$7l=Bb,Q.fi({kind:"betweenEditRotation",event:j})}else if([1,2,3,5,6].indexOf(Q.$67l)>=0)Q.$72l=j,Q.$78l||(Q.$78l=1,r(function(){t.isDragging()&&Q.$43l(),delete Q.$78l},12));else if(7===Q.$67l){if(Q.$87l instanceof s){var l=Q.$87l,Kh=Q.$88l,Cr=t.clone(l.getPoints().get(Kh)),Ob=o.y-Cr.y;Cr.e||(Cr.e=0),Q.$92l||(Q.$92l=Cr.e),Cr.e=Q.$92l-Ob,l.setPoint(Kh,Cr)}else if(Q.$87l instanceof O){var N=Q.$87l,Kh=Q.$88l,c=Hb(S.getDataUI(N),N.s("edge.points")),Cr=c.get(Kh),Ob=o.y-Cr.y;Cr.e||(Cr.e=0),Q.$92l||(Q.$92l=Cr.e),Cr.e=Q.$92l-Ob,c.set(Kh,Cr),N.s("edge.points",di(c))}}else if(8===Q.$67l){var vo=S.sm().getSelection(),om=Q.$93l;om||(om=Q.$93l={}),vo.each(function(X){if(X.p3){var x=X.p3(),E=om[X.getId()];E==C&&(E=om[X.getId()]=x[1]),X.p3([x[0],E-(o.y-Q.$90l.y/a),x[2]])}})}else if(9===Q.$67l){var vo=S.sm().getSelection(),Sd=Q.$94l;Sd||(Sd=Q.$94l={}),vo.each(function(I){if(I.s3){var J=I.s3(),L=Sd[I.getId()];L==C&&(L=Sd[I.getId()]=J[1]);var t=L-(o.y-Q.$91l.y/a);0>t&&(t=.01),I.s3([J[0],t,J[2]])}})}},$79l:function(L,U){var m=this,j=m.gv,H=j.getZoom(),T=j.getEditHelperSize(),A=L.x/H,K=L.y/H,I=T/H,G=I/2;return h({x:A-G,y:K-G,width:I,height:I},U)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(D,b){for(var E=this,R=E.gv,q=R.getZoom(),W=R.getEditPointSize(),p=W/q,V=p/2,o=E.$46l(D),l=0;l<o.length;l++){var A,K,m=o[l],i=R.getDataUI(m);if(i&&i._55O){var M=i._55O;if(M._43O&&m instanceof O){if(A=m.s("edge.points"),A=Hb(i,A),K=m.s("edge.segments"),K&&K.size()||(K=nn(A)),E.$42l(m,b,A._as,K,"edge"))return!0;if("points"===m.s("edge.type")&&E.$41l(m,b,A._as,K,"edge"))return}if(M._43O&&m instanceof s&&M.$15l&&M.$15l.length===m.getPoints().size()){if(A=M.$15l,K=m.getSegments(),K&&K.size()||(K=nn(A)),E.$42l(m,b,A,K,"shape"))return!0;if(E.$41l(m,b,A,K,"shape"))return}}}if(E.$16l){var A,k=E.$16l,X=k[3].x-k[7].x,v=k[3].y-k[7].y,y=F(X*X+v*v),f=k[1].x-k[5].x,$=k[1].y-k[5].y,u=F(f*f+$*$),j={x:b.x*q,y:b.y*q};if(E._80I(j,0,k[0],"northwest",y,u)||E._80I(j,1,k[1],"north",y,u)||E._80I(j,2,k[2],"northeast",y,u)||E._80I(j,7,k[7],"west",y,u)||E._80I(j,3,k[3],"east",y,u)||E._80I(j,6,k[6],"southwest",y,u)||E._80I(j,5,k[5],"south",y,u)||E._80I(j,4,k[4],"southeast",y,u))return!0}if(E.$23l){var x=E.$23l,Y=x.x/q,P=x.y/q;if(h({x:Y-V,y:P-V,width:p,height:p},b))return E.$40l=1,E.$12l=E.getHelperCursor("rotation")||"crosshair",!0}return E.$68l&&E.$79l(E.$68l,b)?(E.$67l=1,E.$12l=E.getHelperCursor("host")||"crosshair",!0):E.$69l&&E.$79l(E.$69l,b)?(E.$67l=2,E.$12l=E.getHelperCursor("parent")||"crosshair",!0):E.$70l&&E.$79l(E.$70l,b)?(E.$67l=3,E.$12l=E.getHelperCursor("edge")||"crosshair",!0):E.$71l&&E.$79l(E.$71l,b)?(E.$67l=4,E.$12l=E.getHelperCursor("remove")||"crosshair",!0):E.$82l&&E.$79l(E.$82l,b)?(E.$67l=5,E.$12l=E.getHelperCursor("source")||"crosshair",!0):E.$83l&&E.$79l(E.$83l,b)?(E.$67l=6,E.$12l=E.getHelperCursor("target")||"crosshair",!0):E._pointElevationHelperPoint&&E.$79l(E._pointElevationHelperPoint,b)?(E.$67l=7,E.$12l=E.getHelperCursor("pointElevation")||"crosshair",!0):E.$90l&&E.$79l(E.$90l,b)?(E.$67l=8,E.$12l=E.getHelperCursor("elevation")||"crosshair",!0):E.$91l&&E.$79l(E.$91l,b)?(E.$67l=9,E.$12l=E.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(o,B,i,e,E,Q){var C=this,c=C.gv,T=c.getEditPointSize(),P=T/2,y=c.sm(),A=c.isDirectionEditable;if(A&&1===y.size()){var t=y.ld();if(A=A.bind(c),t instanceof H){if(!A(t,e))return!1;if("east"===e){if(A(t,"northeast")&&A(t,"southeast")&&2*T>=Q)return!1}else if("west"===e){if(A(t,"northwest")&&A(t,"southwest")&&2*T>=Q)return!1}else if("north"===e){if(A(t,"northwest")&&A(t,"northeast")&&2*T>=E)return!1}else if("south"===e&&A(t,"southwest")&&A(t,"southeast")&&2*T>=E)return!1}}else{if(2*T>=E&&("north"===e||"south"===e))return!1;if(2*T>=Q&&("east"===e||"west"===e))return!1}if(h({x:i.x-P,y:i.y-P,width:T,height:T},o)){if(C.$10l!==e){var j=180*C.$7l/W,$="";j>=337.5||22.5>j?$="north":j>=22.5&&67.5>j?$="northeast":j>=67.5&&112.5>j?$="east":j>=112.5&&157.5>j?$="southeast":j>=157.5&&202.5>j?$="south":j>=202.5&&247.5>j?$="southwest":j>=247.5&&292.5>j?$="west":j>=292.5&&337.5>j&&($="northwest");var F=Td.indexOf($),$=Td[B-(1-F)+8];switch($){case"northwest":C.$12l="nwse-resize";break;case"northeast":C.$12l="nesw-resize";break;case"southwest":C.$12l="nesw-resize";break;case"southeast":C.$12l="nwse-resize";break;case"north":C.$12l="ns-resize";break;case"east":C.$12l="ew-resize";break;case"south":C.$12l="ns-resize";break;case"west":C.$12l="ew-resize"}C.$10l=e}return!0}return!1},$42l:function(b,U,F,s,W){var R,B=this,u=B.gv,V=u.getEditPointSize(),r=V/u.getZoom(),w=-1,a={x:U.x,y:U.y,width:0,height:0},H=function(H){"shape"===W?B._shape=b:B._edge=b,B._removePointIndex=H},Y=function(O){"shape"===W?B._shape=b:B._edge=b,B.$13l=O,B.$12l="crosshair"};for(l(a,r/2),w=F.length-1,R=s.size()-1;R>=0;R--){var z=s.get(R);if(1===z||2===z)w-=1;else if(3===z){var g=F[w-1];if(h(a,g))return Y(w-1),!0;w-=2}else if(4===z){var $=F[w-1],j=F[w-2];if(h(a,$))return Y(w-1),!0;if(h(a,j))return Y(w-2),!0;w-=3}}for(w=F.length-1,R=s.size()-1;R>=0;R--){var z=s.get(R),X=F[w];if(h(a,X))return H(w),Y(w),!0;1===z||2===z?w-=1:3===z?w-=2:4===z&&(w-=3)}return!1},$41l:function(Y,v,y,K,H){var t=this,d=t.gv,E=-1,w=0,R={x:v.x,y:v.y,width:0,height:0},Z=function(q,i){t._hoverSegmentIndex=i,t._lp=v,"shape"===H?t._shape=Y:t._edge=Y};for(l(R,d.getSegmentHoverWidth()/2/d.getZoom()),Y instanceof s&&Y.isClosePath()&&K.indexOf(5)<0&&(K=new T(K._as),K.add(5));w<K.size();w++){var S=K.get(w);if(1===S){var $=y[E],V=y[E+1];if($){var D=lr(new ui($.x,$.y),new ui(V.x,V.y),new ui(R.x,R.y),new ui(R.x+R.width,R.y+R.height));if(D.$62l===x&&D.points.length>0)return Z(D,w),!0}E+=1}else if(2===S){var $=y[E],V=y[E+1],D=lr(new ui($.x,$.y),new ui(V.x,V.y),new ui(R.x,R.y),new ui(R.x+R.width,R.y+R.height));if(D.$62l===x&&D.points.length>0)return Z(D,w),!0;E+=1}else if(3===S){var $=y[E],A=y[E+1],I=y[E+2],D=mr(new ui($.x,$.y),new ui(A.x,A.y),new ui(I.x,I.y),new ui(R.x,R.y),new ui(R.x+R.width,R.y+R.height));if(D.$62l===x)return Z(D,w),!0;E+=2}else if(4===S){var $=y[E],C=y[E+1],q=y[E+2],I=y[E+3],D=Yi(new ui($.x,$.y),new ui(C.x,C.y),new ui(q.x,q.y),new ui(I.x,I.y),new ui(R.x,R.y),new ui(R.x+R.width,R.y+R.height));if(D.$62l===x)return Z(D,w),!0;E+=3}else if(5===S){var $=y[E],V=y[0];if($){var D=lr(new ui($.x,$.y),new ui(V.x,V.y),new ui(R.x,R.y),new ui(R.x+R.width,R.y+R.height));if(D.$62l===x&&D.points.length>0)return Z(D,w),!0}}}return!1},addShapePoint:function(J,c,u){var f=this,Y=f.gv,x=Y.dm();if(x.beginTransaction(),0===arguments.length&&(J=f._shape||f._edge,c=f._hoverSegmentIndex,u=f._lp),J instanceof s||J instanceof O){var A=hs(J,Y.getDataUI(J),c);if(!isNaN(c)&&u&&!isNaN(A)){var N=u;if(J instanceof s){var C=J.p(),I=J.getRotation(),L=J.toSegments();L&&L.size()||(L=nn(J.getPoints())),J.isClosePath()&&L.indexOf(5)<0&&(L=new T(L._as),L.add(5));var t=L.get(c),D="addPoint",Q="removePointAt";if(2===t||1===t){var H={x:N.x,y:N.y};L.add(t,c),H=Tf(C,H.x-C.x,H.y-C.y,-I),J[D](H,A+1)}else if(3===t){var S=J.getPoints(),F=S.get(A),n=S.get(A+2),H={x:N.x,y:N.y};H=Tf(C,H.x-C.x,H.y-C.y,-I);var B=zc(F,H),M=zc(H,n);L.removeAt(c),L.add(3,c),L.add(3,c),J.setPoint(A+1,H),J[D](M,A+2),J[D](B,A+1)}else if(4===t){var S=J.getPoints(),F=S.get(A),n=S.get(A+3),H={x:N.x,y:N.y};H=Tf(C,H.x-C.x,H.y-C.y,-I);var B=Jp(F,H),M=Fr(F,H),m=Jp(H,n),_=Fr(H,n);L.removeAt(c),L.add(4,c),L.add(4,c),J[Q](A+1),J[Q](A+1),J[D](H,A+1),J[D](_,A+2),J[D](m,A+2),J[D](M,A+1),J[D](B,A+1)}else if(5===t){var H={x:N.x,y:N.y};L.add(2,c),H=Tf(C,H.x-C.x,H.y-C.y,-I),J[D](H,A+1)}J.isClosePath()&&L.remove(5),J.setSegments(L);var U=J.getWidth(),k=J.getHeight(),R=J.p().x-U/2,V=J.p().y-k/2;R-=C.x,V-=C.y;var e=sn(J,{x:R,y:V,width:U,height:k},I,C);J.p(e.x,e.y)}else if(J instanceof O){if("points"!==J.s("edge.type"))return x.endTransaction(),void 0;var S=J.s("edge.points");L=J.s("edge.segments"),S=Hb(Y.getDataUI(J),S),L&&L.size()||(L=nn(S)),L=new T(L._as.slice(0)),S=new T(S._as.slice(0));var t=L.get(c);if(2===t||1===t){var H={x:N.x,y:N.y};L.add(t,c),S.add(H,A+1)}else if(3===t){var F=S.get(A),n=S.get(A+2),H={x:N.x,y:N.y},B=zc(F,H),M=zc(H,n);L.removeAt(c),L.add(3,c),L.add(3,c),S.set(A+1,H),S.add(M,A+2),S.add(B,A+1)}else if(4===t){var F=S.get(A),n=S.get(A+3),H={x:N.x,y:N.y},B=Jp(F,H),M=Fr(F,H),m=Jp(H,n),_=Fr(H,n);L.removeAt(c),L.add(4,c),L.add(4,c),S.removeAt(A+1),S.removeAt(A+1),S.add(H,A+1),S.add(_,A+2),S.add(m,A+2),S.add(M,A+1),S.add(B,A+1)}J.s("edge.points",di(S)),J.s("edge.segments",L)}}}x.endTransaction()},removeShapePoint:function(u,I){var i=this,G="removeAt",z=i.gv,X=z.dm();if(X.beginTransaction(),0===arguments.length&&(u=i._shape||i._edge,I=i._removePointIndex),I>=0&&(u instanceof s||u instanceof O)){var Y=Jf(u,i.gv.getDataUI(u),I),H=I;if(u instanceof s){var U=u.p(),m=u.toSegments();m&&m.size()||(m=nn(u.getPoints()));var $=m.get(Y),R="removePointAt";if(1===$&&0===H)if(u.getPoints().size()>1){var t=m.get(Y+1);m[G](Y+1),3===t?u[R](H+1):4===t&&(u[R](H+2),u[R](H+1)),u[R](H)}else u.dm().remove(u);else 2===$||1===$?(m[G](Y),u[R](H)):3===$?(m[G](Y),u[R](H),u[R](H-1)):4===$&&(m[G](Y),u[R](H),u[R](H-1),u[R](H-2));u.setSegments(m);var q=u.getWidth(),e=u.getHeight(),r=u.p().x-q/2,J=u.p().y-e/2;r-=U.x,J-=U.y;var K=sn(u,{x:r,y:J,width:q,height:e},u.getRotation(),U);u.p(K.x,K.y)}else if(u instanceof O){if("points"!==u.s("edge.type"))return X.endTransaction(),void 0;var W=u.s("edge.points");if(m=u.s("edge.segments"),W&&(W=Hb(i.gv.getDataUI(u),W),m&&m.size()||(m=nn(W))),0===I||I===W.size()-1)return X.endTransaction(),void 0;m=new T(m._as.slice(0)),W=new T(W._as.slice(0));var $=m.get(Y);2===$||1===$?(m[G](Y),W[G](H)):3===$?(m[G](Y),W[G](H),W[G](H-1)):4===$&&(m[G](Y),W[G](H),W[G](H-1),W[G](H-2)),u.s("edge.segments",m),u.s("edge.points",di(W))}}X.endTransaction()},changeShapeSegment:function(M,q,r){var $=this,i=$.gv,b=i.dm();if(b.beginTransaction(),1!==arguments.length||isNaN(M)||(r=M,M=$._shape||$._edge,q=$._hoverSegmentIndex),M instanceof s||M instanceof O){var u=hs(M,$.gv.getDataUI(M),q);if(!isNaN(q)&&!isNaN(u))if(M instanceof s){var f=M.p(),x=M.toSegments();x&&x.size()||(x=nn(M.getPoints()));var Y=x.get(q),e=M.toPoints();if(1===r||2===r)1===Y||2===Y?x.set(q,r):3===Y?(x.set(q,r),e.removeAt(u+1)):4===Y&&(x.set(q,r),e.removeAt(u+1),e.removeAt(u+1));else if(3===r){var V=function(){var O=e.get(u),B=e.get(u+1),L=zc(O,B);x.set(q,3),e.add(L,u+1)};2===Y||1===Y?V():4===Y&&(e.removeAt(u+1),e.removeAt(u+1),V())}else if(4===r){var P=function(){var z=e.get(u),Z=e.get(u+1),N=Jp(z,Z),i=Fr(z,Z);x.set(q,4),e.add(N,u+1),e.add(i,u+2)};2===Y||1===Y?P():3===Y&&(e.removeAt(u+1),P())}M.setSegments(x),M.setPoints(e);var S=M.getWidth(),J=M.getHeight(),c=M.p().x-S/2,B=M.p().y-J/2;c-=f.x,B-=f.y;var G=new sn(M,{x:c,y:B,width:S,height:J},M.getRotation(),f);M.p(G.x,G.y)}else if(M instanceof O){if("points"!==M.s("edge.type"))return b.endTransaction(),void 0;var e=M.s("edge.points");x=M.s("edge.segments"),e&&(e=Hb($.gv.getDataUI(M),e),x&&x.size()||(x=nn(e))),x=new T(x._as.slice(0)),e=new T(e._as.slice(0));var Y=x.get(q);if(1===r||2===r)1===Y||2===Y?x.set(q,r):3===Y?(x.set(q,r),e.removeAt(u+1)):4===Y&&(x.set(q,r),e.removeAt(u+1),e.removeAt(u+1));else if(3===r){var V=function(){var P=e.get(u),v=e.get(u+1),s=zc(P,v);x.set(q,3),e.add(s,u+1)};2===Y||1===Y?V():4===Y&&(e.removeAt(u+1),e.removeAt(u+1),V())}else if(4===r){var P=function(){var R=e.get(u),B=e.get(u+1),g=Jp(R,B),N=Fr(R,B);x.set(q,4),e.add(g,u+1),e.add(N,u+2)};2===Y||1===Y?P():3===Y&&(e.removeAt(u+1),P())}M.s("edge.points",di(e)),M.s("edge.segments",x)}}b.endTransaction()},getDefaultSegments:function(D){var i=this.gv,L=i.getDataUI(D);if(D instanceof O){var B=D.s("edge.points");return B=Hb(L,B),nn(B)}if(D instanceof s){var B=D.getPoints(),Q=D.getSegments();return Q&&Q.size()>0?Q:nn(B)}},$43l:function(s){var u=this;s&&(u.$5l=1),u._68I=1,u._42()},_42:function(){var A=this;if(A._68I){delete A._68I;var Y=A.gv,j=A.$5l,B=Y.getZoom(),V=Y.getEditPointSize(),D=V/2,L=new T,P=A._view,J=A._edge,Q=A._shape,h=P.getContext("2d"),X=Y.tx(),p=Y.ty(),n=C,W=Y.getEditPointBackground(),S=Y.getControlPointBackground(),N=Y.getControlPointBorderColor(),f=Y.getEditPointBorderColor(),R=Y.getEditRectBorderColor(),r=Y.getDirectionLineColor(),e=Y.getSegmentHoverColor(),M=Y.getSnapPointBorderColor(),a=Y.getJoinPointBackground(),c=Y.getJoinPointBorderColor(),U=Y.getSegmentHoverWidth(),u=[5,5],E=Y.getEditRectBorderStyle();fd(Y,function(I){Y.isSelected(I)&&Y.isVisible(I)&&L.add(I)}),h.clearRect(0,0,q(P.width),q(P.height)),h.save(),y.translateAndScale(h,X,p,1);var v=C,m={x:0,y:0,width:0,height:0},G=0,$=0,d=0,b=0,z=0,x=0,ph=0,be=0,lg=0,co=0,xh=[];if(j?(delete A.$6l,delete A.$8l,delete A.$7l,delete A.$16l,delete A.$23l):(v=A.$6l,n=A.$7l),delete A.$68l,delete A.$69l,delete A.$71l,delete A.$70l,delete A.$82l,delete A.$83l,delete A._pointElevationHelperPoint,delete A.$90l,delete A.$91l,delete A.$75l,delete A.$74l,L.each(function(M){var V=Y.getDataUI(M);if(V){var D=V._55O;if(Y.isEditable(M))D._56O&&M instanceof H&&$++,xh.push(M),D._42O&&M instanceof H&&G++,Y.isHelperEditable(M,"host")&&b++,Y.isHelperEditable(M,"parent")&&d++,Y.isHelperEditable(M,"remove")&&z++,Y.isHelperEditable(M,"edge")&&x++,Y.isHelperEditable(M,"source")&&ph++,Y.isHelperEditable(M,"target")&&be++,Y.isHelperEditable(M,"elevation")&&lg++,Y.isHelperEditable(M,"tall")&&co++;else if(M instanceof g&&M.isExpanded()){var I=!0,i=Y.getEditableFunc();i&&(I=i(M)),I&&(Y.isHelperEditable(M,"host")&&b++,Y.isHelperEditable(M,"parent")&&d++,Y.isHelperEditable(M,"remove")&&z++,Y.isHelperEditable(M,"edge")&&x++,Y.isHelperEditable(M,"source")&&ph++,Y.isHelperEditable(M,"target")&&be++,Y.isHelperEditable(M,"elevation")&&lg++,Y.isHelperEditable(M,"tall")&&co++,xh.push(M))}}}),h.beginPath(),h.lineWidth=1,h.strokeStyle=Y.getNodeBorderColor(),xh.forEach(function(U){var Q=Y.getDataUI(U),I=Q._55O;if(j)if(n==C&&(n=U instanceof O?0:U instanceof g&&U.isExpanded()?0:U.getRotation(),A.$7l=n),v==C){var i,L,o;if(U instanceof g&&U.isExpanded()||U instanceof O){var F=Y.getDataUIBounds(U);L=F.width,o=F.height,i={x:F.x+L/2,y:F.y+o/2}}else i=U.p(),L=U.getWidth(),o=U.getHeight();v={x:i.x,y:i.y,width:0,height:0},m.x=i.x-L/2,m.y=i.y-o/2,m.width=L,m.height=o,v=k(v,m)}else{var i,L,o,t,P=v.x+v.width/2,u=v.y+v.height/2,Z={x:P,y:u};if(U instanceof g&&U.isExpanded()||U instanceof O){t=0;var F=Y.getDataUIBounds(U);L=F.width,o=F.height,i={x:F.x+L/2,y:F.y+o/2}}else i=U.p(),L=U.getWidth(),o=U.getHeight(),t=U.getRotation();var r={x:i.x-L/2,y:i.y-o/2,width:L,height:o},J={x:r.x,y:r.y},M={x:r.x+r.width,y:r.y},q={x:r.x,y:r.y+r.height},d={x:r.x+r.width,y:r.y+r.height},J=Tf(i,J.x-i.x,J.y-i.y,t),q=Tf(i,q.x-i.x,q.y-i.y,t),d=Tf(i,d.x-i.x,d.y-i.y,t),M=Tf(i,M.x-i.x,M.y-i.y,t),V=-n,f=Tf(Z,J.x-Z.x,J.y-Z.y,V),s=Tf(Z,M.x-Z.x,M.y-Z.y,V),x=Tf(Z,q.x-Z.x,q.y-Z.y,V),l=Tf(Z,d.x-Z.x,d.y-Z.y,V),X=_([f,s,x,l]);v=k(v,X),v.x-=P,v.y-=u;var W=sn(C,v,n,Z);v.x=W.x-v.width/2,v.y=W.y-v.height/2}if(G>1&&Y.isEditable(U)&&Y.isRectEditable(U)&&U instanceof H){var $=U.getRect(),K=I.$45l,b=Ge(K[0],B),R=Ge(K[2],B),z=Ge(K[4],B),N=Ge(K[6],B);U.getRotation()?(h.moveTo(b.x,b.y),h.lineTo(R.x,R.y),h.lineTo(z.x,z.y),h.lineTo(N.x,N.y),h.lineTo(b.x,b.y)):h.rect($.x*B,$.y*B,$.width*B,$.height*B)}}),h.stroke(),v){A.$6l=Z(v),l(v,Y.getEditRectPadding()/B);var $i={x:v.x+v.width/2,y:v.y+v.height/2},Dl=yj($i,v.width,v.height,n),ck=Dl[0],Zg=Dl[1],_n=Dl[2],Ch=Dl[3],mk=Dl[4],Io=Dl[5],Uf=Dl[6],Mk=Dl[7];if(ck=Ge(Dl[0],B),Zg=Ge(Dl[1],B),_n=Ge(Dl[2],B),Ch=Ge(Dl[3],B),mk=Ge(Dl[4],B),Io=Ge(Dl[5],B),Uf=Ge(Dl[6],B),Mk=Ge(Dl[7],B),A.$8l=v,G>0&&(A.$16l=[ck,mk,Zg,Io,Ch,Uf,_n,Mk],h.beginPath(),h.lineWidth=1,h.strokeStyle=R,"dashed"===E&&h.setLineDash&&h.setLineDash(u),h.moveTo(ck.x,ck.y),h.lineTo(Zg.x,Zg.y),h.lineTo(Ch.x,Ch.y),h.lineTo(_n.x,_n.y),h.lineTo(ck.x,ck.y),h.stroke(),"dashed"===E&&h.setLineDash&&h.setLineDash([])),h.beginPath(),h.lineWidth=1,h.fillStyle=W,h.strokeStyle=f,G>0){var nb=Io.x-Mk.x,_q=Io.y-Mk.y,xs=F(nb*nb+_q*_q),Yk=mk.x-Uf.x,gc=mk.y-Uf.y,Nf=F(Yk*Yk+gc*gc),gp=2*V;if(Y.isDirectionEditable&&1===xh.length){var Mc=xh[0],Ve=Y.getDataUI(Mc),hq=Ve._55O,Oq=Y.isDirectionEditable.bind(Y);if(hq._42O){var ic,gn,fj,Yj;Oq(Mc,"northwest")&&(ic=!0,h.rect(ck.x-D,ck.y-D,V,V)),Oq(Mc,"northeast")&&(gn=!0,h.rect(Zg.x-D,Zg.y-D,V,V)),Oq(Mc,"southwest")&&(fj=!0,h.rect(_n.x-D,_n.y-D,V,V)),Oq(Mc,"southeast")&&(Yj=!0,h.rect(Ch.x-D,Ch.y-D,V,V)),Oq(Mc,"north")&&(ic&&gn?xs>gp&&h.rect(mk.x-D,mk.y-D,V,V):h.rect(mk.x-D,mk.y-D,V,V)),Oq(Mc,"south")&&(Yj&&fj?xs>gp&&h.rect(Uf.x-D,Uf.y-D,V,V):h.rect(Uf.x-D,Uf.y-D,V,V)),Oq(Mc,"west")&&(fj&&ic?Nf>gp&&h.rect(Mk.x-D,Mk.y-D,V,V):h.rect(Mk.x-D,Mk.y-D,V,V)),Oq(Mc,"east")&&(Yj&&gn?Nf>gp&&h.rect(Io.x-D,Io.y-D,V,V):h.rect(Io.x-D,Io.y-D,V,V))}}else xs>gp&&(h.rect(mk.x-D,mk.y-D,V,V),h.rect(Uf.x-D,Uf.y-D,V,V)),Nf>gp&&(h.rect(Io.x-D,Io.y-D,V,V),h.rect(Mk.x-D,Mk.y-D,V,V)),h.rect(ck.x-D,ck.y-D,V,V),h.rect(Zg.x-D,Zg.y-D,V,V),h.rect(_n.x-D,_n.y-D,V,V),h.rect(Ch.x-D,Ch.y-D,V,V)}if($>0){var xk=A.$23l=Tf(mk,0,2*-V,n);h.moveTo(xk.x+D,xk.y),h.arc(xk.x,xk.y,D,0,w,!1)}h.fill(),h.stroke(),A.$40l&&A.$44l(h,v,n);var Rr,Zb,qf=Y.getLeftTopHelpers(),om=Y.getRightTopHelpers(),Oc=Y.getLeftBottomHelpers(),gq=Y.getRightBottomHelpers(),tm=Y.getEdgeHelpers(),Sf=Y.getEditHelperSize(),Dq=Sf/2,_k=function($,C,i,k){"leftTop"===C?(Rr=v.x*B-Sf-D-("h"===k?i*(Sf+D):0)-1,Zb=v.y*B-Sf-D-("v"===k?i*(Sf+D):0)-1):"rightTop"===C?(Rr=(v.x+v.width)*B+D+("h"===k?i*(Sf+D):0)+1,Zb=v.y*B-Sf-D-("v"===k?i*(Sf+D):0)-1):"leftBottom"===C?(Rr=v.x*B-Sf-D-("h"===k?i*(Sf+D):0)-1,Zb=(v.y+v.height)*B+D+("v"===k?i*(Sf+D):0)+1):"rightBottom"===C&&(Rr=(v.x+v.width)*B+D+("h"===k?i*(Sf+D):0)+1,Zb=(v.y+v.height)*B+D+("v"===k?i*(Sf+D):0)+1);var f=Rr+Dq,o=Zb+Dq,H=(v.x+v.width/2)*B,W=(v.y+v.height/2)*B,p=Tf({x:H,y:W},f-H,o-W,n);if("host"===$){if(b>0)return A.$77l(h,n,p),!0}else if("edge"===$){if(x>0)return A.$80l(h,n,p),!0}else if("remove"===$){if(z>0)return xh&&1===xh.length&&xh[0]instanceof O?A.$81l(h,n,{x:H+Sf/2+5,y:W}):A.$81l(h,n,p),!0}else if("parent"===$){if(d>0)return xh&&1===xh.length&&xh[0]instanceof O?A.$76l(h,n,{x:H-Sf/2-5,y:W}):A.$76l(h,n,p),!0}else if("elevation"===$){if(lg>0)return A.$85l(h,n,p),!0}else if("tall"===$){if(co>0)return A.$86l(h,n,p),!0}else if("source"===$||"target"===$){var r=xh[0],G=Y.getDataUI(r),R=vi(G,!0),s=R[0],U=R[1];if(ph&&"source"===$)return A.$84l(h,v,s,!0,r.isLooped(),C,i,k),!0;if(be&&"target"===$)return A.$84l(h,v,U,!1,r.isLooped(),C,i,k),!0}};if(qf&&qf.length>0){var Sg=0;qf.forEach(function(C){_k(C,"leftTop",Sg,Y.getLeftTopHelpersAlign()||"h")&&Sg++})}if(om&&om.length>0){var Sg=0;om.forEach(function(I){_k(I,"rightTop",Sg,Y.getRightTopHelpersAlign()||"h")&&Sg++})}if(Oc&&Oc.length>0){var Sg=0;Oc.forEach(function(I){_k(I,"leftBottom",Sg,Y.getLeftBottomHelpersAlign()||"h")&&Sg++})}if(gq&&gq.length>0){var Sg=0;gq.forEach(function(l){_k(l,"rightBottom",Sg,Y.getRightBottomHelpersAlign()||"h")&&Sg++})}if(tm&&tm.length>0&&((ph||be)&&xh&&1===xh.length&&xh[0]instanceof O?!0:!1)){var Sg=0;tm.forEach(function(O){_k(O,"edge",Sg,"h")&&Sg++})}if(A.$72l){var Ee,Gf=A.$67l,Um=A.$68l,ei=A.$69l,Mm=(A.$71l,A.$70l),Ui=A.$82l,se=A.$83l;if(1===Gf?Ee=Um:2===Gf?Ee=ei:3===Gf?Ee=Mm:5===Gf?Ee=Ui:6===Gf&&(Ee=se),Ee){var en=Y.lp(A.$72l),_j=Y.getDataAt(A.$72l);if(_j&&_j instanceof H){var Ud,Zr,pg;if(A.$73l=_j,1===Gf)if(_j instanceof i.Grid)Ud=A.$75l=Mi(_j,en);else if(_j instanceof i.Shape){pg=A.$74l=Ke(_j,en);var km=_j.getPoints();if(pg){var pq=pg.attachIndex,Vh=hs(_j,Y.getDataUI(_j),pq)+1,Dr=Vh+1>=km.size()?0:Vh+1,Wm=km.get(Vh),Me=km.get(Dr),cg=_j.p(),Tb=_j.getRotation();Wm=Tf(cg,Wm.x-cg.x,Wm.y-cg.y,Tb),Me=Tf(cg,Me.x-cg.x,Me.y-cg.y,Tb),h.beginPath(),h.strokeStyle=e,h.lineWidth=U,h.moveTo(Wm.x*B,Wm.y*B),h.lineTo(Me.x*B,Me.y*B),h.stroke()}}Ud?Zr=Ud.rect:(Zr=t.clone(Y.getDataUIBounds(_j)),t.grow(Zr,2)),h.beginPath(),h.rect(Zr.x*B,Zr.y*B,Zr.width*B,Zr.height*B),h.strokeStyle=1===Gf||4===Gf||6===Gf?K:I,h.lineWidth=2,h.setLineDash&&h.setLineDash([8,8]),h.stroke()}else delete A.$73l;en.x=en.x*B,en.y=en.y*B;var Vc=kh(Ee.x,Ee.y,en.x,en.y),Ql=Tf(Ee,en.x-Ee.x,en.y-Ee.y,-Vc),$p=Ql.x-Ee.x;h.save(),h.translate(Ee.x,Ee.y),h.rotate(Vc),o.width=$p,o.height=40;var fe=I;(1===Gf||4===Gf||6===Gf)&&(fe=K),o.comps[0].gradientColor=fe,t.drawImage(h,o,0,-20,$p,40),h.restore()}}}if(L.each(function(g){var E=Y.getDataUI(g);if(E){var R,y,o=E._55O,m=E._78o;if(o&&o._43O&&g instanceof s?(R=o.$15l,y=g.getSegments(),y&&y.size()||(y=nn(R)),g.isClosePath()&&y.indexOf(5)<0&&(y=new T(y._as),y.add(5))):o&&m&&o._43O&&(R=g.s("edge.points"),y=g.s("edge.segments"),R=Hb(E,R),y&&y.size()||(y=nn(R)),R&&(R=R._as)),R&&y){var v=0,t=y.size(),P=A._hoverSegmentIndex;R=R.slice(0);for(var b=0;b<R.length;b++)R[b]=Ge(R[b],B);h.beginPath(),h.strokeStyle=r,h.lineWidth=1,v=0;for(var b=0;t>b;b++){var l=y.get(b);if(1===l||2===l)v++;else if(3===l){var n=R[v-1],z=R[v],$=R[v+1];h.moveTo(n.x,n.y),h.lineTo(z.x,z.y),h.lineTo($.x,$.y),v+=2}else if(4===l){var n=R[v-1],O=R[v],x=R[v+1],$=R[v+2];h.moveTo(n.x,n.y),h.lineTo(O.x,O.y),h.moveTo(x.x,x.y),h.lineTo($.x,$.y),v+=3}}if(h.stroke(),Q===g||J===g&&"points"===J.s("edge.type")){h.beginPath(),v=0,h.strokeStyle=e,h.lineWidth=U;for(var b=0;t>b;b++){var l=y.get(b);if(1===l||2===l){if(P===b){var n=R[v-1],$=R[v];h.moveTo(n.x,n.y),h.lineTo($.x,$.y);break}v++}else if(3===l){if(P===b){var n=R[v-1],z=R[v],$=R[v+1];h.moveTo(n.x,n.y),h.quadraticCurveTo(z.x,z.y,$.x,$.y);break}v+=2}else if(4===l){if(P===b){var n=R[v-1],O=R[v],x=R[v+1],$=R[v+2];h.moveTo(n.x,n.y),h.bezierCurveTo(O.x,O.y,x.x,x.y,$.x,$.y);break}v+=3}else if(5===l&&P===b){var n=R[v-1],$=R[0];h.moveTo(n.x,n.y),h.lineTo($.x,$.y);break}}h.stroke()}h.beginPath(),v=0,h.strokeStyle=c,h.lineWidth=1,h.fillStyle=a;for(var b=0;t>b;b++){var l=y.get(b);if(1===l||2===l){var $=R[v];h.moveTo($.x+D,$.y),h.arc($.x,$.y,D,0,w,!0),v++}else if(3===l){var $=R[v+1];h.moveTo($.x+D,$.y),h.arc($.x,$.y,D,0,w,!0),v+=2}else if(4===l){var $=R[v+2];h.moveTo($.x+D,$.y),h.arc($.x,$.y,D,0,w,!0),v+=3}}h.fill(),h.stroke(),h.beginPath(),v=0,h.strokeStyle=N,h.lineWidth=1,h.fillStyle=S;for(var b=0;t>b;b++){var l=y.get(b);if(1===l||2===l)v++;else if(3===l){var z=R[v];h.moveTo(z.x+D,z.y),h.arc(z.x,z.y,D,0,w,!0),v+=2}else if(4===l){var O=R[v],x=R[v+1];h.moveTo(O.x+D,O.y),h.arc(O.x,O.y,D,0,w,!0),h.moveTo(x.x+D,x.y),h.arc(x.x,x.y,D,0,w,!0),v+=3}}if(h.fill(),h.stroke(),h.beginPath(),v=0,h.strokeStyle=M,h.lineWidth=2,(Q===g||J===g)&&A.$9l!=C){var $=R[A.$9l];h.moveTo($.x+D,$.y),h.arc($.x,$.y,D,0,w,!0),h.stroke()}}}}),A.$87l&&Y.sm().contains(A.$87l)){var Kr,rb=A.$87l,Jp=A.$88l,Sf=Y.getEditHelperSize(),Dq=Sf/2;if(Y.isHelperEditable(rb,"pointElevation"))if(rb instanceof s){var Zh=rb.getPosition();Kr=t.clone(rb.getPoints().get(Jp)),Kr=Tf({x:Zh.x,y:Zh.y},Kr.x-Zh.x,Kr.y-Zh.y,rb.getRotation()),Kr.x*=B,Kr.y*=B,h.translate(Kr.x,Kr.y),t.drawImage(h,t.getImage("xeditinteractor_elevationIcon"),Dq,-Dq,Sf,Sf),h.translate(-Kr.x,-Kr.y),A._pointElevationHelperPoint={x:Kr.x+Sf,y:Kr.y}}else if(rb instanceof O){var io=Hb(Y.getDataUI(rb),rb.s("edge.points")),Kr=t.clone(io.get(Jp));Kr.x*=B,Kr.y*=B,h.translate(Kr.x,Kr.y),t.drawImage(h,t.getImage("xeditinteractor_elevationIcon"),Dq,-Dq,Sf,Sf),h.translate(-Kr.x,-Kr.y),A._pointElevationHelperPoint={x:Kr.x+Sf,y:Kr.y}}}h.restore(),A.$5l=0}},$89l:function(O,K,z,H){O.save();var C=this,F=C.gv,x=F.getEditHelperSize(),q=x/2;O.beginPath(),O.translate(z.x,z.y),O.rotate(K),t.drawImage(O,H,-q,-q,x,x),O.restore()},$85l:function(A,y,z){var g=this;g.$90l=z,g.$89l(A,y,z,t.getImage("xeditinteractor_elevationIcon"))},$86l:function($,M,S){var e=this;e.$91l=S,e.$89l($,M,S,t.getImage("xeditinteractor_tallIcon"))},$77l:function(l,D,N){var j=this;j.$68l=N,j.$89l(l,D,N,t.getImage("xeditinteractor_hostIcon"))},$80l:function(O,L,y){var M=this;M.$70l=y,M.$89l(O,L,y,t.getImage("xeditinteractor_edgeIcon"))},$81l:function(I,x,b){var G=this;G.$71l=b,G.$89l(I,x,b,t.getImage("xeditinteractor_removeIcon"))},$76l:function(Z,m,P){var F=this;F.$69l=P,F.$89l(Z,m,P,t.getImage("xeditinteractor_parentIcon"))},$84l:function(e,$,q,O,o){var B,Q=this,_=Q.gv,m=_.getZoom(),b=_.getEditHelperSize(),l=b/2;q.x*=m,q.y*=m,o&&(O?q.x-=l+5:q.x+=l+5),q.y-=b-2,O?(Q.$82l=q,B=t.getImage("xeditinteractor_sourceIcon")):(Q.$83l=q,B=t.getImage("xeditinteractor_targetIcon")),e.beginPath(),e.translate(q.x,q.y),t.drawImage(e,B,-l,-l,b,b),e.translate(-q.x,-q.y)},$44l:function(S,G,b){S.save();var B=this.gv.getZoom(),T=F(X(G.width,2)+X(G.height,2))/2*B+10,D=T,d=D+8,o=D+18,R=b,P=G.x+G.width/2,g=G.y+G.height/2;S.translate(P*B,g*B),S.beginPath(),S.strokeStyle="rgb(150, 150, 150)";for(var z=0,i=0,w=0,y=0,v=0,f=0;360>f;f++)z=f*W/180,0===f%5&&(i=j(z)*D,w=L(z)*D,y=j(z)*d,v=L(z)*d,S.moveTo(i,w),S.lineTo(y,v)),0===f%45&&(i=j(z)*D,w=L(z)*D,y=j(z)*o,v=L(z)*o,S.moveTo(i,w),S.lineTo(y,v));S.stroke(),S.beginPath(),S.rotate(-$),S.beginPath(),S.fillStyle="rgba(255, 0, 0, 0.1)",S.strokeStyle="rgb(157, 157, 157)",S.moveTo(0,0),S.arc(0,0,o,0,b,!1),S.fill(),S.beginPath(),S.moveTo(0+o,0),S.arc(0,0,o,0,b,!1),S.stroke(),S.rotate($),S.font="bold 12px Verdana, Arial";var Q=20*L(R),Y=20*j(R),s=J(180*R/W)+"°";S.textAlign="center",S.textBaseline="middle",S.beginPath();var E=S.measureText("365.°").width;S.fillStyle="white",S.rect(Q-E/2,-Y-10,E,20),S.fill(),S.beginPath(),S.fillStyle="rgb(79,79,79)",S.fillText(s,Q,-Y),S.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);