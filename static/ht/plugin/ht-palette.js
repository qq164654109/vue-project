!function($,A,r){"use strict";var l="px",p="0",u="innerHTML",d="className",S=ht.Default,V=ht.Color,B=ht.Node,q="position",i="top",X="left",o=S.animate,c=S.getInternal(),y="width",p="0",j="none",z="max-height",H="font",Y="background",e="border-box",v="user-select",J="box-sizing",w="overflow",L=S.isTouchable,c=S.getInternal(),N=V.titleIconBackground,W=S.scrollBarInteractiveSize,K=/msie 9/.test($.navigator?$.navigator.userAgent.toLowerCase():""),U=null,x=function(){return document},_=function(P){return x().createElement(P)},I=function(){return _("div")},g=function(){var _=I(),v=_.style;return v.msTouchAction=j,v.cursor="default",L&&v.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",U),v.position="absolute",v.left=p,v.top=p,_},M=function(){return _("canvas")},P=function(){return document.body},s=function(i,j,$){i.style.setProperty(j,$,U)},E=function(W,t){W.style.removeProperty(t)},O=function(E,T,M){S.def(ht.widget[E],T,M)},G=function(e,H){e.appendChild(H)},k=function(g,p){g.removeChild(p)},h=S.eventListenerOptionsFalse,R=(S.eventListenerOptionsTrue,function(r,T,Y,M){r.addEventListener(T,Y,M?h:h)});c.addMethod(S,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:N,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:N}]},paletteTitleLabelColor:S.labelSelectColor,paletteTitleLabelFont:S.labelFont,paletteContentLabelFont:S.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:S.widgetTitleHeight,paletteTitleBackground:V.titleBackground,paletteTitleHoverBackground:V.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:r,paletteItemHoverBorderColor:V.highlight,paletteItemSelectBackground:V.highlight},!0);var Z=".palette-item:hover{border: 1px solid "+S.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+S.paletteTitleHoverBackground+" !important}",D=document.createElement("style");L||(D.styleSheet?D.styleSheet.cssText=Z:D.appendChild(x().createTextNode(Z))),x().getElementsByTagName("head")[0].appendChild(D);var f=function(w){var r=this;r.$22h=w,r.addListeners()};S.def(f,A,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var m=this;m.$36h&&P().removeChild(m.$36h),m.$23h=m.$24h=m.$25h=m.$35h=m.$36h=U},handle_touchstart:function(z){for(var E,s=this,W=s.$22h,m=z.target,Q=W.sm(),g=W.dm(),O="palette-header",L="palette-header-tool",M="palette-item",i=!1,x=!1,u=!1;m&&(m[d]||"").indexOf(O)<0&&(m[d]||"").indexOf(M)<0;)m=m.parentNode;if(m&&m[d].indexOf(L)>=0?i=!0:m&&m[d].indexOf(O)>=0?u=!0:m&&m[d].indexOf(M)>=0&&(x=!0),S.isLeftButton(z))if(s.$27h(z))s.$24h=S.getClientPoint(z),s.$25h=W.ty();else if(i){S.preventDefault(z),E=m.parentNode.$11h;var Y=g.getDataById(E),o=Y.s("tools")[m.toolIndex];o.action&&o.action.call(W)}else if(u){S.preventDefault(z),E=m.$11h;var Y=g.getDataById(E);Y.isExpanded()?Y.setExpanded(!1):Y.setExpanded(!0)}else if(x){E=m.$11h;var V=g.getDataById(E);Q.ss(V),W.handleDragAndDrop&&(S.preventDefault(z),V.s("draggable")&&(W.handleDragAndDrop(z,"prepare"),s.$35h=0)),V.s("draggable")||(S.preventDefault(z),s.$24h=S.getClientPoint(z),s.$25h=W.ty())}else S.preventDefault(z),s.$24h=S.getClientPoint(z),s.$25h=W.ty();else s.$26h(z)},handle_mousedown:function(z){this.handle_touchstart(z)},handle_mousewheel:function(y){this.handleScroll(y,y.wheelDelta/40,y.wheelDelta!==y.wheelDeltaX)},handle_DOMMouseScroll:function(D){this.handleScroll(D,-D.detail,1)},handleScroll:function(N,b,k){var O=this.$22h;S.preventDefault(N),k&&O._41o()&&O.ty(O.ty()+20*b)},handle_mouseup:function(L){this.handle_touchend(L)},handle_touchend:function(Z){var B=this;B.$37h(Z),B.$26h(Z)},handleWindowMouseUp:function(j){this.handleWindowTouchEnd(j)},handleWindowTouchEnd:function(T){var r=this;r.$37h(T),r.$26h(T)},$37h:function(D){var N=this,n=N.$22h;2===N.$35h&&(N.$35h=3,n.handleDragAndDrop(D,"end"))},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowTouchMove:function(r){var m=this,f=m.$22h,H=m.$23h,R=m.$24h,O=m.$25h,e=S.getClientPoint(r),d=f._29I,z=m.$36h;if(1===m.$35h||2===m.$35h){if(m.$35h=2,f.handleDragAndDrop(r,"between"),L){var t=r.touches[0];r=t?t:r.changedTouches[0]}z.style.left=r.pageX-parseInt(z.width)/2+l,z.style.top=r.pageY-parseInt(z.height)/2+l}else"p"===H?f.ty(O+e.y-R.y):"v"===H&&f.ty(O+(R.y-e.y)/d.height*f._59I)},handle_mousemove:function(q){this.handle_touchmove(q)},handle_touchmove:function(K){if(!S.isDragging()&&S.isLeftButton(K)){var _=this,J=_.$22h,g=_.$27h(K);if(_.$24h){if(!_.$23h){if(S.getDistance(S.getClientPoint(K),_.$24h)<2)return;_.$23h=g?"v":"p",S.startDragging(_)}}else if(g)J._43o();else if(0===_.$35h){if(_.$35h=1,J.handleDragAndDrop(K,"begin"),L){var x=K.touches[0];K=x?x:K.changedTouches[0]}var m=_.$36h=new Image,p=J.$10h[J.sm().ld().getId()].querySelector(".image-box"),Y=parseInt(p.style.width),n=parseInt(p.style.height);m.draggable=!1,m.src=p.toDataURL(),m.width=Y,m.height=n,m.style.position="absolute",m.style.left=K.pageX-Y/2+l,m.style.top=K.pageY-n/2+l,P().appendChild(m),S.startDragging(_)}}},$27h:function(V){var K=this.$22h,Y=K.getView(),E=Y.getBoundingClientRect(),t=K._29I,N=V.clientX-E.left+Y.scrollLeft;return K._41o()&&t.x+t.width-N<W}}),ht.widget.Palette=function(H){var E=this,a=E._view=c.createView(null,E);E.$9h={},E.$10h={},E.$4h={},E._29I={x:0,y:0,width:0,height:0},E._59I=0,E.dm(H?H:new ht.DataModel),a[d]="ht-widget-palette",E.$29h=new f(E),s(a,Y,S.paletteContentBackground),s(a,w,"auto"),s(a,J,e),s(a,"-moz-"+J,e),s(a,"-webkit-"+v,j),s(a,"-moz-"+v,j),s(a,"-ms-"+v,j),s(a,v,j),s(a,"position","absolute"),s(a,"overflow","hidden"),G(a,E._79O=g()),R(a,"dragstart",function(w){w.dataTransfer&&(w.dataTransfer.setData("Text","nodeid:"+w.target.$11h),w.dataTransfer.effectAllowed="all",E.$29h.$26h())})},O("Palette",A,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:S.autoHideScrollBar,_scrollBarSize:S.scrollBarSize,_scrollBarColor:S.scrollBarColor,getViewRect:function(){return this._29I},ty:function(H){return H==U?this.getTranslateY():(this.setTranslateY(H),void 0)},setTranslateY:function(u){if(this.$32h==U){var g=this,P=g.$33h(u),G=g.$30h;g.$30h=P,g.fp("translateY",G,P)}},getTranslateY:function(){return this.$30h},setLayout:function(x){var j,h,q=this,k=q._layout;q._layout=x,"smallicons"===x?j=h=20:"iconsonly"===x?j=h=50:(j=70,h=50),q.setItemImageWidth(j),q.setItemImageHeight(h),q.setItemImagePadding(4),q.fp("layout",k,x)},getDataAt:function(b){for(var X=b.target;X&&X.$11h==U;)X=X.parentNode;return X&&X.$11h!=U?this.getDataModel().getDataById(X.$11h):void 0},$20h:function(){var t=16;return L&&(t*=1.2),t},$19h:function(){return S.paletteTitleHeight},$18h:function(){var p=S.paletteSeparatorWidth,x=S.paletteTitleBackground,f=S.paletteSeparatorColor||S.brighter(x);return p+l+" solid "+f},$17h:function(V){s(V,"cursor","pointer"),s(V,"display","inline-block"),s(V,"margin-right",(L?8:4)+l),s(V,"vertical-align",i)},$1h:function(A){var P=this,T=I(),r=I(),v=_("span");T[d]="palette-header",s(T,q,"relative"),s(T,Y,S.paletteTitleBackground),s(T,"color",S.paletteTitleLabelColor),s(T,i,p),s(T,J,e),s(T,"-moz-"+J,e),s(T,"padding","0 5px 0 0"),s(T,"border-top",P.$18h()),s(T,y,"100%"),s(T,"cursor","pointer"),s(T,"white-space","nowrap"),s(T,w,"hidden"),s(T,H,S.paletteTitleLabelFont),s(T,"line-height",P.$19h()+l),T.$11h=A.getId();var n=M(),b=P.$19h(),j=P.$20h();P.$17h(n),c.setCanvas(n,j,b),G(T,n);var o=A.s("tools");if(o)for(var x=0;x<o.length;x++){var Z=M();P.$17h(Z),c.setCanvas(Z,j,b),Z[d]="palette-header-tool palette-header-tool"+A.getId()+"-"+x,Z.style.position="absolute",Z.style.right=(j+10)*x+"px",Z.toolIndex=x,G(T,Z)}return n[d]="palette-toggle-icon-"+A.getId(),r[d]="palette-content",s(r,"max-height",0+l),s(r,H,S.paletteContentLabelFont),s(r,w,"hidden"),r.$11h=A.getId(),P.$9h[A.getId()]=r,v[u]=A.getName(),s(v,H,S.paletteTitleLabelFont),G(T,n),G(T,v),[T,r]},$2h:function(e){var E=this,p=E._layout,y=K&&e.s("draggable")?_("a"):I(),q=M(),v=I(),P=e.getName()||"",m=e.s("title")||e.getToolTip()||P,J=E._itemMargin;q[d]="image-box";var Z=E.getItemImageWidth(),V=E.getItemImageHeight();return c.setCanvas(q,Z,V),G(y,q),v[u]=P,v[d]="label-box","iconsonly"!==p&&G(y,v),y[d]="palette-item",s(y,"vertical-align",i),s(y,"cursor","pointer"),s(y,"border-radius",5+l),s(y,"border","1px solid transparent"),s(y,"text-align","center"),s(y,"display","inline-block"),s(y,"margin-left",J+l),s(y,"margin-top",J+l),s(y,"color",S.paletteContentLabelColor),"smallicons"===p?(s(q,"vertical-align","middle"),s(y,"margin-left",2+l),s(y,"margin-top",2+l),s(y,"padding",2+l),s(y,"text-align",X),s(v,"display","inline-block"),s(v,"min-width",E.$21h+E._itemMargin+l)):"largeicons"===p&&(s(v,"max-width",Z+l),s(v,"overflow","hidden")),y.$11h=e.getId(),m&&(y.title=m),e.s("draggable")&&!E.handleDragAndDrop&&(K?(y.href="#",s(y,"text-decoration",j)):y.draggable="true"),y},$16h:function(J,f,N,H){var P=c.initContext(J);c.translateAndScale(P,0,0,1),P.clearRect(0,0,N,N);var Q=(N-H)/2;S.drawStretchImage(P,S.getImage(f),"fill",0,Q,H,H),P.restore()},$15h:function(d){var F=this,Y=d.getId(),o=F._view.querySelector(".palette-toggle-icon-"+Y),e=d.isExpanded()?S.paletteCollapseIcon:S.paletteExpandIcon;if(o&&e){var W=F.$19h(),A=F.$20h();F.$16h(o,e,W,A)}},_drawToolsIcon:function(e){var F=this,E=e.s("tools");if(E)for(var A=0;A<E.length;A++){var R=F._view.querySelector(".palette-header-tool"+e.getId()+"-"+A),Y=E[A].icon,n=F.$19h(),v=F.$20h();F.$16h(R,Y,n,v)}},$14h:function(i){var H=this,n=i.getId(),N=H.$10h[n].querySelector(".image-box"),h=i.getImage(),A=i.s("image.stretch");if(N&&h){var b=c.initContext(N),l=H.getItemImagePadding();l="smallicons"===H._layout?l/2:l;var R=H.getItemImageWidth()-2*l,f=H.getItemImageHeight()-2*l;c.translateAndScale(b,0,0,1),b.clearRect(0,0,R,f),S.drawStretchImage(b,S.getImage(h),A,l,l,R,f,i,H),b.restore()}},validateImpl:function(){var s,v,A,I=this,Q=I.$9h,w=I._layout,H=I.$10h,R=I.$4h,C=I._view,X=I.dm();if(I.$13h&&(delete I.$13h,R={},X.each(function(S){R[S.getId()]=S})),"smallicons"===w)for(var b in R){var e=R[b];if(e instanceof B){var P=e.getName()||"",V=S.getTextSize(S.paletteContentLabelFont,P).width;I.$21h!=U&&I.$21h>V||(I.$21h=V)}}for(var b in R){A=R[b];var Y,J;if(X.contains(A)){if(A instanceof ht.Group){var g,N=I.$1h(A),d=H[A.getId()];d&&(g=d.nextSibling,k(C,g),k(C,d)),v=X.getSiblings(A).indexOf(A);var c=C.children[2*v]||I._79O;c&&c.parentNode?(C.insertBefore(N[0],c),C.insertBefore(g||N[1],c)):(C.appendChild(N[0]),C.appendChild(g||N[1])),H[A.getId()]=N[0],s=Q[A.getId()]=g||N[1],J=A.$12h;var F=A.s("promptText");J||(A.$12h=_("div"),A.$12h[u]=F||"",J=A.$12h),0===A.getChildren().size()?s.contains(J)||G(s,J):s.contains(J)&&k(s,J)}else if(Y=A.getParent()){var f=I.$2h(A),M=H[A.getId()];s=Q[Y.getId()],M&&k(M.parentNode,M),v=X.getSiblings(A).indexOf(A);var j=s.children[v];j?s.insertBefore(f,j):G(s,f),H[A.getId()]=f,I.$14h(A)}}else{var h=H[A.getId()],W=h.parentNode;if(A instanceof ht.Group){var E=h.nextSibling;k(C,h),k(C,E),delete Q[A.getId()]}else k(W,h),0===W.children.length&&(Y=X.getDataById(W.$11h),Y&&(J=Y.$12h,J&&!W.contains(J)&&G(W,J)));delete H[A.getId()]}}I.$4h={};var L=function(){var j=I._59I,Y=0;I.$32h!=U&&(clearInterval(I.$32h),Y=0,delete I.$32h),I.$32h=setInterval(function(){I.$31h(),j===I._59I?(Y++,Y>=2&&(clearInterval(I.$32h),delete I.$32h)):(Y=0,j=I._59I)},30)};for(var O in Q)if(s=Q[O],A=X.getDataById(Q[O].$11h),I.$15h(A),I._drawToolsIcon(A),A.isExpanded()){if(s.style.maxHeight===0+l){var m=s.scrollHeight+I._itemMargin+l;o(s).duration(200).set(z,m).set("padding-bottom",I._itemMargin+l).end(function(){return function(){L()}}(m))}else s.style.maxHeight=s.scrollHeight+l;s.style.paddingBottom=I._itemMargin+l}else s.style.maxHeight!==0+l&&o(s).duration(200).set(z,p).set("padding-bottom",p).end(function(){return function(){L()}}(s));I.$28h(),I.$31h()},$31h:function(){for(var K=this,p=K._view,R=0,C=p.children,N=0;N<C.length;N++){var h=C[N];h.className&&h.className.indexOf("palette-")>=0&&(R+=h.offsetHeight)}K._59I=R,K.$30h=K.$33h(K.ty());var S=K.ty();p.scrollTop=-S,K._29I={x:0,y:-S,width:p.clientWidth,height:p.clientHeight},s(K._79O,i,-S+l),K._93I()},$33h:function(n){var o=this,f=o._29I.height-o._59I;return f>n&&(n=f),n>0?0:Math.round(n)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(I){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(I.property)<0&&this.redraw(),"translateY"===I.property&&(this.iv(),this._43o())},findDataByName:function(T){for(var B=this.dm().getDatas(),I=0;I<B.size();I++){var W=B.get(I);if(W.getName()===T)return W}},setDataModel:function(B){var I=this,P=I._dataModel,h=I._selectionModel;P!==B&&(P&&(P.umm(I.$6h,I),P.umd(I.$8h,I),P.umh(I.$7h,I),h||P.sm().ums(I.$28h,I)),I._dataModel=B,B.mm(I.$6h,I),B.md(I.$8h,I),B.mh(I.$7h,I),h?h._21I(B):B.sm().ms(I.$28h,I),I.sm().setSelectionMode("single"),I.fp("dataModel",P,B))},$6h:function(c){var n=this,H=n._view,P=c.data,x=n.$4h;"add"===c.kind?x[P.getId()]=P:"remove"===c.kind?x[P.getId()]=P:"clear"===c.kind&&(n.$10h={},n.$9h={},n.$4h={},H[u]=""),n.iv()},$7h:function(n){var u=this,r=n.data;u.$4h[r.getId()]=r,u.iv()},$8h:function(M){var $=this,p=M.data,b=M.property;"expanded"===b?$.iv():($.$4h[p.getId()]=p,$.iv())},$28h:function(){var b,J=this,T=J.sm(),k="palette-item",L=T.ld();this.dm().each(function(n){b=J.$10h[n.getId()],b&&b[d].indexOf(k)>=0&&(n===L?s(b,Y,S.paletteItemSelectBackground):E(b,Y))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);