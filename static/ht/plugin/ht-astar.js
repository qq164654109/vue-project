!function(n,N,a){"use strict";var J=n.ht;J.Astar={},function(F){var S=F();n.AStar=S.astar,n.AStar.Graph=S.Graph}(function(){function Q(o){for(var i=o,A=[];i.parent;)A.unshift(i),i=i.parent;return A}function X(){return new Z(function(p){return p.f})}function G(s,J){J=J||{},this.nodes=[],this.diagonal=!!J.diagonal,this.grid=[];for(var K=0;K<s.length;K++){this.grid[K]=[];for(var Q=0,P=s[K];Q<P.length;Q++){var b=new I(K,Q,P[Q]);this.grid[K][Q]=b,this.nodes.push(b)}}this.$13x()}function I(b,z,J){this.x=b,this.y=z,this.weight=J}function Z(K){this.content=[],this.scoreFunction=K}var M={search:function(w,q,E,A){w.$6x(),A=A||{};var N=A.heuristic;N||(N=w.diagonal?M.$4x.diagonal:M.$4x.manhattan);var J=A.closest||!1,F=A.punish,i=X(),D=q;for(q.h=N(q,E),w.$7x(q),i.push(q);i.size()>0;){var h=i.pop();if(h===E)return Q(h);h.closed=!0;for(var u=w.neighbors(h),m=0,x=u.length;x>m;++m){var S=u[m];if(!S.closed&&!S.$9x()){var C=h.g+S.getCost(h,F),U=S.visited;(!U||C<S.g)&&(S.visited=!0,S.parent=h,S.h=S.h||N(S,E),S.g=C,S.f=S.g+S.h,w.$7x(S),J&&(S.h<D.h||S.h===D.h&&S.g<D.g)&&(D=S),U?i.$10x(S):i.push(S))}}}return J?Q(D):[]},$4x:{manhattan:function(E,X){var U=Math.abs(X.x-E.x),s=Math.abs(X.y-E.y);return U+s},diagonal:function(C,l){var D=1,U=Math.sqrt(2),W=Math.abs(l.x-C.x),y=Math.abs(l.y-C.y);return D*(W+y)+(U-2*D)*Math.min(W,y)}},$5x:function(u){u.f=0,u.g=0,u.h=0,u.visited=!1,u.closed=!1,u.parent=null}};return G.prototype.$13x=function(){this.dirtyNodes=[];for(var B=0;B<this.nodes.length;B++)M.$5x(this.nodes[B])},G.prototype.$6x=function(){for(var l=0;l<this.dirtyNodes.length;l++)M.$5x(this.dirtyNodes[l]);this.dirtyNodes=[]},G.prototype.$7x=function(r){this.dirtyNodes.push(r)},G.prototype.neighbors=function(u){var w=[],l=u.x,Y=u.y,B=this.grid;return B[l-1]&&B[l-1][Y]&&w.push(B[l-1][Y]),B[l+1]&&B[l+1][Y]&&w.push(B[l+1][Y]),B[l]&&B[l][Y-1]&&w.push(B[l][Y-1]),B[l]&&B[l][Y+1]&&w.push(B[l][Y+1]),this.diagonal&&(B[l-1]&&B[l-1][Y-1]&&w.push(B[l-1][Y-1]),B[l+1]&&B[l+1][Y-1]&&w.push(B[l+1][Y-1]),B[l-1]&&B[l-1][Y+1]&&w.push(B[l-1][Y+1]),B[l+1]&&B[l+1][Y+1]&&w.push(B[l+1][Y+1])),w},G.prototype.toString=function(){for(var C=[],H=this.grid,u=0;u<H.length;u++){for(var N=[],Q=H[u],X=0;X<Q.length;X++)N.push(Q[X].weight);C.push(N.join(" "))}return C.join("\n")},I.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},I.prototype.getCost=function(S,k){var z;if(z=S&&S.x!=this.x&&S.y!=this.y?1.41421*this.weight:this.weight,k){var L=S;if(!L)return z;var B=L.parent;return B?Math.abs(B.x+this.x-2*L.x)>1e-5?z+k:Math.abs(B.y+this.y-2*L.y)>1e-5?z+k:z:z}},I.prototype.$9x=function(){return 0===this.weight},Z.prototype={push:function(_){this.content.push(_),this.$11x(this.content.length-1)},pop:function(){var P=this.content[0],F=this.content.pop();return this.content.length>0&&(this.content[0]=F,this.$12x(0)),P},remove:function(V){var B=this.content.indexOf(V),d=this.content.pop();B!==this.content.length-1&&(this.content[B]=d,this.scoreFunction(d)<this.scoreFunction(V)?this.$11x(B):this.$12x(B))},size:function(){return this.content.length},$10x:function(J){this.$11x(this.content.indexOf(J))},$11x:function(R){for(var H=this.content[R];R>0;){var j=(R+1>>1)-1,O=this.content[j];if(!(this.scoreFunction(H)<this.scoreFunction(O)))break;this.content[j]=H,this.content[R]=O,R=j}},$12x:function(X){for(var i=this.content.length,b=this.content[X],Z=this.scoreFunction(b);;){var T,R=X+1<<1,j=R-1,m=null;if(i>j){var N=this.content[j];T=this.scoreFunction(N),Z>T&&(m=j)}if(i>R){var r=this.content[R],S=this.scoreFunction(r);(null===m?Z:T)>S&&(m=R)}if(null===m)break;this.content[X]=this.content[m],this.content[m]=b,X=m}}},{astar:M,Graph:G}});var y=J.Astar.Finder=function(S,t){var X=this;X.gv=S,X.$13x(t),X.refreshMap()};y.prototype={},y.prototype.constructor=y,N.defineProperties(y.prototype,{_debugInfo:{get:function(){return this.gv._astarDebugInfo},set:function(Q){this.gv._astarDebugInfo=Q}}}),y.prototype.$13x=function(E){var i=this,F=i.$14x={};E=E||{};var u=E.gridSize||10;F.gridSizeX=E.gridSizeX||u,F.gridSizeY=E.gridSizeY||u,F.rect=E.rect,F.filter=E.filter,F.extendBlocks=E.extendBlocks||3,F.fastOverlap=E.fastOverlap===a?!0:E.fastOverlap,F.nodeRectExtend=E.nodeRectExtend||0,F.diagonal=E.diagonal===a?!0:E.diagonal,F.turnPunish=E.turnPunish===a?.1:E.turnPunish,F.simplify=E.simplify===a?!0:E.simplify,F.toGridCenter=E.toGridCenter===a?!1:E.toGridCenter,F.closest=E.closest===a?!0:E.closest},y.prototype.refreshMap=function(){var W,F=this,M=F.$14x,I=M.gridSizeX,C=M.gridSizeY,o=M.extendBlocks;M.rect?W=M.rect:(W=F.$15x(),J.Default.grow(W,I*o,C*o)),J.Default.grow(W,I,C);var c=Math.floor(W.x/I)*I,K=Math.floor(W.y/C)*C,V=Math.ceil(W.width/I),T=Math.ceil(W.height/C),B=V*I,S=T*C;F.$16x={x:c,y:K,w:B,h:S,gridX:I,gridY:C,xLen:V,yLen:T},F.$17x(),F.$21x()},y.prototype.$15x=function(){var j=this.gv;if(j instanceof J.graph.GraphView)return j.getContentRect();var o,i=J.Default.unionRect;return j.dm().each(function(d){j.isVisible(d)&&d.getRect&&(o=i(o,d.getRect()))}),o},y.prototype.$17x=function(){var k,z,Q,s,$=this,S=$.$16x,V=S.xLen,C=S.yLen;for(k=new Array(V),Q=0;V>Q;Q++)for(k[Q]=z=new Array(C),s=C;s--;)z[s]=1;var O=$.$14x.filter;for($.gv.dm().each(function(h){O&&O(h)===!1||(!$._debugInfo||h!==$._debugInfo.grid&&h!=$._debugInfo.path)&&$.$1cw(k,h)}),Q=0;V>Q;Q++)k[Q][0]=1,k[Q][C-1]=1;for(s=0;C>s;s++)k[0][s]=1,k[V-1][s]=1;$.grid=k;var d=new AStar.Graph(k,{diagonal:$.$14x.diagonal});$.graph=d},y.prototype.$18x=function(r,g,w,q,B,h,Z,C){var T=this.$19x,d=T(w-r,B-Z,q-g,h-C);if(1e-6>=d&&d>=-1e-6)return!1;var n=T(B-r,B-Z,h-g,h-C)/d;if(0>n||n>1)return!1;var u=T(w-r,B-r,q-g,h-g)/d;return 0>u||u>1?!1:!0},y.prototype.$19x=function(r,R,O,F){return r*F-R*O},y.prototype.$1aw=function(D,y,X,Y){for(var l=[-(y[1]-D[1]),y[0]-D[0]],m=l[0]*(X[0]-D[0])+l[1]*(X[1]-D[1])>=0,u=0,T=Y.length;T>u;u+=2)if(l[0]*(Y[u]-D[0])+l[1]*(Y[u+1]-D[1])>=0===m)return!1;return!0},y.prototype.$1bw=function(b,z){for(var $,T,c=this,L=0,F=b.length;F>L;L+=2)if($=L===F-2?0:L+2,T=$===F-2?0:$+2,c.$1aw([b[L],b[L+1]],[b[$],b[$+1]],[b[T],b[T+1]],z))return!1;for(var L=0,F=z.length;F>L;L+=2)if($=L===F-2?0:L+2,T=$===F-2?0:$+2,c.$1aw([z[L],z[L+1]],[z[$],z[$+1]],[z[T],z[T+1]],b))return!1;return!0},y.prototype.$1cw=function(K,w){if(w.getRect){var i=this,g=w.getRect();J.Default.grow(g,i.$14x.nodeRectExtend);var n,t,P,$,m,z,F,c,s,U,h,M=i.$1dw({x:g.x,y:g.y}),S=i.$1dw({x:g.x+g.width,y:g.y+g.height}),A=i.$14x.fastOverlap;if(!A){var o=w.getCorners();F=[],o.forEach(function(I){F.push(I.x,I.y)}),U=i.$14x.gridSizeX/2,h=i.$14x.gridSizeY/2}for(t=Math.max(0,M.x),P=Math.min(S.x,K.length-1),m=Math.max(0,M.y),z=Math.min(S.y,K.length?K[0].length-1:-1),n=t;P>=n;n++)for($=m;z>=$;$++)if(A)K[n][$]=0;else{s=i.$1ew({x:n,y:$});var q=s.x-U,G=s.x+U,V=s.y-h,u=s.y+h;c=[q,V,q,u,G,u,G,V],i.$1bw(F,c)&&(K[n][$]=0)}}},y.prototype.$1dw=function(R,J){var s=this,C=s.$16x,U=(R.x-C.x)/C.gridX,L=(R.y-C.y)/C.gridY;return J!==!1&&(U=Math.round(U),L=Math.round(L)),{x:U,y:L}},y.prototype.$1ew=function(c){var C=this,Y=C.$16x;return{x:c.x*Y.gridX+Y.x,y:c.y*Y.gridY+Y.y}},y.prototype.$1fw=function(B){var U=this,V=U.$16x,b=V.xLen,T=V.yLen;if(B.x>=0&&B.x<b&&B.y>=0&&B.y<T)return B;var G={x:B.x,y:B.y};return G.x<0?G.x=0:G.x>=b&&(G.x=b-1),G.y<0?G.y=0:G.y>=T&&(G.y=T-1),G},y.prototype.findPath=function(C,V){var G,b,q,r,D=this,h=D.$1dw(C),K=D.$1dw(V);if(q=D.$1fw(h),r=D.$1fw(K),q!==h&&r!==K){var s=D.$16x,e=s.x-s.gridX/2,t=s.y-s.gridY/2,I=e+s.gridX*s.xLen,l=t+s.gridY*s.yLen;if(!(D.$18x(C.x,C.y,V.x,V.y,e,t,I,t)||D.$18x(C.x,C.y,V.x,V.y,I,t,I,l)||D.$18x(C.x,C.y,V.x,V.y,I,l,e,l)||D.$18x(C.x,C.y,V.x,V.y,e,l,e,t)))return[C,V]}q!==h&&(G=!0,h=q),r!==K&&(b=!0,K=r);var f=D.graph.grid[h.x][h.y],c=D.graph.grid[K.x][K.y],u=AStar.search(D.graph,f,c,{closest:D.$14x.closest,punish:D.$14x.turnPunish});if(!u||!u.length)return null;var H=[];H.push(C),G&&H.push(D.$1ew(u[0]));for(var k=1,X=u.length;X-1>k;k++)H.push(D.$1ew(u[k]));if(b)H.push(D.$1ew(u[X-1])),H.push(V);else{var Q=u[X-1];K.x!==Q.x||K.y!==Q.y||D.$14x.toGridCenter?H.push(D.$1ew(Q)):H.push(V)}return D.$14x.simplify&&(H=D.simplifyPath(H)),D.$20x=H,D.$21x(),H},y.prototype.debugOn=function(d){this.debugFlag=!0,this.debugSettings=d||{},this.$21x()},y.prototype.simplifyPath=function(n){var s=n.length;if(2>=s)return n;var d,r,F=[n[0],n[1]],B=F[0],A=F[1],Q=1e-5;for(d=2;s>d;d++)r=n[d],Math.abs((A.x-B.x)*(r.y-B.y)-(A.y-B.y)*(r.x-B.x))<Q?A=F[F.length-1]=r:(B=A,A=r,F.push(r));return F},y.prototype.$21x=function(){var m=this;if(m.$22x(),this.debugFlag){var z=m.grid;if(z){var f,V=m.gv;if(m.debugSettings.$16x!==!1){f=[];for(var A,e,i,E,O,n=[],N=m.$14x.gridSizeX/2,I=m.$14x.gridSizeY/2,M=z.length,R=M?z[0].length:0,C=1;M-1>C;C++)for(var K=1;R-1>K;K++)z[C][K]||(A=m.$1ew({x:C,y:K}),e=A.x-N,i=A.x+N,E=A.y-I,O=A.y+I,f.push({x:e,y:E},{x:e,y:O},{x:i,y:O},{x:i,y:E}),n.push(1,2,2,2,5));var P=new J.Shape;P.s("shape.border.color","rgba(50, 50, 50, 0.2)"),P.s("shape.border.width",1),P.s("shape.background","rgba(200, 50, 100, 0.2)"),P.s("2d.editable",!1),P.s("2d.selectable",!1),P.setPoints(f),P.setSegments(n),m._debugInfo={grid:P},V.dm().add(P)}m.debugSettings.path!==!1&&(f=new J.Shape,m.$20x&&(f.setPoints(m.$20x),f.s("shape.border.color","red"),f.s("shape.border.width",1),f.s("2d.editable",!1),f.s("2d.selectable",!1),f.s("shape.background",null),m._debugInfo||(m._debugInfo={}),m._debugInfo.path=f,V.dm().add(f)))}}},y.prototype.debugOff=function(){this.debugFlag=!1,this.$22x()},y.prototype.$22x=function(){var O=this;if(O._debugInfo){var h=O._debugInfo.grid,d=O._debugInfo.path,B=O.gv;h&&B.dm().remove(h),d&&B.dm().remove(d),O._debugInfo=null}}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);