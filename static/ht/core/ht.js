!function(_,Z,g){"use strict";var m="ht";if(!_[m]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),_.performance&&_.performance.now||function(){var d=Date.now();_.performance||(_.performance={}),_.performance.now=function(){return Date.now()-d}}();for(var e=Date.now(),S=16,A=["ms","moz","webkit","o"],L=0;L<A.length&&!_.requestAnimationFrame;++L)_.requestAnimationFrame=_[A[L]+"RequestAnimationFrame"],_.cancelAnimationFrame=_[A[L]+"CancelAnimationFrame"]||_[A[L]+"CancelRequestAnimationFrame"];_.requestAnimationFrame||(_.requestAnimationFrame=function(c){var q=Date.now(),u=S+e-q;return 0>u&&(u=0),e=q,_.setTimeout(function(){e=Date.now(),c(performance.now())},u)}),_.cancelAnimationFrame||(_.cancelAnimationFrame=function(e){return _.clearTimeout(e)}),Z.assign===g&&(Z.assign=function(m){if(m===g||null===m)throw new TypeError("Cannot convert undefined or null to object");for(var G=Z(m),f=1;f<arguments.length;f++){var u=arguments[f];if(u!==g&&null!==u)for(var D in u)Z.prototype.hasOwnProperty.call(u,D)&&(G[D]=u[D])}return G})}();var z=_.document,U=null,o=_[m]={},H=_[m+"config"],u=o.Default=H&&H.Default||{},V=o.Style=H&&H.Style||{},W=o.Attr=H&&H.Attr||{},a=o.Color=H&&H.Color||{},y=o.IsGetter=H&&H.IsGetter||{};!function(){var p=!1;try{var s=Z.defineProperty({},"passive",{get:function(){p=!0}});_.addEventListener("test",s,s),_.removeEventListener("test",s,s)}catch(K){p=!1}u.passiveSupported=p}();var k,f,T,p,K=u.passiveSupported,O=u.eventListenerOptionsFalse=K?{passive:!1,capture:!1}:!1,A=u.eventListenerOptionsTrue=K?{passive:!1,capture:!0}:!0,c=Math,$=c.round,d=c.floor,e=c.ceil,P=c.sqrt,N=c.max,s=c.min,v=c.abs,R=c.cos,r=c.acos,G=c.sin,b=c.pow,L=c.asin,D=c.PI,E=2*D,j=D/2,w=c.tan,i=c.atan2,J=c.random,I=c.log,M=!1,q=!1,X=_.parseInt||global.parseInt,B="2019-03-15",Y=_.navigator?_.navigator.platform.indexOf("Win")>-1:!1,Q=function(Z){return Z*Z},l=_.setTimeout,t=_.clearTimeout,n=_.location,S=_.navigator?_.navigator.userAgent.toLowerCase():"",x=function(V){return V.test(S)},h=x(/msie/),F=x(/msie/)||x(/trident/),C=x(/msie 10/),rb=x(/edge/),ag=x(/firefox/),rq=x(/mac/),$d=u.isTouchable===g?Y?!1:z?"ontouchend"in z:!1:u.isTouchable,Yh="default",$o="single",$f="multiple",nd="front",Rd="back",Qg="left",Td="right",Ij="top",Lb="bottom",fs="center",Ee="eye",yh="middle",Mf="east",uc="west",Xb="north",De="none",Wg="px",jp="absolute",Xe="border",fn="triangle",Ui="rect",Fb="circle",ab="cylinder",wr="shape",Qb="items",bq="normal",Se="remove",sg="clear",ke="width",ko="height",xh="ingroup",Zh="check",tr="uncheck",Ar="radio",Mn="radioOn",ti="radioOff",Vm="points",Fg="values",Bh="series",zd="body",Fd="label",Le="label2",Hq="note",Xi="note2",zb="icons",jk="labelFont",Yk="labelColor",aq="labelSelectColor",yr="note.expanded",As="note2.expanded",oe="edge.expanded",er="edge.points",Zq="edge.type",Kn="rotation",El="hidden",Sp="visible",hf="tuv",Vo="no",th="draw",um="select",Lp="currentSubGraph",Qd="selectBackground",ol="autoMakeVisible",bf="autoHideScrollBar",iq="scrollBarColor",Yo="scrollBarSize",Hd="indent",am="rowHeight",uh="columnLineColor",xo="rowLineColor",_b="columnLineVisible",Ld="rowLineVisible",ve="visibleFunc",Tf="expandIcon",tl="collapseIcon",Ob="checkMode",kh="sortFunc",qn="editable",lr="batchEditable",Bb="tristate",Fn="asc",rn="desc",_l="position",Cs="elevation",Jn="children",Hk="translateX",Hc="translateY",Og="dataModel",Dd="maxSize",Hg="shape3d",Er="shape3d.resolution",lc="shape3d.visible",gq="shape3d.from.visible",Fr="shape3d.to.visible",Yj="shape3d.top.visible",Pn="shape3d.bottom.visible",ph="repeat.uv.length",hc="serializeValue",hj="deserializeValue",pk="centerUniform",Gq="uniform",cm="rgba(255,255,255,0)",rd="style",Fl="attr",Mo="field",ad="string",Ni="boolean",hb="color",vg="int",kl="number",Vb="ew-resize",Sf="ns-resize",Ih="pointer",Fk="auto",Ig="mousedown",up="mousemove",df="mouseup",sd="mouseout",wq="touchstart",dp="touchmove",tp="touchend",Pm="keydown",mq="keyup",wb=["DOMMouseScroll","mousewheel"],Sh=ag?wb[0]:wb[1],Yc=$d?[wq,dp,tp,Pm,mq,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Pm,mq,"keypress","input",Ig,up,df,sd,Sh,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],ms=U,yf=U,vm=U,he=df.length,il=function(){vm&&(t(vm.timeout),vm=U)},sk=function(){vm&&hs(vm.e,vm.info)};_.addEventListener&&($d||(_.addEventListener(sd,function(){il()},O),_.addEventListener(Sh,function(){vf()},O)),_.addEventListener(mq,function(V){91===V.keyCode?mf={}:delete mf[V.keyCode]},A),_.addEventListener(Pm,function(f){mf[f.keyCode]=!0},A),_.addEventListener("blur",function(){mf={}},O));var Uh,el,qp,xd=0,cq=U,Wp=function(y,R){var n=l(function(){delete cq[n],Fo(cq)&&(cq=U),y()},R);return n},me=U,Yb=U,Ik={},Uk={},Mk={},Te={},Jl={},mf={},dn={},Rp={},Cg={},Jd={},wo=/.json$/,Gk=/^data:image\/svg\+xml/,go={},Sq=[],dg={},Gg=U,Zl=U,mg=function(){},Xc=function(){throw"Oops!"},$j=[0,0,0],Ng={x:0,y:0,width:0,height:0},Xo=U,Bk=U,dq=U,pc=function(C,q){Uk[C]=q,q&&q.comps&&!q.uuid&&(q.uuid=o.Math.generateUUID()),zp[C]&&(q.cacheRule=zp[C],delete zp[C])},Wb=function(o){Bk&&!o._72O&&(dq||(dq={}),dq[o._72O=Cr()]=o),Uh!=U?bm()<.05&&p&&!el&&(_f=il):_f=br},Fp=function(A,S,N,$){Bk||(Bk={});var L=Bk[A];if(L){if(L.url===S)return;L.image?(L.image.onload=mg,L.image.onerror=mg):L.request&&(L.request.onload=mg,L.request.onerror=mg)}if(wo.test(S)){var J=new or;if(Bk[A]={request:J,url:S},S=u.beforeLoadURL(S),S.data){var s=u.parse(S.data);Me(A,s),u.handleImageLoaded(A,s)}else{J.onload=function(x){if(200===this.status||0===this.status){var s=u.parse(x.target.response||x.target.responseText);Me(A,s),u.handleImageLoaded(A,s)}else Me(A,u.handleUnfoundImage(A,S)||U)},J.onerror=function(){Me(A,u.handleUnfoundImage(A,S)||U)};var h={};h.url=encodeURI(S),h.sync=!1,J.send(h)}}else{var s=new Image;Bk[A]={image:s,url:S},/^data:image/.test(S)||(S=u.beforeLoadURL(S),S=u.appendTimeStamp(S),S=encodeURI(S),s.crossOrigin=u.crossOrigin),u.convertImageSrc(S,function(V){F&&(S.toLowerCase().indexOf(".svg")>0||Gk.test(S))?(z.body.appendChild(s),s.style.visibility="hidden",s.onload=function(){l(function(){if(N&&(s.width=N),$&&(s.height=$),!s.width||!s.height){var Z=s.width||s.clientWidth,m=s.height||s.clientHeight;s.width=Z,s.height=m}u.handleImageLoaded(A,s),Me(A,s),z.body.removeChild(s),s.style.visibility=""},180)},s.onerror=function(){Me(A,u.handleUnfoundImage(A,S)||U),z.body.removeChild(s),s.style.visibility=""}):(s.onload=function(){N&&(s.width=N),$&&(s.height=$),u.handleImageLoaded(A,s),Me(A,s)},s.onerror=function(){Me(A,u.handleUnfoundImage(A,S)||U)}),s.src=V})}},Me=function(p,X){if(pc(p,X),delete Bk[p],Fo(Bk)&&(Bk=U,dq)){for(var J in dq){var h=dq[J];h._2O&&(h._2O={}),h.invalidateAll&&h.invalidateAll(g,"imageLoaded",p),h.redraw&&h.redraw(),h.iv(),delete h._72O}dq=U}if(X&&dq)for(var J in dq){var h=dq[J];h.invalidateAll&&h.invalidateAll(g,"imageLoading",p),h.redraw&&h.redraw(),h.iv()}},Zc=function(){return I=c&&Date,function(){return _.performance&&_.performance.now?_.performance.now():Date.now()}}(),Ed=function(q,y){y?t(q):_.cancelAnimationFrame(q)},pg=function(F,C,Y){return{width:F,height:C,comps:zc(Y)?Y:[Y]}},Bl=function(r,L){return{type:Fb,rect:[r,L,1.6,1.6],borderWidth:1,borderColor:fe,gradient:bo,gradientColor:vq,background:fe}},bi=function(U,E){return pg(16,16,{type:fn,rect:[4,4,10,8],background:U,rotation:E?1.57:3.14})},Vn=function(J,m){return pg(16,16,{type:fn,rect:[4,4,8,7],background:J,rotation:m?3.14:0})},Nj=function(s){var c=s._orientation;return"horizontal"===c||"h"===c},Ze=function(I){var A=U||4,X=U||1,K=U||1;0>A?A=0:A>.25&&(A=.25);var q,h,r,p,i,J,c,H=.5,Q=[],n=[],w=[],O=E/K,d=E/X,F=H-A;for(h=0;X>=h;h++)for(p=-D+h*d,J=R(p),i=G(p),q=0;K>=q;q++)r=q*O,c=F+A*J,Q.push(R(r)*c,i*A,-G(r)*c),(f=I)&&n.push(q/K,1-h/X);for(h=0;X>h;h++){var C=h*(K+1),_=(h+1)*(K+1);for(q=0;K>q;q++)w.push(C+q,_+q+1,_+q,C+q,C+q+1,_+q+1),nq.z=Ub.z=I}},Tn=function(J){var l=2,a=0;for(var S in J)S.length===l&&X(S,32)===Eb&&(Gg=Zl=J[S]),a++;return a},en=function(N,Y,v,h){return v||(v=$d?5:3,v/=h||1),{x:N-v,y:Y-v,width:2*v,height:2*v}},nc=function(f,G,u,I){var W=this;G||(G=$d?5:3,u=20,I=20);var l={x:f,y:G,width:u,height:I};if(u)for(var q=0;u>q;q++)if(3===u)I=20;else for(var T=0;I>T;T++)W=_?_:u;var y={x:D,y:2*D};if(ce(l,y)){var m=ko[0]+Ij[0]+sg[1]+(Fn.length-1);Or[Ee]=W[m],W[m]=gg[Ee]}},yb=function(j){return(/ble$/.test(j)||/ed$/.test(j)||y[j]?"is":"get")+j.charAt(0).toUpperCase()+j.slice(1)},gg=function(E){return"set"+E.charAt(0).toUpperCase()+E.slice(1)},Do=function(S){return typeof S===ad||S instanceof String},Rm=function(S){return typeof S===kl},br=function(h){return typeof h===Ni},Bf=function(d){return d&&"object"==typeof d},tf=function(j){return"function"==typeof j},zc=function(v){return v instanceof Array},Wh=function(h){return h instanceof vc},mi=function(m){return zc(m)?new vc(m):m},_h=function(s){return s instanceof Dq},nr=function(Y){return Y instanceof ic},rg=function(m){return m instanceof cc},Ml=function(g,A){if(!(g instanceof o.Group))return!1;if(!A)return g.isExpanded();var G=A.getDataUI(g);return G&&G._88I?!0:!1},Id=function(q){return q instanceof Vf},ch=function(B){return B&&"IFRAME"===B.tagName},ff=function(J){return J==U||u.numberDigits==U?J:parseFloat(J.toFixed(u.numberDigits))},Je=function(F,m,g){var d,u=m.length;if(g)for(var i=0;g>i;i++)if(3===u)F.push(m[0]),F.push(m[1]),F.push(m[2]);else for(d=0;u>d;d++)F.push(m[d]);else if(3===u)F.push(m[0]),F.push(m[1]),F.push(m[2]);else for(d=0;u>d;d++)F.push(m[d])},Em=function(O){return O?Bf(O)?O:{}:!1},Pk=function(Z,h,R){var M,b=Bf(Z)?Z:Z.prototype;for(M in h)R&&b[M]!==g||(b[M]=h[M]);return Z},mn=function(c){return String.fromCharCode(c)},_c=function(b){for(var f,k=0,A="";k<b.length;k++)f=b[b.length-1-k],"%"===f?f="'":"a"===f?f='"':"]"===f&&(f="\\"),A+=mn(f.charCodeAt(0)-1);return A},Sc=function(E,R,u){E.superClass.constructor.apply(R,u)},Fo=function(S){for(var i in S)return!1;return!0},vb=function(l){return l?0===l.length:!0},uk=function(){var j="";return[tr[0],xo[0],Fd[0]].forEach(function(c){j+=gg(c).slice(3)}),Gq=z&&z[j]||pk,function(Y,i){return Y===i?!0:Y.x===i.x&&Y.y===i.y&&Y.width===i.width&&Y.height===i.height}}(),vo=function(I,C,V){return C>I?C:I>V?V:I},Ai=function(T){return 0>T?-1:T>0?1:0},bm=function(){var Y=1e4*G(he++);return Y-d(Y)},cg=function(m,c,P){return eo(m.x,m.y,c.x,c.y,P.x,P.y,P.x+P.width,P.y,!0)||eo(m.x,m.y,c.x,c.y,P.x+P.width,P.y,P.x+P.width,P.y+P.height,!0)||eo(m.x,m.y,c.x,c.y,P.x+P.width,P.y+P.height,P.x,P.y+P.height,!0)||eo(m.x,m.y,c.x,c.y,P.x,P.y+P.height,P.x,P.y,!0)},eo=function(Y,P,x,t,K,Z,I,o,G){var u=(I-K)*(P-Z)-(o-Z)*(Y-K),F=(o-Z)*(x-Y)-(I-K)*(t-P);if(0!==F){var Q=u/F,l=Y+Q*(x-Y),a=P+Q*(t-P);return G&&(l+vl<s(Y,x)||l-vl>N(Y,x)||l+vl<s(K,I)||l-vl>N(K,I)||a+vl<s(P,t)||a-vl>N(P,t)||a+vl<s(Z,o)||a-vl>N(Z,o))?U:[l,a]}return U},$h=function($,j,w){if($&&w)if(j){if(j===rd)return $.getStyle(w);if(j===Fl)return $.getAttr(w);if(j===Mo)return $[w]}else if(w=yb(w),$[w])return $[w]();return g},Fh=function(s,r,X,I){if(s&&X)if(r){if(r===rd)s.s(X,I);else if(r===Fl)s.a(X,I);else if(r===Mo){var J=s[X];s[X]=I,s.fp("f:"+X,J,I)}}else X=gg(X),s[X]&&s[X](I)},rl=function(c,V,$){return V&&"top"!==V?"bottom"===V?{x:c.x,y:c.y,width:c.width,height:c.height*$}:"right"===V?{x:c.x,y:c.y,width:c.width*$,height:c.height}:"left"===V?{x:c.x+c.width*(1-$),y:c.y,width:c.width*$,height:c.height}:void 0:{x:c.x,y:c.y+c.height*(1-$),width:c.width,height:c.height*$}},Cq=function(r,x,l,N,D){x&&No(r,l,N,1,D,x)},oh=function(p,E,n,R){var d=1-p;return d*d*E+2*p*d*n+p*p*R},nq=function(X,Z,Y,m,D){var y=1-X;return y*y*y*Z+3*y*y*X*Y+3*y*X*X*m+X*X*X*D},Lm=function(g){var B,L,Y,e,d=0;return g.forEach(function(V){if(B=V.length,B>0)for(L=V[0],e=1;B>e;e++)Y=V[e],d+=Pq(L,Y),L=Y}),d},cn=function(R,b,y){var B="__"+R,z=function(q){y.disabled||y["handle_"+R](q)};y[B]||(y[B]=z,b.addEventListener(R,z,O))},ii=function(M,L,X){var u="__"+M,J=X[u];J&&(L.removeEventListener(M,J,O),delete X[u])},Eq=function(v,B){var T="_"+B;v[yb(B)]=function(){return this[T]},v[gg(B)]=function(F){var D=this[T];this[T]=F,this.fp(B,D,F)}},ho=function(M){return Z.create(M)},Xq=function(U){if(!U.element){var p,F;(p=U.textField)?F=qf(yq.TextField,p):(p=U.textArea)?F=qf(yq.TextArea,p):(p=U.button)?F=qf(yq.Button,p):(p=U.comboBox)?F=qf(yq.ComboBox,p):(p=U.checkBox)?F=qf(yq.CheckBox,p):(p=U.radioButton)?F=qf(yq.RadioButton,p):(p=U.slider)?F=qf(yq.Slider,p):(p=U.colorPicker)?F=qf(yq.ColorPicker,p):(p=U.image)&&(F=qf(yq.Image,p)),F&&(U.element=F)}},wm=function(i,I){var b=rr(i);return b._ht=I,b},rr=function(o,p){var N=z.createElement("div"),k=N.style;return N.tabIndex=-1,N.onkeydown=td,k.msTouchAction=De,Bq(N,U,0),$d&&k.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",U),o&&(k.overflow=El),p&&Uo(p,N),N},Aj=function(T,q){var a=z.createElement("canvas"),p=a.style;return p.msTouchAction=De,q||(p.pointerEvents=De),Bq(a,U,0),T&&Uo(T,a),a},Bq=function(Q,t,O){var B=Q.style;B.border=t?t+" solid 1px":0,B.outline=0,B.padding=O?"0 "+O+Wg:0,He(Q)},He=function(w){var u=w.style;u.position=jp,u.margin=0,u.setProperty("box-sizing","border-box",U),u.setProperty("-moz-box-sizing","border-box",U)},gl=function(I,K,e,G){G||(G=rp),K!=U&&(I.width=K*G,I.style.width=K+Wg),e!=U&&(I.height=e*G,I.style.height=e+Wg)},Uo=function(H,Z,L){H.appendChild(Z),L&&(Z.style.position=jp)},Bj=function(l,c){c.split||(c+="");for(var J,t=c.split("\n"),D=0,B=t.length,d=0;B>d;d++){var y=Go(l.font,t[d]);y.width>D&&(D=y.width),J||(J=y.height)}return l.ss=t,{width:D,height:J*B}},bc=function(w,h,F,j,c,E){var W=h.length;if(1===W)lg(w,h[0],F,j,c);else for(var a=F.height/W,O={x:F.x,y:F.y,width:F.width,height:a},s=0;s<h.length;s++)E?ss(w,h[s],j,c,O.x,O.y,O.width,O.height,E):lg(w,h[s],O,j,c),O.y+=a},lg=function(E,x,y,G,r){E.font=G?G:Lh,E.fillStyle=r?r:Jq,E.textAlign=fs,E.textBaseline=yh;var L,l;y?y.width===g?(L=y.x,l=y.y):(L=y.x+y.width/2,l=y.y+y.height/2):(L=0,l=0),E.fillText(x,$(L),$(l))},qj=function(N){N.getView&&(N=N.getView());var u=N.offsetWidth||N.scrollWidth;return!u&&N.style.width&&(u=X(N.style.width)),u},Hp=function(w){w.getView&&(w=w.getView());var Y=w.offsetHeight||w.scrollHeight;return!Y&&w.style.height&&(Y=X(w.style.height)),Y},Tb=function(S,P,J){var Z=P[0].toUpperCase()+P.substring(1,P.length);S["webkit"+Z]=J,S["moz"+Z]=J,S["ms"+Z]=J,S["o"+Z]=J,S[P]=J},og=function(){var y=function(D){td(D),D.stopPropagation()},d=function(Y){td(Y)},I=$d?[wq]:[Pm,Ig];return function(t,Q){var R=rr(),C=R.style;return C.backgroundColor=u.disabledBackground,t&&(C.backgroundImage="url("+t+")",C.backgroundPosition="50% 50%",C.backgroundRepeat="no-repeat no-repeat"),Q===!1?I.forEach(function(z){R.addEventListener(z,d,O)}):I.forEach(function(M){R.addEventListener(M,y,O)}),R}}(),kc=function(o){var i=o.getContext("2d");return i.save(),i.lineCap=hp,i.lineJoin=Cc,i},_f=function(y,i,c,t){Jh(y,i*rp,c*rp),t*=rp,1!==t&&y.scale(t,t)},Jh=function(O,Z,F){O.translate(Z,F)},Xk=function(U,b){b&&U.rotate(b)},Di=function(J,p,h){p===g&&(p=1),h===g&&(h=1),(1!==p||1!==h)&&J.scale(p,h)},Cm=!1,Jp=function(A){var v=z.activeElement;if(z.activeElement!==A){v&&v.forceOnblur&&v.forceOnblur();for(var x=[],j=A.parentNode;j;)x.push([j,j.scrollLeft,j.scrollTop]),j=j.parentNode;if(!Cm){var k=[],o=[];try{for(var s=_.parent,V=_;s!==V;)k.push([s,s.scrollX,s.scrollY]),V=s,s=_.parent;var y=_.frameElement;if(y)for(var N=y.parentNode;N;)o.push([N,N.scrollLeft,N.scrollTop]),N=N.parentNode}catch(h){Cm=!0}}if($d)A.focus();else{var $=Wi(),n=$.target;A.focus(),n.scrollLeft=$.left,n.scrollTop=$.top}x.forEach(function(E){E[0].scrollLeft=E[1],E[0].scrollTop=E[2]}),Cm||(k.forEach(function(m){m[0].scrollTo(m[1],m[2])}),o.forEach(function(v){v[0].scrollLeft=v[1],v[0].scrollTop=v[2]}))}},Fj=function(t){return t&&t.getView?t.getView():t},yk=function(K,d,U,f,m){if(2===arguments.length&&(U=d.y,f=d.width,m=d.height,d=d.x),K.isSelfViewEvent)K.setX(d),K.setY(U),K.setWidth(f),K.setHeight(m);else{var X=Fj(K),c=X.style;if((z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement)!==X)d!==g&&(c.left=d+Wg),U!==g&&(c.top=U+Wg),f!==g&&(c.width=f+Wg),m!==g&&(c.height=m+Wg);else{var E=u.getWindowInfo();c.left=(d=E.left)+Wg,c.top=(U=E.top)+Wg,c.width=(f=E.width)+Wg,c.height=(m=E.height)+Wg}K.endEditing&&!$d&&K.endEditing(),K.redraw&&K.redraw(),K.invalidate&&K.invalidate(),K.onLayouted&&K.onLayouted(d,U,f,m),K.fireViewEvent&&K.fireViewEvent("layout")}},Ce=function(U){if(!U.touches)return U;var a=U.touches[0];return a?a:U.changedTouches[0]},Sb=function(n){return $d?Ce(n).target:n.target},Hn=function(A){u.popup&&u.popup.close(),u.popup=A},Hf=U,of=function(Z){Hf.handleWindowTouchMove(Z)},Ci=function(g){Hf.handleWindowTouchEnd(g),_.removeEventListener(dp,of,O),_.removeEventListener(tp,Ci,O),Hf=U},Bo=function(s){Hf.handleWindowMouseMove(s)},gd=function(G){Hf.handleWindowMouseUp(G),_.removeEventListener(up,Bo,O),_.removeEventListener(df,gd,O),Hf=U},_j=function(s){return 1===Xh(s)},ll=function(q,E){return E?E.keyCode===q:mf[q]},Co=function(N){return ds(N)&&ll(65,N)},Jc=function(c){return ll(46,c)||ll(8,c)},Xd=function(j){return function(M){return M?M.keyCode===j:mf[j]}},Eb=573,Vq=[65,83,68,87,37,38,39,40,32,13,27],Jb=Xd(Vq[0]),bl=Xd(Vq[1]),Gd=Xd(Vq[2]),Jo=Xd(Vq[3]),pf=Xd(Vq[4]),jl=Xd(Vq[5]),wf=Xd(Vq[6]),Lr=Xd(Vq[7]),Lo=Xd(Vq[8]),Hh=Xd(Vq[9]),ip=Xd(Vq[10]),wi={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Jf=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,5,599],Tl=U,gp=U,hn=function(L,V){Tl||(Tl=Aj()),gl(Tl,L,V,1);var k=kc(Tl);return k.clearRect(0,0,L,V),k},Pj=function(){var q,N={};for(var X in _){var v=$f.length;if(X.length==v&&X[0]===$f[2]&&X[1]===De[1]&&X[4]===$f[3]&&X[5]===$f[4]&&X.substr(v-2)===De[1]+De[2]){var C=_[X];for(var f in C)f.length===v&&f.substr(0,3)===Td[3]+Se[3]+um[0]&&f.substr(v-2)===$f[0]+Hq[3]&&(wb=C[f])}}return function(w){var I,c=N[w];return c||(q||(q=Aj(),gl(q,1,1,1)),I=q.getContext("2d"),I.clearRect(0,0,1,1),No(I,0,0,1,1,w),c=I.getImageData(0,0,1,1).data,c=N[w]=[c[0],c[1],c[2],c[3]]),c}}(),Tk=function(q){if(!Do(q))return q;var X=Pj(q);return X.CA||(X.CA=[X[0]/255,X[1]/255,X[2]/255,X[3]/255]),X.CA},sl=function(B,y,_,P,w){var W=Aj();W.width=_,W.height=P;var I=W.getContext("2d");I.drawImage(B,0,0,_,P);try{for(var t=I.getImageData(0,0,_,P),G=t.data,j=0,R=G.length;R>j;j+=4){var Q=G[j+0],u=G[j+1],U=G[j+2],i=G[j+3];"override_a"===w?G[j+3]=255*y[3]:"override_rgb"===w?(G[j+0]=255*y[0],G[j+1]=255*y[1],G[j+2]=255*y[2]):"override"===w?(G[j+0]=255*y[0],G[j+1]=255*y[1],G[j+2]=255*y[2],G[j+3]=255*y[3]):(G[j+0]=y[0]*Q,G[j+1]=y[1]*u,G[j+2]=y[2]*U,G[j+3]=y[3]*i)}I.putImageData(t,0,0)}catch(S){return B}return W},Or=function(b,o,p){return o&&(o="miter"===p?8*o+20:o+1,b&&fo(b,o)),o},Ud=function(c,i){if(i){var R=new hm(i),w=c.width/2,B=c.height/2,L=Pb([R.tf(-w,-B),R.tf(w,-B),R.tf(w,B),R.tf(-w,B)]);return L.x+=c.x+w,L.y+=c.y+B,L}return c},ts=function(I,q,A,v,Y,k,w,G){v*=Math.PI/180;var m={x:Math.cos(v)*(I.x-w.x)/2+Math.sin(v)*(I.y-w.y)/2,y:-Math.sin(v)*(I.x-w.x)/2+Math.cos(v)*(I.y-w.y)/2},Q=Math.pow(m.x,2)/Math.pow(q,2)+Math.pow(m.y,2)/Math.pow(A,2);Q>1&&(q*=Math.sqrt(Q),A*=Math.sqrt(Q));var S=(Y==k?-1:1)*Math.sqrt((Math.pow(q,2)*Math.pow(A,2)-Math.pow(q,2)*Math.pow(m.y,2)-Math.pow(A,2)*Math.pow(m.x,2))/(Math.pow(q,2)*Math.pow(m.y,2)+Math.pow(A,2)*Math.pow(m.x,2)));isNaN(S)&&(S=0);var g={x:S*q*m.y/A,y:S*-A*m.x/q},T={x:(I.x+w.x)/2+Math.cos(v)*g.x-Math.sin(v)*g.y,y:(I.y+w.y)/2+Math.sin(v)*g.x+Math.cos(v)*g.y},i=function(G){return Math.sqrt(Math.pow(G[0],2)+Math.pow(G[1],2))},C=function(L,j){return(L[0]*j[0]+L[1]*j[1])/(i(L)*i(j))},o=function(h,x){return(h[0]*x[1]<h[1]*x[0]?-1:1)*Math.acos(C(h,x))},J=o([1,0],[(m.x-g.x)/q,(m.y-g.y)/A]),N=[(m.x-g.x)/q,(m.y-g.y)/A],f=[(-m.x-g.x)/q,(-m.y-g.y)/A],U=o(N,f);C(N,f)<=-1&&(U=Math.PI),C(N,f)>=1&&(U=0);var C=q>A?q:A,j=q>A?1:q/A,H=q>A?A/q:1;if(null==G){var B={x:0,y:0,width:0,height:0};fo(B,C),B.x*=j,B.width*=j,B.y*=H,B.height*=H;var e=new hm(v);return B=Pb([e.tf(B.x,B.y),e.tf(B.x+B.width,B.y),e.tf(B.x+B.width,B.y+B.height),e.tf(B.x,B.y+B.height)]),B.x+=T.x,B.y+=T.y,[{x:B.x,y:B.y},{x:B.x+B.width,y:B.y},{x:B.x+B.width,y:B.y+B.height},{x:B.x,y:B.y+B.height}]}G.translate(T.x,T.y),G.rotate(v),G.scale(j,H),G.arc(0,0,C,J,J+U,1-k),G.scale(1/j,1/H),G.rotate(-v),G.translate(-T.x,-T.y)},jd=function(Q,C){Q&&Q.beginPath();for(var f,R,E,J=[],S=function(p){for(var S,L=/(\-{0,1}[\d\.]+)/gi,x=[];S=L.exec(p);)x.push(parseFloat(S[0]));return x},h=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,V={x:0,y:0};f=h.exec(C);){var T=f[0],g=T.substr(0,1);if("M"===g||"m"===g){for(var $=S(T),c=0;c<$.length;c+=2){var e=$[c],O=$[c+1];"m"===g&&(e+=V.x,O+=V.y),Q&&Q.moveTo(e,O),J.push({x:e,y:O}),V.x=e,V.y=O}R=E=null}else if("H"===g||"h"===g){for(var $=S(T),c=0;c<$.length;c+=1){var e=$[c];"h"===g&&(e+=V.x),Q&&Q.lineTo(e,V.y),J.push({x:e,y:V.y}),V.x=e}R=E=null}else if("C"===g||"c"===g){for(var $=S(T),c=0;c<$.length;c+=6){var d=$[c],M=$[c+1],i=$[c+2],w=$[c+3],e=$[c+4],O=$[c+5];"c"===g&&(d+=V.x,M+=V.y,i+=V.x,w+=V.y,e+=V.x,O+=V.y),Q&&Q.bezierCurveTo(d,M,i,w,e,O),J.push({x:d,y:M}),J.push({x:i,y:w}),J.push({x:e,y:O}),V.x=e,V.y=O}R=[d,M,i,w,e,O],E=null}else if("S"===g||"s"===g){for(var $=S(T),c=0;c<$.length;c+=4){var d,M;R?(d=2*R[4]-R[2],M=2*R[5]-R[3]):(d=V.x,M=V.y);var i=$[c],w=$[c+1],e=$[c+2],O=$[c+3];"s"===g&&(i+=V.x,w+=V.y,e+=V.x,O+=V.y),Q&&Q.bezierCurveTo(d,M,i,w,e,O),J.push({x:d,y:M}),J.push({x:i,y:w}),J.push({x:e,y:O}),V.x=e,V.y=O}R=[d,M,i,w,e,O],E=null}else if("Q"===g||"q"===g){for(var $=S(T),c=0;c<$.length;c+=4){var d=$[c],M=$[c+1],e=$[c+2],O=$[c+3];"q"===g&&(d+=V.x,M+=V.y,e+=V.x,O+=V.y),Q&&Q.quadraticCurveTo(d,M,e,O),J.push({x:d,y:M}),J.push({x:e,y:O}),V.x=e,V.y=O}R=null,E=[d,M,e,O]}else if("T"===g||"t"===g){for(var $=S(T),c=0;c<$.length;c+=2){var d,M;E?(d=2*E[2]-E[0],M=2*E[3]-E[1]):(d=V.x,M=V.y);var e=$[c],O=$[c+1];"t"===g&&(e+=V.x,O+=V.y),Q&&Q.quadraticCurveTo(d,M,e,O),J.push({x:d,y:M}),J.push({x:e,y:O}),V.x=e,V.y=O}R=null,E=[d,M,e,O]}else if("V"===g||"v"===g){for(var $=S(T),c=0;c<$.length;c+=1){var O=$[c];"v"===g&&(O+=V.y),Q&&Q.lineTo(V.x,O),J.push({x:V.x,y:O}),V.y=O}R=E=null}else if("L"===g||"l"===g){for(var $=S(T),c=0;c<$.length;c+=2){var e=$[c],O=$[c+1];"l"===g&&(e+=V.x,O+=V.y),Q&&Q.lineTo(e,O),J.push({x:e,y:O}),V.x=e,V.y=O}R=E=null}else if("A"===g||"a"===g){for(var $=S(T),c=0;c<$.length;c+=7){var B=$[c],k=$[c+1],K=$[c+2],z=$[c+3],s=$[c+4],e=$[c+5],O=$[c+6];"a"===g&&(e+=V.x,O+=V.y);var Z=ts(V,B,k,K,z,s,{x:e,y:O},Q);Z&&(J=J.concat(Z)),V.x=e,V.y=O}R=E=null}var A=T.substr(T.length-1);("z"===A||"Z"===A)&&Q&&Q.closePath()}return J},zk=function(P,c){var F,L,f="L"===c[0],T=c.length;P.save(),f?(P.transform(c[5],c[6],c[7],c[8],c[9],c[10]),F=P.createLinearGradient(c[1],c[2],c[3],c[4]),L=11):(P.transform(c[7],c[8],c[9],c[10],c[11],c[12]),F=P.createRadialGradient(c[1],c[2],c[3],c[4],c[5],c[6]),L=13);for(var p=P.compGray;T>L;)F.addColorStop(c[L],p?u.toGrayColor(c[L+1]):c[L+1]),L+=2;P.fillStyle=F},Ub=function(m,p){var c=m.s("shape.gradient.pack");if(c){for(var b=c.length,C=new Array(b),N=0;b>N;N++)C[N]=c[N];var L,w,F,$,h,d,e,Z,D,W,g,y,E,I="L"===C[0];L=I?5:7,w=C[L],F=C[L+1],$=C[L+2],h=C[L+3],d=C[L+4],e=C[L+5],Z=p[0],D=p[1],W=p[2],g=p[3],y=p[4],E=p[5],C[L]=Z*w+W*F,C[L+1]=D*w+g*F,C[L+2]=Z*$+W*h,C[L+3]=D*$+g*h,C[L+4]=Z*d+W*e+y,C[L+5]=D*d+g*e+E,m.s("shape.gradient.pack",C)}},Ei=function(B,n,b,J){var R=!1;if(B.beginPath?B.beginPath():R=!0,Wh(n)&&(n=n._as),Wh(b)&&(b=b._as),b&&b.length){for(var C,Y,W,F,L=0,_=0,K=b.length;K>_;_++)C=b[_],1===C?(Y=n[L++],B.moveTo(Y.x,R?-Y.y:Y.y)):2===C?(Y=n[L++],B.lineTo(Y.x,R?-Y.y:Y.y)):3===C?(Y=n[L++],W=n[L++],B.quadraticCurveTo(Y.x,R?-Y.y:Y.y,W.x,R?-W.y:W.y)):4===C?(Y=n[L++],W=n[L++],F=n[L++],B.bezierCurveTo(Y.x,R?-Y.y:Y.y,W.x,R?-W.y:W.y,F.x,R?-F.y:F.y)):5===C&&B.closePath();J&&5!==C&&B.closePath()}else{var t,p,e,Z=n.length;if(Z>0){for(t=n[0],B.moveTo(t.x,R?-t.y:t.y),p=1;Z>p;p++)e=n[p],B.lineTo(e.x,R?-e.y:e.y);J&&B.closePath()}}},Wl=function(P,J,C,a){if(Wh(P)&&(P=P._as),Wh(J)&&(J=J._as),J&&J.length){C=C||Qn;for(var g,F,Z,I,x,A,G,r,m=[],y=U,Y=0,h=0,t=J.length;t>h;h++)if(g=J[h],1===g)m.push(y=[]),y.push(P[Y++]);else if(2===g)y.push(P[Y++]);else if(3===g){for(F=y[y.length-1],Z=P[Y++],I=P[Y++],A=1;C>A;A++)G=oh(A/C,F.x,Z.x,I.x),r=oh(A/C,F.y,Z.y,I.y),y.push({x:G,y:r,b:!0});y.push(I)}else if(4===g){for(F=y[y.length-1],Z=P[Y++],I=P[Y++],x=P[Y++],A=1;C>A;A++)G=nq(A/C,F.x,Z.x,I.x,x.x),r=nq(A/C,F.y,Z.y,I.y,x.y),y.push({x:G,y:r,b:!0});y.push(x)}else 5===g&&y.push(y[0]);return a&&5!==g&&y&&y.length>2&&y.push(y[0]),m}return a&&P.length>2&&(P=P.slice(),P.push(P[0])),P?[P]:[]},Zj=function(u,G,D,o,i,A){var y,C,l,N=Pj(G),L=o,S=N[0],J=N[1],X=N[2];if(D){var V=Pj(D);y=V[0]-S,C=V[1]-J,l=V[2]-X}else y=255-S,C=255-J,l=255-X;for(A||(A=o>10?1:.5,A=1>i?s(A/i,2):A);(o-=A)>0;){var Z=1-o/L,Y=S+y*Z,n=J+C*Z,g=X+l*Z;Y=s(e(Y),255),n=s(e(n),255),g=s(e(g),255),u.strokeStyle="rgb("+Y+","+n+","+g+")",u.lineWidth=o,u.stroke()}},ah=function(){var v={};return function(g,y){var c=g+"-"+y,T=v[c];if(T)return T;var k,p,h,o=Pj(g);return 0>y?(y=(100+y)/100,k=e(o[0]*y),p=e(o[1]*y),h=e(o[2]*y)):(y/=100,k=o[0],p=o[1],h=o[2],k+=(255-k)*y,p+=(255-p)*y,h+=(255-h)*y,k=s(e(k),255),p=s(e(p),255),h=s(e(h),255)),v[c]="rgb("+k+","+p+","+h+")"}}(),No=function(J,S,X,k,i,P){P&&(J.fillStyle=P),J.beginPath(),J.rect(S,X,k,i),J.fill()},Im=function(n,J,b,L,i,s,R){n.beginPath(),Vr[J](n,b.x,b.y,b.width,b.height,L,i,s,R)},pj=function(m,E,Q,R,L){var B=Vr[Q];m.fillStyle=B?B(m,E,R?R:vq,L.x,L.y,L.width,L.height):E},Si=function(c,x,m,z,M,f){try{if(!x.tagName&&x.comps){x._cacheImage_||(x._cacheImage_={});var n;n="override"===z?"colors_override":"override_rgb"===z?"colors_override_rgb":"override_a"===z?"colors_override_a":"colors",x._cacheImage_[n]||(x._cacheImage_[n]={__count__:0});var L=x._cacheImage_[n][m];L||(x._cacheImage_[n].__count__>u.imageCacheThreshold&&(x._cacheImage_[n]={__count__:0}),L=o.Default.toCanvas(x,Zb(x),Qk(x),null,M,f,m,null,z),x._cacheImage_[n][m]=L,x._cacheImage_[n].__count__++),x=L}c.fillStyle=c.createPattern(x,"repeat")}catch(T){c.fillStyle="black"}},An=function(q,p,a,I,i,d,j){q.save(),q.translate(p,a),q.scale(1,j/d),q.arc(0,0,d,I,i),q.restore()},co=function(d,_,n,Y,f,g,F,X){var s,$,L,h,C,p,q,l,j,t,Q;if(v(f)>2*D&&(f=2*D),C=e(v(f)/(D/4)),s=f/C,$=-s,L=-Y,C>0){p=_+R(Y)*g,q=n+G(-Y)*F,X?d.lineTo(p,q):d.moveTo(p,q);for(var P=0;C>P;P++)L+=$,h=L-$/2,l=_+R(L)*g,j=n+G(L)*F,t=_+R(h)*(g/R($/2)),Q=n+G(h)*(F/R($/2)),d.quadraticCurveTo(t,Q,l,j)}},ur=function(V,_,H,e,b,C,E,x,v){6===arguments.length&&(E=C,x=C,v=C);var Z=_+e,r=H+b,N=b>e?2*e:2*b;C=N>C?C:N,E=N>E?E:N,x=N>x?x:N,v=N>v?v:N;var q=.29*v,$=.58*v;V.moveTo(Z,r-v),V.quadraticCurveTo(Z,r-$,Z-q,r-q),V.quadraticCurveTo(Z-$,r,Z-v,r),q=.29*x,$=.58*x,V.lineTo(_+x,r),V.quadraticCurveTo(_+$,r,_+q,r-q),V.quadraticCurveTo(_,r-$,_,r-x),q=.29*C,$=.58*C,V.lineTo(_,H+C),V.quadraticCurveTo(_,H+$,_+q,H+q),V.quadraticCurveTo(_+$,H,_+C,H),q=.29*E,$=.58*E,V.lineTo(Z-E,H),V.quadraticCurveTo(Z-$,H,Z-q,H+q),V.quadraticCurveTo(Z,H+$,Z,H+E),V.lineTo(Z,r-v)},Ko=function(p,r,c,i,K,g,R){r&&(c=$(c),i=$(i),R||(R=1),p.fillStyle=r,p.beginPath(),p.rect(c,i,R,g),p.rect(c,i,K,R),g-R>0&&p.rect(c,i+g-R,K,R),K-R>0&&p.rect(c+K-R,i,R,g),p.fill())},Bd=function(Y,I,D,K){var O=K.x,y=K.y,$=K.width,d=K.height;if(!(!I||!D||0>=$||0>=d)){var o,x=ul(I),w=Qc(I),b=D>0;1===D||-1===D?(Y.fillStyle=b?x:w,Y.beginPath(),Y.rect(O,y,1,d),Y.rect(O,y,$,1),Y.fill(),Y.fillStyle=b?w:x,Y.beginPath(),Y.rect(O,y+d-1,$,1),Y.rect(O+$-1,y,1,d),Y.fill()):(D=s(v(D),s($/2,d/2)),o=Y.createLinearGradient(O,y,O+D,y),o.addColorStop(0,b?x:w),o.addColorStop(1,I),Y.fillStyle=o,Y.beginPath(),Y.moveTo(O,y),Y.lineTo(O+D,y+D),Y.lineTo(O+D,y+d-D),Y.lineTo(O,y+d),Y.lineTo(O,y),Y.fill(),o=Y.createLinearGradient(O,y,O,y+D),o.addColorStop(0,b?x:w),o.addColorStop(1,I),Y.fillStyle=o,Y.beginPath(),Y.moveTo(O,y),Y.lineTo(O+D,y+D),Y.lineTo(O+$-D,y+D),Y.lineTo(O+$,y),Y.lineTo(O,y),Y.fill(),o=Y.createLinearGradient(O,y+d,O,y+d-D),o.addColorStop(0,b?w:x),o.addColorStop(1,I),Y.fillStyle=o,Y.beginPath(),Y.moveTo(O,y+d),Y.lineTo(O+D,y+d-D),Y.lineTo(O+$-D,y+d-D),Y.lineTo(O+$,y+d),Y.lineTo(O,y+d),Y.fill(),o=Y.createLinearGradient(O+$,y,O+$-D,y),o.addColorStop(0,b?w:x),o.addColorStop(1,I),Y.fillStyle=o,Y.beginPath(),Y.moveTo(O+$,y),Y.lineTo(O+$-D,y+D),Y.lineTo(O+$-D,y+d-D),Y.lineTo(O+$,y+d),Y.lineTo(O+$,y),Y.fill())}},ci=function(N,O,M,l,t,L,w){var x=N.createLinearGradient(l,t,L,w);return x.addColorStop(0,M),x.addColorStop(1,O),x},gk=function(_,m,w,R,h,T,c){var D=_.createLinearGradient(R,h,T,c);return D.addColorStop(0,m),D.addColorStop(.5,w),D.addColorStop(1,m),D},Pi=function(X,U,A,f,Q,W,D){var M=X.createLinearGradient(f,Q,W,D);return M.addColorStop(0,U),M.addColorStop(1/3,A),M.addColorStop(2/3,U),M.addColorStop(1,A),M},Vk=function(t,c,j,P,O,T,I,p,f){var b=t.createRadialGradient(P+T*p,O+I*f,s(T,I)/24,P+T/2,O+I/2,N(T,I)/2);return b.addColorStop(0,j),b.addColorStop(1,c),b},eq=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Vr={polygon:function(B,y,L,v,r,E){(E==U||3>E)&&(E=6);for(var K,$,k=s(v,r)/2,M=y+v/2,I=L+r/2,_=0,X=2*D/E,g=0;E>g;g++)K=M+R(_)*k,$=I+G(_)*k,0===g?B.moveTo(K,$):B.lineTo(K,$),_+=X;B.closePath()},arc:function(V,q,K,w,C,O,g,L,J){O==U&&(O=D),g==U&&(g=E),L==U&&(L=!0);var S=q+w/2,u=K+C/2;L&&V.moveTo(S,u),J?An(V,S,u,O,g,w/2,C/2):V.arc(S,u,s(w,C)/2,O,g),L&&V.closePath()},rect:function(D,x,d,q,n){D.rect(x,d,q,n)},circle:function(y,$,C,r,P){y.arc($+r/2,C+P/2,s(r,P)/2,0,E,!0)},oval:function(D,h,w,Q,b){An(D,h+Q/2,w+b/2,0,E,Q/2,b/2)},roundRect:function(H,C,r,t,i,J){J==U&&(J=s(s(t,i)/4,8)),ur(H,C,r,t,i,J)},star:function(c,X,J,U,x){var i=2*U,K=2*x,Q=X+U/2,h=J+x/2;c.moveTo(Q-i/4,h-K/12),c.lineTo(X+.306*U,J+.579*x),c.lineTo(Q-i/6,h+K/4),c.lineTo(X+U/2,J+.733*x),c.lineTo(Q+i/6,h+K/4),c.lineTo(X+.693*U,J+.579*x),c.lineTo(Q+i/4,h-K/12),c.lineTo(X+.611*U,J+.332*x),c.lineTo(Q+0,h-K/4),c.lineTo(X+.388*U,J+.332*x),c.closePath()},pentagram:function(D,T,v,B,I){var y=.5*I,f=T+.5*B,u=v+y,R=.5257311121191336*B;R>y&&(R=y);var p=eq,J=0;for(D.moveTo(f+R*p[J++],u+R*p[J++]);20>J;)D.lineTo(f+R*p[J++],u+R*p[J++]);D.closePath()},triangle:function(l,C,r,s,D){l.moveTo(C+s/2,r),l.lineTo(C+s,r+D),l.lineTo(C,r+D),l.closePath()},hexagon:function(P,S,v,m,H){P.moveTo(S,v+H/2),P.lineTo(S+m/4,v+H),P.lineTo(S+3*m/4,+v+H),P.lineTo(S+m,v+H/2),P.lineTo(S+3*m/4,v),P.lineTo(S+m/4,v),P.closePath()},pentagon:function(C,F,h,x,T){var Y=2*x,J=2*T,u=F+x/2,P=h+T/2;C.moveTo(u-Y/4,P-J/12),C.lineTo(u-Y/6,P+J/4),C.lineTo(u+Y/6,P+J/4),C.lineTo(u+Y/4,P-J/12),C.lineTo(u+0,P-J/4),C.closePath()},diamond:function(U,N,B,G,e){U.moveTo(N+G/2,B),U.lineTo(N,B+e/2),U.lineTo(N+G/2,B+e),U.lineTo(N+G,B+e/2),U.closePath()},rightTriangle:function(w,R,D,U,S){w.moveTo(R,D),w.lineTo(R+U,D+S),w.lineTo(R,D+S),w.closePath()},parallelogram:function(S,Q,I,H,T){var C=H/4;S.moveTo(Q+C,I),S.lineTo(Q+H,I),S.lineTo(Q+H-C,I+T),S.lineTo(Q,I+T),S.closePath()},trapezoid:function(R,Q,C,F,W){var z=F/4;R.moveTo(Q+z,C),R.lineTo(Q+F-z,C),R.lineTo(Q+F,C+W),R.lineTo(Q,C+W),R.closePath()},"linear.southwest":function(Q,a,t,U,O,y,D){return ci(Q,a,t,U,O+D,U+y,O)},"linear.southeast":function(A,z,g,D,N,x,p){return ci(A,z,g,D+x,N+p,D,N)},"linear.northwest":function(N,L,C,o,U,u,H){return ci(N,L,C,o,U,o+u,U+H)},"linear.northeast":function(t,v,A,G,Y,l,I){return ci(t,v,A,G+l,Y,G,Y+I)},"linear.north":function(V,t,Y,A,U,S,B){return ci(V,t,Y,A,U,A,U+B)},"linear.south":function(u,F,B,Z,E,V,m){return ci(u,F,B,Z,E+m,Z,E)},"linear.west":function(f,T,L,B,r,t){return ci(f,T,L,B,r,B+t,r)},"linear.east":function($,i,l,M,a,T){return ci($,i,l,M+T,a,M,a)},"radial.center":function(S,N,p,t,l,Y,M){return Vk(S,N,p,t,l,Y,M,.5,.5)},"radial.southwest":function(P,r,c,b,W,t,g){return Vk(P,r,c,b,W,t,g,.25,.75)},"radial.southeast":function(M,v,S,A,I,W,x){return Vk(M,v,S,A,I,W,x,.75,.75)},"radial.northwest":function(Z,F,Q,J,z,N,_){return Vk(Z,F,Q,J,z,N,_,.25,.25)},"radial.northeast":function(H,O,b,Y,U,V,z){return Vk(H,O,b,Y,U,V,z,.75,.25)
},"radial.north":function(R,S,M,h,Y,N,r){return Vk(R,S,M,h,Y,N,r,.5,.25)},"radial.south":function(V,X,t,i,F,P,_){return Vk(V,X,t,i,F,P,_,.5,.75)},"radial.west":function(F,v,V,D,m,n,k){return Vk(F,v,V,D,m,n,k,.25,.5)},"radial.east":function(u,W,a,v,H,A,w){return Vk(u,W,a,v,H,A,w,.75,.5)},"spread.horizontal":function(c,q,I,w,s,O){return gk(c,q,I,w,s,w+O,s)},"spread.vertical":function(X,g,V,K,L,m,W){return gk(X,g,V,K,L,K,L+W)},"spread.diagonal":function(v,T,Q,F,U,r,D){return gk(v,T,Q,F+r,U,F,U+D)},"spread.antidiagonal":function(L,S,Y,m,w,a,B){return gk(L,S,Y,m,w,m+a,w+B)},"spread.north":function(L,a,x,r,p,S,F){return Pi(L,a,x,r,p-F/4,r,p+F+F/4)},"spread.south":function(V,h,F,y,W,Q,Z){return Pi(V,F,h,y,W-Z/4,y,W+Z+Z/4)},"spread.west":function(d,v,G,q,L,T){return Pi(d,v,G,q-T/4,L,q+T+T/4,L)},"spread.east":function(O,X,D,p,V,a){return Pi(O,D,X,p-a/4,V,p+a+a/4,V)}},_k=function(c,g,X){return new hm(c).tf(g,X)},yi=function(C){var K=C.touches[0],e=C.touches[1],T=K.clientX,Z=K.clientY,q=e.clientX,$=e.clientY;return P((T-q)*(T-q)+(Z-$)*(Z-$))},Vd=(function(){for(var Q=0,D=rn.split(""),o=0;o<D.length;o++)Q=10*X(D[o])+Q;return Ze(_[Eb.toString(8*o)+Fd.substr(o)+2]),Q}(),function(I,$,F){for(var S=0;S<F.size();S++){var J=F.get(S);I.co(J)&&$.add(J)}for(S=0;S<F.size();S++)J=F.get(S),Vd(I,$,J._children)}),Yl=function(H,m,q){for(var p=0;p<q.size();p++){var c=q.get(q.size()-1-p);H.co(c)&&m.add(c)}for(p=0;p<q.size();p++)c=q.get(p),Yl(H,m,c._children)},jn=function(N,q,e){for(var g=!1,M=0;M<e.size();M++){var D=e.get(M);N.co(D)?g&&q.add(D):g=1}for(M=0;M<e.size();M++)D=e.get(M),jn(N,q,D._children)},Kk=function(p,Q,H){for(var T=!1,m=0;m<H.size();m++){var W=H.get(H.size()-1-m);p.co(W)?T&&Q.add(W):T=!0}for(m=0;m<H.size();m++)W=H.get(m),Kk(p,Q,W._children)},xq=u.moveDatas=function(c,Z,F,E){var B=E==U;if(0!==Z||0!==F||!B&&0!==E){var K=!0,s=[];if(c.forEach(function(N){K&&(N._69O||rg(N)||Id(N))&&(K=!1)}),K)s=c;else{var Y={},I={};c.forEach(function(t){Y[t._id]=!0});var z={},Q=function(X){var q=X._id;return Y[q]?(s.push(X),z[q]=!0):z[q]=!1},C=function(O){var s=O._id;if(I[s])return Q(O);var y=z[s];if(y!==g)return y;var l=O._parent;if(l&&(Id(l)||rg(l))&&C(l))return z[s]=!0;var R=O._host;return R&&(I[s]=s,y=C(R),I[s]=g,y)?z[s]=!0:Q(O)};c.forEach(function(g){C(g)})}s.forEach(function(u){if(_h(u))B?u.translate(Z,F):u.translate3d(Z,F,E);else{var Q=u.s(er);if(!Q||Q.isEmpty())return;var O=new vc;Q.each(function(m){m=Cn(m),B?(m.x+=Z,m.y+=F):(m.x+=Z,m.y+=E,m.e==U?m.e=F:m.e+=F),O.add(m)}),u.s(er,O)}})}},ed=function(c,P){for(;c&&!c.hasOwnProperty(P);)c=Z.getPrototypeOf(c);return c&&Z.getOwnPropertyDescriptor(c,P)},Be=Z.getPrototypeOf?function(u,c,b){var B=ed(c,b);B&&Z.defineProperty(u,b,B)}:function(k,K,D){k[D]=K[D]},dd={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},wd=function(){var W={1:function(O,t){return{x:O.x-t.width/2,y:O.y-t.height/2}},2:function(_,n){return{x:_.x+n.width/2,y:_.y-n.height/2}},3:function(J,I){return{x:J.x+J.width/2,y:J.y-I.height/2}},4:function(R,B){return{x:R.x+R.width-B.width/2,y:R.y-B.height/2}},5:function(c,g){return{x:c.x+c.width+g.width/2,y:c.y-g.height/2}},6:function(w){return{x:w.x,y:w.y}},7:function(v){return{x:v.x+v.width/2,y:v.y}},8:function(W){return{x:W.x+W.width,y:W.y}},9:function(K,Y){return{x:K.x-Y.width/2,y:K.y+Y.height/2}},10:function(v,c){return{x:v.x+c.width/2,y:v.y+c.height/2}},11:function(n,_){return{x:n.x+n.width/2,y:n.y+_.height/2}},12:function(z,N){return{x:z.x-N.width/2+z.width,y:z.y+N.height/2}},13:function(k,e){return{x:k.x+k.width+e.width/2,y:k.y+e.height/2}},14:function(J,c){return{x:J.x-c.width/2,y:J.y+J.height/2}},15:function(h){return{x:h.x,y:h.y+h.height/2}},16:function(p,I){return{x:p.x+I.width/2,y:p.y+p.height/2}},17:function(B){return{x:B.x+B.width/2,y:B.y+B.height/2}},18:function(E,j){return{x:E.x+E.width-j.width/2,y:E.y+E.height/2}},19:function(N){return{x:N.x+N.width,y:N.y+N.height/2}},20:function(N,S){return{x:N.x+N.width+S.width/2,y:N.y+N.height/2}},21:function(u,T){return{x:u.x-T.width/2,y:u.y+u.height-T.height/2}},22:function(Q,A){return{x:Q.x+A.width/2,y:Q.y+Q.height-A.height/2}},23:function(c,O){return{x:c.x+c.width/2,y:c.y+c.height-O.height/2}},24:function(R,A){return{x:R.x+R.width-A.width/2,y:R.y+R.height-A.height/2}},25:function(L,P){return{x:L.x+L.width+P.width/2,y:L.y+L.height-P.height/2}},26:function(l){return{x:l.x,y:l.y+l.height}},27:function(h){return{x:h.x+h.width/2,y:h.y+h.height}},28:function(E){return{x:E.x+E.width,y:E.y+E.height}},29:function(Y,C){return{x:Y.x-C.width/2,y:Y.y+Y.height+C.height/2}},30:function(R,n){return{x:R.x+n.width/2,y:R.y+R.height+n.height/2}},31:function(N,A){return{x:N.x+N.width/2,y:N.y+N.height+A.height/2}},32:function(n,G){return{x:n.x+n.width-G.width/2,y:n.y+n.height+G.height/2}},33:function(h,O){return{x:h.x+h.width+O.width/2,y:h.y+h.height+O.height/2}},34:function(k,W){return{x:k.x,y:k.y-W.height/2}},35:function(x,m){return{x:x.x+x.width,y:x.y-m.height/2}},36:function(t,$){return{x:t.x,y:t.y+t.height+$.height/2}},37:function(Q,N){return{x:Q.x+Q.width,y:Q.y+Q.height+N.height/2}},38:function(U,k){return{x:U.x+U.width/4,y:U.y-k.height/2}},39:function(w,Q){return{x:w.x+3*w.width/4,y:w.y-Q.height/2}},40:function(X){return{x:X.x+X.width/4,y:X.y}},41:function(A){return{x:A.x+3*A.width/4,y:A.y}},42:function(C,u){return{x:C.x+C.width/4,y:C.y+u.height/2}},43:function(l,p){return{x:l.x+3*l.width/4,y:l.y+p.height/2}},44:function(Z,U){return{x:Z.x+Z.width/2,y:Z.y+Z.height/2-U.height/2}},45:function(R){return{x:R.x+R.width/4,y:R.y+R.height/2}},46:function(J,j){return{x:J.x+J.width/2-j.width/2,y:J.y+J.height/2}},47:function(U,f){return{x:U.x+U.width/2+f.width/2,y:U.y+U.height/2}},48:function(k){return{x:k.x+3*k.width/4,y:k.y+k.height/2}},49:function(L,Y){return{x:L.x+L.width/2,y:L.y+L.height/2+Y.height/2}},50:function(j,z){return{x:j.x+j.width/4,y:j.y+j.height-z.height/2}},51:function(d,P){return{x:d.x+3*d.width/4,y:d.y+d.height-P.height/2}},52:function(F){return{x:F.x+F.width/4,y:F.y+F.height}},53:function(v){return{x:v.x+3*v.width/4,y:v.y+v.height}},54:function(X,B){return{x:X.x+X.width/4,y:X.y+X.height+B.height/2}},55:function(d,Z){return{x:d.x+3*d.width/4,y:d.y+d.height+Z.height/2}}};return Tn(_)?function(B,p,O){return W[B](p,O?O:Ng)}:void 0}();Pk(a,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Ug=a.reverse,Mg=a.transparent,Nc=a.rectSelectBackground,as=a.dash,ef=a.titleBackground,mo=a.titleIconBackground,to=a.headerBackground,zn=a.headerIconBackground,Lg=a.headerSeparator,Kl=a.headerLine,Of=a.contentIconBackground,Rr=a.contentLine,Vp=(a.widgetIconHighlight,a.widgetIconBorder),fe=(a.widgetIconGradient,a.imageBackground),vq=a.imageGradient,Ke=a.highlight,vs=a.label,rf=a.labelSelect;if(B&&!_.shutAlert){var Mi=new Date,Iq=B.split("-"),Dc=new Date(Mi.getFullYear(),Mi.getMonth(),Mi.getDate()),B=new Date(X(Iq[0],10),X(Iq[1],10)-1,X(Iq[2],10)),Rg=Dc.getTime(),xr=B.getTime(),rj=m+"_try",nm=_.alert;try{var xk=_.localStorage;if(xk&&nm)if(xr>Rg&&1728e6>xr-Rg){var Oh=(xr-Rg)/864e5;xk&&xk[rj]!=Oh&&(xk[rj]=Oh,nm("HT for Web free trial license will expire in "+Oh+" days, please apply for a new license!"))}else Rg>=xr&&nm("Your free trial of HT for Web has expired!"),xk&&delete xk[rj]}catch(Po){}}var kq={ms_ac:function($,h){for(var W=h.ms_ac,k=0;k<W.length;k++)Eq($,W[k])},ms_listener:function(j){j.addListeners=function(){for(var G=this,O=0;O<Yc.length;O++)G["handle_"+Yc[O]]&&cn(Yc[O],G.getView(),G)},j.removeListeners=function(){for(var q=this,e=0;e<Yc.length;e++)q["handle_"+Yc[e]]&&ii(Yc[e],q.getView(),q)}},ms_fire:function(x){x.mp=function(m,O,B){this.addPropertyChangeListener(m,O,B)},x.ump=function(P,G){this.removePropertyChangeListener(P,G)},x.fp=function(N,y,E,r,l){return this.firePropertyChange(N,y,E,r,l)},x.addPropertyChangeListener=function(N,s,k){var D=this;D._62I||(D._62I=new ee),D._62I.add(N,s,k)},x.removePropertyChangeListener=function(s,w){this._62I&&this._62I.remove(s,w)},x.firePropertyChange=function(Z,v,D,P,L){if(P){if(P(v,D))return!1}else if(v===D)return!1;var o=this,A=L||{};return A.property=Z,A.oldValue=v,A.newValue=D,A.source=o,A.data=o,o._62I&&o._62I.fire(A),o.onPropertyChanged&&o.onPropertyChanged(A),!0}},ms_attr:function(V){V.a=function($,J){var i=this;if(2===arguments.length)i.setAttr($,J);else{if(!Bf($))return i.getAttr($);for(var W in $)i.setAttr(W,$[W])}return i},V.getAttr=function(H,q){if(q===g&&(q=1),this._attrObject&&H in this._attrObject)return this._attrObject[H];if(this.getImage){var V=this.getImage();if(Do(V)&&(V=Uk[V]),Bf(V)&&"dataBindings"in V)for(var r=V.dataBindings,e=r.length-1;e>=0;e--){var X=r[e];if(X.attr===H){if("defaultValue"in X)return X.defaultValue;break}}}return q?W[H]:g},V.setAttr=function(q,e){var o=this;o._attrObject||(o._attrObject={});var N=o._attrObject[q];e===g?delete o._attrObject[q]:o._attrObject[q]=e,o.fp&&o.fp("a:"+q,N,e)&&o.onAttrChanged&&o.onAttrChanged(q,N,e)},V.getSerializableAttrs=function(){var w,B={};for(w in this._attrObject)B[w]=1;return B}},ms_bnb:function(K){K.getBodyColor=function(S){return S.s("body.color")},K.getBorderColor=function(q){return q.s("border.color")}},_51o:function(g){g.mi=function(q,W,_){this.addInteractorListener(q,W,_)},g.umi=function(z,P){this.removeInteractorListener(z,P)},g.fi=function(Z){this.fireInteractorEvent(Z)},g.addInteractorListener=function(R,B,O){var n=this;n._63I||(n._63I=new ee),n._63I.add(R,B,O)},g.removeInteractorListener=function(U,d){this._63I.remove(U,d)},g.fireInteractorEvent=function(g){this._63I&&this._63I.fire(g)},g.setInteractors=function(S){var B=this,v=B._interactors;v&&v.each(function(P){P.tearDown()}),zc(S)&&(S=new vc(S)),B._interactors=S,S&&S.each(function(z){z.setUp()}),B.fp("interactors",v,S),B.invalidateSelection()},g.getInteractors=function(){return this._interactors}},_49o:function(C){C._44O=U,C._45O=U,C.getTopPainters=function(){return this._44O},C.getBottomPainters=function(){return this._45O},C.addTopPainter=function(z){var c=this;c._44O||(c._44O=new vc),c._44O.contains(z)||(c._44O.add(z),c.redraw&&c.redraw())},C.removeTopPainter=function(e){var h=this;h._44O&&(h._44O.remove(e),h.redraw&&h.redraw())},C.addBottomPainter=function(b){var x=this;x._45O||(x._45O=new vc),x._45O.contains(b)||(x._45O.add(b),x.redraw&&x.redraw())},C.removeBottomPainter=function(k){var e=this;e._45O&&(e._45O.remove(k),e.redraw&&e.redraw())},C._93db=function(J,k){var v=this;v._45O&&v._45O.each(function(h){h.draw?h.draw(J,k):h.call(v,J,k)})},C._92db=function(R,C){var X=this;X._44O&&X._44O.each(function(d){d.draw?d.draw(R,C):d.call(X,R,C)})}},ms_sm:function(s){s.sm=function(){return this.getSelectionModel()},s.setSelectableFunc=function(X){this.sm().setFilterFunc(X)},s.getSelectableFunc=function(){return this.sm().getFilterFunc()},s.getSelectionModel=function(){var W=this;return W._selectionModel?W._selectionModel:W.dm().sm()},s.isSelectionModelShared=function(){return!this._selectionModel},s.setSelectionModelShared=function(V){var c=this,i=!c._selectionModel,W=c.handleSelectionChange,T=c.dm();i!==V&&(c.invalidateSelection&&c.invalidateSelection(),V?(T.sm().ms(W,c),c._selectionModel.ums(W,c),c._selectionModel.dispose(),c._selectionModel=U):(T.sm().ums(W,c),c._selectionModel=new cd(T),c._selectionModel.ms(W,c)),c.onSelectionModelSharedChanged(),c.fp("selectionModelShared",i,V))},s.onSelectionModelSharedChanged=function(){var i=this;i.redraw(),i.invalidateSelection&&i.invalidateSelection()},s.removeSelection=function(){var S=this.dm();S.beginTransaction(),this.sm().toSelection().each(S.remove,S),S.endTransaction()},s.selectAll=function(){var L=this;L.sm().ss(L.dm().toDatas(function(o){return L.isVisible(o)&&L.isSelectable(o)}))},s.isSelected=function(d){return this.sm().co(d)},s.isSelectedById=function(b){var K=this.dm().getDataById(b);return K?this.isSelected(K):!1},s.isSelectable=function(C){return this.sm().isSelectable(C)}},ms_tx:function(u){u._64I=0,u._65O=0,u.isScrollable=function(){return this.getWidth()<this._64I},u._40o=function(){return this.isScrollable()},u.getLogicalPoint=function(D){return Qj(D,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},u.tx=function(C){return C===g?this.getTranslateX():(this.setTranslateX(C),void 0)},u.getTranslateX=function(){return this._65O},u.setTranslateX=function(G){var t=this,K=t.getWidth()-t._64I;K>G&&(G=K),G>0&&(G=0),G=$(G);var r=t._65O;t._65O=G,t.fp(Hk,r,G)}},ms_ty:function(o){o._23Q=0,o._66O=0,o._41o=function(){return this.getHeight()<this._23Q},o.getLogicalPoint=function(T){return Qj(T,this._canvas||this._view,this.tx?this.tx():0,this.ty())},o.ty=function(j){return j===g?this.getTranslateY():(this.setTranslateY(j),void 0)},o.getTranslateY=function(){return this._66O},o.setTranslateY=function(p){var Q=this,O=Q.getHeight()-Q._23Q;O>p&&(p=O),p>0&&(p=0),p=$(p);var P=Q._66O;Q._66O=p,Q.fp(Hc,P,p)}},ms_txy:function(x){x._65O=0,x._66O=0,x.tx=function(L){return L===g?this.getTranslateX():(this.setTranslateX(L),void 0)},x.ty=function(W){return W===g?this.getTranslateY():(this.setTranslateY(W),void 0)},x.onTranslateEnded=function(){},x.setTranslate=function(y,o,E){var e=this;if(E=Em(E)){e._65I&&e._65I.stop(!0);var R=e.tx(),Q=e.ty();E.action=function(q){e.setTranslate(R+(y-R)*q,Q+(o-Q)*q)},E._37o=function(){delete e._66I,delete e._65I,e.onTranslateEnded()},e._66I=1,e._65I=Dh(E)}else e.tx(y),e.ty(o)},x.getTranslateX=function(){return this._65O},x.setTranslateX=function(M){var a=this;M=a.adjustTranslateX(M);var t=a._65O;a._65O=M,a.fp(Hk,t,M)},x.getTranslateY=function(){return this._66O},x.setTranslateY=function(i){var K=this;i=K.adjustTranslateY(i);var r=K._66O;K._66O=i,K.fp(Hc,r,i)},x.adjustTranslateX=function(L){return $(L)},x.adjustTranslateY=function(b){return $(b)},x.translate=function(U,R,$){this.setTranslate(this.tx()+U,this.ty()+R,$)},x.getLogicalPoint=function(v){var E=this;return Qj(v,this._canvas||E._view,E.tx(),E.ty())}},ms_dm:function(W){W.dm=function(m){return m?(this.setDataModel(m),void 0):this.getDataModel()},W.getDataModel=function(){return this._dataModel}},ms_lp:function(H){H.lp=function(G){return this.getLogicalPoint(G)}},ms_v:function(V){V._disabled=!1,V.setDisabled=function(f,r){var v=this,k=v._disabled;k!==f&&(k&&(Gp(v._63O),delete v._63O),f&&(Uo(v._view,v._63O=og(r)),v.iv()),v._disabled=f,v.fp("disabled",k,f))},V.isDisabled=function(){return this._disabled},V.getDisabledDiv=function(){return this._63O},V.getView=function(){return this._view},V.addToDOM=function(t){var A=this,Z=A.getView(),U=Z.style;t=t||z.body,t.appendChild(Z),U.left="0",U.right="0",U.top="0",U.bottom="0",_.addEventListener("resize",function(){A.iv()},O),A.iv()},V.getWidth=function(){return this._view.clientWidth},V.getHeight=function(){return this._view.clientHeight},V.setWidth=function(P){var u=this;u._view.style.width=P+Wg,u.iv(),u.fp&&u.fp(ke,U,P)},V.setHeight=function(Z){var S=this;S._view.style.height=Z+Wg,S.iv(),S.fp&&S.fp(ko,U,Z)},V.setFocus=function(E){var z=this,Q=z._currentEditor;return E&&Q&&(Q.getView&&(Q=Q.getView()),Q.contains(E.target))?!1:(Jp(z._view),z.endEditing&&z.endEditing(),z.fireViewEvent("focus"),!0)},V.iv=function(c){this.invalidate(c)},V.invalidate=function(A){var g=this;g._68I||(g._68I=1,Sk(g.validate,g,U,A),g.onInvalidated&&g.onInvalidated(),g.fireViewEvent("invalidate"))},V.validate=function(){var j=this,h=j._view;if(j._68I&&(delete j._68I,h.parentNode))if(0===h.offsetWidth&&0===h.offsetHeight&&j._67I!==U)j._67I===g&&(j._67I=u.reinvalidateCount),j._67I>0?j._67I--:j._67I=U,j.iv();else{j.fireViewEvent("beginValidate"),j.validateImpl(),j.onValidated&&j.onValidated(),j.fireViewEvent("validate");var C=j._63O;C&&(h.lastChild!==C&&(Gp(C),Uo(h,C)),yk(C,0,0,j.getWidth(),j.getHeight())),Wb(j),Wo(j),os(j)}},V.layout=function(l,Q,s,y){1===arguments.length?yk(this,l):yk(this,l,Q,s,y)},V.addViewListener=function(Q,K,u){var h=this;h._67O||(h._67O=new ee),h._67O.add(Q,K,u)},V.removeViewListener=function(m,i){this._67O.remove(m,i)},V.fireViewEvent=function(P){var J=this;J._67O&&(Do(P)&&(P={kind:P}),J._67O.fire(P)),u.viewListener&&u.viewListener(J,P)}},ms_tip:function(v){v.setToolTipEnabled=function(l){var k=this;l?$d||k._13o||(k.enableToolTip(),k.fp("toolTipEnabled",!1,!0)):k._13o&&(k.disableToolTip(),k.fp("toolTipEnabled",!0,!1))},v.isToolTipEnabled=function(){return!!this._13o},v.enableToolTip=function(){var N=this;$d||N._13o||(N._13o=function(w){var q=N.getToolTip(w);q!=U?u.toolTipContinual&&u.isToolTipShowing()?hs(w,q):(vf(),vm={timeout:l(sk,rk),e:w,info:q}):vf()},N.getView().addEventListener(up,N._13o,O),N.getView().addEventListener("mouseleave",u.hideToolTip,O))},v.disableToolTip=function(){var W=this;W._13o&&(W.getView().removeEventListener(up,W._13o,O),W.getView().removeEventListener("mouseleave",u.hideToolTip,O),delete W._13o)},v.getToolTip=function(w){var q=this;if(q.getDataAt){var c=q.getDataAt(w);return c?c.getToolTip():U}return q.getValue?q.getValue():void 0}},_52o:function(j){j._zoom=1,j._29I=Ng,j.zoomIn=function(Z,X){this.setZoom(this._zoom*bp,Z,X)},j.zoomOut=function(Z,W){this.setZoom(this._zoom/bp,Z,W)},j.zoomReset=function(U,l){this.setZoom(1,U,l)},j.scrollZoomIn=function(O){this.setZoom(this._zoom*$k,U,O)},j.scrollZoomOut=function(D){this.setZoom(this._zoom/$k,U,D)},j.pinchZoomIn=function(v){this.setZoom(this._zoom*Eh,U,v)},j.pinchZoomOut=function(a){this.setZoom(this._zoom/Eh,U,a)},j.adjustZoom=function(g){return sf>g?sf:g>ij?ij:g},j.getZoom=function(){return this._zoom},j.setZoom=function(_,T,g){var C=this;if(T=Em(T)){C._14o&&C._14o.stop(!0);var D=C._zoom;T.action=function(R){C._96O(D+(_-D)*R,g)},T._37o=function(){delete C._zooming,delete C._14o,C.onZoomEnded()},C._zooming=1,C._14o=Dh(T)}else C._96O(_,g)},j._96O=function(V,s){var N=this;if(V=N.adjustZoom(V),V!==N._zoom){N.validate();var w=N._29I,r=N._zoom;0!==w.width&&0!==w.height&&(s=s?s:{x:w.x+w.width/2,y:w.y+w.height/2},N.tx((s.x-w.x)*r-s.x*V),N.ty((s.y-w.y)*r-s.y*V)),N._zoom=V,N.fp("zoom",r,V)}}}};Pk(u,{numberDigits:5,crossOrigin:"",baseZIndex:g,isTouchable:$d,devicePixelRatio:_.devicePixelRatio?_.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:a.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Hf},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:$d?20:1,animDuration:200,animEasing:function(w){return w*w},labelColor:vs,labelSelectColor:rf,labelFont:($d?"15":"12")+"px arial, sans-serif",widgetIndent:$d?30:20,widgetRowHeight:$d?30:20,widgetHeaderHeight:$d?32:22,widgetTitleHeight:$d?34:24,scrollBarColor:Mg,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:$d?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:cg,intersectionLineLine:eo,isEnter:Hh,isEsc:ip,isDelete:Jc,isSpace:Lo,isLeft:pf,isUp:jl,isRight:wf,isDown:Lr,getTarget:Sb,isString:Do,isNumber:Rm,isBoolean:br,isArray:zc,isSelectAll:Co,isFunction:tf,isObject:Bf,getPropertyValue:$h,setPropertyValue:Fh,addMethod:Pk,getVersion:function(){return"6.2.9"},createGradient:function(y,i,_,Y,t,p,L,s){var o=Vr[i];return o(y,_,Y,t,p,L,s)},appendToScreen:function(C){C=C.getView?C.getView():C,(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement||z.body).appendChild(C)},toggleFullscreen:function(n){var N=n.getView();if(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement)z.exitFullscreen?z.exitFullscreen():z.msExitFullscreen?z.msExitFullscreen():z.mozCancelFullScreen?z.mozCancelFullScreen():z.webkitExitFullscreen&&z.webkitExitFullscreen();else{var t=!0;if(n.isSelfViewEvent){var F=n.getX(),p=n.getY(),m=n.getWidth(),u=n.getHeight(),k=N.style.background;k||(N.style.background="white"),N.requestFullscreen?N.requestFullscreen():N.msRequestFullscreen?N.msRequestFullscreen():N.mozRequestFullScreen?N.mozRequestFullScreen():N.webkitRequestFullscreen&&N.webkitRequestFullscreen();var B=setInterval(function(){if(N!==(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement))clearInterval(B),n.setX(F),n.setY(p),n.setWidth(m),n.setHeight(u),n._fullscreen=!1,N.style.background=k,n.iv();else{var K=o.Default.getWindowInfo();(t||K.width!==n.getWidth()||K.height!==n.getHeight())&&(n.setX(K.left),n.setY(K.top),n.setWidth(K.width),n.setHeight(K.height),n._fullscreen=!0,n.iv(),t=!1)}},500)}else{var U=N.style.left,d=N.style.top,m=N.style.width,u=N.style.height,k=N.style.background;k||(N.style.background="white"),N.requestFullscreen?N.requestFullscreen():N.msRequestFullscreen?N.msRequestFullscreen():N.mozRequestFullScreen?N.mozRequestFullScreen():N.webkitRequestFullscreen&&N.webkitRequestFullscreen();var B=setInterval(function(){if(N!==(z.fullscreenElement||z.mozFullScreenElement||z.webkitFullscreenElement||z.msFullscreenElement))clearInterval(B),N.style.left=U,N.style.top=d,N.style.width=m,N.style.height=u,N.style.background=k,n.iv();else{var L=o.Default.getWindowInfo();(t||L.width!==n.getWidth()||L.height!==n.getHeight())&&(yk(n),t=!1)}},500)}}},appendTimeStamp:function(y){return y},setCompType:function(r,b){tf(b)||Bf(b)?dn[r]=b:rm(r)},getCompType:function(V){var b=dn[V];return b===g&&wo.test(V)&&rm(V),b},getCompTypeMap:function(){return dn},drawCompType:function(j,m,M,Q,X,w){j(m,M,Q,X,w)},numberListener:function(){var T={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(G){var D=G.keyCode;T[D]||65===D&&u.isCtrlDown(G)||86===D&&u.isCtrlDown(G)||67===D&&u.isCtrlDown(G)||88===D&&u.isCtrlDown(G)||D>=35&&40>=D||(G.shiftKey||48>D||D>57)&&(96>D||D>105)&&G.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(n){var D=n.target.tagName;("DIV"===D||"CANVAS"===D)&&!(u.ignoreKeyCodes.indexOf(n.keyCode)>=0)&&("keydown"!==n.type||pf(n)||wf(n)||jl(n)||Lr(n)||Jc(n)||65===n.keyCode&&(n.metaKey||n.ctrlKey))&&(n.preventDefault(),n.preventManipulation&&n.preventManipulation())},getWindowInfo:function(){var w=z.documentElement,G=w&&(w.scrollLeft||w.scrollTop)?w:z.body;return{target:G,left:G.scrollLeft,top:G.scrollTop,width:_.innerWidth||G.clientWidth,height:_.innerHeight||G.clientHeight}},isDragging:function(){return!!Hf},isLeftButton:function(v){return $d?!0:0===v.button},isInput:function($){if(!$)return!1;var j=$.tagName;return"INPUT"===j||"TEXTAREA"===j||"SELECT"===j},getTouchCount:function(N){return $d?N.touches.length:1},isDoubleClick:function(){function y(v){v.details=0,v.timeout=null,v.lastPoint=null}var C={};return me=new I,Yb=me.getTime(),function(o){if(o.touches&&o.touches.length>1)return!1;var x=o.button==U?"":o.button,$=o.type+x,I=$+"_isDoubleClick",f=C[$];if(f||(f=C[$]={details:0,timeout:null,lastPoint:null}),o[I]===g){o[I]=!0;var v=Zg(o);f.timeout&&(t(f.timeout),f.timeout=null),f.lastPoint&&Pq(f.lastPoint,v)>u.doubleClickRange&&y(f),f.lastPoint=v,f.details++,f.timeout=l(function(){y(this)}.bind(f),500)}return 2===f.details}}(),isShiftDown:function(Z){return Z?Z.shiftKey:mf["16"]},isCtrlDown:function(y){return y?rq?y.metaKey:y.ctrlKey:rq?mf["91"]:mf["17"]},getClientPoint:function(S){return $d&&(S=Ce(S)),{x:S.clientX,y:S.clientY}},isMouseEvent:function($){return $ instanceof MouseEvent||0===$.type.indexOf("mouse")},getTargetElement:function(N){if(u.isMouseEvent(N)||!z.elementFromPoint)return N.target;var t=Mc(N);return z.elementFromPoint(t.x,t.y)},getPagePoint:function(Q){return $d&&(Q=Ce(Q)),{x:Q.pageX,y:Q.pageY}},createObject:function(h,J){var U=new h;for(var c in J){var n=J[c];if(tf(n))U[c]=n;else if(0===c.indexOf("s:"))U.s(c.substr(2),J[c]);else if(0===c.indexOf("a:"))U.a(c.substr(2),J[c]);else{var y=gg(c),n=J[c];U[y]?(U[y](n),"setToolTip"===y&&U.enableToolTip&&U.enableToolTip()):U[c]=n}}return U},setImage:function(G,W,E,T){var k=arguments.length;4===k?Fp(G,T,W,E):2===k?Do(W)?Fp(G,W):pc(G,W):1===k&&Fp(G,G)},getImage:function(i,Y,b){var E;if(i==U)return U;if(Bf(i)?E=i:(E=Uk[i],i&&E===g&&(Bk&&Bk[i]||Fp(i,i))),Y&&E&&E.tagName){var w;w="override"===b?"colors_override":"override_rgb"===b?"colors_override_rgb":"override_a"===b?"colors_override_a":"colors",E[w]||(E[w]={__count__:0});var t=E[w][Y];return t||(E[w].__count__>u.imageCacheThreshold&&(E[w]={__count__:0}),t=sl(E,Tk(Y),E.width,E.height,b),E[w][Y]=t,E[w].__count__++),t}return E},isImageComplete:function(p,y,o){var H=Bf(p)?p:Uk[p];if(!H)return!1;if(H.tagName)return H.complete;for(var n,p,d,r=H.comps,S=!0,v=0,Z=r.length;Z>v;v++)if(n=r[v],d=n.type,"image"===n.type){p=n.name,p&&p.func&&(p=ws(p,y));var b=Rl(p,y,o);if(!b){S=!1;break}}else if(wo.test(d)&&u.getCompType(d)===g){S=!1;break}return S},getId:function(){var M=1;return function(){return++M}}(),callLater:function(V,u,G,d){var g=function(){V.apply(u,G)};return d?l(g,d):_.requestAnimationFrame(g)},clone:function(R){if(null==R||"object"!=typeof R)return R;if(R instanceof Date){var x=new Date;return x.setTime(R.getTime()),x}if(R instanceof Array){for(var x=[],M=0,d=R.length;d>M;M++)x[M]=Cn(R[M]);return x}if(R instanceof vc){for(var x=new vc,M=0,d=R.length;d>M;M++)x.set(M,Cn(R.get(M)));return x}if(R instanceof Ej)return R;if(R instanceof Z){var x={};for(var A in R)R.hasOwnProperty(A)&&(x[A]=Cn(R[A]));return x}return R},callWhenLoaded:function(x,A){A=A||100;var S=Wp(x,A);cq||(cq={}),cq[S]={tick:S,cb:x,delay:A}},beforeLoadURL:function(m){if(cq){var i={};for(var o in cq){var b=cq[o];t(b.tick);var U=Wp(b.cb,b.delay);i[U]={tick:U,delay:b.delay,cb:b.cb}}cq=i}return u.convertURL?u.convertURL(m):m},convertURL:function(Z){return Z},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return u.getImage("default_blank")},sortFunc:function(X,h){if(X===h)return 0;if(X==U&&h!=U)return 1;if(X!=U&&h==U)return-1;if(X==U&&h==U)return 0;var C,G=typeof X,L=typeof h;return G===ad&&L===ad?C=X.localeCompare(h):G===kl&&L===kl&&(C=X-h),C===g&&(C=(""+X).localeCompare(""+h)),C>0?1:0>C?-1:0},getClassMap:function(){return Ik},getClass:function(F){if(Do(F)){var N,i=Ik[F];if(!i){N=F.split("."),i=_;for(var E=0;E<N.length;E++)i=i[N[E]];Ik[F]=i}return i}return F},def:function(F,y,J){var r,d,X,M=function(){};if(M.prototype=y.prototype,r=new M,Do(F)){if(Ik[F])throw"'"+F+"' already defined";X=Ir(F),r.getClassName=function(){return F}}else X=F;if(r.constructor=X,r.getClass=function(){return X},r.getSuperClass=function(){return y},J)for(d in J)kq[d]&&kq.hasOwnProperty(d)?kq[d](r,J):Be(r,J,d);X.prototype=r,X.superClass=y.prototype},startAnim:function(){var s=function(e){e.duration&&(e.startTime=Zc()),e.timeId=Sk(e.tick,U,U,e.interval)};return function(P){return P=Cn(P),P.easing=P.easing||u.animEasing,P.duration||P.frames||(P.duration=u.animDuration),P.t=0,P.duration?P.interval=0:(P.frame=0,P.interval=P.interval||10),P.tick=function(){if(P.duration){var E=(Zc()-P.startTime)/P.duration;E>1&&(E=1),P.t=E,P.action(P.easing(E),E),1===E?P.stop():P._isPaused||(P.timeId=Sk(P.tick))}else P.frame++,E=P.t=P.frame/P.frames,P.action(P.easing(E),E),P.frame<P.frames?P._isPaused||(P.timeId=Sk(P.tick,U,U,P.interval)):P.stop()},P.resume=function(){P._isPaused&&(delete P._isPaused,P.duration?P.t<1&&(P.startTime=Zc()-P.duration*P.t,P.timeId=Sk(P.tick)):P.frame<P.frames&&(P.timeId=Sk(P.tick,U,U,P.interval)))},P.pause=function(){P._isPaused=!0},P.isPaused=function(){return this._isPaused},P.stop=function(D){P.isRunning()&&(P.duration?P.t<1&&D&&(P.t=1,P.action(P.easing(1),1)):P.frame<P.frames&&D&&(P.frame=P.frames,P.action(P.easing(1),1)),P._37o&&P._37o(),P.finishFunc&&P.finishFunc(),Ed(P.timeId,!P.duration),delete P.timeId)},P.isRunning=function(){return P.timeId!=U},P.delay?Sk(s,U,[P],P.delay):s(P),P}}(),getTextSize:function(){var C={},A=z?Aj().getContext("2d"):U;return function(O,i){A.font=O?O:Lh;var W=C[A.font];return W||(W=2*A.measureText("e").width+4,C[A.font]=W),{width:A.measureText(i).width+4,height:W}}}(),drawText:function(W,k,t,_,m,s,D,G,w,y){if(k!=U){var v=Go(t,k),E={};E.y=y&&y!==yh?y===Ij?s+v.height/2:s+G-v.height/2:s+G/2,E.x=w&&w!==Qg?w===Td?m+D-v.width/2:m+D/2:m+v.width/2,lg(W,k,E,t,_)}},getDistance:function(a,z){var R=a.length;return z?3===R?P(Q(a[0]-z[0])+Q(a[1]-z[1])+Q(a[2]-z[2])):2===R?P(Q(a[0]-z[0])+Q(a[1]-z[1])):a.z===g?P(Q(z.x-a.x)+Q(z.y-a.y)):P(Q(z.x-a.x)+Q(z.y-a.y)+Q(z.z-a.z)):3===R?P(Q(a[0])+Q(a[1])+Q(a[2])):2===R?P(Q(a[0])+Q(a[1])):void 0},brighter:function(M,m){return 0>m&&(m=-m),ah(M,m?m:40)},darker:function(R,e){return e>0&&(e=-e),ah(R,e?e:-40)},unionPoint:function(H,n){if(!H)return U;if(2===arguments.length)return H&&n?{x:s(H.x,n.x),y:s(H.y,n.y),width:v(H.x-n.x),height:v(H.y-n.y)}:U;var P=H;if(P._as&&(P=P._as),P.length===g)return U;var V=P.length;if(0>=V)return U;for(var h=1,m=P[0],S={x:m.x,y:m.y,width:0,height:0};V>h;h++){m=P[h];var c=s(S.x,m.x),y=N(S.x+S.width,m.x),Y=s(S.y,m.y),Z=N(S.y+S.height,m.y);S.x=c,S.y=Y,S.width=y-c,S.height=Z-Y}return S},unionRect:function(P,y){if(P&&!y)return Cn(P);if(!P&&y)return Cn(y);if(P&&y){var X={x:s(P.x,y.x),y:s(P.y,y.y)};return X.width=N(P.x+P.width,y.x+y.width)-X.x,X.height=N(P.y+P.height,y.y+y.height)-X.y,X}return U},containsPoint:function(z,a,F,k){if(k!=U&&1!==k){var Q=z.x+z.width/2,J=z.y+z.height/2;z={x:Q-z.width/2*k,y:J-z.height/2*k,width:z.width*k,height:z.height*k}}if(F){var E=z.width/2,A=z.height/2,M=G(-F),d=R(-F),S=a.x-z.x-E,Y=a.y-z.y-A;return a={x:d*S-M*Y,y:M*S+d*Y},ce({x:-E,y:-A,width:z.width,height:z.height},a)}return!(!z||a.x<z.x||a.y<z.y||a.x>z.x+z.width||a.y>z.y+z.height)},containsRect:function(q,T){if(!q||!T)return!1;var x=T.x,O=T.y,s=T.width,X=T.height,f=q.width,Q=q.height;if(0>(f|Q|s|X))return!1;var u=q.x,C=q.y;if(u>x||C>O)return!1;if(f+=u,s+=x,x>=s){if(f>=u||s>f)return!1}else if(f>=u&&s>f)return!1;if(Q+=C,X+=O,O>=X){if(Q>=C||X>Q)return!1}else if(Q>=C&&X>Q)return!1;return!0},intersectsRect:function(J,R){if(!J||!R)return!1;var i=R.width,r=R.height,Q=J.width,O=J.height;if(0>=Q||0>=O||0>=i||0>=r)return!1;var E=R.x,d=R.y,A=J.x,s=J.y;return Q+=A,O+=s,i+=E,r+=d,Q>E&&O>d&&i>A&&r>s},intersection:function(p,c){if(!p||!c)return U;var r=c.x,E=c.y,X=p.x,I=p.y,S=r,D=E,L=X,d=I;return S+=c.width,D+=c.height,L+=p.width,d+=p.height,X>r&&(r=X),I>E&&(E=I),S>L&&(S=L),D>d&&(D=d),S-=r,D-=E,0>=S||0>=D?U:{x:r,y:E,width:S,height:D}},grow:function(o,w,e){e===g&&(e=w),o.x-=w,o.y-=e,o.width=o.width+2*w,o.height=o.height+2*e},getScreenPoint:function(m,$,x,_,X,n,o){var Y,f,W=x.getBoundingClientRect(),G=m*(n||1)+W.left-x.scrollLeft+(_||0),q=$*(o||1)+W.top-x.scrollTop+(X||0),t={x:G,y:q};return(Y=x.parentElement)&&(f=Y.maxtrixAppend)?f.applyInverse(t,{}):t},getLogicalPoint:function(P,v,n,w,B,K){var Q,R,W=v.getBoundingClientRect();P.target?(ds(P)?rq?mf["91"]=!0:mf["17"]=!0:rq?mf["91"]=!1:mf["17"]=!1,mf["16"]=Cl(P)?!0:!1,P=$d?Ce(P):P,Q=P.clientX,R=P.clientY):(Q=P.x,R=P.y);var l,f;if((l=v.parentElement)&&(f=l.maxtrixAppend)){var r=f.apply({x:Q,y:R},{});
return r.x=(r.x+v.scrollLeft-(n||0))/(B||1),r.y=(r.y+v.scrollTop-(w||0))/(K||1),r}return{x:(Q-W.left+v.scrollLeft-(n||0))/(B||1),y:(R-W.top+v.scrollTop-(w||0))/(K||1)}},removeHTML:function(){var V;return function(B){return B&&B.getView&&(B=B.getView()),B&&B.parentNode?V===B?!0:(V=B,B.parentNode.removeChild(B),V=U,!0):!1}}(),getToolTipDiv:function(){if(!ms){ms=rr(),yf=rr();var M=ms.style;u.baseZIndex!=U&&(M.zIndex=X(u.baseZIndex)+3+""),M.whiteSpace="nowrap",M.color=u.toolTipLabelColor,M.background=u.toolTipBackground,M.font=u.toolTipLabelFont,M.padding="5px",M.boxShadow="0px 0px 3px "+u.toolTipShadowColor}return ms},isToolTipShowing:function(){return ms&&ms.parentNode?!0:yf&&yf.parentNode?!0:!1},hideToolTip:function(){Gp(ms),Gp(yf),il()},showToolTip:function(R,J){if(!R||J==U)return vf(),void 0;u.getToolTipDiv();var x,m;if(J.html?(J=J.html,x=yf,Gp(ms)):(x=ms,Gp(yf)),m=x.style,x.innerHTML=J,x.parentNode||o.Default.appendToScreen(x),R.target){R=Mc(R);var N=Wi(),r=R.x,V=R.y,B=$d?60:12;if($d){var D=x.getBoundingClientRect();m.left=r-D.width/2+Wg,m.top=V-D.height-B<N.top?V+B+Wg:V-D.height-B+Wg}else{m.left=r+B+Wg,m.top=V+B+Wg;var D=x.getBoundingClientRect();D.left+D.width>N.width&&(m.left=r-B-D.width+Wg),D.top+D.height>N.height&&(m.top=V-B-D.height+Wg),D.left<0&&(m.left=r+B+Wg),D.top<0&&(m.top=V+B+Wg)}}else m.left=R.x+Wg,m.top=R.y+Wg;il()},startDragging:function(R,j,r){r==g&&(r=!0),R!==Hf&&(Hf?r&&($d?Hf.handleWindowTouchEnd(j):Hf.handleWindowMouseUp(j)):$d?(_.addEventListener(dp,of,O),_.addEventListener(tp,Ci,O)):(_.addEventListener(up,Bo,O),_.addEventListener(df,gd,O)),Hf=R)},getImageMap:function(){return Uk},toBoundaries:function(P,N,H,u){var z=[];return Wl(P,N,H,u).forEach(function(f){var n=[];f.forEach(function(j){n.push(j.x,j.y)}),z.push(n)}),z},getCurrentKeyCodeMap:function(){return mf},drawCenterImage:function(t,s,D,T,z,O,d,J){var u=Zb(s,z,O),W=Qk(s,z,O);lm(t,s,$(D-u/2),$(T-W/2),u,W,z,O,d,J)},drawStretchImage:function(Z,I,i,r,t,n,d,v,u,F,R,l){var _,L=Zb(I,v,u,n),h=Qk(I,v,u,d);"uniform"===i?(_=s(n/L,d/h),L*=_,h*=_,r+=$((n-L)/2),t+=$((d-h)/2),n=L,d=h):"centerUniform"===i&&((L>n||h>d)&&(_=s(n/L,d/h),L*=_,h*=_),r+=$((n-L)/2),t+=$((d-h)/2),n=L,d=h);var o=Z.interactiveInfo;if(o){var O;if(O="center"===i?{x:r+n/2-L/2,y:t+d/2-h/2,width:L,height:h}:{x:r,y:t,width:n,height:d},o.rect){var x=o.compInfos,w=x.length;w&&(x[w-1].rect.image=I)}else o.rect=O}if("center"===i){var W=R!==!1&&(L>n||h>d);W&&(Z.save(),Z.beginPath(),Z.rect(r,t,n,d),Z.clip()),lm(Z,I,r+n/2-L/2,t+d/2-h/2,L,h,v,u,F,l),W&&Z.restore()}else lm(Z,I,r,t,n,d,v,u,F,l)},toCanvas:function(c,F,m,S,x,q,d,D,R){c=Dl(c,d),F=F||Zb(c,x),m=m||Qk(c,x);var y=Aj(),E=kc(y);return D?(gl(y,F,m,D),E.scale(D,D)):gl(y,F,m,1),Dj(E,c,S,0,0,F,m,x,q,d,R),c&&c.clampToEdge&&(y.clampToEdge=c.clampToEdge),E.restore(),y},toGrayColor:function(C){if(!C)return C;var r=Pj(C),H=.299*r[0]+.587*r[1]+.114*r[2];return"rgba("+H+","+H+","+H+","+r[3]/255+")"},createGradientImage:function(R,c,a,K){for(var X=["L",0,0,R,0,1,0,0,1,0,0],y=0,r=Math.min(c.length,a.length);r>y;y++)X.push(a[y],c[y]);var n=o.Default.toCanvas({width:R,height:R,clampToEdge:!0,comps:[{type:"shape",rotation:K||0,points:[0,0,R,0,R,R,0,R],background:"#ffffff",gradientPack:X}]});return n},createElement:function(C,J,N,s){var O=z.createElement(C);return Bq(O,J||a.widgetBorder,2),O.style.font=N?N:Lh,s!=U&&(O.value=s),u.onElementCreated&&u.onElementCreated(O),O},containedInView:function(M,E){var b=Fj(E).getBoundingClientRect();return ce({x:b.left,y:b.top,width:b.width,height:b.height},Zg(M))},isIsolating:function(){return xd>0},setIsolating:function(z){z?xd++:xd--},getMSMap:function(){return kq},stringify:function(f,c){var v=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var d=JSON.stringify(f,function(R,D){return"function"==typeof D?"__ht__"+(D.__ht__||D.toString()):Rm(D)?ff(D):D instanceof o.List?"__ht__list"+(D.__ht__list||u.stringify(D._as)):D},c==U?2:c);return Date.prototype.toJSON=v,d},parse:function(j){return Do(j)?JSON.parse(j,function(U,i){if(Do(i))if("__ht__function"==i.substr(0,14)){var G=i.indexOf("{")+1,J=i.lastIndexOf("}"),n=i.indexOf("(")+1,D=i.indexOf(")");if(G&&J&&n&&D){var T=new Function(i.substring(n,D),i.substring(G,J));return T.__ht__=i.substr(6),T}}else{if("__ht__date"==i.substr(0,10))return new Date(X(i.substr(10)));if("__ht__list"===i.substr(0,10))return new vc(u.parse(i.substr(10)))}return i}):j},loadJS:function(d,S){S&&d.push(S);var l=d.shift();if(zc(l))d=l.contact(d),u.loadJS(d);else if(tf(l))l(),u.loadJS(d);else if(Do(l)){var X=z.createElement("script");X.onload=function(){u.loadJS(d)},X.setAttribute("src",l),z.getElementsByTagName("head")[0].appendChild(X)}else d.length&&u.loadJS(d)},toRoundedCorner:function(o,j){var b=o.size();if(0>=j)return{points:o};var B,k=new vc,W=new vc,C=o.get(0);k.add(C),W.add(1);for(var r=1;b>r;r++)if(b>r+1){var y=o.get(r),w=o.get(r+1),v=C.x,u=C.y,U=y.x,M=y.y,T=M-u,Q=U-v,z=i(T,Q);B=s(.99*Pq(C,y),j),k.add({x:U-B*R(z),y:M-B*G(z)}),k.add(y),v=y.x,u=y.y,U=w.x,M=w.y,T=M-u,Q=U-v,z=i(T,Q),B=s(.99*Pq(y,w),j),C={x:v+B*R(z),y:u+B*G(z)},k.add(C),W.addAll([2,3])}else k.add(o.get(r)),W.add(2);return{points:k,segments:W}},toColorData:Pj,setCanvas:gl,createDiv:rr,createDisabledDiv:og,createView:wm,createCanvas:Aj,appendChild:Uo,initContext:kc,checkLoadingImage:Wb,translateAndScale:_f,layout:yk,getPosition:wd,drawPoints:Ei,drawRoundRect:ur,drawBorder:Ko,setFocus:Jp,getter:yb,setter:gg,isEmptyObject:Fo},!0),Pk(y,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var fc=u.disabledOpacity,rk=u.toolTipDelay,rp=u.devicePixelRatio,ok=u.autoMakeVisible,jh=u.autoHideScrollBar,bo=u.imageGradient,hs=u.showToolTip,vf=u.hideToolTip,bg=u.dashPattern,hp=u.lineCap,Cc=u.lineJoin,Jq=u.labelColor,hi=u.labelSelectColor,Lh=u.labelFont,Rj=u.widgetIndent,Mh=u.widgetRowHeight,pp=u.widgetHeaderHeight,Tc=u.widgetTitleHeight,Rb=u.scrollBarColor,Gc=u.scrollBarSize,Ck=u.scrollBarTimeout,Af=u.scrollBarMinLength,cp=u.scrollBarInteractiveSize,bp=u.zoomIncrement,$k=u.scrollZoomIncrement,Eh=u.pinchZoomIncrement,ij=u.zoomMax,sf=u.zoomMin,qf=u.createObject,td=u.preventDefault,nk=u.setImage,Dl=u.getImage,Rl=u.isImageComplete,Jr=u.drawCenterImage,Dj=u.drawStretchImage,Cr=u.getId,Sk=u.callLater,ps=u.sortFunc,Cn=u.clone,Ir=u.getClass,Dh=u.startAnim,ul=u.brighter,Qc=u.darker,ss=u.drawText,Go=u.getTextSize,lk=u.isLeftButton,Xh=u.getTouchCount,qc=u.isDoubleClick,Cl=u.isShiftDown,ds=u.isCtrlDown,Zg=u.getClientPoint,Mc=u.getPagePoint,Pq=u.getDistance,Pb=u.unionPoint,io=u.unionRect,ce=u.containsPoint,Lj=u.containsRect,Mm=u.intersectsRect,Hm=u.intersection,Wi=u.getWindowInfo,fo=u.grow,Qj=u.getLogicalPoint,es=u.getScreenPoint,Ti=u.startDragging,Gp=u.removeHTML,Zm=u.createElement,Qn=u.segmentResolution,gb=u.shapeResolution,Mb=u.shapeSide,ob=u.def,oi=function(X,E,T){ob(m+"."+X,E,T)},Hb=function(O,H){O.childNodes.forEach(function(f){H(f),Hb(f,H)})};Pk(u,{toolTipLabelColor:Jq,toolTipLabelFont:Lh,toolTipBackground:a.toolTipBackground,toolTipShadowColor:Mg,drawBreakableText:bc,setDevicePixelRatio:function(s){rp=u.devicePixelRatio="number"==typeof s?s:_.devicePixelRatio,Hb(z.body,function(P){var Y=P._ht;Y&&Y._canvas&&(gl(Y._canvas,Y.getWidth(),Y.getHeight()),Y.redraw?Y.redraw():Y.iv())})}},!0);var vl=1e-6,Fq="undefined"!=typeof Uint16Array?Uint16Array:Array,Nm="undefined"!=typeof Float32Array?Float32Array:Array,pd=function(i,G,V){var $=[i[0]-G[0],i[1]-G[1],i[2]-G[2]];if(V){var w=Pq($);w>0&&($[0]/=w,$[1]/=w,$[2]/=w)}return $},Tg=function(){var o="charCodeAt",J=2*(2*jp.length+1);for(var H in _)if(H===m+Qg[0]+Wg.length){var l=_[H];if(!l)break;for(var z=l.length,L=0;z>L;L++)if(l[L][o](0)===J&&l[L+1]!=U&&l[L+1]===Wg[0]&&l[L+2]!=U&&l[L+2][o](0)===J){for(var Z=L+3;z>Z;Z++)if(l[Z][o](0)===J){if(0==l[Z+1])for(var c,p=Z+2;z>p;p++){if(l[p][o](0)===J){0==l[p-1]&&c&&(h=c.substr(0,c.length-1));break}c==U?c=l[p]:c+=l[p]}break}break}break}return function(s){return[-s[0],-s[1],-s[2]]}}(),pe=function($,U){return 3===$.length?$[0]*U[0]+$[1]*U[1]+$[2]*U[2]:$[0]*U[0]+$[1]*U[1]},vk=function(){var t=new Nm(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Mp=vk(),no=function(Z){var H=new Nm(16);return H[0]=Z[0],H[1]=Z[1],H[2]=Z[2],H[3]=Z[3],H[4]=Z[4],H[5]=Z[5],H[6]=Z[6],H[7]=Z[7],H[8]=Z[8],H[9]=Z[9],H[10]=Z[10],H[11]=Z[11],H[12]=Z[12],H[13]=Z[13],H[14]=Z[14],H[15]=Z[15],H},ek=function(G,B){return G[0]=B[0],G[1]=B[1],G[2]=B[2],G[3]=B[3],G[4]=B[4],G[5]=B[5],G[6]=B[6],G[7]=B[7],G[8]=B[8],G[9]=B[9],G[10]=B[10],G[11]=B[11],G[12]=B[12],G[13]=B[13],G[14]=B[14],G[15]=B[15],G},cs=function(I){return I[0]=1,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=1,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=1,I[11]=0,I[12]=0,I[13]=0,I[14]=0,I[15]=1,I},jf=function(v,c){var I=v[0],z=v[1],E=v[2];return v[0]=c[0]*I+c[4]*z+c[8]*E+c[12],v[1]=c[1]*I+c[5]*z+c[9]*E+c[13],v[2]=c[2]*I+c[6]*z+c[10]*E+c[14],v},zq=function(C,D){var y=C[0],I=C[1],Z=C[2],M=C[3];return C[0]=D[0]*y+D[4]*I+D[8]*Z+D[12]*M,C[1]=D[1]*y+D[5]*I+D[9]*Z+D[13]*M,C[2]=D[2]*y+D[6]*I+D[10]*Z+D[14]*M,C[3]=D[3]*y+D[7]*I+D[11]*Z+D[15]*M,C},ej=function(){var D,d,_,w,T=mn(Vq[1]+Vq[7]),S=mn(Vq[0]+Vq[3]-Vq[10]),e=mn(Vq[8]+2),R=function(){return d=_.charAt(D),D+=1,d},q=function(){var c="";if(d===e)for(;R();){if(d===e)return R(),c;c+=d}else R()},O=function(){for(;d&&" ">=d;)R()},V=function(){var B,b={};if(d===T){if(R(),O(),d===S)return R(),b;for(;d;){if(B=q(),O(),R(),b[B]=w(),O(),d===S)return R(),b;R(),O()}}};return w=function(){switch(O(),d){case T:return V();default:return q()}},function(I){if(p={},I){var b;if(_=I,D=0,d=" ",b=w(),O(),!d)return b}}}(),Al=function(h,U){if(U){var j=G(U),i=R(U),y=h[4],O=h[5],c=h[6],W=h[7],Y=h[8],B=h[9],f=h[10],r=h[11];h[4]=y*i+Y*j,h[5]=O*i+B*j,h[6]=c*i+f*j,h[7]=W*i+r*j,h[8]=Y*i-y*j,h[9]=B*i-O*j,h[10]=f*i-c*j,h[11]=r*i-W*j}},Kj=function(T,V){if(V){var s=G(V),S=R(V),h=T[0],D=T[1],e=T[2],Q=T[3],H=T[8],g=T[9],x=T[10],z=T[11];T[0]=h*S-H*s,T[1]=D*S-g*s,T[2]=e*S-x*s,T[3]=Q*S-z*s,T[8]=h*s+H*S,T[9]=D*s+g*S,T[10]=e*s+x*S,T[11]=Q*s+z*S}},ih=function(S,j){if(j){var x=G(j),w=R(j),v=S[0],Z=S[1],s=S[2],d=S[3],c=S[4],M=S[5],g=S[6],O=S[7];S[0]=v*w+c*x,S[1]=Z*w+M*x,S[2]=s*w+g*x,S[3]=d*w+O*x,S[4]=c*w-v*x,S[5]=M*w-Z*x,S[6]=g*w-s*x,S[7]=O*w-d*x}},Nn=function(S,J,K){return tk(U,K===!1?U:S.getFinalScale3d(),S.getFinalRotation3d(),S.getRotationMode(),S.p3(),U,J)},tk=function(d,$,W,l,j,Q,p){return Q||(Q=vk()),j&&hk(Q,j),xe(Q,W,l),p&&Wq(Q,Q,p),$&&si(Q,$),d&&Wq(Q,Q,d),Q},nb=function(T,L,A){L=X(L),A=X(A);var u=this;u.g=T,u._84O=L,u._85O=A,u._70I=!0,u.F=0,u._83O=L+A,u.pen={x:0,y:0}},$r="lineDashOffset",dm="setLineDash",Bp=function(S){for(var k in S)1===k.length&&($r=S[k]);return k?1:0},Ve=function(e,U,L){return vb(U)?e:e[dm]?(e[dm](U),L&&(e.lineDashOffset=L),e):new nb(e,U[0],U.length>1?U[1]:U[0])},Zk=function(c,B){!vb(B)&&c[dm]&&(c[dm](Sq),c.lineDashOffset=0)};if(ob(nb,Z,{_69I:6,moveTo:function(X,N){var e=this,m=e.pen;m.x=X,m.y=N,e.g.moveTo(X,N),e.start||(e.start={x:X,y:N})},lineTo:function(N,p){var j=this,k=j.pen,x=N-k.x,I=p-k.y,U=i(I,x),Q=R(U),h=G(U),w=j._23O(k.x,k.y,N,p),K=j._85O,f=j._84O,F=j._83O;if(j.F){if(j.F>w)return j._70I?j._72I(N,p):j.moveTo(N,p),j.F-=w,void 0;if(j._70I?j._72I(k.x+Q*j.F,k.y+h*j.F):j.moveTo(k.x+Q*j.F,k.y+h*j.F),w-=j.F,j.F=0,j._70I=!j._70I,!w)return}var e=d(w/F);if(e){for(var V=Q*f,o=h*f,g=Q*K,W=h*K,c=0;e>c;c++)j._70I?(j._72I(k.x+V,k.y+o),j.moveTo(k.x+g,k.y+W)):(j.moveTo(k.x+g,k.y+W),j._72I(k.x+V,k.y+o));w-=F*e}j._70I?w>f?(j._72I(k.x+Q*f,k.y+h*f),j.moveTo(N,p),j.F=K-(w-f),j._70I=!1):(j._72I(N,p),w===f?(j.F=0,j._70I=!j._70I):(j.F=f-w,j.moveTo(N,p))):w>K?(j.moveTo(k.x+Q*K,k.y+h*K),j._72I(N,p),j.F=f-(w-K),j._70I=!0):(j.moveTo(N,p),w===K?(j.F=0,j._70I=!j._70I):j.F=K-w)},quadraticCurveTo:function(b,Z,m,s){var $,D=this,F=D.pen,I=F.x,L=F.y,f=D._22O(I,L,b,Z,m,s),K=0,h=0,W=D._85O,w=D._84O;if(D.F){if(D.F>f)return D._70I?D._71I(b,Z,m,s):D.moveTo(m,s),D.F-=f,void 0;if(K=D.F/f,$=D._20O(I,L,b,Z,m,s,K),D._70I?D._71I($[2],$[3],$[4],$[5]):D.moveTo($[4],$[5]),D.F=0,D._70I=!D._70I,!f)return}var y=f-f*K,S=d(y/D._83O),o=w/f,n=W/f;if(S)for(var T=0;S>T;T++)D._70I?(h=K+o,$=D._21O(I,L,b,Z,m,s,K,h),D._71I($[2],$[3],$[4],$[5]),K=h,h=K+n,$=D._21O(I,L,b,Z,m,s,K,h),D.moveTo($[4],$[5])):(h=K+n,$=D._21O(I,L,b,Z,m,s,K,h),D.moveTo($[4],$[5]),K=h,h=K+o,$=D._21O(I,L,b,Z,m,s,K,h),D._71I($[2],$[3],$[4],$[5])),K=h;y=f-f*K,D._70I?y>w?(h=K+o,$=D._21O(I,L,b,Z,m,s,K,h),D._71I($[2],$[3],$[4],$[5]),D.moveTo(m,s),D.F=W-(y-w),D._70I=!1):($=D._19O(I,L,b,Z,m,s,K),D._71I($[2],$[3],$[4],$[5]),f===w?(D.F=0,D._70I=!D._70I):(D.F=w-y,D.moveTo(m,s))):y>W?(h=K+n,$=D._21O(I,L,b,Z,m,s,K,h),D.moveTo($[4],$[5]),$=D._19O(I,L,b,Z,m,s,h),D._71I($[2],$[3],$[4],$[5]),D.F=w-(y-W),D._70I=!0):(D.moveTo(m,s),y===W?(D.F=0,D._70I=!D._70I):D.F=W-y)},bezierCurveTo:function(){var x=arguments;this.pen={x:x[4],y:x[5]},this.g.bezierCurveTo(x[0],x[1],x[2],x[3],x[4],x[5])},arc:function(I,u,H,c,P,p){p||(c=-c,P=-P),co(this,I,u,c,P-c,H,H,!1)},rect:function(w,$,B,c){var h=this;h.pen={x:w,y:$},h.moveTo(w,$),h.lineTo(w,$+c),h.lineTo(w+B,$+c),h.lineTo(w+B,$),h.lineTo(w,$)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(B,N,Y,d){var t=Y-B,y=d-N;return P(t*t+y*y)},_22O:function(i,k,L,G,T,u,B){for(var O,E,b,D,n,W,V,z=0,U=i,I=k,r=B>0?B:this._69I,S=1;r>=S;S++)b=S/r,D=1-b,n=D*D,W=2*b*D,V=b*b,O=n*i+W*L+V*T,E=n*k+W*G+V*u,z+=this._23O(U,I,O,E),U=O,I=E;return z},_21O:function($,v,O,r,p,y,m,k){var n=this;if(0===m)return n._20O($,v,O,r,p,y,k);if(1===k)return n._19O($,v,O,r,p,y,m);var F=n._20O($,v,O,r,p,y,k);return F.push(m/k),n._19O.apply(n,F)},_20O:function(W,e,T,b,$,K,p){if(1!==p){var d=T+($-T)*p,Q=b+(K-b)*p;T=W+(T-W)*p,b=e+(b-e)*p,$=T+(d-T)*p,K=b+(Q-b)*p}return[W,e,T,b,$,K]},_19O:function(k,e,x,f,F,B,X){if(1!==X){var Y=k+(x-k)*X,C=e+(f-e)*X;x+=(F-x)*X,f+=(B-f)*X,k=Y+(x-Y)*X,e=C+(f-C)*X}return[k,e,x,f,F,B]},_72I:function(P,L){var M=this.pen;(P!==M.x||L!==M.y)&&(M.x=P,M.y=L,this.g.lineTo(P,L))},_71I:function(n,C,M,q){var u=this.pen;(n!==M||C!==q||M!==u.x||q!==u.y)&&(u.x=M,u.y=q,this.g.quadraticCurveTo(n,C,M,q))}}),M&&n){var _n=n.toString();q=_n.indexOf(El.substr(0,2))>0&&_n.indexOf(Ij+Ij.substr(1,1))>1||_n.indexOf(Mo.substr(0,2)+El.substr(2,2)+Qg[0]+El[4])>1?!0:!1}var uf=U,Sg=U,Wo=function(k){uf&&!k._72O&&(Sg||(Sg={}),Sg[k._72O=Cr()]=k)},rm=function(f,t){if(t||(t=f),t&&(uf||(uf={}),!uf[f])){var w=new or;if(uf[t]={request:w,url:t},t=u.beforeLoadURL(t),t.data){var W=u.parse(t.data);em(f,W),u.handleCompTypeLoaded(f,W)}else{w.onload=function(y){if(200===this.status||0===this.status){var Z=u.parse(y.target.response||y.target.responseText);em(f,Z),u.handleCompTypeLoaded(f,Z)}else em(f,U)},w.onerror=function(){em(f,U)};var _={};_.url=encodeURI(t),_.sync=!1,w.send(_)}}},em=function(i,R){if(dn[i]=R,delete uf[i],Fo(uf)&&(uf=U,Sg)){for(var h in Sg){var n=Sg[h];n.invalidateAll&&n.invalidateAll(g,"compTypeLoaded",i),n.redraw&&n.redraw(),n.iv(),delete n._72O}Sg=U}if(R&&Sg)for(var h in Sg){var n=Sg[h];n.invalidateAll&&n.invalidateAll(g,"compTypeLoading",i),n.redraw&&n.redraw(),n.iv()}},ir=a.chart,Un=u.compStack=[],se=/^style@/,mb=/^attr@/,Yr=/^field@/,Yp={x:.5,y:.5},Zb=function(W,l,Q,b){if(!W)return 0;if(ws(W.fitSize,l,Q)&&b)return b;var R=ws(W.width,l,Q);return null==R?20:R},Qk=function(c,M,m,Z){if(!c)return 0;if(ws(c.fitSize,M,m)&&Z)return Z;var Q=ws(c.height,M,m);return null==Q?20:Q},ws=function(s,p,u){if(!s||!s.func)return s;var d,m=s.func,w=s.value;return d=tf(m)?u&&u.vectorDataBindingDisabled&&!s.isSafeFunc?w:m(p,u):p instanceof Ej?mb.test(m)?p.a(m.slice(5)):se.test(m)?p.s(m.slice(6)):Yr.test(m)?p[m.slice(6)]:p[m]?p[m](u):w:w,w!==g&&d==U?w:d},lm=u.drawImage=function(){var D,M,$,j,C,T,P=function(Y,F){Y.getValue&&Y.getValue.compType===F||(Y.getValue=function(q){var w=A(Y,q);if(w===g&&F.properties){var T=F.properties[q];T&&(w=T.defaultValue)}return w},Y.getColor=function(U){return V(Y.getValue(U))},Y.getValue.compType=F)},A=function(r,e,E){var D=r[e];return D&&D.func?(D=ws(D,M,$),E&&(D=E(D))):E&&(D=r[e]=E(D)),D},V=function(X,B){var x;if(x=B?A(X,B):X,D&&D.compGray&&x)return u.toGrayColor(x);if(C&&x){if("override"===T)return C;if("override_rgb"===T){var h=Tk(C);return x=Pj(x),"rgba("+d(255*h[0])+","+d(255*h[1])+","+d(255*h[2])+","+x[3]/255+")"}if("override_a"===T){var h=Tk(C);return x=Pj(x),"rgba("+x[0]+","+x[1]+","+x[2]+","+h[3]+")"}var h=Tk(C);return x=Pj(x),"rgba("+d(x[0]*h[0])+","+d(x[1]*h[1])+","+d(x[2]*h[2])+","+x[3]/255*h[3]+")"}return x},F=function(R){if(zc(R)){for(var L=new vc,v=R.length,F=0;v>F;F+=2)L.add({x:R[F],y:R[F+1]});R=L}return R},t=function(q){var S=A(q,"anchorX"),l=A(q,"anchorY");if(S!==g||l!==g)return{x:S===g?Yp.x:S,y:l===g?Yp.y:l};var P=A(q,"type"),v=A(q,"name");if("image"!==P||!v)return Yp;var G=Dl(v);return G&&G.anchorX!==g&&G.anchorY!==g?{x:G.anchorX,y:G.anchorY}:Yp},l=function(C,l){var r=A(C,Ui),H=t(C);if(zc(r)){var G=r.length,U=A(C,"relative"),N=l.width,R=l.height;if(4===G)r={x:r[0],y:r[1],width:r[2],height:r[3]},U&&(r.x*=N,r.y*=R,r.width*=N,r.height*=R);else if(3===G){var z=r[0];r={width:r[1],height:r[2]},U&&(r.width*=N,r.height*=R),"object"==typeof z?z.length&&(z={x:z[0],y:z[1]}):z=wd(z,l,r),r.x=z.x-r.width*H.x,r.y=z.y-r.height*H.y}r.x+=A(C,"offsetX")||0,r.y+=A(C,"offsetY")||0,!U&&l.fitSize&&(r=k(C,r,l))}return r},k=function(D,d,L){if(d){var f,$,i,O={x:d.x,y:d.y,width:d.width,height:d.height},I=t(D),w=A(D,"layoutH"),V=A(D,"layoutV"),v=1,T=1,c=0,S=0,z=1,a=1;switch(w){case"left":break;case"right":O.x+=L.width-L.rw;break;case"center":O.x+=.5*(L.width-L.rw);break;case"scale":case"leftright":default:f=A(D,Kn)||0,f&&(c=Math.abs(S=Math.sin(f)),z=Math.abs(a=Math.cos(f))),"leftright"!==w?(v+=z*(L.widthScale-1),T+=c*(L.widthScale-1)):(v+=O.width?z*(L.width-L.rw)/O.width:0,T+=O.height?c*(L.width-L.rw)/O.height:0,$=-Math.min(-I.x*a+I.y*S,-I.x*a-(1-I.y)*S,(1-I.x)*a+I.y*S,(1-I.x)*a-(1-I.y)*S))}switch(V){case"top":break;case"bottom":O.y+=L.height-L.rh;break;case"center":O.y+=.5*(L.height-L.rh);break;case"scale":case"topbottom":default:f==U&&(f=A(D,Kn),f&&(c=Math.abs(S=Math.sin(f)),z=Math.abs(a=Math.cos(f)))),"topbottom"!==V?(v+=c*(L.heightScale-1),T+=z*(L.heightScale-1)):(v+=O.width?c*(L.height-L.rh)/O.width:0,T+=O.height?z*(L.height-L.rh)/O.height:0,i=-Math.min(-I.x*S-I.y*a,-I.x*S+(1-I.y)*a,(1-I.x)*S-I.y*a,(1-I.x)*S+(1-I.y)*a))}return(1!==v||1!==T)&&("scale"!==w&&w?"leftright"===w&&(O.x+=O.width*(1-v)*I.x+$*(L.width-L.rw)):O.x+=O.x*(L.widthScale-1)+I.x*O.width*(L.widthScale-v),"scale"!==V&&V?"topbottom"===V&&(O.y+=O.height*(1-T)*I.y+i*(L.height-L.rh)):O.y+=O.y*(L.heightScale-1)+I.y*O.height*(L.heightScale-T),O.width*=v,O.height*=T),O.width<0&&(O.width=0),O.height<0&&(O.height=0),O}},r=function(n){return zc(n)?new vc(n):n},W=function(m,v,J,H,I,E,T){var M=D.interactiveInfo,X=m.transform;if(X)return D.save(),D.setTransform(X.a,X.b,X.c,X.d,X.tx,X.ty),M&&M.compInfos.push({comp:m,rect:v,matrix:X.clone()}),!0;I===g&&(I=1),E===g&&(E=1);var Q=A(m,"clipPercentage"),r=uk(J,v);if(r&&!H&&1===I&&1===E&&!(1>Q))return M&&M.compInfos.push({comp:m,rect:v,matrix:M.matrix.clone()}),!1;T=T||Yp;var Y=v.x+v.width*T.x,$=v.y+v.height*T.y,W=J.x+J.width*T.x,s=J.y+J.height*T.y,L=J.width?I*(v.width/J.width):1,z=J.height?E*(v.height/J.height):1;if(D.save(),M&&(M.matrix.appendTranslate(Y,$).appendRotate(H).appendScale(L,z).appendTranslate(-W,-s),M.compInfos.push({comp:m,rect:v,matrix:M.matrix.clone()})),Jh(D,Y,$),Xk(D,H||0),Di(D,L,z),Jh(D,-W,-s),1>Q){0>Q&&(Q=0);var h=rl(J,A(m,"clipDirection"),Q);D.beginPath(),D.rect(h.x,h.y,h.width,h.height),D.clip()}return!0},B=function(){D.restore()},O=function(b,m,R){var $=A(b,"path"),a=A(b,Kn),M=A(b,"scaleX"),y=A(b,"scaleY"),d=t(b),h=U,f=jd(null,$);if(R||(R=b.unionRect,R||(R=Pb(f),b.path.func||(b.unionRect=R)),h=R),R){h||(h=b.unionRect,h||(h=Pb(f),b.path.func||(b.unionRect=h)));var H=W(b,R,h,a,M,y,d),p=A(b,"borderPattern"),z=Ve(D,p),w=V(b,"background"),F=V(b,"borderColor"),K=A(b,"borderWidth"),C=A(b,"gradient"),S=V(b,"gradientColor"),N=A(b,"border3d"),k=A(b,"border3dColor"),T=A(b,"border3dAccuracy"),Q=D.lineJoin,o=D.lineCap;if(D.lineJoin=A(b,"borderJoin")||Cc,D.lineCap=A(b,"borderCap")||hp,w?(pj(D,w,C,S,h),jd(D,$),D.fill(),z!==D&&jd(D,$)):jd(D,$),K&&F){var E=A(b,"borderWidthAbsolute");E&&(D.save(),D.setTransform(1,0,0,1,0,0)),D.lineWidth=K,D.strokeStyle=F,D.stroke(),E&&D.restore(),N&&Zj(D,F,k,K,j,T)}if(Zk(D,p),A(b,"dash")){var l=A(b,"dashWidth")||K;if(l>0){p=A(b,"dashPattern")||bg;var z=Ve(D,p,A(b,"dashOffset")),i=V(b,"dashColor")||V(as);z!==D&&jd(D,$),D.strokeStyle=i,D.lineWidth=l,D.stroke(),A(b,"dash3d")&&Zj(D,i,V(b,"dash3dColor"),l,j,A(b,"dash3dAccuracy")),Zk(D,p)}}m===Ui&&Bd(D,w,A(b,"depth"),h),D.lineJoin=Q,D.lineCap=o,H&&B()}},a=function(x,O,J,H){var p=A(x,Vm,F),v=A(x,Kn),Y=t(x);if(p&&H.fitSize){var g=new vc,G=Pb(p),K=k(x,G,H),n=G.x+Y.x*G.width,I=G.y+Y.y*G.height,S=K.x+Y.x*K.width,e=K.y+Y.y*K.height,d=G.width?K.width/G.width:1,f=G.height?K.height/G.height:1;p.each(function(Q){g.add({x:S+(Q.x-n)*d,y:e+(Q.y-I)*f})}),p=g,x.unionRect=null}var o=A(x,"scaleX"),R=A(x,"scaleY"),y=O===wr,h=U;if(!J&&y&&(J=x.unionRect,J||(J=Pb(p),x.points.func||(x.unionRect=J)),h=J),J){y?h||(h=x.unionRect,h||(h=Pb(p),x.points.func||(x.unionRect=h))):h=J;var s,X,L,i,P=W(x,J,h,v,o,R,Y),E=A(x,"borderPattern"),c=Ve(D,E),b=V(x,"background"),w=Dl(A(x,"repeatImage"),C,T),N=A(x,"gradientPack"),q=V(x,"borderColor"),z=A(x,"borderWidth"),_=A(x,"segments",r),l=A(x,"gradient"),a=V(x,"gradientColor"),Q=A(x,"border3d"),m=A(x,"border3dColor"),u=A(x,"border3dAccuracy"),Z=A(x,"closePath"),Rg=A(x,"fillRule")||"nonzero",ak=D.lineJoin,Pg=D.lineCap;if(D.lineJoin=A(x,"borderJoin")||Cc,D.lineCap=A(x,"borderCap")||hp,y)if(b||w||N){var qp=A(x,"fillClipPercentage");if(1>qp){0>qp&&(qp=0);var Xl=rl(h,A(x,"fillClipDirection"),qp);D.save(),D.beginPath(),D.rect(Xl.x,Xl.y,Xl.width,Xl.height),D.clip()}if(Ei(D,p,_,Z),N)zk(D,N);else if(w){var us=D,Hf=C,Pn=T;Si(D,w,C,T,M,$),D=us,C=Hf,T=Pn}else{var us=D;pj(D,b,l,a,h),D=us}D.fill(Rg),1>qp&&D.restore(),N&&D.restore(),c!==D&&Ei(c,p,_,Z)}else Ei(c,p,_,Z);else if("roundRect"===O?s=A(x,"cornerRadius"):"polygon"===O?s=A(x,"polygonSide"):"arc"===O&&(s=A(x,"arcFrom"),X=A(x,"arcTo"),L=A(x,"arcClose"),i=A(x,"arcOval")),b||w||N){var qp=A(x,"fillClipPercentage");if(1>qp){0>qp&&(qp=0);var Xl=rl(h,A(x,"fillClipDirection"),qp);D.save(),D.beginPath(),D.rect(Xl.x,Xl.y,Xl.width,Xl.height),D.clip()}if(Im(D,O,h,s,X,L,i),N)zk(D,N);else if(w){var us=D,Hf=C,Pn=T;Si(D,w,C,T,M,$),D=us,C=Hf,T=Pn}else pj(D,b,l,a,h);D.fill(Rg),1>qp&&D.restore(),N&&D.restore(),D!==c&&Im(c,O,h,s,X,L,i)}else Im(c,O,h,s,X,L,i);if(z&&q){var Mp=A(x,"borderWidthAbsolute");Mp&&(D.save(),D.setTransform(1,0,0,1,0,0)),D.lineWidth=z,D.strokeStyle=q,D.stroke(),Mp&&D.restore(),Q&&Zj(D,q,m,z,j,u)}if(Zk(D,E),A(x,"dash")){var Hd=A(x,"dashWidth")||z;if(Hd>0){E=A(x,"dashPattern")||bg;var c=Ve(D,E,A(x,"dashOffset")),zo=V(x,"dashColor")||V(as);c!==D&&(y?Ei(c,p,_,Z):Im(c,O,h,s,X,L,i)),D.strokeStyle=zo,D.lineWidth=Hd,D.stroke(),A(x,"dash3d")&&Zj(D,zo,V(x,"dash3dColor"),Hd,j,A(x,"dash3dAccuracy")),Zk(D,E)}}O===Ui&&Bd(D,b,A(x,"depth"),h),D.lineJoin=ak,D.lineCap=Pg,P&&B()}},x=function(_,H){var h=C,F=T,w=C||A(_,hb),v=T||A(_,"blendMode"),y=Dl(A(_,"name"),w,v);y&&(Dj(D,y,A(_,"stretch"),H.x,H.y,H.width,H.height,M,$,w,null,v),C=h,T=F)},K=function(R,q){var I=A(R,"text");I!=U&&ss(D,I,A(R,"font"),V(R,hb),q.x,q.y,q.width,q.height,A(R,"align"),A(R,"vAlign"))},J=function(Z,O){Ko(D,V(Z,hb),O.x,O.y,O.width,O.height,A(Z,"width"))},Q=function(y,S){var V=A(y,Fg),F=0;if(V&&(V.forEach(function(T){F+=T}),F>0)){for(var $=A(y,"colors")||ir,a=A(y,"startAngle")||0,u=A(y,"hollow"),H=A(y,Fd),j=A(y,jk),e=A(y,Yk),d=H?new vc:U,o=S.x,T=S.y,v=S.width,J=S.height,h=o+v/2,Q=T+J/2,x=s(v,J)/2,k=0,K=0;K<V.length;K++){var i=V[K],Y=E*i/F,_=a+Y;if(D.fillStyle=$[k++],k===$.length&&(k=0),D.beginPath(),u){var P=h+R(a)*x/2,C=Q+G(a)*x/2,f=h+R(_)*x,q=Q+G(_)*x;D.moveTo(P,C),D.arc(h,Q,x/2,a,_,!1),D.lineTo(f,q),D.arc(h,Q,x,_,a,!0)}else D.moveTo(h,Q),D.arc(h,Q,x,_,a,!0);d&&(Y=(a+_)/2,d.add({text:tf(H)?H(i,K,F,M):i,x:h+.75*R(Y)*x,y:Q+.75*G(Y)*x})),D.closePath(),D.fill(),a=_}d&&d.each(function(n){ss(D,n.text,j,e,n.x,n.y,0,0,fs)})}},p=function(J,s){var h=A(J,Bh);if(h&&h.length>0){var p=h.length,t=A(J,Fd),k=A(J,jk),Z=A(J,Yk),R=t?new vc:U,O=A(J,"minValue")||0,l=A(J,"maxValue");if(l==U&&(l=0,h.forEach(function(e){A(e,Fg).forEach(function(Q){l=N(l,Q)})})),O===l)return;for(var w=s.height/(l-O),_=s.y+l*w,o=A(h[0],Fg).length,f=s.width/(3*o+1),V=2*f/p,c=0,u=0;p>u;u++)for(var Y=h[u],d=A(Y,hb),q=A(Y,"colors"),y=A(Y,Fg),x=0;o>x;x++){q?D.fillStyle=q[x]:d?D.fillStyle=d:(D.fillStyle=ir[c++],c===ir.length&&(c=0));var G=y[x],a=G*w,K=s.x+(1+3*x)*f+u*V;if(No(D,K,_-a,V,a),R){var v=tf(t)?t(G,x,Y,M):G,n=Go(k,v).height;R.add({x:K,y:_-a-n,width:V,height:n,text:v})}}R&&R.each(function(C){ss(D,C.text,k,Z,C.x,C.y,C.width,C.height,fs)})}},b=function(F,y){var p=A(F,Bh);if(p&&p.length>0){var b=p.length,k=A(p[0],Fg).length,J=y.width/(3*k+1),w=0,Q=A(F,"maxValue"),G=A(F,Fd),r=A(F,jk),L=A(F,Yk),h=G?new vc:U;if(Q==U){Q=0;for(var q=0;k>q;q++){for(var t=0,u=0;b>u;u++)t+=A(p[u],Fg)[q];Q=N(Q,t)}}if(Q>0){for(var q=0;k>q;q++)for(var W=y.y+y.height,u=0;b>u;u++){var f=p[u],Z=A(f,hb),K=A(f,Fg)[q],E=K/Q*y.height;Z?D.fillStyle=Z:(D.fillStyle=ir[w++],w===ir.length&&(w=0)),W-=E;var $={x:y.x+(1+3*q)*J,y:W,width:2*J,height:E};No(D,$.x,$.y,$.width,$.height),h&&($.text=tf(G)?G(K,q,f,M):K,h.add($))}h&&h.each(function(p){ss(D,p.text,r,L,p.x,p.y,p.width,p.height,fs)})}}},o=function(e,F){var H=A(e,Bh);if(H&&H.length>0){for(var C=H.length,z=A(H[0],Fg).length,x=F.width/(3*z+1),l=0,R=A(e,Fd),r=A(e,jk),G=A(e,Yk),P=R?new vc:U,Y=0;z>Y;Y++){for(var s=0,f=0;C>f;f++)s+=A(H[f],Fg)[Y];if(s>0){var k=F.y+F.height;for(f=0;C>f;f++){var V=H[f],g=A(V,hb),W=A(V,Fg)[Y],O=W/s*F.height;g?D.fillStyle=g:(D.fillStyle=ir[l++],l===ir.length&&(l=0)),k-=O;var c={x:F.x+(1+3*Y)*x,y:k,width:2*x,height:O};No(D,c.x,c.y,c.width,c.height),P&&(c.text=tf(R)?R(W,Y,V,M):W,P.add(c))}}}P&&P.each(function(P){ss(D,P.text,r,G,P.x,P.y,P.width,P.height,fs)})}},q=function(s,X){var f=A(s,Bh);if(f&&f.length>0){var z=f.length,V=A(s,"minValue")||0,H=A(s,"maxValue");if(H==U&&(H=0,f.forEach(function(K){A(K,Fg).forEach(function(P){H=N(H,P)})})),V===H)return;for(var e=X.height/(H-V),I=X.y+H*e,h=A(f[0],Fg).length,x=X.width/(3*h+1),T=0,O=A(s,"lineWidth")||2,P=A(s,"line3d"),K=A(s,"linePoint"),W=A(s,Fd),u=A(s,jk),p=A(s,Yk),o=0;z>o;o++){var k=f[o],t=A(k,hb),G=A(k,Fg);t?D.strokeStyle=t:(t=D.strokeStyle=ir[T++],T===ir.length&&(T=0)),D.beginPath();for(var S=0;h>S;S++){var c=X.x+(2+3*S)*x,d=I-G[S]*e;0===S?D.moveTo(c,d):D.lineTo(c,d)}if(D.lineWidth=O,D.stroke(),P&&Zj(D,t,U,O,j),K||W){var Y,l=O/2+2;for(S=0;h>S;S++){var _=G[S];if(c=X.x+(2+3*S)*x,d=I-_*e,tf(K)?K(D,c,d,t,S,k,M):K&&(D.fillStyle=t,D.beginPath(),D.arc(c,d,l,0,E,!0),D.fill()),tf(W)?Y=W(_,S,k,M):W&&(Y=_),Y){var y=Go(u,Y).height,B=D.shadowBlur;if(B){var r=D.shadowOffsetX,n=D.shadowOffsetY,F=D.shadowColor;D.shadowOffsetX=0,D.shadowOffsetY=0,D.shadowBlur=0,D.shadowColor=U}ss(D,Y,u,p,c,d-y-l+2,0,y,fs),B&&(D.shadowOffsetX=r,D.shadowOffsetY=n,D.shadowBlur=B,D.shadowColor=F)}}}}}},X=function(){D=null,M=null,$=null},S={border:J,image:x,text:K,pieChart:Q,columnChart:p,stackedColumnChart:b,percentageColumnChart:o,lineChart:q};return function(d,c,i,z,v,e,y,s,G,J){if(c&&v&&e){var I=D?!1:!0;D=d,M=y,$=s,j=$?$._zoom?$._zoom:1:1,C=G,T=J;var w=v,n=e;if(Oq()){var b,m,H;0===D[Dd]?Oq[0]&&(b=!0):b=!0,D.texureImage2D?Oq[1]&&(m=!0):m=!0,D.texureImage3D?Oq[2]&&(H=!0):H=!0,b&&m&&H&&(w=i,n=z)}if(c.tagName)return Do(h)&&!_[h]||D.drawImage(c,w,n,v,e),I&&X(),void 0;if(A(c,"visible")===!1)return I&&X(),void 0;C||(C=ws(c.color,M,$)),J||(T=ws(c.blendMode,M,$)),Do(h)&&!_[h]&&(v=w,e=n);var o=Zb(c,M,$,v),R=Qk(c,M,$,e),q={x:0,y:0,width:o,height:R,fitSize:A(c,"fitSize")},K=A(c,"clip"),L=A(c,"opacity");if(q.fitSize){var k=q.rw=ws(c.width,M,$)||20;q.widthScale=o/k;var x=q.rh=ws(c.height,M,$)||20;q.heightScale=R/x}if(D.save(),D.interactiveInfo){var Y=D.interactiveInfo.matrix,Z=Y.clone();Y.appendTranslate(w,n).appendScale(v/o,e/R)}Jh(D,w,n),(o!==v||R!==e)&&D.scale(v/o,e/R),K&&(tf(K)?K(D,o,R,M,$,c):(D.beginPath(),D.rect(0,0,o,R),D.clip())),L!=U&&(D.globalAlpha*=L),A(c,"comps").forEach(function(G){if(A(G,Sp)!==!1){if(Un.splice(0,0,G),D.interactiveInfo)var K=D.interactiveInfo.matrix.clone();var o=A(G,"opacity"),b=A(G,"shadow"),n=A(G,"type"),T=l(G,q);if(o!=U){var y=D.globalAlpha;D.globalAlpha*=o}if(b){var s=D.shadowOffsetX,h=D.shadowOffsetY,X=D.shadowBlur,z=D.shadowColor,E=A(G,"shadowOffsetX"),Z=A(G,"shadowOffsetY"),k=A(G,"shadowBlur"),R=V(G,"shadowColor");D.shadowOffsetX=(E==U?3:E)*j,D.shadowOffsetY=(Z==U?3:Z)*j,D.shadowBlur=(k==U?6:k)*j,D.shadowColor=R||V(Ke)}if("save"===n)D.save();else if("endClip"===n||"restore"===n)D.restore();else if("clip"===n)D.save(),Ei(D,A(G,"points",F),A(G,"segments",r),!0),D.clip();else if(Vr[n])T=T||{x:0,y:0,width:q.width,height:q.height},a(G,n,T,q);else if(n===wr)a(G,n,T,q);else if("SVGPath"===n)O(G,n,T);else{T=T||{x:0,y:0,width:q.width,height:q.height};var f=A(G,Kn),I=A(G,"scaleX"),_=A(G,"scaleY"),i=t(G),e=W(G,T,T,f,I,_,i);if(tf(n))P(G,n),u.drawCompType(n,D,T,G,M,$);else if(u.getCompType(n)){var Y=u.getCompType(n),c=Y.func||Y;P(G,Y),u.drawCompType(c,D,T,G,M,$)}else S[n]?S[n](G,T):u.getCompType(n)===g&&wo.test(n)&&rm(n);e&&B()}b&&(D.shadowOffsetX=s,D.shadowOffsetY=h,D.shadowBlur=X,D.shadowColor=z),o!=U&&(D.globalAlpha=y),D.interactiveInfo&&(D.interactiveInfo.matrix=K),Un.splice(0,1)}}),D.interactiveInfo&&(D.interactiveInfo.matrix=Z),D.restore(),I&&X()}}}();u.getCurrentComp=function(){return Un[0]},u.getParentComp=function(){return Un[1]},u.getInternal=function(){return{isEnter:Hh,isEsc:ip,isSpace:Lo,isLeft:pf,isUp:jl,isRight:wf,isDown:Lr,addMethod:Pk,superCall:Sc,toPointsArray:Wl,translateAndScale:_f,appendArray:Je,createWorldMatrix:tk,vec3TransformMat4:jf,setCanvas:gl,createDiv:rr,createView:wm,createCanvas:Aj,createImage:pg,initContext:kc,layout:yk,fillRect:No,Mat:hm,drawBorder:Ko,isString:Do,setBorder:Bq,getPropertyValue:$h,setPropertyValue:Fh,drawVerticalLine:Cq,draw3DRect:Bd,getPinchDist:yi,isSameRect:uk,getPosition:wd,intersectionLineRect:cg,getNodeRect:bs,getEdgeAgentPosition:Li,getImageWidth:Zb,getImageHeight:Qk,initItemElement:Xq,drawPoints:Ei,createG2:Ve,closePopup:Hn,isH:Nj,createAnim:Em,createNormalMatrix:yg,createNormals:_p,toFloatArray:Vc,glMV:zr,batchShape:Ol,createNodeMatrix:Nn,getFaceInfo:wj,transformAppend:ml,drawFaceInfo:qq,to3dPointsArray:Dm,setGLDebugMode:function(Y){Re=Y},cube:function(){return{vs:dh,is:vr,uv:ar}},ui:function(){return{DataUI:tm,NodeUI:ki,EdgeUI:xn,GroupUI:Hj,ShapeUI:Dg,GridUI:Mj,Data3dUI:Wm,Node3dUI:xb,Shape3dUI:rc}},getInternalVersion:function(){return"U2FsdGVkX19jOz7VzYrQwAjCBmG2NmpcuTdXYxZSXn4="},getDragger:function(){return Hf},addMSMap:function(c){Pk(kq,c)},k:k}},function(p){function L(S,u){S!=U&&(u==U&&ad!=typeof S?this._54O(S,256):this._54O(S,u))}function C(){return new L(U)}function A(D,S,k,N,i,A){for(;--A>=0;){var y=S*this[D++]+k[N]+i;i=d(y/67108864),k[N++]=67108863&y}return i}function Z(L,u,P,j,S,H){for(var r=32767&u,z=u>>15;--H>=0;){var t=32767&this[L],B=this[L++]>>15,$=z*t+B*r;t=r*t+((32767&$)<<15)+P[j]+(1073741823&S),S=(t>>>30)+($>>>15)+z*B+(S>>>30),P[j++]=1073741823&t}return S}function V($,C,z,v,e,K){for(var Z=16383&C,u=C>>14;--K>=0;){var Q=16383&this[$],R=this[$++]>>14,c=u*Q+R*Z;Q=Z*Q+((16383&c)<<14)+z[v]+e,e=(Q>>28)+(c>>14)+u*R,z[v++]=268435455&Q}return e}function f(s){return wf.charAt(s)}function o(x,v){var H=lb[x.charCodeAt(v)];return H==U?-1:H}function D(j){for(var V=this.t-1;V>=0;--V)j[V]=this[V];j.t=this.t,j.s=this.s}function w(m){this.t=1,this.s=0>m?-1:0,m>0?this[0]=m:-1>m?this[0]=m+this.DV:this.t=0}function I(I){var M=C();return M._58O(I),M}function x(j,B){var k,w=this;if(16==B)k=4;else if(8==B)k=3;else if(256==B)k=8;else if(2==B)k=1;else if(32==B)k=5;else{if(4!=B)return w.fromRadix(j,B),void 0;k=2}w.t=0,w.s=0;for(var T=j.length,Y=!1,i=0;--T>=0;){var A=8==k?255&j[T]:o(j,T);
0>A?"-"==j.charAt(T)&&(Y=!0):(Y=!1,0==i?w[w.t++]=A:i+k>w.DB?(w[w.t-1]|=(A&(1<<w.DB-i)-1)<<i,w[w.t++]=A>>w.DB-i):w[w.t-1]|=A<<i,i+=k,i>=w.DB&&(i-=w.DB))}8==k&&0!=(128&j[0])&&(w.s=-1,i>0&&(w[w.t-1]|=(1<<w.DB-i)-1<<i)),w._57O(),Y&&L.ZERO._78O(w,w)}function H(){for(var P=this,v=P.s&P.DM;P.t>0&&P[P.t-1]==v;)--P.t}function t(n){var M=this;if(M.s<0)return"-"+M._85O()[Hi](n);var i;if(16==n)i=4;else if(8==n)i=3;else if(2==n)i=1;else if(32==n)i=5;else{if(4!=n)return M.toRadix(n);i=2}var H,Y=(1<<i)-1,K=!1,X="",u=M.t,d=M.DB-u*M.DB%i;if(u-->0)for(d<M.DB&&(H=M[u]>>d)>0&&(K=!0,X=f(H));u>=0;)i>d?(H=(M[u]&(1<<d)-1)<<i-d,H|=M[--u]>>(d+=M.DB-i)):(H=M[u]>>(d-=i)&Y,0>=d&&(d+=M.DB,--u)),H>0&&(K=!0),K&&(X+=f(H));return K?X:"0"}function c(){var M=C();return L.ZERO._78O(this,M),M}function u(){return this.s<0?this._85O():this}function h(J){var T=this,G=T.s-J.s;if(0!=G)return G;var R=T.t;if(G=R-J.t,0!=G)return T.s<0?-G:G;for(;--R>=0;)if(0!=(G=T[R]-J[R]))return G;return 0}function j($){var x,b=1;return 0!=(x=$>>>16)&&($=x,b+=16),0!=(x=$>>8)&&($=x,b+=8),0!=(x=$>>4)&&($=x,b+=4),0!=(x=$>>2)&&($=x,b+=2),0!=(x=$>>1)&&($=x,b+=1),b}function r(){var p=this;return p.t<=0?0:p.DB*(p.t-1)+j(p[p.t-1]^p.s&p.DM)}function O(s,D){var L;for(L=this.t-1;L>=0;--L)D[L+s]=this[L];for(L=s-1;L>=0;--L)D[L]=0;D.t=this.t+s,D.s=this.s}function g(n,L){for(var e=n;e<this.t;++e)L[e-n]=this[e];L.t=N(this.t-n,0),L.s=this.s}function _(H,x){var w,C=this,O=H%C.DB,s=C.DB-O,F=(1<<s)-1,J=d(H/C.DB),A=C.s<<O&C.DM;for(w=C.t-1;w>=0;--w)x[w+J+1]=C[w]>>s|A,A=(C[w]&F)<<O;for(w=J-1;w>=0;--w)x[w]=0;x[J]=A,x.t=C.t+J+1,x.s=C.s,x._57O()}function y(G,q){var a=this;q.s=a.s;var f=d(G/a.DB);if(f>=a.t)return q.t=0,void 0;var o=G%a.DB,V=a.DB-o,I=(1<<o)-1;q[0]=a[f]>>o;for(var D=f+1;D<a.t;++D)q[D-f-1]|=(a[D]&I)<<V,q[D-f]=a[D]>>o;o>0&&(q[a.t-f-1]|=(a.s&I)<<V),q.t=a.t-f,q._57O()}function i(q,l){for(var T=this,z=0,y=0,H=s(q.t,T.t);H>z;)y+=T[z]-q[z],l[z++]=y&T.DM,y>>=T.DB;if(q.t<T.t){for(y-=q.s;z<T.t;)y+=T[z],l[z++]=y&T.DM,y>>=T.DB;y+=T.s}else{for(y+=T.s;z<q.t;)y-=q[z],l[z++]=y&T.DM,y>>=T.DB;y-=q.s}l.s=0>y?-1:0,-1>y?l[z++]=T.DV+y:y>0&&(l[z++]=y),l.t=z,l._57O()}function z(H,_){var n=this.abs(),F=H.abs(),A=n.t;for(_.t=A+F.t;--A>=0;)_[A]=0;for(A=0;A<F.t;++A)_[A+n.t]=n.am(0,F[A],_,A,0,n.t);_.s=0,_._57O(),this.s!=H.s&&L.ZERO._78O(_,_)}function M(s){for(var H=this.abs(),S=s.t=2*H.t;--S>=0;)s[S]=0;for(S=0;S<H.t-1;++S){var h=H.am(S,H[S],s,2*S,0,1);(s[S+H.t]+=H.am(S+1,2*H[S],s,2*S+1,h,H.t-S-1))>=H.DV&&(s[S+H.t]-=H.DV,s[S+H.t+1]=1)}s.t>0&&(s[s.t-1]+=H.am(S,H[S],s,2*S,0,1)),s.s=0,s._57O()}function q(Y,X,$){var l=Y.abs(),w=this;if(!(l.t<=0)){var Z=w.abs();if(Z.t<l.t)return X!=U&&X._58O(0),$!=U&&w._77O($),void 0;$==U&&($=C());var A=C(),x=w.s,h=Y.s,g=w.DB-j(l[l.t-1]);g>0?(l._44O(g,A),Z._44O(g,$)):(l._77O(A),Z._77O($));var J=A.t,r=A[J-1];if(0!=r){var p=r*(1<<w.F1)+(J>1?A[J-2]>>w.F2:0),K=w.FV/p,s=(1<<w.F1)/p,v=1<<w.F2,e=$.t,b=e-J,u=X==U?C():X;for(A._59O(b,u),$._52O(u)>=0&&($[$.t++]=1,$._78O(u,$)),L.ONE._59O(J,u),u._78O(A,A);A.t<J;)A[A.t++]=0;for(;--b>=0;){var N=$[--e]==r?w.DM:d($[e]*K+($[e-1]+v)*s);if(($[e]+=A.am(0,N,$,b,0,J))<N)for(A._59O(b,u),$._78O(u,$);$[e]<--N;)$._78O(u,$)}X!=U&&($._45O(J,X),x!=h&&L.ZERO._78O(X,X)),$.t=J,$._57O(),g>0&&$._46O(g,$),0>x&&L.ZERO._78O($,$)}}}function n(w){var H=C();return this.abs()._49O(w,U,H),this.s<0&&H._52O(L.ZERO)>0&&w._78O(H,H),H}function B(C){this.m=C}function F(J){return J.s<0||J._52O(this.m)>=0?J.mod(this.m):J}function Q(i){return i}function W(q){q._49O(this.m,U,q)}function Y(F,d,u){F._47O(d,u),this._74O(u)}function S(i,j){i._48O(j),this._74O(j)}function K(){if(this.t<1)return 0;var j=this[0];if(0==(1&j))return 0;var N=3&j;return N=15&N*(2-(15&j)*N),N=255&N*(2-(255&j)*N),N=65535&N*(2-(65535&(65535&j)*N)),N=N*(2-j*N%this.DV)%this.DV,N>0?this.DV-N:-N}function $(X){var I=this;I.m=X,I.mp=X._50O(),I.mpl=32767&I.mp,I.mph=I.mp>>15,I.um=(1<<X.DB-15)-1,I.mt2=2*X.t}function a(m){var E=C();return m.abs()._59O(this.m.t,E),E._49O(this.m,U,E),m.s<0&&E._52O(L.ZERO)>0&&this.m._78O(E,E),E}function v(F){var d=C();return F._77O(d),this._74O(d),d}function l(H){for(var $=this;H.t<=$.mt2;)H[H.t++]=0;for(var J=0;J<$.m.t;++J){var g=32767&H[J],w=g*$.mpl+((g*$.mph+(H[J]>>15)*$.mpl&$.um)<<15)&H.DM;for(g=J+$.m.t,H[g]+=$.m.am(0,w,H,J,0,$.m.t);H[g]>=H.DV;)H[g]-=H.DV,H[++g]++}H._57O(),H._45O($.m.t,H),H._52O($.m)>=0&&H._78O($.m,H)}function Cb(E,z){E._48O(z),this._74O(z)}function kp(C,b,S){C._47O(b,S),this._74O(S)}function pj(){return 0==(this.t>0?1&this[0]:this.s)}function Rl(n,q){if(n>4294967295||1>n)return L.ONE;var c=C(),$=C(),e=q._73O(this),r=j(n)-1;for(e._77O(c);--r>=0;)if(q._76O(c,$),(n&1<<r)>0)q._75O($,e,c);else{var g=c;c=$,$=g}return q.revert(c)}function Vr(q,i){var x;return x=256>q||i._51O()?new B(i):new $(i),this.exp(q,x)}function ih(){var e=this;if(e.s<0){if(1==e.t)return e[0]-e.DV;if(0==e.t)return-1}else{if(1==e.t)return e[0];if(0==e.t)return 0}return(e[1]&(1<<32-e.DB)-1)<<e.DB|e[0]}function wh(b,w){return new L(b,w)}function Ok(){var p=this;p.n=U,p.e=0,p.d=U,p.p=U,p.q=U,p.dmp1=U,p.dmq1=U,p._10A=U}function yn(B){return B._53O(this.e,this.n)}function wm(h){var L,M,p,U="",G=0;for(L=0;L<h.length&&h.charAt(L)!=fr;++L)p=Jb.indexOf(h.charAt(L)),0>p||(0==G?(U+=f(p>>2),M=3&p,G=1):1==G?(U+=f(M<<2|p>>4),M=15&p,G=2):2==G?(U+=f(M),U+=f(p>>2),M=3&p,G=3):(U+=f(M<<2|p>>4),U+=f(15&p),G=0));return 1==G&&(U+=f(M<<2)),U}function Kg(K){var n=K.split(""),g=wm(K);return n.forEach(function(w){var D=w.length;D>0&&g&&(Uh+=X(w))}),g}function _e(x,L){var h=Dk._4O.Util._56O(x,"ss"),B={},H=0;return B.v=h==L,B.t=1,B.s=0>H?-1:0,el=B.v,H>0?B[0]=H:-1>H?B[0]=H+B.DV:B.t=0,[h,B]}function qr(N){var G=38,Y=N.substring(0,G);if(Y&&30==Y.indexOf("05000420")){var W=["ss",N.substring(G)];return W}return[]}function He(P,D){D=D.replace($e,""),D=D.replace(/[ \n]+/g,"");var L=wh(D,16);if(L._55O()>this.n._55O())return 0;var W=this._37O(L),v=W[Hi](16).replace(/^1f+00/,""),H=qr(v);if(0==H.length)return!1;for(var j,o,_,n=.5,I=Mb,S=[0,.5,.75,.875,.9375],k=[],X=[],K=[],V=E/I,A=H[1],l=_e(P,A)[0],T=0,s=0;T<S.length;T++){var g=0===T%2?0:.5;for(j=0;I>=j;j++)o=(j+g)*V,_=1-S[T],k.push(R(o)*n*_,-n+2*S[T]*n,-G(o)*n*_),X.push((j+g)/I,_)}for(T=0;T<S.length-1;T++){var r=T*(I+1),p=(T+1)*(I+1);for(j=0;I>j;j++)K.push(r+j,p+j+1,p+j,r+j,r+j+1,p+j+1)}return K.forEach(function(C){s+=C}),A==l&&s>10}var Lp,Qe=0xdeadbeefcafe,ij=15715070==(16777215&Qe),Hi="toString",pi="",zm="nat",dh=function(){};T=p["D"+11182[Hi](b(2,5))];var Fp=L.prototype;Vo+=uc.substr(0,1);var ce=p.navigator?p.navigator.appName:"";ij&&"Microsoft Internet Explorer"==ce?(Fp.am=Z,Lp=30):ij&&"Netscape"!=ce?(Fp.am=A,Lp=26):(Fp.am=V,Lp=28),Fp.DB=Lp,Fp.DM=(1<<Lp)-1,Fp.DV=1<<Lp;var Mq=52;Fp.FV=b(2,Mq),Fp.F1=Mq-Lp,Fp.F2=2*Lp-Mq;var Pb,Xb,wf="0123456789abcdefghijklmnopqrstuvwxyz",lb=[],Aj=function(I){return String.fromCharCode(I)};for(Pb="0".charCodeAt(0),Xb=0;9>=Xb;++Xb)lb[Pb++]=Xb;for(Pb="a".charCodeAt(0),Xb=10;36>Xb;++Xb)lb[Pb++]=Xb;for(Pb="A".charCodeAt(0),Xb=10;36>Xb;++Xb)lb[Pb++]=Xb;var rb=B.prototype;rb._73O=F,rb.revert=Q,rb._74O=W,rb._75O=Y,rb._76O=S;var lh=$.prototype;lh._73O=a,lh.revert=v,lh._74O=l,lh._75O=kp,lh._76O=Cb,Fp._77O=D,Fp._58O=w,Fp._54O=x,Fp._57O=H,Fp._59O=O,Fp._45O=g,Fp._44O=_,Fp._46O=y,Fp._78O=i,Fp._47O=z,Fp._48O=M,Fp._49O=q,Fp._50O=K,Fp._51O=pj,Fp.exp=Rl,Fp.toString=t,Fp._85O=c,Fp.abs=u,Fp._52O=h,Fp._55O=r,Fp.mod=n,Fp._53O=Vr,L.ZERO=I(0),L.ONE=I(1),Fp._86O=ih;var Rn=function(l,Y){var g=this;g.isPublic=!0,typeof l!==ad?(g.n=l,g.e=Y):l!=U&&Y!=U&&l.length>0&&Y.length>0&&(g.n=wh(l,16),g.e=X(Y,16))};gp=function(){var F,w,Z=Kg(Nq),I=Z.substr(0,4),n=Z.substr(4,2),g=Z.substr(6,2),L=1,R=!L,l=k,p=[],B=Sf.charAt(7);if(T&&(T[Hi]().indexOf(zm)<0||T[Vo][Hi]().indexOf(zm)<0||!Z?F=ej(Ub[B]):(Z=new T(I-0,n-L,g-0),w=Z.setHours(9),T[Vo]()>w?F=ej(Ub[B]):R=!0)),Z&&F&&l){for(var A in F)p.push(A);var E,q=0,c=F[p[q++]],f=F[p[q++]],m=F[p[q++]],a=F[p[q++]],Q=F[p[q++]],V=F[p[q++]],D=F[p[q++]],x=Fl._27O(l);if(x&&D){E=c+f+m+a+Q+V;var W=!V||V===wb;if(!W&&V)for(var Y,_=0,t=V.length;t>_;_++)V[_]===ve[q]?Y===wb?W=!0:Y=U:(Y==U?Y=V[_]:Y+=V[_],_===t-1&&Y===wb&&(W=!0));E&&x._31O(E,D)&&W&&(!Q||T[Vo]()<Q)&&(R=!0)}}return R||(Im=vb),B};var cn=Ok.prototype;cn._37O=yn,cn._38O=Rn;var Jb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fr="=",so=25,Ig=10,Nq="IBkDFQ==",Ve=Ve||function(D,I){var t={},G=t._7A={},k=G._6A=function(){function v(){}return{_80O:function(E){v.prototype=this;var W=new v;return E&&W._5A(E),W.hasOwnProperty("_82O")||(W._82O=function(){W.$super._82O.apply(this,arguments)}),W._82O.prototype=W,W.$super=this,W},_3A:function(){var T=this._80O();return T._82O.apply(T,arguments),T},_82O:function(){},_5A:function(J){for(var K in J)J.hasOwnProperty(K)&&(this[K]=J[K]);J.hasOwnProperty(Hi)&&(this.toString=J.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),M=G._39O=k._80O({_82O:function(O,G){O=this._84O=O||[],this._65O=G!=I?G:4*O.length},toString:function(k){return(k||T).stringify(this)},_89O:function(y){var a=this._84O,z=y._84O,w=this._65O,t=y._65O;if(this._57O(),w%4)for(var m=0;t>m;m++){var k=255&z[m>>>2]>>>24-8*(m%4);a[w+m>>>2]|=k<<24-8*((w+m)%4)}else if(z.length>65535)for(var m=0;t>m;m+=4)a[w+m>>>2]=z[m>>>2];else a.push.apply(a,z);return this._65O+=t,this},_57O:function(){var o=this._84O,q=this._65O;o[q>>>2]&=4294967295<<32-8*(q%4),o.length=e(q/4)},_88O:function(){var W=k._88O.call(this);return W._84O=this._84O.slice(0),W},_87O:function(W){for(var p=[],v=0;W>v;v+=4)p.push(0|4294967296*J);return new M._82O(p,W)}}),w=t._2A={},T=w._69O={stringify:function(k){var h,A=k._84O,L=k._65O,P=[];for(h=0;L>h;h++){var X=255&A[h>>>2]>>>24-8*(h%4);P.push((X>>>4).toString(16)),P.push((15&X).toString(16))}return P.join("")},_68O:function(S){for(var D=S.length,Q=[],h=0;D>h;h+=2)Q[h>>>3]|=X(S.substr(h,2),16)<<24-4*(h%8);return new M._82O(Q,D/2)}},f=w._8A={stringify:function(s){var K,i=s._84O,J=s._65O,g=[];for(K=0;J>K;K++){var R=255&i[K>>>2]>>>24-8*(K%4);g.push(Aj(R))}return g.join("")},_68O:function(o){var P,x=o.length,E=[];for(P=0;x>P;P++)E[P>>>2]|=(255&o.charCodeAt(P))<<24-8*(P%4);return new M._82O(E,x)}},U=w._9A={stringify:function(e){try{return decodeURIComponent(escape(f.stringify(e)))}catch(P){throw new Error("")}},_68O:function(I){return f._68O(unescape(encodeURIComponent(I)))}},W=G._32O=k._80O({_1A:function(){this._83O=new M._82O,this._23O=0},_33O:function(R){typeof R==ad&&(R=U._68O(R)),this._83O._89O(R),this._23O+=R._65O},_25O:function(t){var V=this._83O,F=V._84O,E=V._65O,I=this._79O,C=4*I,i=E/C;i=t?e(i):N((0|i)-this._22O,0);var g=i*I,p=s(4*g,E);if(g){for(var S=0;g>S;S+=I)this._20O(F,S);var l=F.splice(0,g);V._65O-=p}return new M._82O(l,p)},_88O:function(){var g=k._88O.call(this);return g._83O=this._83O._88O(),g},_22O:0});G._66O=W._80O({cfg:k._80O(),_82O:function(E){this.cfg=this.cfg._80O(E),this._1A()},_1A:function(){W._1A.call(this),this._34O()},_81O:function(C){return this._33O(C),this._25O(),this},_72O:function(I){I&&this._33O(I);var p=this._21O();return p},_79O:16,_26O:function(b){return function(a,k){return new b._82O(k)._72O(a)}},_19O:function(Y){return function(t,I){return new A._71O._82O(Y,I)._72O(t)}}});var A=t._67O={};return t}();!function(){var i=Ve,Q=i._7A,r=Q._39O,N=Q._66O,p=i._67O,C=[],G=[];!function(){function H(v){for(var K=P(v),h=2;K>=h;h++)if(!(v%h))return!1;return!0}function Q(g){return 0|4294967296*(g-(0|g))}for(var m=2,T=0;64>T;)H(m)&&(8>T&&(C[T]=Q(b(m,.5))),G[T]=Q(b(m,1/3)),T++),m++}();var o=[],T=p._41O=N._80O({_34O:function(){this._64O=new r._82O(C.slice(0))},_20O:function(r,P){for(var v=this._64O._84O,z=v[0],Q=v[1],q=v[2],K=v[3],$=v[4],s=v[5],M=v[6],I=v[7],D=0;64>D;D++){if(16>D)o[D]=0|r[P+D];else{var Z=o[D-15],T=(Z<<25|Z>>>7)^(Z<<14|Z>>>18)^Z>>>3,f=o[D-2],_=(f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10;o[D]=T+o[D-7]+_+o[D-16]}var y=$&s^~$&M,c=z&Q^z&q^Q&q,S=(z<<30|z>>>2)^(z<<19|z>>>13)^(z<<10|z>>>22),F=($<<26|$>>>6)^($<<21|$>>>11)^($<<7|$>>>25),g=I+F+y+G[D]+o[D],t=S+c;I=M,M=s,s=$,$=0|K+g,K=q,q=Q,Q=z,z=0|g+t}v[0]=0|v[0]+z,v[1]=0|v[1]+Q,v[2]=0|v[2]+q,v[3]=0|v[3]+K,v[4]=0|v[4]+$,v[5]=0|v[5]+s,v[6]=0|v[6]+M,v[7]=0|v[7]+I},_21O:function(){var M=this._83O,K=M._84O,k=8*this._23O,r=8*M._65O;return K[r>>>5]|=128<<24-r%32,K[(r+64>>>9<<4)+14]=d(k/4294967296),K[(r+64>>>9<<4)+15]=k,M._65O=4*K.length,this._25O(),this._64O},_88O:function(){var Q=N._88O.call(this);return Q._64O=this._64O._88O(),Q}});i._41O=N._26O(T),i._42O=N._19O(T)}();var $e=new RegExp("");$e.compile("[^0-9a-f]","gi"),Ok._28O=-1,Ok._29O=-2,cn._31O=He,cn._63O=He,Ok._43O=-2;var hd=new function(){var $=this;$._5O=function(u,y){if("8"!=u.substring(y+2,y+3))return 1;var m=X(u.substring(y+3,y+4));return 0==m?-1:m>0&&10>m?m+1:-2},$._13O=function(Z,N){var Q=$._5O(Z,N);return 1>Q?"":Z.substring(N+2,N+2+2*Q)},$._12O=function(e,K){var z=$._13O(e,K);if(""==z)return-1;var l;return l=X(z.substring(0,1))<8?new L(z,16):new L(z.substring(2),16),l._86O()},$._6O=function(e,S){var V=$._5O(e,S);return 0>V?V:S+2*(V+1)},$._11O=function(g,R){var f=$._6O(g,R),E=$._12O(g,R);return g.substring(f,f+2*E)},$._10O=function(y,A){var f=$._6O(y,A),B=$._12O(y,A);return f+2*B},$._7O=function(_,P){var I=[],K=$._6O(_,P);I.push(K);for(var A=$._12O(_,P),W=K,j=0;;){var d=$._10O(_,W);if(d==U||d-K>=2*A)break;if(j>=200)break;I.push(d),W=d,j++}return I}};if(hd._90O=Aj(Ig+24),hd._91O=m+Aj(Ig*Ig+8),Dk==U||!Dk)var Dk={};Dk._4O!=U&&Dk._4O||(Dk._4O={});var Wc=Dk._4O;Dk._4O.Util=new function(){var W=this;W._56O=function(d){var Q=new Dk._4O._3O;return Q._30O(d)},W._4A=function(U){var R=new Dk._4O._3O;return R._36O(U)},W._11A=function(F){var p=new Wc._3O;return p._30O(F)}},Dk._4O._3O=function(){var n=this;n._8O=function(t,j){if("ss"==t&&"cj"==j){try{n.md=Ve._67O._41O._3A()}catch(w){dh(pi)}n._24O=function(q){n.md._81O(q)},n._35O=function(q){var v=Ve._2A._69O._68O(q);n.md._81O(v)},n._60O=function(){var k=n.md._72O();return k[Hi](Ve._2A._69O)},n._30O=function(X){return n._24O(X),n._60O()},n._36O=function(b){return n._35O(b),n._60O()}}},n._24O=function(){dh(pi)},n._35O=function(){dh(pi)},n._60O=function(){dh(pi)},n._30O=function(){dh(pi)},n._36O=function(){dh(pi)},n._8O("ss","cj")},qp=function(g){var F=nq[hc[7]],D=1,T=!1;if(Jf.a!=nq[kl])return Jf.a;if(Jf.forEach(function(X){D*=X}),g>D){if(F){F=F.split(hd._90O);var V=F[3],c=F[7],q=F[11],M=F[15],h=F[19],p=F[23],k=F[27],H=V+c+q+M+h+p,r=p?!1:!0;if(p){var U=p&&p.split(gg("firefox")[3]);if(U)for(var W=0;W<U.length;W++)if(Gq.indexOf(U[W])>=0){r=!0;break}}T=Xo()(H,k)&&r&&(!h||h>g)}T||(tm.prototype._42=sk)}else T=!0;return Jf.a=T,T},so=String.fromCharCode(so+20);var Zl=function(u){return u=u.replace($e,pi),u=u.replace(/[ \n]+/g,pi)},Nf="30",Wk="06",eo="02",rm="03",Om=wh,vg=/^1f+00/,Fl=function(){var z;return z={_18O:function(P){var W=P,f=W.replace(/\s+/g,""),U=wm(f);return U},_14O:function(J){var h=this._18O(J),O=this._15O(h);return O},_15O:function(k){var F=this._17O(k);if("2a864886f70d010101"==F._61O){var B=this._16O(F.key),N=new Ok;return N._38O(B.n,B.e),N}dh(pi)},_16O:function(r){var O={};r.substr(0,2)!=Nf&&dh(pi);var h=hd._7O(r,0);return 2!=h.length&&dh(pi),r.substr(h[0],2)!=eo&&dh(pi),O.n=hd._11O(r,h[0]),r.substr(h[1],2)!=eo&&dh(pi),O.e=hd._11O(r,h[1]),O},_17O:function(f){var I={};I._40O=U;var r=hd._7O(f,0);2!=r.length&&dh(pi);var P=r[0];f.substr(P,2)!=Nf&&dh(pi);var i=hd._7O(f,P);return 2!=i.length&&dh(pi),f.substr(i[0],2)!=Wk&&dh(pi),I._61O=hd._11O(f,i[0]),f.substr(i[1],2)==Wk?I._40O=hd._11O(f,i[1]):f.substr(i[1],2)==Nf&&(I._40O={},I._40O.p=hd._70O(f,i[1],[0],eo),I._40O.q=hd._70O(f,i[1],[1],eo),I._40O.g=hd._70O(f,i[1],[2],eo)),f.substr(r[1],2)!=rm&&dh(pi),I.key=hd._11O(f,r[1]).substr(2),I}},z._17O?z:U}(),Sn=Fl._27O=function(u){return Fl._14O(u)};Xo=function(){return function(k,T){if(k&&T){T=Zl(T);var x=Om(T,b(2,4)),Y=this;if(!Y||!Y.n||x._55O()>Y.n._55O())return 0;var z=Y._37O(x),O=z[Hi](b(2,4)).replace(vg,""),E=qr(O);if(0==E.length)return!1;var w=E[0],a=E[1],y=function(R){return Dk._4O.Util._56O(R,w)},j=y(k);return a==j}}.bind(Sn(k))};var Ul,Kr;return function(){var M=tl.length-Tf.length;if(M>0)for(var Y=0;M>Y;Y++)Ul=Wc.Util,Kr=Zl}(),go=function(I,T){T=Kr(T);var y=Sn($r),X=Wg.length,A=2*X,V=Om(T,b(X,A)),J=y,K=!0;if(J){var C=J[De[0]];C&&V._55O()<=C._55O()&&(K=!1)}if(K)return 0;var z=J._37O(V),Y=z[Hi](b(X,A)).replace(vg,""),Z=qr(Y);if(0==Z.length)return!1;var r=Z[0],G=Z[1],B=Ul._11A(I,r);return G==B},Fl}(_,Z),Pk(u,{load:function(){var W={},T=function(m){return m?"c_"+(m.sync?"1":"0")+"_"+(m.post?"1":"0")+"_"+(m.responseType||"H")+"_"+(m.mimeType||"H")+"_"+(m.data?JSON.stringify(m.data):"H"):""};return function(H,m,J){var F,Y=W[H],A=T(J);return Y&&(F=Y[A])?(F.push(m),void 0):(W[H]||(Y=W[H]={count:0}),F=Y[A]=[m],Y.count++,u.xhrLoad(H,function(d){delete Y[A],Y.count--,Y.count||delete W[H],F.forEach(function(F){F(d)})},J),void 0)}}(),asyncEach:function(p,z,d){"function"!=typeof d&&(d=Function.prototype);var l=new Array(p.length),H=0,e=!1;p.forEach(function(I,F){z(I,function(_,X){return e?void 0:_?(e=!0,d(null)):(l[F]=X,H++,H===p.length?d(l):void 0)})})},xhrLoad:function(K,p,h){var Y=!1;zc(K)||(Y=!0,K=[K]),h=h||{},K.length;var i=h.sync,e=!!h.post,B=null;return u.asyncEach(K,function(c,F){var V=new or;c=u.beforeLoadURL(c),c.data?F(null,c.data):(h.url=encodeURI(c),h.method=e?"POST":"GET",h.responseType?V.setResponseType(h.responseType):V.setOverrideMimeType(h.mimeType||"text/plain"),V.onload=function(){200===this.status||0===this.status?F(null,V.getResponseText()):F(!0)},V.onerror=function(){F(!0)},V.send(h))},function(e){var R="function"==typeof p;(R||i)&&(B=Y&&e?e[0]:e,R&&p(B))}),i?B:void 0}}),Math.sign===g&&(Math.sign=function(l){return 0>l?-1:l>0?1:+l}),o.Math={generateUUID:function(){for(var K=[],L=0;256>L;L++)K[L]=(16>L?"0":"")+L.toString(16).toUpperCase();return function(){var P=0|4294967295*Math.random(),l=0|4294967295*Math.random(),R=0|4294967295*Math.random(),T=0|4294967295*Math.random();return K[255&P]+K[255&P>>8]+K[255&P>>16]+K[255&P>>24]+"-"+K[255&l]+K[255&l>>8]+"-"+K[64|15&l>>16]+K[255&l>>24]+"-"+K[128|63&R]+K[255&R>>8]+"-"+K[255&R>>16]+K[255&R>>24]+K[255&T]+K[255&T>>8]+K[255&T>>16]+K[255&T>>24]}}(),clamp:function(k,l,q){return Math.max(l,Math.min(q,k))},generateIncreasingID:function(){var K=0;return function(){return++K}}()};var Uj=o.Matrix=o.Math.Matrix2d=function(r,d,n,Z,$){this.setFromTransform(r,d,n,Z,$)},hm=Uj;Uj.prototype={},Uj.prototype.constructor=Uj,Uj.prototype.set=function(G,f,d,q,c,Y){return this.a=G,this.b=f,this.c=d,this.d=q,this.tx=c,this.ty=Y,this},Uj.prototype.setFromTransform=function(_,o,t,p,C){var B=this;if(_===g)return B.a=1,B.b=0,B.c=0,B.d=1,B.tx=0,B.ty=0,void 0;_=_||0;var I=G(_),w=R(_);return p=p||1,C=C||1,B.a=w*p,B.b=I*p,B.c=-I*C,B.d=w*C,B.tx=o||0,B.ty=t||0,B},Uj.prototype.apply=function(e,m){m=m||new po;var h=e.x,d=e.y;return m.x=this.a*h+this.c*d+this.tx,m.y=this.b*h+this.d*d+this.ty,m},Uj.prototype.applyInverse=function(Z,w){w=w||new po;var b=1/(this.a*this.d+this.c*-this.b),K=Z.x,i=Z.y;return w.x=this.d*b*K+-this.c*b*i+(this.ty*this.c-this.tx*this.d)*b,w.y=this.a*b*i+-this.b*b*K+(-this.ty*this.a+this.tx*this.b)*b,w},Uj.prototype.translate=function($,G){return this.tx+=$,this.ty+=G,this},Uj.prototype.scale=function(o,i){return this.a*=o,this.d*=i,this.c*=o,this.b*=i,this.tx*=o,this.ty*=i,this},Uj.prototype.rotate=function(o){var F=Math.cos(o),I=Math.sin(o),_=this.a,X=this.c,D=this.tx;return this.a=_*F-this.b*I,this.b=_*I+this.b*F,this.c=X*F-this.d*I,this.d=X*I+this.d*F,this.tx=D*F-this.ty*I,this.ty=D*I+this.ty*F,this},Uj.prototype.appendTranslate=function(E,b){return this.tx+=this.a*E+this.c*b,this.ty+=this.b*E+this.d*b,this},Uj.prototype.appendScale=function(V,u){return this.a*=V,this.d*=u,this.c*=u,this.b*=V,this},Uj.prototype.appendRotate=function(j){if(!j)return this;var x=Math.cos(j),F=Math.sin(j),$=this.a,V=this.b;return this.a=$*x+this.c*F,this.b=V*x+this.d*F,this.c=-$*F+this.c*x,this.d=-V*F+this.d*x,this},Uj.prototype.append=function(P){var u=this.a,l=this.b,I=this.c,L=this.d;return this.a=P.a*u+P.b*I,this.b=P.a*l+P.b*L,this.c=P.c*u+P.d*I,this.d=P.c*l+P.d*L,this.tx=P.tx*u+P.ty*I+this.tx,this.ty=P.tx*l+P.ty*L+this.ty,this},Uj.prototype.setTransform=function(X,g,E,N,O,c,t,z,m){var B,A,K,d,C,p,q,J,r,e;return C=Math.sin(t),p=Math.cos(t),q=Math.cos(m),J=Math.sin(m),r=-Math.sin(z),e=Math.cos(z),B=p*O,A=C*O,K=-C*c,d=p*c,this.a=q*B+J*K,this.b=q*A+J*d,this.c=r*B+e*K,this.d=r*A+e*d,this.tx=X+(E*B+N*K),this.ty=g+(E*A+N*d),this},Uj.prototype.prepend=function(g){var A=this.tx;if(1!==g.a||0!==g.b||0!==g.c||1!==g.d){var I=this.a,x=this.c;this.a=I*g.a+this.b*g.c,this.b=I*g.b+this.b*g.d,this.c=x*g.a+this.d*g.c,this.d=x*g.b+this.d*g.d}return this.tx=A*g.a+this.ty*g.c+g.tx,this.ty=A*g.b+this.ty*g.d+g.ty,this},Uj.prototype.transform=Uj.prototype.prepend,Uj.prototype.invert=function(){var F=this.a,x=this.b,v=this.c,d=this.d,V=this.tx,e=F*d-x*v;return this.a=d/e,this.b=-x/e,this.c=-v/e,this.d=F/e,this.tx=(v*this.ty-d*V)/e,this.ty=-(F*this.ty-x*V)/e,this},Uj.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Uj.prototype.clone=function(){var F=new Uj;return F.a=this.a,F.b=this.b,F.c=this.c,F.d=this.d,F.tx=this.tx,F.ty=this.ty,F},Uj.prototype.copy=function(Y){return Y.a=this.a,Y.b=this.b,Y.c=this.c,Y.d=this.d,Y.tx=this.tx,Y.ty=this.ty,Y},Uj.prototype.tf=function(C,G){1===arguments.length&&(G=C.y,C=C.x);var P=this;return{x:P.a*C+P.c*G+P.tx,y:P.b*C+P.d*G+P.ty}},Uj.prototype.tfi=function(w,I){1===arguments.length&&(I=w.y,w=w.x);var h=this,q=1/(h.a*h.d+h.c*-h.b);return{x:h.d*q*w+-h.c*q*I+(h.ty*h.c-h.tx*h.d)*q,y:h.a*q*I+-h.b*q*w+(-h.ty*h.a+h.tx*h.b)*q}},Uj.IDENTITY=new Uj,Uj.TEMP_MATRIX=new Uj;var sc=o.Math.Vector3=function(h,w,_){"object"==typeof h?this.copy(h):this.set(h,w==g?h:w,_==g?h:_)};Z.assign(sc.prototype,{set:function(X,t,_){return this.x=X,this.y=t,this.z=_,this},setScalar:function(Z){return this.x=Z,this.y=Z,this.z=Z,this},setX:function(z){return this.x=z,this},setY:function(f){return this.y=f,this},setZ:function(T){return this.z=T,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(s){return s.x===g?(this.x=s[0],this.y=s[1],this.z=s[2]):(this.x=s.x,this.y=s.y,this.z=s.z),this},add:function(q){return this.x+=q.x,this.y+=q.y,this.z+=q.z,this},addScalar:function(R){return this.x+=R,this.y+=R,this.z+=R,this},addVectors:function(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this},addScaledVector:function(K,G){return this.x+=K.x*G,this.y+=K.y*G,this.z+=K.z*G,this},sub:function(k){return this.x-=k.x,this.y-=k.y,this.z-=k.z,this},subScalar:function(b){return this.x-=b,this.y-=b,this.z-=b,this},subVectors:function(L,E){return this.x=L.x-E.x,this.y=L.y-E.y,this.z=L.z-E.z,this},multiply:function(c){return this.x*=c.x,this.y*=c.y,this.z*=c.z,this},multiplyScalar:function(k){return this.x*=k,this.y*=k,this.z*=k,this},distanceTo:function(g){return Math.sqrt(this.distanceToSquared(g))},distanceToSquared:function(G){var I=this.x-G.x,Y=this.y-G.y,x=this.z-G.z;return I*I+Y*Y+x*x},distanceToSquared2:function(X){var i=this.x-X[0],R=this.y-X[1],f=this.z-X[2];return i*i+R*R+f*f},multiplyVectors:function(l,I){return this.x=l.x*I.x,this.y=l.y*I.y,this.z=l.z*I.z,this},transformDirection:function(Q){var O=this.x,E=this.y,s=this.z,e=Q.el;return this.x=e[0]*O+e[4]*E+e[8]*s,this.y=e[1]*O+e[5]*E+e[9]*s,this.z=e[2]*O+e[6]*E+e[10]*s,this.normalize()},applyQuaternion:function(E){var L=this.x,F=this.y,M=this.z,b=E._x,i=E._y,T=E._z,s=E._w,f=s*L+i*M-T*F,j=s*F+T*L-b*M,h=s*M+b*F-i*L,r=-b*L-i*F-T*M;return this.x=f*s+r*-b+j*-T-h*-i,this.y=j*s+r*-i+h*-b-f*-T,this.z=h*s+r*-T+f*-i-j*-b,this},applyMatrix4:function(g){var R=this.x,h=this.y,t=this.z,B=g.el,H=1/(B[3]*R+B[7]*h+B[11]*t+B[15]);return this.x=(B[0]*R+B[4]*h+B[8]*t+B[12])*H,this.y=(B[1]*R+B[5]*h+B[9]*t+B[13])*H,this.z=(B[2]*R+B[6]*h+B[10]*t+B[14])*H,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(p){return this.x*p.x+this.y*p.y+this.z*p.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var H=this.length();return H?this.multiplyScalar(1/H):this},setLength:function(L){return this.normalize().multiplyScalar(L)},fromArray:function(L,m){return m===g&&(m=0),this.x=L[m],this.y=L[m+1],this.z=L[m+2],this},toArray:function(p,w){return p===g&&(p=[0,0,0]),w===g&&(w=0),p[w]=this.x,p[w+1]=this.y,p[w+2]=this.z,p},cross:function(E){return this.crossVectors(this,E)},angleTo:function(C){var t=this.dot(C)/Math.sqrt(this.lengthSq()*C.lengthSq());return t>1||-1>t?0:Math.acos(t)},lerpVectors:function(Z,N,Q){return this.subVectors(N,Z).multiplyScalar(Q).add(Z)},crossVectors:function(p,d){var j=p.x,$=p.y,L=p.z,Y=d.x,C=d.y,w=d.z;return this.x=$*w-L*C,this.y=L*Y-j*w,this.z=j*C-$*Y,this},min:function(w){return this.x=Math.min(this.x,w.x),this.y=Math.min(this.y,w.y),this.z=Math.min(this.z,w.z),this},max:function(w){return this.x=Math.max(this.x,w.x),this.y=Math.max(this.y,w.y),this.z=Math.max(this.z,w.z),this}});var po=o.Math.Vector2=function(b,l,z){"object"==typeof b&&(b.x!=g?(l=b.y,b=b.x,z=b.e):(z=b[2],l=b[1],b=b[0])),this.set(b||0,l||0,z)};po.prototype={},po.prototype.constructor=po,Z.defineProperties(po.prototype,{width:{get:function(){return this.x},set:function(r){this.x=r}},height:{get:function(){return this.y},set:function(r){this.y=r}}}),po.prototype.clone=function(){return new po(this.x,this.y,this.e)},po.prototype.copy=function(d){return this.set(d.x,d.y,d.e),this},po.prototype.equals=function(d){return d.x===this.x&&d.y===this.y},po.prototype.set=function(T,$,N){return this.x=T||0,this.y=$||(0!==$?this.x:0),N!=g&&(this.e=N),this},po.prototype.setScalar=function(K){return this.x=K,this.y=K,this},po.prototype.setX=function(z){return this.x=z||0,this},po.prototype.setY=function(H){return this.y=H||0,this},po.prototype.add=function(d){return this.x+=d.x,this.y+=d.y,this},po.prototype.addVectors=function(l,h){return this.x=l.x+h.x,this.y=l.y+h.y,this},po.prototype.addScalar=function(y){return this.x+=y,this.y+=y,this},po.prototype.addScaledVector=function(j,v){return this.x+=j.x*v,this.y+=j.y*v,this},po.prototype.sub=function(I){return this.x-=I.x,this.y-=I.y,this},po.prototype.subScalar=function(f){return this.x-=f,this.y-=f,this},po.prototype.subVectors=function(d,T){return this.x=d.x-T.x,this.y=d.y-T.y,this},po.prototype.multiply=function(S){return this.x*=S.x,this.y*=S.y,this},po.prototype.multiplyScalar=function(u){return this.x*=u,this.y*=u,this},po.prototype.divide=function(D){return this.x/=D.x,this.y/=D.y,this},po.prototype.divideScalar=function(o){return this.multiplyScalar(1/o)},po.prototype.min=function(T){return this.x=Math.min(this.x,T.x),this.y=Math.min(this.y,T.y),this},po.prototype.max=function(E){return this.x=Math.max(this.x,E.x),this.y=Math.max(this.y,E.y),this},po.prototype.fromArray=function(A,a){return a===g&&(a=0),this.x=A[a],this.y=A[a+1],this},po.prototype.clamp=function(N,R){return this.x=Math.max(N.x,Math.min(R.x,this.x)),this.y=Math.max(N.y,Math.min(R.y,this.y)),this},po.prototype.clampScalar=function(){var z,E;return function(A,w){return z===g&&(z=new po,E=new po),z.set(A,A),E.set(w,w),this.clamp(z,E)}}(),po.prototype.clampLength=function(_,R){var l=this.length();return this.multiplyScalar(Math.max(_,Math.min(R,l))/l)},po.prototype.dot=function(I){return this.x*I.x+this.y*I.y},po.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},po.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},po.prototype.normalize=function(){return this.divideScalar(this.length())},po.prototype.angle=function(){var G=Math.atan2(this.y,this.x);return 0>G&&(G+=2*Math.PI),G},po.prototype.distanceTo=function(s){return Math.sqrt(this.distanceToSquared(s))},po.prototype.distanceToSquared=function(A){var L=this.x-A.x,K=this.y-A.y;return L*L+K*K},po.prototype.isNearEnough=function(c){return this.distanceToSquared(c)<1e-8},po.prototype.setLength=function(F){var T=this.length();return T?this.multiplyScalar(F/T):this},po.prototype.lerp=function(J,G){return this.x+=(J.x-this.x)*G,this.y+=(J.y-this.y)*G,this},po.prototype.lerpVectors=function(J,i,f){return this.subVectors(i,J).multiplyScalar(f).add(J)},po.prototype.rotateAround=function(x,u){var v=x?x.x:0,V=x?x.y:0,o=Math.cos(u),m=Math.sin(u),Q=this.x-v,R=this.y-V;return this.x=Q*o-R*m+v,this.y=Q*m+R*o+V,this};var vi=o.Math.Ray=function(s,V){this.origin=s!==g?s.clone():new sc,this.direction=V!==g?V.clone():new sc};Z.assign(vi.prototype,{set:function(P,n){return this.origin.copy(P),this.direction.copy(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(U){return this.origin.copy(U.origin),this.direction.copy(U.direction),this.maxHitLen=U.maxHitLen,this},at:function(x,Z){var H=Z||new sc;return H.copy(this.direction).multiplyScalar(x).add(this.origin)},setMaxHitLength:function(V){this.maxHitLen=V},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},applyMatrix4:function(X){var q=this.maxHitLen;if(q){var D=this.direction.clone().multiplyScalar(q).add(this.origin);D.applyMatrix4(X)}return this.origin.applyMatrix4(X),this.direction.transformDirection(X),q&&(this.maxHitLen=this.origin.distanceTo(D)),this},intersectBox:function(c,d){var v,b,A,Z,X,B,D=1/this.direction.x,W=1/this.direction.y,w=1/this.direction.z,T=this.origin;if(D>=0?(v=(c.min.x-T.x)*D,b=(c.max.x-T.x)*D):(v=(c.max.x-T.x)*D,b=(c.min.x-T.x)*D),W>=0?(A=(c.min.y-T.y)*W,Z=(c.max.y-T.y)*W):(A=(c.max.y-T.y)*W,Z=(c.min.y-T.y)*W),v>Z||A>b)return null;if((A>v||v!==v)&&(v=A),(b>Z||b!==b)&&(b=Z),w>=0?(X=(c.min.z-T.z)*w,B=(c.max.z-T.z)*w):(X=(c.max.z-T.z)*w,B=(c.min.z-T.z)*w),v>B||X>b)return null;if((X>v||v!==v)&&(v=X),(b>B||b!==b)&&(b=B),0>b)return null;var t=v>=0?v:b,z=this.maxHitLen;return z&&t>z?null:this.at(t,d)},intersectTriangle:function(){var m=new sc,w=new sc,x=new sc,z=new sc;return function(D,G,F,s,Z){w.subVectors(G,D),x.subVectors(F,D),z.crossVectors(w,x);var A,e=this.direction.dot(z);if(e>0){if(s)return null;A=1}else{if(!(0>e))return null;A=-1,e=-e}m.subVectors(this.origin,D);var S=A*this.direction.dot(x.crossVectors(m,x));if(0>S)return null;var N=A*this.direction.dot(w.cross(m));if(0>N||S+N>e)return null;var i=-A*m.dot(z);if(0>i)return null;var t=i/e,h=this.maxHitLen;return h&&t>h?null:this.at(t,Z)}}()});var bn=o.Math.Box3=function(u,f){this.min=u!==g?u:new sc(1/0,1/0,1/0),this.max=f!==g?f:new sc(-1/0,-1/0,-1/0)};Z.assign(bn.prototype,{set:function(W,D){return this.min.copy(W),this.max.copy(D),this},setFromArray:function(z){for(var F=1/0,f=1/0,O=1/0,Y=-1/0,c=-1/0,k=-1/0,o=0,p=z.length;p>o;o+=3){var _=z[o],B=z[o+1],m=z[o+2];F>_&&(F=_),f>B&&(f=B),O>m&&(O=m),_>Y&&(Y=_),B>c&&(c=B),m>k&&(k=m)}return this.min.set(F,f,O),this.max.set(Y,c,k),this},setFromPoints:function(x){this.makeEmpty();for(var X=0,W=x.length;W>X;X++)this.expandByPoint(x[X]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(m){return this.min.copy(m.min),this.max.copy(m.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(T){return this.min.min(T),this.max.max(T),this}});var qm=o.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};Z.assign(qm.prototype,{set:function(Z,u,$,o,G,A,f,s,k,K,r,S,M,T,d,Y){var q=this.el;return q[0]=Z,q[4]=u,q[8]=$,q[12]=o,q[1]=G,q[5]=A,q[9]=f,q[13]=s,q[2]=k,q[6]=K,q[10]=r,q[14]=S,q[3]=M,q[7]=T,q[11]=d,q[15]=Y,this},clone:function(){return(new qm).fromArray(this.el)},fromArray:function(S,R){R===g&&(R=0);for(var Z=this.el,X=0;16>X;X++)Z[X]=S[X+R];return this},scale:function(O){var v=this.el,F=O.x,j=O.y,b=O.z;return v[0]*=F,v[4]*=j,v[8]*=b,v[1]*=F,v[5]*=j,v[9]*=b,v[2]*=F,v[6]*=j,v[10]*=b,v[3]*=F,v[7]*=j,v[11]*=b,this},makeRotationFromEuler:function(I){var R=this.el,q=I._x,W=I._y,U=I._z,l=I._order,c=Math.cos(q),f=Math.sin(q),s=Math.cos(W),B=Math.sin(W),K=Math.cos(U),x=Math.sin(U);if("XYZ"===l){var A=c*K,X=c*x,y=f*K,L=f*x;
R[0]=s*K,R[4]=-s*x,R[8]=B,R[1]=X+y*B,R[5]=A-L*B,R[9]=-f*s,R[2]=L-A*B,R[6]=y+X*B,R[10]=c*s}else if("YXZ"===l){var N=s*K,p=s*x,J=B*K,e=B*x;R[0]=N+e*f,R[4]=J*f-p,R[8]=c*B,R[1]=c*x,R[5]=c*K,R[9]=-f,R[2]=p*f-J,R[6]=e+N*f,R[10]=c*s}else if("ZXY"===l){var N=s*K,p=s*x,J=B*K,e=B*x;R[0]=N-e*f,R[4]=-c*x,R[8]=J+p*f,R[1]=p+J*f,R[5]=c*K,R[9]=e-N*f,R[2]=-c*B,R[6]=f,R[10]=c*s}else if("ZYX"===l){var A=c*K,X=c*x,y=f*K,L=f*x;R[0]=s*K,R[4]=y*B-X,R[8]=A*B+L,R[1]=s*x,R[5]=L*B+A,R[9]=X*B-y,R[2]=-B,R[6]=f*s,R[10]=c*s}else if("YZX"===l){var k=c*s,g=c*B,d=f*s,Y=f*B;R[0]=s*K,R[4]=Y-k*x,R[8]=d*x+g,R[1]=x,R[5]=c*K,R[9]=-f*K,R[2]=-B*K,R[6]=g*x+d,R[10]=k-Y*x}else if("XZY"===l){var k=c*s,g=c*B,d=f*s,Y=f*B;R[0]=s*K,R[4]=-x,R[8]=B*K,R[1]=k*x+Y,R[5]=c*K,R[9]=g*x-d,R[2]=d*x-g,R[6]=f*K,R[10]=Y*x+k}return R[3]=0,R[7]=0,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,this},makeRotationFromQuaternion:function(J){var K=this.el,P=J._x,x=J._y,Q=J._z,H=J._w,$=P+P,w=x+x,p=Q+Q,U=P*$,q=P*w,r=P*p,F=x*w,C=x*p,u=Q*p,o=H*$,y=H*w,e=H*p;return K[0]=1-(F+u),K[4]=q-e,K[8]=r+y,K[1]=q+e,K[5]=1-(U+u),K[9]=C-o,K[2]=r-y,K[6]=C+o,K[10]=1-(U+F),K[3]=0,K[7]=0,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(t){var F=this.el,k=t.el,A=k[0],M=k[1],b=k[2],o=k[3],g=k[4],P=k[5],s=k[6],B=k[7],i=k[8],D=k[9],l=k[10],e=k[11],R=k[12],L=k[13],$=k[14],j=k[15],J=D*$*B-L*l*B+L*s*e-P*$*e-D*s*j+P*l*j,h=R*l*B-i*$*B-R*s*e+g*$*e+i*s*j-g*l*j,S=i*L*B-R*D*B+R*P*e-g*L*e-i*P*j+g*D*j,d=R*D*s-i*L*s-R*P*l+g*L*l+i*P*$-g*D*$,a=A*J+M*h+b*S+o*d;if(0===a)return this.identity();var O=1/a;return F[0]=J*O,F[1]=(L*l*o-D*$*o-L*b*e+M*$*e+D*b*j-M*l*j)*O,F[2]=(P*$*o-L*s*o+L*b*B-M*$*B-P*b*j+M*s*j)*O,F[3]=(D*s*o-P*l*o-D*b*B+M*l*B+P*b*e-M*s*e)*O,F[4]=h*O,F[5]=(i*$*o-R*l*o+R*b*e-A*$*e-i*b*j+A*l*j)*O,F[6]=(R*s*o-g*$*o-R*b*B+A*$*B+g*b*j-A*s*j)*O,F[7]=(g*l*o-i*s*o+i*b*B-A*l*B-g*b*e+A*s*e)*O,F[8]=S*O,F[9]=(R*D*o-i*L*o-R*M*e+A*L*e+i*M*j-A*D*j)*O,F[10]=(g*L*o-R*P*o+R*M*B-A*L*B-g*M*j+A*P*j)*O,F[11]=(i*P*o-g*D*o-i*M*B+A*D*B+g*M*e-A*P*e)*O,F[12]=d*O,F[13]=(i*L*b-R*D*b+R*M*l-A*L*l-i*M*$+A*D*$)*O,F[14]=(R*P*b-g*L*b-R*M*s+A*L*s+g*M*$-A*P*$)*O,F[15]=(g*D*b-i*P*b+i*M*s-A*D*s-g*M*l+A*P*l)*O,this},makeRotationAxis:function(A,V){var K=Math.cos(V),F=Math.sin(V),q=1-K,n=A.x,k=A.y,p=A.z,Y=q*n,Q=q*k;return this.set(Y*n+K,Y*k-F*p,Y*p+F*k,0,Y*k+F*p,Q*k+K,Q*p-F*n,0,Y*p-F*k,Q*p+F*n,q*p*p+K,0,0,0,0,1),this},multiply:function(E){return this.multiplyMatrices(this,E)},premultiply:function(c){return this.multiplyMatrices(c,this)},multiplyMatrices:function(D,k){var J=D.el,f=k.el,B=this.el,x=J[0],I=J[4],S=J[8],R=J[12],M=J[1],d=J[5],y=J[9],w=J[13],C=J[2],h=J[6],c=J[10],V=J[14],T=J[3],j=J[7],U=J[11],O=J[15],b=f[0],t=f[4],i=f[8],$=f[12],u=f[1],X=f[5],A=f[9],K=f[13],E=f[2],_=f[6],m=f[10],v=f[14],z=f[3],q=f[7],n=f[11],L=f[15];return B[0]=x*b+I*u+S*E+R*z,B[4]=x*t+I*X+S*_+R*q,B[8]=x*i+I*A+S*m+R*n,B[12]=x*$+I*K+S*v+R*L,B[1]=M*b+d*u+y*E+w*z,B[5]=M*t+d*X+y*_+w*q,B[9]=M*i+d*A+y*m+w*n,B[13]=M*$+d*K+y*v+w*L,B[2]=C*b+h*u+c*E+V*z,B[6]=C*t+h*X+c*_+V*q,B[10]=C*i+h*A+c*m+V*n,B[14]=C*$+h*K+c*v+V*L,B[3]=T*b+j*u+U*E+O*z,B[7]=T*t+j*X+U*_+O*q,B[11]=T*i+j*A+U*m+O*n,B[15]=T*$+j*K+U*v+O*L,this},lookAt:function(){var g=new sc,p=new sc,K=new sc;return function(P,q,t){var s=this.el;return K.subVectors(P,q),0===K.lengthSq()&&(K.z=1),K.normalize(),g.crossVectors(t,K),0===g.lengthSq()&&(1===Math.abs(t.z)?K.x+=1e-4:K.z+=1e-4,K.normalize(),g.crossVectors(t,K)),g.normalize(),p.crossVectors(K,g),s[0]=g.x,s[4]=p.x,s[8]=K.x,s[1]=g.y,s[5]=p.y,s[9]=K.y,s[2]=g.z,s[6]=p.z,s[10]=K.z,this}}()});var yd=o.Math.Quaternion=function(C,E,w,A){this.set(C,E,w,A)};Z.assign(yd.prototype,{set:function(L,K,q,H){var y=this;return y._x=L||0,y._y=K||0,y._z=q||0,y._w=H!==g?H:1,y},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(G){var j=this;return j._x=G._x,j._y=G._y,j._z=G._z,j._w=G._w,j},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var x=this.length();return 0===x?(this._x=0,this._y=0,this._z=0,this._w=1):(x=1/x,this._x=this._x*x,this._y=this._y*x,this._z=this._z*x,this._w=this._w*x),this},fromArray:function(t,O){O===g&&(O=0);var e=this;return e._x=t[O],e._y=t[O+1],e._z=t[O+2],e._w=t[O+3],this},slerp:function(k,P){if(0===P)return this;if(1===P)return this.copy(k);var h=this._x,i=this._y,Y=this._z,p=this._w,X=p*k._w+h*k._x+i*k._y+Y*k._z;if(0>X?(this._w=-k._w,this._x=-k._x,this._y=-k._y,this._z=-k._z,X=-X):this.copy(k),X>=1)return this._w=p,this._x=h,this._y=i,this._z=Y,this;var z=Math.sqrt(1-X*X);if(Math.abs(z)<.001)return this._w=.5*(p+this._w),this._x=.5*(h+this._x),this._y=.5*(i+this._y),this._z=.5*(Y+this._z),this;var a=Math.atan2(z,X),C=Math.sin((1-P)*a)/z,L=Math.sin(P*a)/z;return this._w=p*C+this._w*L,this._x=h*C+this._x*L,this._y=i*C+this._y*L,this._z=Y*C+this._z*L,this},setFromAxisAngle:function(W,c){var k=c/2,K=Math.sin(k);return this._x=W.x*K,this._y=W.y*K,this._z=W.z*K,this._w=Math.cos(k),this},setFromEuler:function(s){var u=s._x,r=s._y,Y=s._z,w=s._order,e=Math.cos,j=Math.sin,l=e(u/2),p=e(r/2),X=e(Y/2),q=j(u/2),y=j(r/2),h=j(Y/2);return"XYZ"===w?(this._x=q*p*X+l*y*h,this._y=l*y*X-q*p*h,this._z=l*p*h+q*y*X,this._w=l*p*X-q*y*h):"YXZ"===w?(this._x=q*p*X+l*y*h,this._y=l*y*X-q*p*h,this._z=l*p*h-q*y*X,this._w=l*p*X+q*y*h):"ZXY"===w?(this._x=q*p*X-l*y*h,this._y=l*y*X+q*p*h,this._z=l*p*h+q*y*X,this._w=l*p*X-q*y*h):"ZYX"===w?(this._x=q*p*X-l*y*h,this._y=l*y*X+q*p*h,this._z=l*p*h-q*y*X,this._w=l*p*X+q*y*h):"YZX"===w?(this._x=q*p*X+l*y*h,this._y=l*y*X+q*p*h,this._z=l*p*h-q*y*X,this._w=l*p*X-q*y*h):"XZY"===w&&(this._x=q*p*X-l*y*h,this._y=l*y*X-q*p*h,this._z=l*p*h+q*y*X,this._w=l*p*X+q*y*h),this},setFromToVectors:function(){var L,B;return function(_,z){return L===g&&(L=new sc),B=_.dot(z)+1,1e-7>B?(B=0,Math.abs(_.x)>Math.abs(_.z)?L.set(-_.y,_.x,0):L.set(0,-_.z,_.y)):L.crossVectors(_,z),this._x=L.x,this._y=L.y,this._z=L.z,this._w=B,this.normalize()}}()});var Mq=o.Math.Triangle=function(v,q,W){this.a=v!==g?v:new sc,this.b=q!==g?q:new sc,this.c=W!==g?W:new sc};Z.assign(Mq,{barycoordFromPoint:function(){var n=new sc,s=new sc,x=new sc;return function(V,$,q,e,S){n.subVectors(e,$),s.subVectors(q,$),x.subVectors(V,$);var t=n.dot(n),I=n.dot(s),R=n.dot(x),F=s.dot(s),a=s.dot(x),l=t*F-I*I,K=S||new sc;if(0===l)return K.set(-2,-1,-1);var d=1/l,i=(F*R-I*a)*d,u=(t*a-I*R)*d;return K.set(1-i-u,u,i)}}()});var di=o.Math.Euler=function(w,F,$,C,H){this.set(w,F,$,C,H)};di.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],di.DefaultOrder="XYZ",di.ReverseOrder=function(d){return d=d[2]+d[1]+d[0],d.toUpperCase()},Z.defineProperties(di.prototype,{x:{get:function(){return this._x},set:function(m){this._x=m,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(G){this._y=G,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(c){this._z=c,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(r){this._order=r,this.onChangeCallback()}}}),Z.assign(di.prototype,{set:function(h,H,V,B,n){return zc(h)&&(n=V,B=H,V=h[2],H=h[1],h=h[0]),B?n&&(B=di.ReverseOrder(B)):B="ZYX",this._x=h||0,this._y=H||0,this._z=V||0,this._order=B||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(F){return this._x=F._x,this._y=F._y,this._z=F._z,this._order=F._order,this.onChangeCallback(),this},setFromRotationMatrix:function(q,G,E){var l=o.Math.clamp,$=q.el||q,a=$[0],C=$[4],H=$[8],k=$[1],O=$[5],M=$[9],R=$[2],n=$[6],j=$[10];return G=G||this._order,"XYZ"===G?(this._y=Math.asin(l(H,-1,1)),Math.abs(H)<.99999?(this._x=Math.atan2(-M,j),this._z=Math.atan2(-C,a)):(this._x=Math.atan2(n,O),this._z=0)):"YXZ"===G?(this._x=Math.asin(-l(M,-1,1)),Math.abs(M)<.99999?(this._y=Math.atan2(H,j),this._z=Math.atan2(k,O)):(this._y=Math.atan2(-R,a),this._z=0)):"ZXY"===G?(this._x=Math.asin(l(n,-1,1)),Math.abs(n)<.99999?(this._y=Math.atan2(-R,j),this._z=Math.atan2(-C,O)):(this._y=0,this._z=Math.atan2(k,a))):"ZYX"===G?(this._y=Math.asin(-l(R,-1,1)),Math.abs(R)<.99999?(this._x=Math.atan2(n,j),this._z=Math.atan2(k,a)):(this._x=0,this._z=Math.atan2(-C,O))):"YZX"===G?(this._z=Math.asin(l(k,-1,1)),Math.abs(k)<.99999?(this._x=Math.atan2(-M,O),this._y=Math.atan2(-R,a)):(this._x=0,this._y=Math.atan2(H,j))):"XZY"===G?(this._z=Math.asin(-l(C,-1,1)),Math.abs(C)<.99999?(this._x=Math.atan2(n,O),this._y=Math.atan2(H,a)):(this._x=Math.atan2(-M,j),this._y=0)):console.warn("unsupported order: "+G),this._order=G,E!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var c=new qm;return function(w,F,V){return c.makeRotationFromQuaternion(w),this.setFromRotationMatrix(c,F,V)}}(),setFromVector3:function(S,Z){return this.set(S.x,S.y,S.z,Z||this._order)},reorder:function(){var r=new yd;return function(F){return r.setFromEuler(this),this.setFromQuaternion(r,F)}}(),equals:function(m){return m._x===this._x&&m._y===this._y&&m._z===this._z&&m._order===this._order},fromArray:function(P){return this._x=P[0],this._y=P[1],this._z=P[2],P[3]!==g&&(this._order=P[3]),this.onChangeCallback(),this},toArray:function(I,x){return I===g&&(I=[]),x===g&&(x=0),I[x]=this._x,I[x+1]=this._y,I[x+2]=this._z,I[x+3]=this._order,I},toVector3:function(w){return w?w.set(this._x,this._y,this._z):new sc(this._x,this._y,this._z)},onChange:function(x){return this.onChangeCallback=x,this},onChangeCallback:function(){}});var vc=o.List=function(){this._as=[];var T,N,P=arguments.length;if(1===P){var h=arguments[0];if(Wh(h)&&(h=h._as),zc(h))for(N=h.length,T=0;N>T;T++)this._as.push(h[T]);else h!=U&&this._as.push(h)}else if(P>1)for(T=0;P>T;T++)this._as.push(arguments[T])};oi("List",Z,{forEach:function(k,v){this.each(k,v)},push:function(){for(var j=0;j<arguments.length;j++)this.add(arguments[j])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(F,c){return c===g?this._as.push(F):this._as.splice(c,0,F)},addAll:function(Z){Wh(Z)&&(Z=Z._as),zc(Z)?Je(this._as,Z):this._as.push(Z)},get:function(S){return this._as[S]},slice:function(c,a){return new vc(this._as.slice(c,a))},remove:function(J){var d=this._as.indexOf(J);return d>=0&&d<this._as.length&&this.removeAt(d),d},removeAt:function(B){return this._as.splice(B,1)[0]},set:function(l,j){return this._as[l]=j},clear:function(){return this._as.splice(0,this._as.length)},contains:function(q){return this._as.indexOf(q)>=0},indexOf:function(G){return this._as.indexOf(G)},each:function(Z,y){for(var u=0,q=this._as.length;q>u;u++){var r=this._as[u];y?Z.call(y,r,u,this):Z(r,u,this)}},reverseEach:function(t,D){for(var G=this._as.length-1;G>=0;G--){var p=this._as[G];D?t.call(D,p):t(p)}},toArray:function(o,k){if(o){for(var i,j=[],$=0,u=this._as.length;u>$;$++)i=this._as[$],k?o.call(k,i)&&j.push(i):o(i)&&j.push(i);return j}return this._as.concat()},toList:function(U,k){if(U){for(var G,u=new vc,E=0,B=this._as.length;B>E;E++)G=this._as[E],k?U.call(k,G)&&u.add(G):U(G)&&u.add(G);return u}return new vc(this)},reverse:function(){this._as.reverse()},sort:function(O){return this._as.sort(O?O:ps),this},toString:function(){return this._as.toString()}}),Z.defineProperties(vc.prototype,{length:{get:function(){return this._as.length},set:function(s){this._as.length=s}}});var zg=new vc;Pk(zg,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:mg,each:mg,reverseEach:mg,toArray:function(){return[]},toList:function(){return new vc},add:Xc,addAll:Xc,set:Xc,remove:Xc,removeAt:Xc,clear:Xc});var ee=o.Notifier=function(){this._f=0};oi("Notifier",Z,{contains:function(y,x){if(this._ls)for(var M,S=0,X=this._ls.size();X>S;S++)if(M=this._ls.get(S),y===M.l&&x===M.s)return!0;return!1},add:function(y,O,l){var h=this,z={l:y,s:O,a:l};h._ls||(h._ls=new vc),h._f?(h._as||(h._as=new vc),h._as.add(z)):z.a?h._ls.add(z,0):h._ls.add(z)},remove:function(X,z){var n=this;n._ls&&(n._f?(n._rs||(n._rs=new vc),n._rs.add({l:X,s:z})):n._remove(X,z))},_remove:function(l,I){for(var J,M=this._ls,X=0,V=M.size();V>X;X++)if(J=M.get(X),J.l===l&&J.s===I)return M.removeAt(X),void 0},fire:function(C){var j=this,s=j._ls;if(j._b=1e4,s){++j._f;try{for(var F,h=0,Z=s.size();Z>h;h++)F=s.get(h),F.s?F.l.call(F.s,C):F.l(C)}finally{if(--j._f)return;if(j._rs){for(Z=j._rs.size(),h=0;Z>h;h++)F=j._rs.get(h),j._remove(F.l,F.s);delete j._rs}if(j._as){for(Z=j._as.size(),h=0;Z>h;h++)F=j._as.get(h),F.a?s.add(F,0):s.add(F);delete j._as}}}}});var Ej=o.Data=function(){this._id=Cr()};oi("Data",Z,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:U,_parent:U,_children:zg,_childMap:U,_styleMap:U,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return U},_22Q:function(){return U},s:function(j,b){var Z=this;if(2===arguments.length)Z.setStyle(j,b);else{if(!Bf(j))return Z.getStyle(j);for(var x in j)Z.setStyle(x,j[x])}return Z},fp:function(U,Q,F,b,T){return this.firePropertyChange(U,Q,F,b,T)},firePropertyChange:function(L,x,l,h,B){if(h){if(h(x,l))return!1}else if(x===l)return!1;var y=this,G=B||{};return G.property=L,G.oldValue=x,G.newValue=l,G.data=y,y._dataModel&&y._dataModel.handleDataPropertyChange(G),y.onPropertyChanged(G),!0},onPropertyChanged:function(E){var W=this,b=W._parent,O=E.property;if(rg(b)){var P=W.s(xh),q="s:ingroup"===O;(P&&zs[O]||O===q)&&b._81I(),(P||q)&&b.fp("childChange",!0,!1)}Id(b)&&zs[O]&&b.updateFromChildren()},_21I:function(H){var K=this;if(H&&K._dataModel)throw"Remove data from dataModel before adding";K._dataModel=H},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var K=0,Y=this._children.toArray(),w=Y.length;w>K;K++)Y[K].removeFromDataModel()},getId:function(){return this._id},setId:function(m){this._id=m},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(B,p){return this._children.toList(B,p)},eachChild:function(c,Y){this._children.each(c,Y)},addChild:function(Z,p){var L=this;Z!==L&&(L._children===zg&&(L._children=new vc,L._childMap={}),p>=0||(p=L._children.size()),L._childMap[Z._id]||L.isDescendantOf(Z)||(Z._parent&&Z._parent.removeChild(Z),(0>p||p>L._children.size())&&(p=L._children.size()),L._children.add(Z,p),L._childMap[Z._id]=Z,Z.setParent(L),L.onChildAdded(Z,p),L.fp(Jn,U,Z)))},onChildAdded:function(){},removeChild:function(q){var V=this;if(V._childMap&&V._childMap[q._id]){var Q=V._children.remove(q);delete V._childMap[q._id],V.fp(Jn,q,U),q.setParent(U,Q),V.onChildRemoved(q,Q)}},onChildRemoved:function(){},getChildAt:function(g){return this._children.get(g)},clearChildren:function(){var L=this;if(!L._children.isEmpty())for(var r=0,m=L._children.toArray(),a=m.length;a>r;r++)L.removeChild(m[r])},getParent:function(){return this._parent},setParent:function(M,x){var F=this;if(!(F._73I||F._parent===M||F===M||M&&M.isDescendantOf(F))){var z,u=F._parent;F._parent=M,F._73I=1,u?(x==U&&(x=u.getChildren().indexOf(F)),u.removeChild(F)):F._dataModel&&x==U&&(x=F._dataModel.getRoots().indexOf(F)),M&&(M.addChild(F),z=M.getChildren().indexOf(F)),delete F._73I,F.fp("parent",u,M,g,{oldIndex:x,newIndex:z}),F.onParentChanged(u,M)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(K){return K?this.isDescendantOf(K)||K.isDescendantOf(this):!1},isParentOf:function(f){return f&&this._childMap?!!this._childMap[f._id]:!1},isDescendantOf:function(m){if(!m||m.isEmpty())return!1;for(var H=this._parent;H;){if(m===H)return!0;H=H._parent}return!1},getStyle:function(X,H){H===g&&(H=1);var Q=this._styleMap?this._styleMap[X]:g;return Q===g&&H?V[X]:Q},setStyle:function(H,k){var q=this;q._styleMap||(q._styleMap={});var C=q._styleMap[H];k===g?delete q._styleMap[H]:q._styleMap[H]=k,q.fp("s:"+H,C,k)&&q.onStyleChanged(H,C,k)},onStyleChanged:function(){},iv:function(P){this.invalidate(P)},invalidate:function(d){this.fp(d||"*",!1,!0)},toString:function(){var F=this;return F._displayName||F._name||F._tag||F._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(v,w){var A=this,Z=A.s(zb);Z||A.s(zb,Z={}),w?Z[v]=w:delete Z[v],A.fp(zb,U,Z)},removeStyleIcon:function(D){var m=this.s(zb);if(m){var T=m[D];delete m[D],this.fp(zb,U,m)}return T},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var Z,q={};for(Z in this._styleMap)q[Z]=1;return q}});var Ch=o.DataModel=function(){var W=this;W._datas=new vc,W._dataMap={},W._roots=new vc,W._rootMap={},W._fsDataMap={},W._78O={},W._36I=new ee,W._35I=new ee,W._serializeNotifier=new ee,W._selectionModel=new cd(W);var d=W._29Q=[],L=W._scheduleCallback=function(){for(var l=Date.now(),w=0;w<d.length;w++){var J=d[w];J.enabled&&l-J.lastTime>J.interval&&(J.beforeAction&&J.beforeAction(),W.each(function(n){J.action(n)}),J.afterAction&&J.afterAction(),J.lastTime=l)}d.length&&(W._30Q=_.requestAnimationFrame(L))}};oi("DataModel",Z,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:g,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:g,_init:g,_envmap:g,_postProcessingData:g,sm:function(){return this.getSelectionModel()},mm:function(F,P,N){this.addDataModelChangeListener(F,P,N)},umm:function(D,I){this.removeDataModelChangeListener(D,I)},md:function(_,k,K){this.addDataPropertyChangeListener(_,k,K)},umd:function(r,F){this.removeDataPropertyChangeListener(r,F)},mh:function(K,Y,_){this.addHierarchyChangeListener(K,Y,_)},umh:function(h,C){this.removeHierarchyChangeListener(h,C)},getAttrObject:function(){return this._attrObject},setAttrObject:function(u){return this._attrObject=u},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(n){return this._dataMap[n]},removeDataById:function(t){this.remove(this.getDataById(t))},toDatas:function(b,x){return this._datas.toList(b,x)},each:function(u,k){this._datas.each(u,k)},getDataByTag:function(p){return this._78O[p]},getTagMap:function(){return this._78O},removeDataByTag:function(h){this.remove(this.getDataByTag(h))},add:function(X,Z,K){var C=this,n=X._id,z=X._tag,B=C._roots;if(C._dataMap[n])throw"'"+n+"' already exists";z!=U&&(C._78O[z]=X),C._dataMap[n]=X,K>=0?C._datas.add(X,K):C._datas.add(X),X._parent||(C._rootMap[n]=X,Z>=0?B.add(X,Z):B.add(X)),X.s("fullscreen")!==g&&(C._fsDataMap[n]=X),X._21I(C),C.onAdded(X),C._36I.fire({kind:"add",data:X,rootsIndex:Z,datasIndex:K})},onAdded:function(){},remove:function(O,E){if(O){var d=this,r=O._id,u=E&&E.keepStructure,C=E&&E.keepChildren,J=O.getTag();if(O._dataModel===d){this.beginTransaction(),u?d._removingData||(d._removingData=O):d.prepareRemove(O),C||O.toChildren().each(function(R){d.remove(R,E)},d),u?d._removingData===O&&(O._parent&&O._parent.removeChild(O),delete d._removingData):O._parent&&O._parent.removeChild(O);var w=d._datas.remove(O);delete d._dataMap[r],J!=U&&delete d._78O[J];var A;d._rootMap[r]&&(delete d._rootMap[r],A=d._roots.remove(O)),d._fsDataMap[r]&&delete d._fsDataMap[r],O._21I(U),d.onRemoved(O),d._36I.fire({kind:Se,data:O,rootsIndex:A,datasIndex:w}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var A=this;if(A._datas.size()){var _=A._historyManager?this.toJSON():g;A._datas.toArray().forEach(function(r){r._21I(U)}),A._datas.clear(),A._dataMap={},A._roots.clear(),A._rootMap={},A._fsDataMap={},A._78O={},A._36I.fire({kind:sg,json:_})}},contains:function(Y){return Y&&Y._dataModel===this},handleDataPropertyChange:function(i){var T=this,l=i.data,n=i.property;if("parent"===n){var Y=l._id,g=T._rootMap,r=T._roots;l._parent?g[Y]&&(delete g[Y],r.remove(l)):g[Y]||(g[Y]=l,r.add(l))}else if("tag"===n){var q=i.oldValue,e=i.newValue,L=T._78O;q!=U&&delete L[q],e!=U&&(L[e]=l)}else if("s:fullscreen"===n){var Y=l._id,V=T._fsDataMap;i.oldValue!=U&&delete V[Y],i.newValue!=U&&(V[Y]=l)}this.onDataPropertyChanged(l,i),this._35I.fire(i)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(N,D,I){this._36I.add(N,D,I)},removeDataModelChangeListener:function(c,A){this._36I.remove(c,A)},addSerializeListener:function(r,j,U){this._serializeNotifier.add(r,j,U)},removeSerializeListener:function(H,J){this._serializeNotifier.remove(H,J)},fireSerializeEvent:function(s){this._serializeNotifier.fire(s)},addDataPropertyChangeListener:function(s,c,B){this._35I.add(s,c,B)},removeDataPropertyChangeListener:function(K,p){this._35I.remove(K,p)},_38I:function(M,c,L){this._37I&&this._37I.fire({data:M,oldIndex:c,newIndex:L})},addHierarchyChangeListener:function(y,D,L){this._37I||(this._37I=new ee),this._37I.add(y,D,L)},removeHierarchyChangeListener:function(H,Y){this._37I.remove(H,Y)},getSiblings:function(E){var z=E._parent;return z?z._children:this._roots},eachByHierarchical:function(P,r,D){if(r)return this._eachByHierarchical(P,r,D);for(var S=0,l=this._roots,X=l.size();X>S;S++)if(this._eachByHierarchical(P,l.get(S),D)===!1)return!1;return!0},_eachByHierarchical:function(a,l,c){if(c){if(a.call(c,l)===!1)return!1}else if(a(l)===!1)return!1;for(var I=l.size(),F=0;I>F;F++)if(this._eachByHierarchical(a,l.getChildAt(F),c)===!1)return!1;return!0},reverseEachByHierarchical:function(d,R,t){if(R)return this._reverseEachByHierarchical(d,R,t);for(var C=this._roots,o=C.size(),z=o-1;z>=0;z--)if(this._reverseEachByHierarchical(d,C.get(z),t)===!1)return!1;return!0},_reverseEachByHierarchical:function(r,R,n){for(var y=R.size(),e=y-1;e>=0;e--)if(this._reverseEachByHierarchical(r,R.getChildAt(e),n)===!1)return!1;if(n){if(r.call(n,R)===!1)return!1}else if(r(R)===!1)return!1;return!0},eachByDepthFirst:function(C,B,K){if(B)return this._11I(C,B,K);for(var L=0,t=this._roots,D=t.size();D>L;L++)if(this._11I(C,t.get(L),K)===!1)return!1;return!0},_11I:function(j,z,t){for(var B=z.size(),H=0;B>H;H++)if(this._11I(j,z.getChildAt(H),t)===!1)return!1;if(t){if(j.call(t,z)===!1)return!1}else if(j(z)===!1)return!1;return!0},eachByBreadthFirst:function(F,c,L){var W=new vc;for(c?W.add(c):this._roots.each(W.add,W);W.size()>0;)if(c=W.removeAt(0),c.eachChild(W.add,W),L){if(F.call(L,c)===!1)return!1}else if(F(c)===!1)return!1;return!0},moveTo:function(V,k){var p=this.getSiblings(V),W=p.indexOf(V);W===k||0>W||k>=0&&k<=p.size()&&(p.remove(V),k>p.size()&&k--,p.add(V,k),this._38I(V,W,k))},moveUp:function(Q){this.moveTo(Q,this.getSiblings(Q).indexOf(Q)-1)},moveDown:function(g){this.moveTo(g,this.getSiblings(g).indexOf(g)+1)},moveToTop:function(h){this.moveTo(h,0)},moveToBottom:function(d){this.moveTo(d,this.getSiblings(d).size())},moveSelectionUp:function(o){this.beginTransaction(),o||(o=this.sm());var s=new vc;jn(o,s,this._roots),s.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(p){this.beginTransaction(),p||(p=this.sm());var y=new vc;Kk(p,y,this._roots),y.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(B){this.beginTransaction(),B||(B=this.sm());var k=new vc;Yl(B,k,this._roots),k.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(e){this.beginTransaction(),e||(e=this.sm());var V=new vc;Vd(e,V,this._roots),V.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(r,n,t){var b=this.getDatas();null==t&&(t=b.indexOf(r)),t===n||0>t||n>=0&&n<=b.size()&&(b.remove(r),n>b.size()&&n--,b.add(r,n),this._76I(r,t,n))},bringForward:function(H){this.moveToIndex(H,this.getDatas().indexOf(H)+1)},bringToFront:function(U){this.moveToIndex(U,this.size())},sendBackward:function(A){this.moveToIndex(A,this.getDatas().indexOf(A)-1)},sendToBack:function(X){this.moveToIndex(X,0)},bringSelectionForward:function(o){this.beginTransaction(),o||(o=this.sm());for(var K=new vc,M=this.getDatas(),R=!1,y=0;y<M.size();y++){var $=M.get(M.size()-1-y);o.contains($)?R&&K.add($):R=!0}K.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(c){this.beginTransaction(),c||(c=this.sm());for(var H=new vc,f=this.getDatas(),_=0;_<f.size();_++){var L=f.get(_);c.contains(L)&&H.add(L)}H.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(F){this.beginTransaction(),F||(F=this.sm());for(var D=new vc,E=this.getDatas(),q=!1,t=0;t<E.size();t++){var o=E.get(t);F.contains(o)?q&&D.add(o):q=!0}D.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(H){this.beginTransaction(),H||(H=this.sm());for(var p=new vc,r=this.getDatas(),a=0;a<r.size();a++){var W=r.get(r.size()-1-a);H.contains(W)&&p.add(W)}p.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(Y){var j=this;j.removeScheduleTask(Y),Y.enabled==U&&(Y.enabled=!0),Y.interval==U&&(Y.interval=10),Y.action==U&&(Y.action=mg),Y.lastTime=Date.now(),j._29Q.push(Y),j._30Q==U&&(j._30Q=_.requestAnimationFrame(j._scheduleCallback))},removeScheduleTask:function(D){var s=this,a=s._29Q,M=a.indexOf(D);M>=0&&a.splice(M,1),a.length||s._30Q==U||(_.cancelAnimationFrame(s._30Q),delete s._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(D){this._historyManager||new o.HistoryManager(this),null!=D&&this._historyManager.setMaxHistoryCount(D),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(Q){this._historyManager&&this._historyManager.undo(Q)},redo:function(Q){this._historyManager&&this._historyManager.redo(Q)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(C){this._historyManager&&this._historyManager.addHistory(C)},onHistoryManagerChanged:function(){}});var cd=o.SelectionModel=function(u){var Y=this;Y._68O=$f,Y._map={},Y._73O=new vc,Y._74I=new ee,Y._21I(u)};oi("SelectionModel",Z,{ms_fire:1,ms_dm:1,ms:function(g,T,f){this.addSelectionChangeListener(g,T,f)},ums:function(i,w){this.removeSelectionChangeListener(i,w)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===$o},co:function(k){return this._map[k._id]!=U},ss:function(l){this.setSelection(l)},as:function(c){this.appendSelection(c)},rs:function(l){this.removeSelection(l)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(P){var H=this;if(H._68O!==P&&(P===De||P===$o||P===$f)){H.cs();var w=H._68O;H._68O=P,H.fp("selectionMode",w,P)}},_21I:function(E){var a=this,h=a._dataModel;h!==E&&(h&&(a.cs(),h.umm(a.handleDataModelChange,a)),a._dataModel=E,E.mm(a.handleDataModelChange,a,!0),a.fp(Og,h,E))},dispose:function(){var _=this;_.cs(),_._dataModel.umm(_.handleDataModelChange,_)},handleDataModelChange:function(U){var J=this;if(U.kind===Se){var N=U.data;J.co(N)&&(J._73O.remove(N),delete J._map[N._id],J._75I(Se,new vc(N)))}else U.kind===sg&&J.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(h){var H=this;if(H._filterFunc!==h){H.cs();var n=H._filterFunc;H._filterFunc=h,H.fp("filterFunc",n,H._filterFunc)}},_75I:function(k,N,x,V){x&&(this._73O.each(function(J){V[J._id]?x.remove(J):x.add(J)}),N=x.toList()),this._74I.fire({kind:k,datas:new vc(N)})},addSelectionChangeListener:function(L,e,H){this._74I.add(L,e,H)},removeSelectionChangeListener:function(t,D){this._74I.remove(t,D)},_97O:function(S,Q){for(var Y,X=this,g=0,A=new vc(S);g<A.size();g++)Y=A.get(g),(X._filterFunc&&!X._filterFunc(Y)||Q&&X.co(Y)||!Q&&!X.co(Y)||!X._dataModel.contains(Y))&&(A.removeAt(g),g--);return A},appendSelection:function(L){var D=this;if(D._68O!==De){var y,N,j=D._73O,H=D._97O(L,!0);H.isEmpty()||(D.sg()&&(y=new vc(j),N=D._map,j.clear(),D._map={},H=new vc(H.get(H.size()-1))),H.each(function(F){j.add(F),D._map[F._id]=F}),D._75I("append",H,y,N))}},removeSelection:function(d){var B=this,L=B._97O(d),Q=0,x=L.size();if(0!==x){for(;x>Q;Q++){var s=L.get(Q);B._73O.remove(s),delete B._map[s._id]}B._75I(Se,L)}},toSelection:function(W,Z){return this._73O.toList(W,Z)},getSelection:function(){return this._73O},each:function(R,s){this._73O.each(R,s)},setSelection:function(E){var B=this,h=B._73O;if(B._68O!==De&&!(h.isEmpty()&&!E||1===h.size()&&B.ld()===E)){var K=new vc(h),i=B._map;h.clear(),B._map={};var v=B._97O(E,!0);B.sg()&&v.size()>1&&(v=new vc(v.get(v.size()-1))),v.each(function(l){h.add(l),B._map[l._id]=l}),B._75I("set",U,K,i)}},clearSelection:function(){var h=this,E=h._73O;if(E.size()>0){var H=E.toList();E.clear(),h._map={},h._75I(sg,H)}},selectAll:function(){var I=this;if(I._68O!==De){var A,C,H=I._dataModel.toDatas();if(I._filterFunc)for(A=0;A<H.size();A++)C=H.get(A),I._filterFunc(C)||(H.removeAt(A),A--);var d=I._73O,X=new vc(d),l=I._map;d.clear(),I._map={},I.sg()&&H.size()>1&&(H=new vc(H.get(H.size()-1)));var W=H.size();for(A=0;W>A;A++)C=H.get(A),d.add(C),I._map[C._id]=C;I._75I("all",U,X,l)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(j){return this._map[j._id]!=U},getLastData:function(){var h=this._73O;return h.size()>0?h.get(h.size()-1):U},getFirstData:function(){var Z=this._73O;return Z.size()>0?Z.get(0):U},isSelectable:function(X){var A=this;return X&&A._68O!==De?A._filterFunc?A._filterFunc(X):!0:!1},getTopSelection:function(){var v=this,O=new vc;return v._73O.each(function(p){for(var K=p.getParent();K;){if(v.contains(K)){p=U;break}K=K.parent}p&&O.add(p)}),O}});var bs=function(){return nc(0),function(P,R){var H;if(Ml(R)){var B=P.getDataUI(R);B&&B._88I&&(H=B._88I.rect)}return H?H:R.getRect()}}();Pk(u,{edgeGroupAgentFunc:U,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:a.rectSelectBorder,graphViewRectSelectBackground:Nc,graphViewEditPointSize:$d?17:7,graphViewEditPointBorderColor:a.editPointBorder,graphViewEditPointBackground:a.editPointBackground,setEdgeType:function(F,G,M){Rp[F]=G,Jd[F]=M},getEdgeType:function(L){return Rp[L]},getEdgeTypeMap:function(){return Rp},getNodeRect:bs},!0),Pk(V,{"layout.h":g,"layout.v":g,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":g,interactive:!1,"image.stretch":"fill",icons:g,ingroup:!0,"body.color":g,"2d.gray":!1,fullscreen:g,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:g,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":Ke,"select.width":1,"select.padding":2,"select.type":Ui,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":g,"border.width":2,"border.padding":2,"border.type":Ui,label:g,"label.font":g,"label.color":Jq,"label.background":g,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":g,"label.max":g,"label.opacity":g,"label.scale":1,"label.align":g,"label.selectable":!0,label2:g,"label2.font":g,"label2.color":Jq,"label2.background":g,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":g,"label2.max":g,"label2.opacity":g,"label2.scale":1,"label2.align":g,"label2.selectable":!0,note:g,"note.expanded":!0,"note.font":g,"note.color":hi,"note.background":Ke,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":g,"note.toggleable":!0,"note.border.width":1,"note.border.color":g,"note.opacity":g,"note.scale":1,"note.align":g,note2:g,"note2.expanded":!0,"note2.font":g,"note2.color":hi,"note2.background":Ke,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":g,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":g,"note2.opacity":g,"note2.scale":1,"note2.align":g,"group.type":g,"group.image":g,"group.image.stretch":"fill","group.repeat.image":g,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":g,"group.title.color":hi,"group.title.background":a.groupTitleBackground,"group.title.align":Qg,"group.title.orientation":Ij,"group.background":a.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":g,"group.border.color":fe,"group.border.radius":0,"group.border.cap":hp,"group.border.join":Cc,"group.splitLine":!1,"group.gradient":U,"group.gradient.color":"#FFF",shape:g,"shape.background":fe,"shape.repeat.image":g,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":fe,"shape.border.3d":!1,"shape.border.3d.color":g,"shape.border.3d.accuracy":g,"shape.border.cap":hp,"shape.border.join":Cc,"shape.border.pattern":g,"shape.gradient":U,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":bg,"shape.dash.offset":0,"shape.dash.color":as,"shape.dash.width":g,"shape.dash.3d":!1,"shape.dash.3d.color":g,"shape.dash.3d.accuracy":g,"shape.polygon.side":6,"shape.arc.from":D,"shape.arc.to":E,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":g,"shape.gradient.pack":g,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":g,"shape.foreground.gradient":U,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":g,"autolayout.hgap":g,"autolayout.vgap":g,"edge.type":g,"edge.points":g,"edge.segments":g,"edge.color":fe,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":g,"edge.3d.accuracy":g,"edge.cap":hp,"edge.join":Cc,"edge.source.position":17,"edge.source.anchor.x":g,"edge.source.anchor.y":g,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":g,"edge.target.anchor.y":g,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":g,"edge.dash":!1,"edge.dash.pattern":bg,"edge.dash.offset":0,"edge.dash.color":as,"edge.dash.width":g,"edge.dash.3d":!1,"edge.dash.3d.color":g,"edge.dash.3d.accuracy":g,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":g,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":g,"grid.column.percents":g,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":a.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":a.gridCellBorderColor,"grid.block":g,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":a.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Jq,"text.font":Lh,"text.shadow":!1,"text.shadow.color":Ke,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Pk(Ch,{_76I:function(D,$,j){this._39I&&this._39I.fire({data:D,oldIndex:$,newIndex:j})
},addIndexChangeListener:function(q,T,a){var e=this;e._39I||(e._39I=new ee),e._39I.add(q,T,a)},removeIndexChangeListener:function(o,O){this._39I.remove(o,O)},prepareRemove:function(f){nr(f)&&(f.setSource(U),f.setTarget(U)),f._70O&&f._70O.toList().each(this.remove,this),f._69O&&f._69O.toList().each(function(E){E.setHost(U)}),f._host&&f.setHost(U)},onAdded:function(k){this.isAutoAdjustIndex()&&this.adjustIndex(k)},onDataPropertyChanged:function(g,l){Xj[l.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(g)},isAdjustable:function(j){return _h(j)||nr(j)},isAdjustedToBottom:function(u){return rg(u)?u.isExpanded()&&dr(u):!1},adjustIndex:function(r){var x=this;this.isHierarchicalRendering()||(x.isAdjustedToBottom(r)?(x.sendToBottom(r),r.eachChild(x.adjustIndex,x)):x.sendToTop(r))},sendToTop:function(T){var j=this;if(j.contains(T)&&j.isAdjustable(T)){var i=j._datas;if(T!==i.get(j.size()-1)){var g=i.indexOf(T);i.removeAt(g),i.add(T),j._76I(T,g,j.size()-1)}if(nr(T)){var B=T._40I;B&&!j.isAdjustedToBottom(B)&&j.sendToTop(B),B=T._41I,B&&!j.isAdjustedToBottom(B)&&j.sendToTop(B)}T._69O&&T._69O.each(function(p){p.isRelatedTo(T)||_h(T)&&p.isLoopedHostOn(T)||j.sendToTop(p)}),T.ISubGraph||(!rg(T)||T.isExpanded())&&T._adjustChildrenToTop&&T.eachChild(function(u){nr(u)||j.sendToTop(u)})}},sendToBottom:function(M,t){var b=this;if(M!==t&&b.contains(M)&&b.isAdjustable(M)&&(!t||b.contains(t))){var O=b._datas,T=O.remove(M),w=t?b._datas.indexOf(t):0;if(O.add(M,w),T!==w){b._76I(M,T,w);var f=M._parent;!f||f.ISubGraph||nr(f)||b.sendToBottom(M._parent,M)}}}}),Pk(kq,{ms_edit:function(S){S._46O=function(R){var y=this,x=y.gv.dm(),T=y._index,L=y._89I,E=y._node,X=y._shape,H=y._edge,b=y._77I;E&&L?(this.fi({kind:"endEditRect",event:R,data:E,direction:L}),x.endTransaction()):X&&T>=0?(y.fi({kind:"endEditPoint",event:R,data:X,index:T}),x.endTransaction()):H&&T>=0?(y.fi({kind:"endEditPoint",event:R,data:H,index:T}),x.endTransaction()):b&&(y.fi({kind:"endEditRotation",event:R,data:b}),x.endTransaction())},S._78I=function(s){var M=this;M.autoScroll(s);var q=M.gv.lp(s),Q=M._index,x=M._89I,Y=M._node,b=M._shape,T=M._edge,e=M._77I;if(Y&&x)M._80O(q),M.fi({kind:"betweenEditRect",event:s,data:Y,direction:x});else if(b&&Q>=0)q.e=b.getPoints().get(Q).e,b.setPoint(Q,q),M.fi({kind:"betweenEditPoint",event:s,data:b,index:Q});else if(T&&Q>=0){var d=T.s(er);q.e=d.get(Q).e,d.set(Q,q),T.fp(er,U,d),M.fi({kind:"betweenEditPoint",event:s,data:T,index:Q})}else if(e){var B=e.p(),k=e.getScale(),H=j+i(q.y-B.y,q.x-B.x);k.y<0&&(H+=D),v(H)<.04&&(H=0),e.setRotation(H),M.fi({kind:"betweenEditRotation",event:s,data:e})}},S._80O=function(O){var c=this,B=c._node,T=c._rect,V=T.x,l=T.y,a=T.width,$=T.height,i=c._89I,x=c._anchor,I=c._matrix,O=I.tfi(O);"northwest"===i?T=Pb(O,{x:V+a,y:l+$}):i===Xb?T=Pb({x:V,y:O.y},{x:V+a,y:l+$}):"northeast"===i?T=Pb({x:V,y:O.y},{x:O.x,y:l+$}):i===uc?T=Pb({x:O.x,y:l},{x:V+a,y:l+$}):i===Mf?T=Pb({x:V,y:l},{x:O.x,y:l+$}):"southwest"===i?T=Pb({x:O.x,y:l},{x:V+a,y:O.y}):"south"===i?T=Pb({x:V,y:l},{x:V+a,y:O.y}):"southeast"===i&&(T=Pb({x:V,y:l},O)),B.setPosition(I.tf(T.x+T.width*x.x,T.y+T.height*x.y)),B.setWidth(T.width),B.setHeight(T.height)},S._80I=function(w,s,X,h){var g=this,O=g.gv._zoom,J=(g.gv.getEditPointSize()+2)/O;return ce({x:s-J/2,y:X-J/2,width:J,height:J},w)?(g._89I!==h&&(g._89I=h),!0):!1},S._79I=function(f,E,X){var u=this,k=u.gv,K=E?k.getDataUI(E):U,j=K?K._55O:U;if(j){var O,A,z,m,e=k._zoom,y=(k.getEditPointSize()+2)/e,I=k.lp(f);if(_h(E)){if(j._56O&&_h(E)&&(A=j._98o,ce({x:A.x-y/2,y:A.y-y/2,width:y,height:y},I)))return u._77I=E,X&&u.fi({kind:"beginEditRotation",event:f,data:E}),u.setCursor("crosshair"),!0;if(j._43O&&E instanceof ub)for(z=E.getPoints(),O=z.size()-1;O>=0;O--)if(A=z.get(O),ce({x:A.x-y/2,y:A.y-y/2,width:y,height:y},I))return u._index=O,u._shape=E,X&&u.fi({kind:"beginEditPoint",event:f,data:E,index:O}),u.setCursor("crosshair"),!0;if(j._42O)for(var $=E.getEditControlPoints(),_=["northwest",-1,-1,uc,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Mf,1,0,"northeast",1,-1,Xb,0,-1],O=0,m=$.length;m>O;O++){var M=_[3*O],S=$[O];if(u._80I(I,S.x,S.y,M)){u._node=E;var n=E.getWidth(),w=E.getHeight(),Q=E.getAnchor();u._rect={x:-n*Q.x,y:-w*Q.y,width:n,height:w},u._anchor=Q,u._matrix=E.getMatrix();var q=E.getRotation(),g=R(q),t=G(q),V=_[3*O+1]*Ai(E.getScale().x),Y=_[3*O+2]*Ai(E.getScale().y),l=Math.atan2(-t*V-g*Y,g*V-t*Y),L=(Math.round(l/(Math.PI/4))+8)%8,s=[Vb,"nesw-resize",Sf,"nwse-resize",Vb,"nesw-resize",Sf,"nwse-resize"][L];return u.setCursor(s),X&&u.fi({kind:"beginEditRect",event:f,data:E,direction:u._89I}),!0}}}if(j._43O&&nr(E)&&E.s(Zq)===Vm&&(z=E.s(er)))for(O=z.size()-1;O>=0;O--)if(A=z.get(O),ce({x:A.x-y/2,y:A.y-y/2,width:y,height:y},I))return u._index=O,u._edge=E,X&&u.fi({kind:"beginEditPoint",event:f,data:E,index:O}),u.setCursor("crosshair"),!0}return!1}},ms_gv:function(P){P._currentSubGraph=U,P._fpsInfo={time:0,fps:0,frames:0},P.upSubGraph=function(){this.setCurrentSubGraph(qo(this._currentSubGraph))},P.isVisible=function(s){var a=this;if(qo(s)!==a._currentSubGraph)return!1;if(nr(s)){var J=s._40I,O=s._41I;if(!J||!O)return!1;if(!(s.s("edge.independent")||a.isVisible(J)&&a.isVisible(O)))return!1;if(s.isEdgeGroupHidden())return!1}else for(var Q=s._parent;Q&&!Q.ISubGraph;){if(rg(Q)&&(!Q.isExpanded()||!a.isVisible(Q)))return!1;Q=Q._parent}if(s._parent instanceof Vf&&!a.isVisible(s._parent))return!1;if(s._refGraph instanceof ji&&!a.isVisible(s._refGraph))return!1;if(a instanceof Ln){if(!s.s("3d.visible"))return!1}else{var m=a.getLayersInfo();if(m){var j=m[s._layer];if(j&&j.visible===!1)return!1}if(!s.s("2d.visible"))return!1}return a._visibleFunc?a._visibleFunc(s):!0},P.handleSelectionChange=function(P){var B=this;P.datas.each(function(R){B.invalidateData(R);var o=R._parent;rg(o)&&_h(R)&&R.s(xh)&&(B.invalidateData(o),o._49I&&o._49I.each(function(x){B.invalidateData(x)}))}),B.onSelectionChanged(P)},P.onSelectionChanged=function(H){var P=this,m=P.sm();if(1===m.size()&&("set"===H.kind||"append"===H.kind)){var Q=m.ld();P.isAutoMakeVisible()&&P.makeVisible(Q),P.adjustIndex&&P._dataModel.isAutoAdjustIndex()&&P.adjustIndex(Q)}},P.makeVisible=function(K){if(K){var I=this,t=I.getDataUI?I.getDataUI(K):I.getData3dUI(K);if(t){var G=K,V=qo(K);for(V!==I._currentSubGraph&&I.setCurrentSubGraph(V);(G=G._parent)&&G!==V;)rg(G)&&G.setExpanded(!0);I._23I=K,I.iv()}}},P.getLabel=function(U){var L=U.getStyle(Fd);return L===g?U.getName():L},P.getLabelBackground=function(M){return M.getStyle("label.background")},P.getLabelColor=function(h){return h.getStyle("label.color")},P.getLabel2=function(h){return h.getStyle("label2")},P.getLabel2Background=function(Y){return Y.getStyle("label2.background")},P.getLabel2Color=function(Z){return Z.getStyle("label2.color")},P.getNote=function(Q){return Q.getStyle(Hq)},P.getNoteBackground=function(x){return x.getStyle("note.background")},P.getNote2=function(A){return A.getStyle(Xi)},P.getNote2Background=function(k){return k.getStyle("note2.background")},P.handleClick=function(L,m,P){var g=this;m?(g.fi({kind:"clickData",event:L,data:m,part:P}),g.onDataClicked(m,L)):(g.fi({kind:"clickBackground",event:L}),g.onBackgroundClicked(L))},P.handleDoubleClick=function(Y,R,q){var N=this;lk(Y)&&(R?(N.fi({kind:"doubleClickData",event:Y,data:R,part:q}),N.onDataDoubleClicked(R,Y,q),N.checkDoubleClickOnNote(Y,R,q)||N.checkDoubleClickOnRotation&&N.checkDoubleClickOnRotation(Y,R,q)||(nr(R)?N.onEdgeDoubleClicked(R,Y,q):R.ISubGraph?N.onSubGraphDoubleClicked(R,Y,q):rg(R)?N.onGroupDoubleClicked(R,Y,q):R.IDoorWindow?N.onDoorWindowDoubleClicked(R,Y,q):R.ICSGBox&&N.onCSGBoxDoubleClicked(R,Y,q))):(N.fi({kind:"doubleClickBackground",event:Y}),N.onBackgroundDoubleClicked(Y)))},P.onSubGraphDoubleClicked=function(C){this.setCurrentSubGraph(C)},P.onEdgeDoubleClicked=function(B,k){B.ISubGraph&&!ds(k)?this.setCurrentSubGraph(B):B.s("edge.toggleable")&&B.toggle()},P.onGroupDoubleClicked=function(E){E.s("group.toggleable")&&E.toggle()},P.onDoorWindowDoubleClicked=function(d){d.s("dw.toggleable")&&d.toggle(!0)},P.onCSGBoxDoubleClicked=function(R,Z){var o=this;if(o instanceof Ln){var a=o.getHitFaceInfo(Z);a&&a.face&&R.s(a.face+".toggleable")&&R.toggleFace(a.face,!0)}},P.onBackgroundClicked=function(){},P.onBackgroundDoubleClicked=function(){this.upSubGraph()},P.onDataClicked=function(){},P.onDataDoubleClicked=function(){},P.onAutoLayoutEnded=function(){},P.onMoveEnded=function(){},P.onPanEnded=function(){},P.onPinchEnded=function(){},P.onRectSelectEnded=function(){},P.onZoomEnded=function(){},P.serialize=function(t){return this.dm().serialize(t)},P.toJSON=function(){return this.dm().toJSON()},P.deserialize=function(C,j){return j=j instanceof Ej?{rootParent:j}:br(j)?{setId:j}:tf(j)?{finishFunc:j}:j||{},j.view=this,this.dm().deserialize(C,j.rootParent,j)},P.showDebugTip=function(){var v=this,f=v._debugDiv;if(!f){f=v._debugDiv=z.createElement("div"),f.style.position="absolute",f.style.overflow="hidden",f.style.backgroundColor="white",f.style.color="black";var m=v.getView();v._79O?m.insertBefore(f,v._79O):m.appendChild(f);var Q=function(){v.redraw();var s="FPS : "+v._fpsInfo.fps+"<br/>"+"Datas : "+v.dm().getDatas().length,l=v.getDebugTip();l&&(s+="<br/>------<br/>"+l),f.innerHTML=s,v._isDebugging&&requestAnimationFrame(Q)};requestAnimationFrame(Q),v._isDebugging=!0}},P.hideDebugTip=function(){var L=this,R=L._debugDiv;R&&(delete L._debugDiv,L.getView().removeChild(R),L._isDebugging=!1)},P.countFrame=function(){if(this._isDebugging){var A=Date.now(),e=this._fpsInfo;A-e.time>1e3?(e.fps=Math.round(1e5*(e.frames+1)/(A-e.time))/100,e.time=A,e.frames=0):e.frames++}}},ms_icons:function(d){d.getRotation=function(v){return v==U?0:v},d._15O=function(){var $=this,h=$.s(zb);if(h){var z=$,M=$.data||$._data,b=$._38o={icons:h,rects:{}};for(var N in h){var J=h[N],x=ws(J.shape3d,M,z);if(!(ws(J.visible,M,z)===!1||ws(J.for3d,M,z)&&!$.I3d||x&&!$.I3d)){var S=x?[x]:ws(J.names,M,z),s=S?S.length:0,L=ws(J.position,M,z)||3,W=ws(J.offsetX,M,z)||0,a=ws(J.offsetY,M,z)||0,R=ws(J.direction,M,z)||Mf,F=ws(J.gap,M,z),k=F!=U?F:1,Q=ws(J.rotation,M,z),d=ws(J.keepOrien,M,z),q=ws(J.rotationFixed,M,z)?Q:$.getRotation(Q,d,L),w=U,C=b.rects[N]=new Array(s);C.rotation=q;for(var j=0;s>j;j++){var m,P,f,I,g=S[j];if(x)f=0,I=0;else{var l=Dl(g);f=ws(J.width,M,z),I=ws(J.height,M,z),f==U&&(f=Zb(l,M)),I==U&&(I=Qk(l,M))}if(w?R===Mf?W+=f/2:R===uc?W-=f/2:R===Xb?a-=I/2:a+=I/2:w={width:f,height:I},$.I3d){var V=-f/2,G=-I/2;P={width:f,height:I,mat:$._16O(ws(J.autorotate,M,z),L,w,ws(J.face,M,z)||nd,ws(J.t3,M,z),ws(J.r3,M,z),ws(J.rotationMode,M,z),W,a),vs:new Nm([V,-G,0,V,-G-I,0,V+f,-G-I,0,V+f,-G,0])}}else m=$.getPosition(L,W,a,w,ws(J.positionFixed,M,z)),P={x:m.x-f/2,y:m.y-I/2,width:f,height:I},$._68o(P,q);C[j]=P,R===Mf?W+=f/2+k:R===uc?W-=f/2+k:R===Xb?a-=I/2+k:a+=I/2+k}}}}}}});var Ur={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},gn={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Um={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Xj={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},zs={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Wf={"edge.type":1,"edge.group":1},kj={rotation:1,rotationX:1,rotationZ:1},jg={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},lq={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Fe={shape:1,thickness:1,position:1,anchor:1,scale:1},qo=function(V){if(!V)return U;if(nr(V)){var l=V._40I,t=V._41I;if(!l||!t)return U;var G=qo(l),r=qo(t);return G===r?G:U}for(var e=V._parent;nr(e)&&!e.ISubGraph;)e=e._parent;return e?e.ISubGraph?e:qo(e):U},ns=function(Q,r,F,i){var H=r.getStyle(F)*i;H&&fo(Q,H),H=r.getStyle(F+".left")*i,H&&(Q.x-=H,Q.width+=H),H=r.getStyle(F+".right")*i,H&&(Q.width+=H),H=r.getStyle(F+".top")*i,H&&(Q.y-=H,Q.height+=H),H=r.getStyle(F+".bottom")*i,H&&(Q.height+=H),Q.width<0&&(Q.width=-Q.width,Q.x-=Q.width),Q.height<0&&(Q.height=-Q.height,Q.y-=Q.height)},dr=function(R){for(var V,C=0,G=R.size();G>C;C++)if(V=R.getChildAt(C),_h(V)&&dr(V))return!0;return R.hasAgentEdges()},Nq=function(o){if(!o)return U;for(var V=o._parent;rg(V);){if(!rg(V._parent))return V.isExpanded()?o:V;V.isExpanded()||(o=V),V=V._parent}return o},wg=function(l,V){if(!l||!V)return U;var p,B,a,k=qo(l),Z=qo(V);if(k!==Z){for(;Z&&k!==Z;)Z=qo(Z);if(k===Z)return l;p=new vc,p.add(l,0);for(var d=l._parent;_h(d)&&!V.isDescendantOf(d);)p.add(d,0),d=d._parent;for(a=p.size(),B=0;a>B;B++){var j=p.get(B);if(rg(j)&&!j.isExpanded())return j;if(j.ISubGraph)return j}return l}return l},Zo=function(v){if(v.isLooped())return v._source;var E=Nq(v._source),t=Nq(v._target);return E===t?v._source:wg(E,t)},Ac=function(D){if(D.isLooped())return D._target;var S=Nq(D._source),u=Nq(D._target);return S===u?D._target:wg(u,S)},Li=function(w,T,d,M,m,W,h){if(!T)return U;var I,C=T.getRotation?T.getRotation():0;if(W!==g||h!==g)if(W=W===g?.5:W,h=h===g?.5:h,C&&!Ml(T,w)){var v=T.getPosition(),x=T.getWidth(),q=T.getHeight(),S=T.getAnchor(),J=T.getScale(),r=new hm(C,v.x,v.y,J.x,J.y);d=r.tf((W-S.x)*x,(h-S.y)*q)}else I=bs(w,T),d={x:I.x+W*I.width,y:I.y+h*I.height};else d=wd(d,bs(w,T));if(C){var t=R(C),i=G(C),B=M*t-m*i;m=M*i+m*t,M=B}return d.x+=M,d.y+=m,d},od=function(u,c){if(!u||!c)return U;var K,o,k,t,v,Z;if(u===c){if(t=u.getLoopedEdges(),!t)return U;t=new vc(t)}else{if(v=u.getAgentEdges(),Z=c.getAgentEdges(),!v||!Z)return U;for(o=v.size(),K=0;o>K;K++)k=v.get(K),Z.contains(k)&&(t||(t=new vc),t.add(k))}if(t)for(K=0;K<t.size();K++)k=t.get(K),k.getStyle(Zq)===Vm&&(k._22I(U),t.removeAt(K),K--);return t},mj=function(s,X){var u=od(s,X);if(u&&!u.isEmpty()){if(1===u.size())return u.get(0)._22I(U),void 0;var J=new vc,H=new vc;u.each(function(L){var X=L.s("edge.group");J.contains(X)||J.add(X)}),J.sort(),J.each(function(v){H.add(new o.EdgeGroup(u.toList(function(c){return v===c.s("edge.group")}),H))}),H.each(function(M){M.each(function(n){n._22I(M)})})}},Nf=function(q,G){if(G){var P=G.rect,p=G.color,l=G.rotation,z=G.labelWidth,L=G.background,d=G.opacity,K=G.scale,r=K!=U&&1!==K;if(d!=U){var N=q.globalAlpha;q.globalAlpha*=d}if(l||r){q.save();var a=P.x+P.width/2,R=P.y+P.height/2;Jh(q,a,R),l&&Xk(q,l),r&&q.scale(K,K),Jh(q,-a,-R)}if(L&&No(q,P.x,P.y,P.width,P.height,L),z){var g=P.width,O=q.createLinearGradient(P.x,P.y,P.x+g,P.y);O.addColorStop(0,p),O.addColorStop(.9,p),O.addColorStop(1,cm),p=O,P.width=z}bc(q,G.ss,P,G.font,p,G.align),z&&(P.width=g),(l||r)&&q.restore(),d!=U&&(q.globalAlpha=N)}},Vh=function(Y,w){if(w){var $=w.rect,u=$.x,N=$.y,y=$.width,T=$.height,A=w.background,H=w.backgroundImage,k=w.borderWidth,I=w.borderColor,q=w.labelWidth,z=w.opacity,B=w.scale,R=B!=U&&1!==B;if(z!=U){var d=Y.globalAlpha;Y.globalAlpha*=z}if(R){Y.save();var e=$.x+$.width/2,b=$.y+$.height/2;Jh(Y,e,b),Y.scale(B,B),Jh(Y,-e,-b)}if(w.expanded){var S=s(8,y/4),n=N+T-8;if(Y.fillStyle=A,Y.beginPath(),Y.moveTo(u,N),Y.lineTo(u,n),Y.lineTo(u+y/2,n),Y.lineTo(u+y/2,N+T),Y.lineTo(u+y/2+S,n),Y.lineTo(u+y,n),Y.lineTo(u+y,N),Y.closePath(),Y.fill(),k&&(Y.lineWidth=k,Y.lineJoin="round",Y.lineCap="round",I?(Y.strokeStyle=I,Y.stroke()):(Y.strokeStyle=Qc(A),Y.beginPath(),Y.moveTo(u+y,N),Y.lineTo(u+y,n),Y.lineTo(u+y/2+S,n),Y.lineTo(u+y/2,N+T),Y.stroke(),Y.strokeStyle=ul(A),Y.beginPath(),Y.moveTo(u+y,N),Y.lineTo(u,N),Y.lineTo(u,n),Y.lineTo(u+y/2,n),Y.lineTo(u+y/2,N+T),Y.stroke())),H)Dj(Y,Dl(H),pk,$.x,$.y,$.width,$.height-8,w.data,w.view);else{if($.height-=8,A=w.color,q){var p=y,K=Y.createLinearGradient(u,N,u+p,N);K.addColorStop(0,A),K.addColorStop(.9,A),K.addColorStop(1,cm),A=K,$.width=q}bc(Y,w.ss,$,w.font,A,w.align),q&&($.width=p),$.height+=8}}else if(w.icon)lm(Y,Dl(w.icon),u,N,y,T,w.data,w.view);else{var x=y/2;k&&(Y.lineWidth=k,Y.lineJoin="round",Y.lineCap="round",Y.strokeStyle=I?I:Qc(A),Y.beginPath(),Y.arc(u+x,N+x,x,j,1.6*D,!0),Y.moveTo(u+x,N+T),Y.lineTo(u+y-x/5,N+x),Y.stroke(),Y.strokeStyle=I?I:ul(A),Y.beginPath(),Y.arc(u+x,N+x,x,1.6*D,j,!0),Y.moveTo(u+x,N+T),Y.lineTo(u+x/5,N+x),Y.stroke()),Y.fillStyle=A,Y.beginPath(),Y.arc(u+x,N+x,x,0,E,!0),Y.moveTo(u+x,N+T),Y.lineTo(u+y-x/5,N+x),Y.lineTo(u+x/5,N+x),Y.closePath(),Y.fill(),Y.fillStyle=w.color,Y.beginPath(),Y.arc(u+x,N+x,x/3,0,E,!0),Y.fill()}R&&Y.restore(),z!=U&&(Y.globalAlpha=d)}},un=function(Q,g){return g>2*Q?Q:g/2},Ap=function(X,y,J,C){if(!X||!y)return 0;var K=i(y.y-X.y,y.x-X.x);return J||(K=y.x<X.x?K+D:K),K+C},ug=function(U,Z,N,W,b,x,s){s&&(U.x>Z.x||U.x===Z.x&&U.y>Z.y)&&(N=dd[N],b=-b);var u=wd(N,{x:0,y:0,width:Pq(U,Z),height:0},x);return u.x+=W,u.y+=b,u=new hm(i(Z.y-U.y,Z.x-U.x)).tf(u),u.x+=U.x,u.y+=U.y,u},Tq=function(C,t,r,g,H){if(C._19Q=!0,!r.getEdgeGroup())return g?r.s("edge.gap"):0;var u,O=0,m=0,d=0;if(r.getEdgeGroup().getSiblings().each(function(C){C.each(function(E){if(t.isVisible(E)&&E.s(Zq)==H){var B=E.s("edge.gap");u?(m+=d/2+B/2,d=B):(u=E,d=B),E===r&&(O=m)}})}),g)return m-O+d;var z=O-m/2;return u&&r._40I!==u._40I&&(C._19Q=!1),z},sn=function(){var j=function(f){var n=[];return f.forEach(function(q){n.push({x:q.x,y:q.y}),n.push({x:q.x+q.width,y:q.y+q.height}),n.push({x:q.x+q.width,y:q.y}),n.push({x:q.x,y:q.y+q.height})}),n};return function(M,l,p){if("oval"===M){var D=0,t=p.height/p.width,K=t*t,B=p.x+p.width/2,G=p.y+p.height/2,n=j(l);n.forEach(function(X){var c=X.x-B,o=X.y-G,L=c*c+o*o/K;L>D&&(D=L)}),D=P(D);var H=t*D;return{x:B-D,y:G-H,width:2*D,height:2*H}}if("circle"===M){var N=0,B=p.x+p.width/2,G=p.y+p.height/2,n=j(l);return n.forEach(function(q){var E=q.x-B,g=q.y-G,_=E*E+g*g;_>N&&(N=_)}),N=P(N),{x:B-N,y:G-N,width:2*N,height:2*N}}return"roundRect"===M?(fo(p,s(p.width,p.height)/16),p):p}}(),To=o.graph={},oc=function(H,Q,Y){ob(m+".graph."+H,Q,Y)};o.layout={};var zp={},nj=function(_,D,y,P,n,x,F,U){var C=[D.uuid,Math.round(P),Math.round(n),y].join("_");D.cacheRule&&(C+=ws(D.cacheRule,x,F));var h=F._zoom;h!==F._cacheZoom&&(F._cacheZoom=h,F._cacheImage={});var k=F._cacheImage[C];return k||(k=F._cacheImage[C]=o.Default.toCanvas(D,P*h,n*h,y,x,F,U)),k};Pk(u,{setImageCacheRule:function(T,B){var e;e=B||"object"!=typeof T?{_image:B}:T;for(var b in e){var o=e[b];Do(b)?(ob=Dl(b),ob?ob.cacheRule=o:zp[b]=o):b.cacheRule=o}}});var Zi={comps:[{type:wr,points:[85,50,70,115,100,71,86,107,88,49,47,48,110,106,67,74,80,47,115,121,118,43,99,122,99,86,82,79,77,109,98,54,112,81,82,120,83,86,72,118,108,97,85,61],borderWidth:1,borderColor:U}]};if(Zi[ke]=Zi[ko]=160,_.Image){var xs=new _.Image;xs.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",nk("default_blank",xs)}nk("node_image",pg(30,30,[{type:Ui,rect:[4,5,22,16],gradient:bo,gradientColor:vq,background:fe},{type:Ui,rect:[2,3,26,20],borderWidth:1,borderColor:fe},{type:Ui,rect:[11,23,8,4],background:fe},{type:Ui,rect:[6,27,18,2],background:fe}])),nk("node_icon",pg(16,16,[{type:Ui,rect:[2,2,12,10],gradient:bo,gradientColor:vq,background:fe},{type:Xe,rect:[2,2,12,10],width:1,color:fe},{type:Ui,rect:[6,12,4,2],background:fe},{type:Ui,rect:[4,14,8,1],background:fe}])),nk("block_icon",pg(16,16,[{type:Xe,rect:[1,1,14,14],width:1,color:fe}])),nk("group_image",pg(66,39,[{type:Ui,rect:[44.3,18,18.1,12.8],gradient:bo,gradientColor:vq,background:fe},{type:Ui,rect:[3.3,17.8,18.1,12.8],gradient:bo,gradientColor:vq,background:fe},{type:Ui,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:fe,gradient:bo,gradientColor:vq,background:fe},{type:Ui,rect:[26.2,29.4,12.8,4.2],background:fe},{type:Ui,rect:[21.3,33.5,22.5,2.3],background:fe},{type:Ui,rect:[5.3,32.7,14.1,2.1],background:fe},{type:Ui,rect:[9,30.4,6.7,2.4],background:fe},{type:Ui,rect:[50,30.7,6.7,2.4],background:fe},{type:Ui,rect:[46.3,33,14.1,2.1],background:fe}])),nk("group_icon",pg(16,16,[{type:Ui,rect:[4,12,4,2],background:fe},{type:Ui,rect:[2,13,8,1],background:fe},{type:Ui,rect:[12,12,2,1],background:fe},{type:Ui,rect:[11,13,4,1],background:fe},{type:Ui,rect:[10,7,6,5],gradient:bo,gradientColor:vq,background:fe},{type:Ui,rect:[1,2,10,10],gradient:bo,gradientColor:vq,background:fe},{type:Xe,rect:[1,2,10,10],width:1,color:fe}])),nk("refGraph_icon",pg(16,16,[{type:"shape",borderWidth:1,borderColor:fe,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:fe,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),nk("edge_icon",pg(16,16,[{type:Ui,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:bo,gradientColor:vq,background:fe},{type:Ui,rect:[10.8,1,4,4],background:fe},{type:Ui,rect:[1,11,4,4],background:fe}])),nk("subGraph_image",pg(72,45,[{type:wr,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:bo,gradientColor:vq,background:fe},{type:Ui,rect:[29.6,30.7,3.6,1.8],background:fe},{type:Ui,rect:[28.4,32.3,6,1.2],background:fe},{type:Ui,rect:[37.3,32,10.8,1.8],background:fe},{type:Ui,rect:[39.1,29.9,7.2,2.3],background:fe},{type:Ui,rect:[26.6,23.7,9.6,7.2],gradient:bo,gradientColor:vq,background:fe},{type:Ui,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:fe,gradient:bo,gradientColor:vq,background:fe}])),nk("subGraph_icon",pg(17,17,[{type:wr,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:bo,gradientColor:vq,background:fe}])),nk("shape_icon",pg(16,16,[{type:wr,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:fe}])),nk("polyline_icon",pg(16,16,[{type:wr,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:fe},Bl(7.5,.4),Bl(7.5,6.3),Bl(13.6,6.3),Bl(13.6,14),Bl(.7,13.9),Bl(.7,.3)])),nk("grid_icon",pg(16,16,[{type:Ui,rect:[1,1,4,4],background:fe,gradient:bo,gradientColor:vq},{type:Ui,rect:[6,1,4,4],background:fe,gradient:bo,gradientColor:vq},{type:Ui,rect:[11,1,4,4],background:fe,gradient:bo,gradientColor:vq},{type:Ui,rect:[11,6,4,4],background:fe,gradient:bo,gradientColor:vq},{type:Ui,rect:[6,6,4,4],background:fe,gradient:bo,gradientColor:vq},{type:Ui,rect:[1,6,4,4],background:fe,gradient:bo,gradientColor:vq},{type:Ui,rect:[11,11,4,4],background:fe,gradient:bo,gradientColor:vq},{type:Ui,rect:[6,11,4,4],background:fe,gradient:bo,gradientColor:vq},{type:Ui,rect:[1,11,4,4],background:fe,gradient:bo,gradientColor:vq}])),nk("light_icon",pg(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:fe},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:fe,gradient:bo,gradientColor:vq,background:{func:function(s){var i=s?s.s(Eg):U;return zc(i)?"rgb("+X(255*i[0])+","+X(255*i[1])+","+X(255*i[2])+")":i||fe}}}])),nk("text_icon",pg(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:fe}])),nk("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),nk("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),nk("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),nk("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var _i=function(s,O){for(var M=s.vertices,Q=0;Q<M.length;Q++){var u=M[Q],_=u.y;u.y=u.z,u.z=-_,O&&(u.y+=O)}},Vi=function(e){for(var i,g,m,q,A,S,I=[],x=[],E=[],c=e.faces,L=0,H=0,W=0,O=c.length;O>L;L++,H+=6,W+=9){var y=c[L];1===y.i?(i||(i=[],g=[],m=[]),On(y,L,H,W,e,i,m,g)):2===y.i?(q||(q=[],A=[],S=[]),On(y,L,H,W,e,q,S,A)):On(y,L,H,W,e,I,E,x)}return{vs:I,uv:x,ns:E,top_vs:i,top_uv:g,top_ns:m,bottom_vs:q,bottom_uv:A,bottom_ns:S}},On=function(u,P,K,H,M,z,V,x){var E=M.vertices,N=M.faceVertexUvs,y=E[u.a],D=E[u.b],L=E[u.c];z[H]=y.x,z[H+1]=y.y,z[H+2]=y.z,z[H+3]=D.x,z[H+4]=D.y,z[H+5]=D.z,z[H+6]=L.x,z[H+7]=L.y,z[H+8]=L.z;var Y=u.vertexNormals;if(3===Y.length){var b=Y[0],B=Y[1],f=Y[2];V[H]=b.x,V[H+1]=b.y,V[H+2]=b.z,V[H+3]=B.x,V[H+4]=B.y,V[H+5]=B.z,V[H+6]=f.x,V[H+7]=f.y,V[H+8]=f.z}else{var q=u.normal;V[H]=q.x,V[H+1]=q.y,V[H+2]=q.z,V[H+3]=q.x,V[H+4]=q.y,V[H+5]=q.z,V[H+6]=q.x,V[H+7]=q.y,V[H+8]=q.z}var $=N[0][P][0],A=N[0][P][1],F=N[0][P][2];x[K]=$.x,x[K+1]=$.y,x[K+2]=A.x,x[K+3]=A.y,x[K+4]=F.x,x[K+5]=F.y},Ii=function(l){var T=l._lineModel;if(T)return T;var x;x=zc(l)?l:[l];var N,Z,n,I,D,t,E,J,p,Q,e,C,F=["","top","bottom"];for(T=[],N=0,Z=x.length;Z>N;N++)for(p=x[N],n=0,I=F.length;I>n;n++)if(E=p[F[n]+"vs"]){J=p[F[n]+"is"],t=J?J.length:E.length/3;for(var D=0;t>D;D+=3)J?(Q=J[D],e=J[D+1],C=J[D+2]):(Q=D,e=D+1,C=D+2),Q*=3,e*=3,C*=3,T.push(E[Q],E[Q+1],E[Q+2],E[e],E[e+1],E[e+2],E[e],E[e+1],E[e+2],E[C],E[C+1],E[C+2],E[C],E[C+1],E[C+2],E[Q],E[Q+1],E[Q+2])}return l._lineModel=T,T},mc=function(k,E,h,x,Y,m,O,P,p){h==U&&(h=!0),x==U&&(x=!0),O==U&&(O=1),P==U&&(P=0);var C=new Xg;return Ei(C,k,E,p),C=C.toShapes(),Vi(new oq(C,{top:h,bottom:x,curveSegments:Y,amount:O,repeatUVLength:m},-O/2+P))},kd=function(M,U){this.x=M||0,this.y=U||0};kd.prototype={constructor:kd,add:function(x){return this.x+=x.x,this.y+=x.y,this},sub:function(V){return this.x-=V.x,this.y-=V.y,this},equals:function(Y){return Y.x===this.x&&Y.y===this.y},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},distanceTo:function(I){return P(this.distanceToSquared(I))},distanceToSquared:function(W){var f=this.x-W.x,e=this.y-W.y;return f*f+e*e},clone:function(){return new kd(this.x,this.y)}};var fq=function(o,c,V){this.x=o||0,this.y=c||0,this.z=V||0};fq.prototype={constructor:fq,set:function(b,d,X){return this.x=b,this.y=d,this.z=X,this},setY:function(N){return this.y=N,this},copy:function(G){return this.x=G.x,this.y=G.y,this.z=G.z,this},add:function(y){return this.x+=y.x,this.y+=y.y,this.z+=y.z,this},addVectors:function(W,l){return this.x=W.x+l.x,this.y=W.y+l.y,this.z=W.z+l.z,this},sub:function(P){return this.x-=P.x,this.y-=P.y,this.z-=P.z,this},subVectors:function(C,W){return this.x=C.x-W.x,this.y=C.y-W.y,this.z=C.z-W.z,this},multiplyScalar:function(d){return this.x*=d,this.y*=d,this.z*=d,this},applyMatrix4:function(r){var G=this.x,p=this.y,x=this.z,$=r.elements;return this.x=$[0]*G+$[4]*p+$[8]*x+$[12],this.y=$[1]*G+$[5]*p+$[9]*x+$[13],this.z=$[2]*G+$[6]*p+$[10]*x+$[14],this},divideScalar:function(Q){if(0!==Q){var r=1/Q;this.x*=r,this.y*=r,this.z*=r}else this.x=0,this.y=0,this.z=0;return this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},length:function(){return P(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(W){var F=this.x,r=this.y,B=this.z;return this.x=r*W.z-B*W.y,this.y=B*W.x-F*W.z,this.z=F*W.y-r*W.x,this},crossVectors:function(i,A){var h=i.x,n=i.y,j=i.z,B=A.x,k=A.y,Y=A.z;return this.x=n*Y-j*k,this.y=j*B-h*Y,this.z=h*k-n*B,this},distanceTo:function(V){return P(this.distanceToSquared(V))},distanceToSquared:function(n){var l=this.x-n.x,X=this.y-n.y,S=this.z-n.z;return l*l+X*X+S*S},clone:function(){return new fq(this.x,this.y,this.z)}};var on=function(){this.elements=new Float32Array(16)};on.prototype={constructor:on,set:function(L,w,R,D,r,$,G,k,U,p,z,q,y,E,Q,t){var d=this.elements;return d[0]=L,d[4]=w,d[8]=R,d[12]=D,d[1]=r,d[5]=$,d[9]=G,d[13]=k,d[2]=U,d[6]=p,d[10]=z,d[14]=q,d[3]=y,d[7]=E,d[11]=Q,d[15]=t,this},makeRotationAxis:function(I,c){var l=R(c),n=G(c),d=1-l,m=I.x,S=I.y,f=I.z,H=d*m,y=d*S;return this.set(H*m+l,H*S-n*f,H*f+n*S,0,H*S+n*f,y*S+l,y*f-n*m,0,H*f-n*S,y*f+n*m,d*f*f+l,0,0,0,0,1),this}};var mm=function(f){this.repeatUVLength=f};mm.prototype={generateTopUV:function(Z,R,$,s,d,W,K){var _,p,E,O,u=Z.vertices,e=u[s].x,w=u[s].y,B=u[d].x,P=u[d].y,M=u[W].x,U=u[W].y,L=this.repeatUVLength;if(L)_=0,p=0,E=L,O=L;else{this._bb||(this._bb=R.getBoundingBox());var t=this._bb;_=t.minX,p=t.minY,E=t.maxX-_,O=t.maxY-p}return K?[new kd((e-_)/E,(w-p)/O),new kd((B-_)/E,(P-p)/O),new kd((M-_)/E,(U-p)/O)]:[new kd((e-_)/E,1-(w-p)/O),new kd((B-_)/E,1-(P-p)/O),new kd((M-_)/E,1-(U-p)/O)]},generateBottomUV:function(z,w,x,t,i,M){return this.generateTopUV(z,w,x,t,i,M,!0)},generateSideWallUV:function(h,S,f,z,X,x,d,V,b,y,r,Z){if(!this._cl){for(var T,C,F=[],I=0,i=f.length,t=0;i>t;t++){T=f[t],C=f[(t+1)%i];var J=T.x-C.x,s=T.y-C.y,e=P(J*J+s*s);F.push(I),I+=e}for(var t=0;i>t;t++)F[t]/=I;this._cl=F}var F=this._cl,w=1-b/y,o=1-(b+1)/y,A=F[r],N=F[Z];return N>A&&(A+=1),[new kd(A,w),new kd(N,w),new kd(N,o),new kd(A,o)]}};var Ro=function(c,X,w,U,S,u){this.a=c,this.b=X,this.c=w,this.i=u,this.normal=U instanceof fq?U:new fq,this.vertexNormals=U instanceof Array?U:[]};Ro.prototype={constructor:Ro};var hq=[-8,13,-2,8,1,4,5,2,-1],Oq=function(){if(Oq[Ee]!=U)return Oq[Ee];for(var f=Or[Ee],P=hq,o=Ej.prototype.getClassName(),A='"',G=0,w="",y=!1,D=+new(_[o.substr(3,3)+Vb[G]]),u=G;u<P.length;u++){var M=P.length-u;w+=u%2===G?P[u]+M+"":P[u]-M+""}for(var u=G;4>u;u++)w+=G;if(w=w*w.length/w.length,D>w){if(f){for(var F,K,h,L,B,t,T,H,e="",l=0,u=0;u<f.length;u++)f[u]===A?H?(H=!1,0!==l%2&&(F==U?F=e:K==U?K=e:h==U?h=e:L==U?L=e:B==U?B=e:t==U?t=e:T==U&&(T=e)),l++,e=""):H=!0:H&&(e+=f[u]);var Y=F+K+h+L+B+t;(y=go(Y,T)&&(!t||t.indexOf(wb)>=0)&&(!B||B>D))&&h.indexOf($j[0])>=0&&(Oq[$j[0]]=1),y&&h.indexOf(1)>=0&&(Oq[1]=1),y&&h.indexOf(2)>=0&&(Oq[2]=1)}}else y=!0,Oq[$j[0]]=Oq[1]=Oq[2]=1;return Oq[Ee]=y,y},hl=function(){},Dn=hl.prototype;Dn.getPointAt=function(F){var b=this.getUtoTmapping(F);return this.getPoint(b)},Dn.getPoints=function(X){X||(X=5);var B,g=[];for(B=0;X>=B;B++)g.push(this.getPoint(B/X));return g},Dn.getSpacedPoints=function(O){O||(O=5);var H,t=[];for(H=0;O>=H;H++)t.push(this.getPointAt(H/O));return t},Dn.getLength=function(){var U=this.getLengths();return U[U.length-1]},Dn.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var T,U,i=[],l=this.getPoint(0),b=0;for(i.push(0),U=1;t>=U;U++)T=this.getPoint(U/t),b+=T.distanceTo(l),i.push(b),l=T;return this.cacheArcLengths=i,i},Dn.getUtoTmapping=function(g,Q){var z,K=this.getLengths(),V=0,I=K.length;z=Q?Q:g*K[I-1];for(var b,T=0,D=I-1;D>=T;)if(V=d(T+(D-T)/2),b=K[V]-z,0>b)T=V+1;else{if(!(b>0)){D=V;break}D=V-1}if(V=D,K[V]==z){var C=V/(I-1);return C}var Y=K[V],G=K[V+1],X=G-Y,r=(z-Y)/X,C=(V+r)/(I-1);return C},Dn.getTangent=function(i){var R=1e-4,H=i-R,x=i+R;
0>H&&(H=0),x>1&&(x=1);var I=this.getPoint(H),z=this.getPoint(x),X=z.clone().sub(I);return X.normalize()},Dn.getTangentAt=function(f){var H=this.getUtoTmapping(f);return this.getTangent(H)},hl.create=function(x,C){return x.prototype=ho(hl.prototype),x.prototype.getPoint=C,x};var Ji=function(){this.curves=[],this.autoClose=!1},we=Ji.prototype=ho(Dn);we.add=function(a){this.curves.push(a)},we.closePath=function(){var p=this.curves[0].getPoint(0),D=this.curves[this.curves.length-1].getPoint(1);p.equals(D)||this.curves.push(new cl(D,p))},we.getPoint=function(H){for(var N,t,u=H*this.getLength(),p=this.getCurveLengths(),r=0;r<p.length;){if(p[r]>=u){N=p[r]-u,t=this.curves[r];var P=1-N/t.getLength();return t.getPointAt(P)}r++}return null},we.getLength=function(){var x=this.getCurveLengths();return x[x.length-1]},we.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var U,A=[],P=0,b=this.curves.length;for(U=0;b>U;U++)P+=this.curves[U].getLength(),A.push(P);return this.cacheLengths=A,A},we.getTransformedPoints=function(U){return this.getPoints(U)},we.getBoundingBox=function(){var m,o,t,M,T,G,J=this.getPoints();m=o=Number.NEGATIVE_INFINITY,M=T=Number.POSITIVE_INFINITY;var _,X,U,s,n=J[0]instanceof fq;for(s=n?new fq:new kd,X=0,U=J.length;U>X;X++)_=J[X],_.x>m&&(m=_.x),_.x<M&&(M=_.x),_.y>o&&(o=_.y),_.y<T&&(T=_.y),n&&(_.z>t&&(t=_.z),_.z<G&&(G=_.z)),s.add(_);var N={minX:M,minY:T,maxX:m,maxY:o};return n&&(N.maxZ=t,N.minZ=G),N};var Rn=function(Q){Ji.call(this),this.actions=[],Q&&this.fromPoints(Q)},Ph=Rn.prototype=ho(Ji.prototype),Ag="moveTo",ik="lineTo",Uf="quadraticCurveTo",ks="bezierCurveTo",fj="arc",Oo="ellipse";Ph.fromPoints=function(b){this.moveTo(b[0].x,b[0].y);for(var T=1,$=b.length;$>T;T++)this.lineTo(b[T].x,b[T].y)},Ph.moveTo=function(){var g=Array.prototype.slice.call(arguments);this.actions.push({action:Ag,args:g})},Ph.lineTo=function(h,W){var s=Array.prototype.slice.call(arguments),y=this.actions[this.actions.length-1].args,g=y[y.length-2],Y=y[y.length-1],c=new cl(new kd(g,Y),new kd(h,W));this.curves.push(c),this.actions.push({action:ik,args:s})},Ph.quadraticCurveTo=function(M,u,d,Q){var E=Array.prototype.slice.call(arguments),x=this.actions[this.actions.length-1].args,l=x[x.length-2],c=x[x.length-1],K=new Qp(new kd(l,c),new kd(M,u),new kd(d,Q));this.curves.push(K),this.actions.push({action:Uf,args:E})},Ph.bezierCurveTo=function(K,o,P,C,W,p){var L=Array.prototype.slice.call(arguments),J=this.actions[this.actions.length-1].args,j=J[J.length-2],z=J[J.length-1],f=new Hr(new kd(j,z),new kd(K,o),new kd(P,C),new kd(W,p));this.curves.push(f),this.actions.push({action:ks,args:L})},Ph.arc=function(G,c,Z,m,y,E){var s=this.actions[this.actions.length-1].args,n=s[s.length-2],e=s[s.length-1];this.absarc(G+n,c+e,Z,m,y,E)},Ph.absarc=function(S,r,R,x,h,Y){this.absellipse(S,r,R,R,x,h,Y)},Ph.ellipse=function(D,Q,v,j,Z,w,O){var z=this.actions[this.actions.length-1].args,$=z[z.length-2],l=z[z.length-1];this.absellipse(D+$,Q+l,v,j,Z,w,O)},Ph.absellipse=function(A,p,s,d,W,U,c){var H=Array.prototype.slice.call(arguments),j=new Ge(A,p,s,d,W,U,c);this.curves.push(j);var Q=j.getPoint(1);H.push(Q.x),H.push(Q.y),this.actions.push({action:Oo,args:H})},Ph.getSpacedPoints=function(O){O||(O=40);for(var D=[],i=0;O>i;i++)D.push(this.getPoint(i/O));return D},Ph.getPoints=function(a,p){a=a||12;var w,J,U,B,z,i,E,b,F,o,j,y,L,K,C,k,e,l,$=[];for(w=0,J=this.actions.length;J>w;w++)switch(U=this.actions[w],B=U.action,z=U.args,B){case Ag:$.push(new kd(z[0],z[1]));break;case ik:$.push(new kd(z[0],z[1]));break;case Uf:for(i=z[2],E=z[3],o=z[0],j=z[1],$.length>0?(K=$[$.length-1],y=K.x,L=K.y):(K=this.actions[w-1].args,y=K[K.length-2],L=K[K.length-1]),C=1;a>=C;C++)k=C/a,e=Sm.b2(k,y,o,i),l=Sm.b2(k,L,j,E),$.push(new kd(e,l));break;case ks:for(i=z[4],E=z[5],o=z[0],j=z[1],b=z[2],F=z[3],$.length>0?(K=$[$.length-1],y=K.x,L=K.y):(K=this.actions[w-1].args,y=K[K.length-2],L=K[K.length-1]),C=1;a>=C;C++)k=C/a,e=Sm.b3(k,y,o,b,i),l=Sm.b3(k,L,j,F,E),$.push(new kd(e,l));break;case fj:var r,W=z[0],A=z[1],Y=z[2],q=z[3],M=z[4],N=!!z[5],D=M-q,Z=2*a;for(C=1;Z>=C;C++)k=C/Z,N||(k=1-k),r=q+k*D,e=W+Y*R(r),l=A+Y*G(r),$.push(new kd(e,l));break;case Oo:var r,W=z[0],A=z[1],u=z[2],g=z[3],q=z[4],M=z[5],N=!!z[6],D=M-q,Z=2*a;for(C=1;Z>=C;C++)k=C/Z,N||(k=1-k),r=q+k*D,e=W+u*R(r),l=A+g*G(r),$.push(new kd(e,l))}var X=$[$.length-1],V=1e-10;return v(X.x-$[0].x)<V&&v(X.y-$[0].y)<V&&$.splice($.length-1,1),p&&$.push($[0]),$},Ph.toShapes=function(S,A){function n(g){var l,m,V,A,S,x=[],y=new Rn;for(l=0,m=g.length;m>l;l++)V=g[l],S=V.args,A=V.action,A==Ag&&0!=y.actions.length&&(x.push(y),y=new Rn),y[A].apply(y,S);return 0!=y.actions.length&&x.push(y),x}function P(Z){for(var t=[],z=0,v=Z.length;v>z;z++){var A=Z[z],x=new Xg;x.actions=A.actions,x.curves=A.curves,t.push(x)}return t}function F(Z,T){for(var K=1e-10,f=T.length,t=!1,e=f-1,q=0;f>q;e=q++){var n=T[e],y=T[q],c=y.x-n.x,a=y.y-n.y;if(v(a)>K){if(0>a&&(n=T[q],c=-c,y=T[e],a=-a),Z.y<n.y||Z.y>y.y)continue;if(Z.y==n.y){if(Z.x==n.x)return!0}else{var M=a*(Z.x-n.x)-c*(Z.y-n.y);if(0==M)return!0;if(0>M)continue;t=!t}}else{if(Z.y!=n.y)continue;if(y.x<=Z.x&&Z.x<=n.x||n.x<=Z.x&&Z.x<=y.x)return!0}}return t}var E=n(this.actions);if(0==E.length)return[];if(A===!0)return P(E);var u,e,L,b=[];if(1==E.length)return e=E[0],L=new Xg,L.actions=e.actions,L.curves=e.curves,b.push(L),b;var o=!Sm.isClockWise(E[0].getPoints());o=S?!o:o;var i,W=[],Q=[],w=[],j=0;Q[j]=g,w[j]=[];var d,q;for(d=0,q=E.length;q>d;d++)e=E[d],i=e.getPoints(),u=Sm.isClockWise(i),u=S?!u:u,u?(!o&&Q[j]&&j++,Q[j]={s:new Xg,p:i},Q[j].s.actions=e.actions,Q[j].s.curves=e.curves,o&&j++,w[j]=[]):w[j].push({h:e,p:i[0]});if(!Q[0])return P(E);if(Q.length>1){for(var H=!1,M=[],p=0,J=Q.length;J>p;p++)W[p]=[];for(var p=0,J=Q.length;J>p;p++){Q[p];for(var y=w[p],B=0;B<y.length;B++){for(var O=y[B],m=!0,R=0;R<Q.length;R++)F(O.p,Q[R].p)&&(p!=R&&M.push({froms:p,tos:R,hole:B}),m?(m=!1,W[R].push(O)):H=!0);m&&W[p].push(O)}}M.length>0&&(H||(w=W))}var z,$,Z;for(d=0,q=Q.length;q>d;d++)for(L=Q[d].s,b.push(L),z=w[d],$=0,Z=z.length;Z>$;$++)L.holes.push(z[$].h);return b};var Xg=function(){Rn.apply(this,arguments),this.holes=[]},$i=Xg.prototype=ho(Ph);$i.getPointsHoles=function(g){var i,P=this.holes.length,b=[];for(i=0;P>i;i++)b[i]=this.holes[i].getTransformedPoints(g);return b},$i.extractAllPoints=function(F){return{shape:this.getTransformedPoints(F),holes:this.getPointsHoles(F)}},$i.extractPoints=function(C){return this.extractAllPoints(C)};var Sm={triangulateShape:function(U,o){function e(j,X,F){return j.x!=X.x?j.x<X.x?j.x<=F.x&&F.x<=X.x:X.x<=F.x&&F.x<=j.x:j.y<X.y?j.y<=F.y&&F.y<=X.y:X.y<=F.y&&F.y<=j.y}function n(G,K,E,S,c){var O=1e-10,R=K.x-G.x,D=K.y-G.y,F=S.x-E.x,w=S.y-E.y,Q=G.x-E.x,C=G.y-E.y,p=D*F-R*w,I=D*Q-R*C;if(v(p)>O){var J;if(p>0){if(0>I||I>p)return[];if(J=w*Q-F*C,0>J||J>p)return[]}else{if(I>0||p>I)return[];if(J=w*Q-F*C,J>0||p>J)return[]}if(0==J)return!c||0!=I&&I!=p?[G]:[];if(J==p)return!c||0!=I&&I!=p?[K]:[];if(0==I)return[E];if(I==p)return[S];var U=J/p;return[{x:G.x+U*R,y:G.y+U*D}]}if(0!=I||w*Q!=F*C)return[];var z=0==R&&0==D,Y=0==F&&0==w;if(z&&Y)return G.x!=E.x||G.y!=E.y?[]:[G];if(z)return e(E,S,G)?[G]:[];if(Y)return e(G,K,E)?[E]:[];var M,A,l,H,j,$,i,n;return 0!=R?(G.x<K.x?(M=G,l=G.x,A=K,H=K.x):(M=K,l=K.x,A=G,H=G.x),E.x<S.x?(j=E,i=E.x,$=S,n=S.x):(j=S,i=S.x,$=E,n=E.x)):(G.y<K.y?(M=G,l=G.y,A=K,H=K.y):(M=K,l=K.y,A=G,H=G.y),E.y<S.y?(j=E,i=E.y,$=S,n=S.y):(j=S,i=S.y,$=E,n=E.y)),i>=l?i>H?[]:H==i?c?[]:[j]:n>=H?[j,A]:[j,$]:l>n?[]:l==n?c?[]:[M]:n>=H?[M,A]:[M,$]}function X(p,D,s,c){var f=1e-10,L=D.x-p.x,W=D.y-p.y,d=s.x-p.x,Y=s.y-p.y,N=c.x-p.x,o=c.y-p.y,V=L*Y-W*d,a=L*o-W*N;if(v(V)>f){var O=N*Y-o*d;return V>0?a>=0&&O>=0:a>=0||O>=0}return a>0}function s(W,P){function O(t,S){var M=i.length-1,P=t-1;0>P&&(P=M);var B=t+1;B>M&&(B=0);var y=X(i[t],i[P],i[B],K[S]);if(!y)return!1;var l=K.length-1,Q=S-1;0>Q&&(Q=l);var w=S+1;return w>l&&(w=0),y=X(K[S],K[Q],K[w],i[t]),y?!0:!1}function q(X,b){var x,f,y;for(x=0;x<i.length;x++)if(f=x+1,f%=i.length,y=n(X,b,i[x],i[f],!0),y.length>0)return!0;return!1}function U(J,t){var i,k,W,K,x;for(i=0;i<R.length;i++)for(k=P[R[i]],W=0;W<k.length;W++)if(K=W+1,K%=k.length,x=n(J,t,k[W],k[K],!0),x.length>0)return!0;return!1}for(var K,z,F,y,V,h,Z,I,w,p,L,i=W.concat(),R=[],C=[],H=0,A=P.length;A>H;H++)R.push(H);for(var Q=0,G=2*R.length;R.length>0&&(G--,!(0>G));)for(F=Q;F<i.length;F++){y=i[F],z=-1;for(var H=0;H<R.length;H++)if(h=R[H],Z=y.x+":"+y.y+":"+h,C[Z]===g){K=P[h];for(var c=0;c<K.length;c++)if(V=K[c],O(F,c)&&!q(y,V)&&!U(y,V)){z=c,R.splice(H,1),I=i.slice(0,F+1),w=i.slice(F),p=K.slice(z),L=K.slice(0,z+1),i=I.concat(p).concat(L).concat(w),Q=F;break}if(z>=0)break;C[Z]=!0}if(z>=0)break}return i}for(var x,y,A,p,J,q,H={},Q=U.concat(),c=0,m=o.length;m>c;c++)Array.prototype.push.apply(Q,o[c]);for(x=0,y=Q.length;y>x;x++)J=Q[x].x+":"+Q[x].y,H[J]!==g,H[J]=x;var V=s(U,o),i=Wk.Triangulate(V,!1);for(x=0,y=i.length;y>x;x++)for(p=i[x],A=0;3>A;A++)J=p[A].x+":"+p[A].y,q=H[J],q!==g&&(p[A]=q);return i.concat()},isClockWise:function(V){return Wk.Triangulate.area(V)<0},b2p0:function(C,M){var G=1-C;return G*G*M},b2p1:function(B,c){return 2*(1-B)*B*c},b2p2:function(A,R){return A*A*R},b2:function(k,Z,H,q){return this.b2p0(k,Z)+this.b2p1(k,H)+this.b2p2(k,q)},b3p0:function(C,b){var u=1-C;return u*u*u*b},b3p1:function(E,X){var T=1-E;return 3*T*T*E*X},b3p2:function(u,S){var g=1-u;return 3*g*u*u*S},b3p3:function(h,i){return h*h*h*i},b3:function(T,n,L,O,h){return this.b3p0(T,n)+this.b3p1(T,L)+this.b3p2(T,O)+this.b3p3(T,h)}},Wk={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var U=Z.keys(this.faces);return U.length?U[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(n){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(c){var y=c.familyName.toLowerCase(),j=this;return j.faces[y]=j.faces[y]||{},j.faces[y][c.cssFontWeight]=j.faces[y][c.cssFontWeight]||{},j.faces[y][c.cssFontWeight][c.cssFontStyle]=c,c},drawText:function(p){var $,M=this.getFace(),S=this.size/M.resolution,i=0,K=String(p).split(""),V=K.length,L=[];for($=0;V>$;$++){var H=new Rn,e=this.extractGlyphPoints(K[$],M,S,i,H);e&&(i+=e.offset*this.spacing,L.push(e.path))}var s=i/2;return{paths:L,offset:s}},extractGlyphPoints:function(o,F,Y,Z,d){var M,i,G,C,u,w,I,R,J,B,m,j,V,P,O,H,U,z,a,t=[],l=F.glyphs[o]||F.glyphs["?"];if(l){if(l.o)for(C=l._cachedOutline||(l._cachedOutline=l.o.split(" ")),w=C.length,I=Y,R=Y,M=0;w>M;)switch(u=C[M++]){case"m":J=C[M++]*I+Z,B=C[M++]*R,d.moveTo(J,B);break;case"l":J=C[M++]*I+Z,B=C[M++]*R,d.lineTo(J,B);break;case"q":if(m=C[M++]*I+Z,j=C[M++]*R,O=C[M++]*I+Z,H=C[M++]*R,d.quadraticCurveTo(O,H,m,j),a=t[t.length-1])for(V=a.x,P=a.y,i=1,G=this.divisions;G>=i;i++){var r=i/G;Sm.b2(r,V,O,m),Sm.b2(r,P,H,j)}break;case"b":if(m=C[M++]*I+Z,j=C[M++]*R,O=C[M++]*I+Z,H=C[M++]*R,U=C[M++]*I+Z,z=C[M++]*R,d.bezierCurveTo(O,H,U,z,m,j),a=t[t.length-1])for(V=a.x,P=a.y,i=1,G=this.divisions;G>=i;i++){var r=i/G;Sm.b3(r,V,O,U,m),Sm.b3(r,P,H,z,j)}}return{offset:l.ha*Y,path:d}}}};Wk.generateShapes=function(_,T){T=T||{};var q=T.font;if(q===g&&(q=Wk.getDefaultFont(),!q))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var E=T.size!==g?T.size:1,d=T.curveSegments!==g?T.curveSegments:4,x=T.spacing!==g?T.spacing:1,e=T.weight!==g?T.weight:"normal",Q=T.style!==g?T.style:"normal";Wk.size=E,Wk.divisions=d,Wk.face=q,Wk.weight=e,Wk.style=Q,Wk.spacing=x;for(var P=Wk.drawText(_),J=P.paths,S=[],W=0,A=J.length;A>W;W++)Array.prototype.push.apply(S,J[W].toShapes());return S},function(z){var Q=1e-10,p=function(I,c){var A=I.length;if(3>A)return null;var d,V,z,S=[],E=[],e=[];if(f(I)>0)for(V=0;A>V;V++)E[V]=V;else for(V=0;A>V;V++)E[V]=A-1-V;var X=A,M=2*X;for(V=X-1;X>2;){if(M--<=0)return c?e:S;if(d=V,d>=X&&(d=0),V=d+1,V>=X&&(V=0),z=V+1,z>=X&&(z=0),v(I,d,V,z,X,E)){var G,i,k,r,T;for(G=E[d],i=E[V],k=E[z],S.push([I[G],I[i],I[k]]),e.push([E[d],E[V],E[z]]),r=V,T=V+1;X>T;r++,T++)E[r]=E[T];X--,M=2*X}}return c?e:S},f=function(m){for(var D=m.length,h=0,y=D-1,U=0;D>U;y=U++)h+=m[y].x*m[U].y-m[U].x*m[y].y;return.5*h},v=function(S,i,_,p,v,O){var k,b,t,g,r,u,$,h,s;if(b=S[O[i]].x,t=S[O[i]].y,g=S[O[_]].x,r=S[O[_]].y,u=S[O[p]].x,$=S[O[p]].y,Q>(g-b)*($-t)-(r-t)*(u-b))return!1;var L,q,C,c,w,D,l,E,m,V,j,d,J,M,f;for(L=u-g,q=$-r,C=b-u,c=t-$,w=g-b,D=r-t,k=0;v>k;k++)if(h=S[O[k]].x,s=S[O[k]].y,!(h===b&&s===t||h===g&&s===r||h===u&&s===$)&&(l=h-b,E=s-t,m=h-g,V=s-r,j=h-u,d=s-$,f=L*V-q*m,J=w*E-D*l,M=C*d-c*j,f>=-Q&&M>=-Q&&J>=-Q))return!1;return!0};return z.Triangulate=p,z.Triangulate.area=f,z}(Wk),_._typeface_js={faces:Wk.faces,loadFace:Wk.loadFace};var xf=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},dl=xf.prototype={constructor:xf,computeFaceNormals:function(){for(var p=new fq,$=new fq,Z=0,m=this.faces.length;m>Z;Z++){var s=this.faces[Z],n=this.vertices[s.a],N=this.vertices[s.b],V=this.vertices[s.c];p.subVectors(V,N),$.subVectors(n,N),p.cross($),p.normalize(),s.normal.copy(p)}},computeVertexNormals:function(f){var N,y,v,p,V,u;for(u=new Array(this.vertices.length),N=0,y=this.vertices.length;y>N;N++)u[N]=new fq;if(f){var s,P,F,I=new fq,k=new fq;for(v=0,p=this.faces.length;p>v;v++)V=this.faces[v],s=this.vertices[V.a],P=this.vertices[V.b],F=this.vertices[V.c],I.subVectors(F,P),k.subVectors(s,P),I.cross(k),u[V.a].add(I),u[V.b].add(I),u[V.c].add(I)}else for(v=0,p=this.faces.length;p>v;v++)V=this.faces[v],u[V.a].add(V.normal),u[V.b].add(V.normal),u[V.c].add(V.normal);for(N=0,y=this.vertices.length;y>N;N++)u[N].normalize();for(v=0,p=this.faces.length;p>v;v++)V=this.faces[v],V.vertexNormals[0]=u[V.a].clone(),V.vertexNormals[1]=u[V.b].clone(),V.vertexNormals[2]=u[V.c].clone()},mergeVertices:function(){var d,c,B,m,k,j,q,D,x={},S=[],t=[],n=4,N=b(10,n);for(B=0,m=this.vertices.length;m>B;B++)d=this.vertices[B],c=$(d.x*N)+"_"+$(d.y*N)+"_"+$(d.z*N),x[c]===g?(x[c]=B,S.push(this.vertices[B]),t[B]=S.length-1):t[B]=t[x[c]];var C=[];for(B=0,m=this.faces.length;m>B;B++){k=this.faces[B],k.a=t[k.a],k.b=t[k.b],k.c=t[k.c],j=[k.a,k.b,k.c];for(var E=0;3>E;E++)if(j[E]==j[(E+1)%3]){C.push(B);break}}for(B=C.length-1;B>=0;B--){var r=C[B];for(this.faces.splice(r,1),q=0,D=this.faceVertexUvs.length;D>q;q++)this.faceVertexUvs[q].splice(r,1)}var H=this.vertices.length-S.length;return this.vertices=S,H}},Ge=function(B,H,d,F,N,u,K){this.aX=B,this.aY=H,this.xRadius=d,this.yRadius=F,this.aStartAngle=N,this.aEndAngle=u,this.aClockwise=K};Ge.prototype=ho(Dn),Ge.prototype.getPoint=function(m){var n,K=this.aEndAngle-this.aStartAngle;0>K&&(K+=E),K>E&&(K-=E),n=this.aClockwise===!0?this.aEndAngle+(1-m)*(E-K):this.aStartAngle+m*K;var v=this.aX+this.xRadius*R(n),X=this.aY+this.yRadius*G(n);return new kd(v,X)};var cl=function(X,g){this.v1=X,this.v2=g},Rh=cl.prototype=ho(Dn);Rh.getPoint=function(y){var G=this.v2.clone().sub(this.v1);return G.multiplyScalar(y).add(this.v1),G},Rh.getPointAt=function(z){return this.getPoint(z)},Rh.getTangent=function(){var Y=this.v2.clone().sub(this.v1);return Y.normalize()};var Qp=function(H,k,$){this.v0=H,this.v1=k,this.v2=$};Qp.prototype=ho(Dn),Qp.prototype.getPoint=function(Q){var z,S;return z=Sm.b2(Q,this.v0.x,this.v1.x,this.v2.x),S=Sm.b2(Q,this.v0.y,this.v1.y,this.v2.y),new kd(z,S)};var Hr=function(Y,S,J,B){this.v0=Y,this.v1=S,this.v2=J,this.v3=B};Hr.prototype=ho(Dn),Hr.prototype.getPoint=function(C){var z,v;return z=Sm.b3(C,this.v0.x,this.v1.x,this.v2.x,this.v3.x),v=Sm.b3(C,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new kd(z,v)},hl.create(function($,v){this.v1=$,this.v2=v},function(r){var R=new fq;return R.subVectors(this.v2,this.v1),R.multiplyScalar(r),R.add(this.v1),R});var Io=hl.create(function(p,r,j){this.v0=p,this.v1=r,this.v2=j},function(D){var $,M,N;return $=Sm.b2(D,this.v0.x,this.v1.x,this.v2.x),M=Sm.b2(D,this.v0.y,this.v1.y,this.v2.y),N=Sm.b2(D,this.v0.z,this.v1.z,this.v2.z),new fq($,M,N)}),Tm=hl.create(function(w,N,U,R){this.v0=w,this.v1=N,this.v2=U,this.v3=R},function(n){var r,I,c;return r=Sm.b3(n,this.v0.x,this.v1.x,this.v2.x,this.v3.x),I=Sm.b3(n,this.v0.y,this.v1.y,this.v2.y,this.v3.y),c=Sm.b3(n,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new fq(r,I,c)}),Dp=function(I,K,t,N,Z,Q,m,v){xf.call(this),N=N!==g?N:.5,Z=Z!==g?Z:.5,v=v!==g?v:1,I=I||8,Q=Q||0,m=m||E;var p,U,x=1,f=v/2,j=[],B=[],u=this.vertices,$=this.faces,l=this.faceVertexUvs;for(U=0;x>=U;U++){var M=[],n=[],z=U/x,d=z*(Z-N)+N;for(p=0;I>=p;p++){var b=p/I,F=new fq,h=-(b*m+Q);F.z=d*G(h),F.y=-z*v+f,F.x=d*R(h),u.push(F),M.push(u.length-1),n.push(new kd(b,z))}j.push(M),B.push(n)}var X,r,_=(Z-N)/v;for(p=0;I>p;p++)for(0!==N?(X=u[j[0][p]].clone(),r=u[j[0][p+1]].clone()):(X=u[j[1][p]].clone(),r=u[j[1][p+1]].clone()),X.setY(P(X.x*X.x+X.z*X.z)*_).normalize(),r.setY(P(r.x*r.x+r.z*r.z)*_).normalize(),U=0;x>U;U++){var C=j[U][p],c=j[U+1][p],e=j[U+1][p+1],s=j[U][p+1],J=X.clone(),H=X.clone(),o=r.clone(),O=r.clone(),q=B[U][p].clone(),k=B[U+1][p].clone(),A=B[U+1][p+1].clone(),w=B[U][p+1].clone();$.push(new Ro(C,c,s,[J,H,O])),l[0].push([q,k,w]),$.push(new Ro(c,e,s,[H.clone(),o,O.clone()])),l[0].push([k.clone(),A,w.clone()])}if(K&&N>0)for(this.vertices.push(new fq(0,f,0)),p=0;I>p;p++){var C=j[0][p],c=j[0][p+1],e=this.vertices.length-1,J=new fq(0,1,0),H=new fq(0,1,0),o=new fq(0,1,0),q=B[0][p].clone(),k=B[0][p+1].clone(),A=new kd(k.x,0);$.push(new Ro(C,c,e,[J,H,o],null,1));var V=p/I*E,D=R(V),y=G(V),T=(p+1)/I*E,L=R(T),W=G(T);l[0].push([new kd(.5+.5*D,.5+.5*y),new kd(.5+.5*L,.5+.5*W),new kd(.5,.5)])}if(t&&Z>0)for(this.vertices.push(new fq(0,-f,0)),p=0;I>p;p++){var C=j[U][p+1],c=j[U][p],e=u.length-1,J=new fq(0,-1,0),H=new fq(0,-1,0),o=new fq(0,-1,0),q=B[U][p+1].clone(),k=B[U][p].clone();$.push(new Ro(C,c,e,[J,H,o],null,2));var V=p/I*E,D=R(V),y=G(V),T=(p+1)/I*E,L=R(T),W=G(T);l[0].push([new kd(.5+.5*L,.5-.5*W),new kd(.5+.5*D,.5-.5*y),new kd(.5,.5)])}};Dp.prototype=ho(dl);var uo=function(x,J,O,m,i,K,u){xf.call(this),u=u||.5,x=x||16,J=J||16,O=(O!==g?O:0)-D,m=m!==g?m:E,i=i!==g?i:0,K=K!==g?K:D;var Q,Z,X=[],p=[],d=this.vertices,N=this.faces,h=this.faceVertexUvs;for(Z=0;J>=Z;Z++){var W=[],B=[];for(Q=0;x>=Q;Q++){var P=Q/x,H=Z/J,f=new fq;f.x=-u*R(O+P*m)*G(i+H*K),f.y=u*R(i+H*K),f.z=u*G(O+P*m)*G(i+H*K),d.push(f),W.push(d.length-1),B.push(new kd(P,H))}X.push(W),p.push(B)}for(Z=0;J>Z;Z++)for(Q=0;x>Q;Q++){var V=X[Z][Q+1],$=X[Z][Q],s=X[Z+1][Q],r=X[Z+1][Q+1],T=d[V].clone().normalize(),I=d[$].clone().normalize(),U=d[s].clone().normalize(),w=d[r].clone().normalize(),C=p[Z][Q+1].clone(),z=p[Z][Q].clone(),o=p[Z+1][Q].clone(),y=p[Z+1][Q+1].clone();v(d[V].y)===u?(C.x=(C.x+z.x)/2,N.push(new Ro(V,s,r,[T,U,w])),h[0].push([C,o,y])):v(d[s].y)===u?(o.x=(o.x+y.x)/2,N.push(new Ro(V,$,s,[T,I,U])),h[0].push([C,z,o])):(N.push(new Ro(V,$,r,[T,I,w])),h[0].push([C,z,y]),N.push(new Ro($,s,r,[I.clone(),U,w.clone()])),h[0].push([z.clone(),o,y.clone()]))}};uo.prototype=ho(dl);var ae=function(Q,z,x,t,J,m){xf.call(this),Q=Q||.33,z=z||.17,t=t||8,x=x||6,J=J||0,m=m||E;for(var q=new fq,v=[],f=[],y=0;t>=y;y++)for(var n=y/t*E+D,k=0;x>=k;k++){var g=k/x*m+J;q.x=Q*R(g),q.z=-Q*G(g);var s=new fq,P=Q+z*R(n);s.x=P*R(g),s.z=-P*G(g),s.y=z*G(n),this.vertices.push(s),v.push(new kd(k/x,1-y/t)),f.push(s.clone().sub(q).normalize())}for(var y=1;t>=y;y++)for(var k=1;x>=k;k++){var M=(x+1)*y+k-1,r=(x+1)*(y-1)+k-1,I=(x+1)*(y-1)+k,S=(x+1)*y+k,Z=new Ro(M,r,S,[f[M].clone(),f[r].clone(),f[S].clone()]);this.faces.push(Z),this.faceVertexUvs[0].push([v[M].clone(),v[r].clone(),v[S].clone()]),Z=new Ro(r,I,S,[f[r].clone(),f[I].clone(),f[S].clone()]),this.faces.push(Z),this.faceVertexUvs[0].push([v[r].clone(),v[I].clone(),v[S].clone()])}this.computeFaceNormals()};ae.prototype=ho(dl);var oq=function(E,z,O){return E?(xf.call(this),E=E instanceof Array?E:[E],this.addShapeList(E,z),z.convertYZ!==!1&&_i(this,O),this.computeFaceNormals(),void 0):(E=[],void 0)},Np=oq.prototype=ho(xf.prototype);Np.addShapeList=function(U,q){for(var v=U.length,d=0;v>d;d++){var n=U[d];this.addShape(n,q)}},Np.addShape=function(c,l){function K(){if(l.bottom)for(var g=0;_>g;g++)e=u[g],L(e[2],e[1],e[0],!0);if(l.top)for(g=0;_>g;g++)e=u[g],L(e[0]+i*G,e[1]+i*G,e[2]+i*G,!1)}function $(){var G=0;for(J(x,G),G+=x.length,b=0,q=T.length;q>b;b++)W=T[b],J(W,G),G+=W.length}function J(C,U){for(var Z,h,q=C.length;--q>=0;){Z=q,h=q-1,0>h&&(h=C.length-1);var B=0,P=G;for(B=0;P>B;B++){var u=i*B,F=i*(B+1),N=U+Z+u,I=U+h+u,X=U+h+F,c=U+Z+F;s(N,I,X,c,C,B,P,Z,h)}}}function Y($,z,t){p.vertices.push(new fq($,z,t))}function L(f,g,w,z){f+=D,g+=D,w+=D,p.faces.push(new Ro(f,g,w,null,null,z?2:1));var s=z?M.generateBottomUV(p,c,l,f,g,w):M.generateTopUV(p,c,l,f,g,w);p.faceVertexUvs[0].push(s)}function s(u,k,r,z,O,T,E,Z,S){u+=D,k+=D,r+=D,z+=D,p.faces.push(new Ro(u,k,z)),p.faces.push(new Ro(k,r,z));var x=M.generateSideWallUV(p,c,O,l,u,k,r,z,T,E,Z,S);p.faceVertexUvs[0].push([x[0],x[1],x[3]]),p.faceVertexUvs[0].push([x[1],x[2],x[3]])}var h,r,n,R,U,m=l.amount,v=l.curveSegments||gb,G=l.steps||1,o=l.extrudePath,I=!1,M=new mm(l.repeatUVLength);o&&(h=o.getSpacedPoints(G),I=!0,r=l.frames!==g?l.frames:new xj.FrenetFrames(o,G,!1),n=new fq,R=new fq,U=new fq);var W,b,q,p=this,D=this.vertices.length,X=c.extractPoints(v),S=X.shape,T=X.holes,A=!Sm.isClockWise(S);if(A){for(S=S.reverse(),b=0,q=T.length;q>b;b++)W=T[b],Sm.isClockWise(W)&&(T[b]=W.reverse());A=!1}var u=Sm.triangulateShape(S,T),x=S;for(b=0,q=T.length;q>b;b++)W=T[b],S=S.concat(W);for(var B,e,i=S.length,_=u.length,F=0;i>F;F++)B=S[F],I?(R.copy(r.normals[0]).multiplyScalar(B.x),n.copy(r.binormals[0]).multiplyScalar(B.y),U.copy(h[0]).add(R).add(n),Y(U.x,U.y,U.z)):Y(B.x,B.y,0);var d;for(d=1;G>=d;d++)for(F=0;i>F;F++)B=S[F],I?(R.copy(r.normals[d]).multiplyScalar(B.x),n.copy(r.binormals[d]).multiplyScalar(B.y),U.copy(h[d]).add(R).add(n),Y(U.x,U.y,U.z)):Y(B.x,B.y,m/G*d);K(),$()};var xj=function(k,y,m,p,S){function M(w,A,B){return n.vertices.push(new fq(w,A,B))-1}xf.call(this),y=y||64,m=m||1,p=p||8,S=S||!1;var O,U,C,A,j,t,r,x,b,i,w,W,h,u,B,T,l,H,d,K,Q=[],n=this,s=y+1,V=new fq,F=new xj.FrenetFrames(k,y,S),v=F.tangents,Y=F.normals,a=F.binormals;for(this.tangents=v,this.normals=Y,this.binormals=a,b=0;s>b;b++)for(Q[b]=[],A=b/(s-1),x=k.getPointAt(A),O=v[b],U=Y[b],C=a[b],i=0;p>i;i++)j=i/p*E,t=-m*R(j),r=m*G(j),V.copy(x),V.x+=t*U.x+r*C.x,V.y+=t*U.y+r*C.y,V.z+=t*U.z+r*C.z,Q[b][i]=M(V.x,V.y,V.z);for(b=0;y>b;b++)for(i=0;p>i;i++)w=S?(b+1)%y:b+1,W=(i+1)%p,h=Q[b][i],u=Q[w][i],B=Q[w][W],T=Q[b][W],l=new kd(b/y,i/p),H=new kd((b+1)/y,i/p),d=new kd((b+1)/y,(i+1)/p),K=new kd(b/y,(i+1)/p),this.faces.push(new Ro(h,u,T)),this.faceVertexUvs[0].push([l,H,K]),this.faces.push(new Ro(u,B,T)),this.faceVertexUvs[0].push([H.clone(),d,K.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};xj.prototype=ho(dl),xj.FrenetFrames=function(K,a,Q){function c(){F[0]=new fq,W[0]=new fq,S=Number.MAX_VALUE,Z=v(I[0].x),R=v(I[0].y),i=v(I[0].z),S>=Z&&(S=Z,p.set(1,0,0)),S>=R&&(S=R,p.set(0,1,0)),S>=i&&p.set(0,0,1),O.crossVectors(I[0],p).normalize(),F[0].crossVectors(I[0],O),W[0].crossVectors(I[0],F[0])}var L,S,Z,R,i,g,d,p=new fq,I=[],F=[],W=[],O=new fq,z=new on,t=a+1,V=1e-4;for(this.tangents=I,this.normals=F,this.binormals=W,g=0;t>g;g++)d=g/(t-1),I[g]=K.getTangentAt(d),I[g].normalize();for(c(),g=1;t>g;g++)F[g]=F[g-1].clone(),W[g]=W[g-1].clone(),O.crossVectors(I[g-1],I[g]),O.length()>V&&(O.normalize(),L=r(vo(I[g-1].dot(I[g]),-1,1)),F[g].applyMatrix4(z.makeRotationAxis(O,L))),W[g].crossVectors(I[g],F[g]);if(Q)for(L=r(vo(F[0].dot(F[t-1]),-1,1)),L/=t-1,I[0].dot(O.crossVectors(F[0],F[t-1]))>0&&(L=-L),g=1;t>g;g++)F[g].applyMatrix4(z.makeRotationAxis(I[g],L*g)),W[g].crossVectors(I[g],F[g])};var lo=function(T,q,n,e){xf.call(this),q=q||18,n=n||0,e=e==U?E:e;for(var O=1/(T.length-1),l=1/q,f=0,Q=q;Q>=f;f++)for(var t=n+f*l*e,b=R(t),J=G(t),j=0,K=T.length;K>j;j++){var z=T[j],$=new fq;$.x=b*z.x-J*z.y,$.y=J*z.x+b*z.y,$.z=z.z,this.vertices.push($)}for(var P=T.length,f=0,Q=q;Q>f;f++)for(var j=0,K=T.length-1;K>j;j++){var N=j+P*f,F=N,D=N+P,b=N+1+P,g=N+1,p=f*l,o=j*O,C=p+l,H=o+O;this.faces.push(new Ro(F,g,D)),this.faceVertexUvs[0].push([new kd(p,o),new kd(p,H),new kd(C,o)]),this.faces.push(new Ro(D,g,b)),this.faceVertexUvs[0].push([new kd(C,o),new kd(p,H),new kd(C,H)])}this.mergeVertices(),_i(this),this.computeFaceNormals(),this.computeVertexNormals()};lo.prototype=ho(dl);var Ye=function(y,$){$=$||{};var Z=Wk.generateShapes(y,$);$.amount=$.amount!==g?$.amount:.5,$.convertYZ=!1,$.fill!==!1&&($.bottom=!0,$.top=!0),oq.call(this,Z,$)};Ye.prototype=ho(Np);var Dq=o.Node=function(){Sc(Dq,this)},Kq={X:Al,Y:Kj,Z:ih},Ip={X:0,Y:1,Z:2},_d={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},_r="xzy",xe=function(s,n,t){if(n){var A=n[0],q=n[1],O=n[2];"xzy"===t?(Kj(s,q),ih(s,O),Al(s,A)):"xyz"===t?(ih(s,O),Kj(s,q),Al(s,A)):"yxz"===t?(ih(s,O),Al(s,A),Kj(s,q)):"yzx"===t?(Al(s,A),ih(s,O),Kj(s,q)):"zxy"===t?(Kj(s,q),Al(s,A),ih(s,O)):"zyx"===t?(Al(s,A),Kj(s,q),ih(s,O)):(Kj(s,q),ih(s,O),Al(s,A))}};oi("Node",Ej,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:_r,_64O:0,_rotationX:0,_53O:0,_host:U,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return ki},_22Q:function(){return xb},getX:function(){return this.p().x},setX:function(p){this.p(p,this.p().y)},getY:function(){return this.p().y},setY:function(r){this.p(this.p().x,r)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(y){this.setAnchor(y,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(w){this.setAnchor(this.getAnchor().x,w)},getScaleX:function(){return this.getScale().x},setScaleX:function(o){this.setScale(o,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(z){this.setScale(this.getScale().x,z)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(r,P){jf(r,tk(U,U,this.r3(),this.getRotationMode())),this.translate3d(r[0]*P,r[1]*P,r[2]*P)},translateFront:function(w){this.translate3dBy([0,0,1],w)},translateBack:function(h){this.translate3dBy([0,0,-1],h)},translateLeft:function(b){this.translate3dBy([-1,0,0],b)},translateRight:function(v){this.translate3dBy([1,0,0],v)},translateTop:function(Y){this.translate3dBy([0,1,0],Y)},translateBottom:function(p){this.translate3dBy([0,-1,0],p)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(y,j,d){1===arguments.length&&(j=y[1],d=y[2],y=y[0]),this.p(y,d),this.setElevation(j)},translate3d:function(v,j,J){1===arguments.length&&(j=v[1],J=v[2],v=v[0]),this.translate(v,J),this.setElevation(this._54O+j)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(c,B,I){1===arguments.length&&(B=c[1],I=c[2],c=c[0]),this.setSize(c,I),this.setTall(B)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(v,U,n){1===arguments.length&&(U=v[1],n=v[2],v=v[0]),this.setRotationX(v),this.setRotation(-U),this.setRotationZ(n)},setRotationY:function(P){this.setRotation(-P)},getRotationY:function(){return-this._64O},lookAtDirection:function(A,u){u=u||nd;var N=this,T=Pq(A);u===nd?(N.r3([-L(A[1]/T),-i(A[2],A[0])+j,0]),N.setRotationMode("xzy")):u===Td?(N.r3(0,-i(A[2],A[0]),L(A[1]/T)),N.setRotationMode("zyx")):u===Qg?(N.r3(0,-i(A[2],A[0])+D,-L(A[1]/T)),N.setRotationMode("zyx")):u===Ij?(N.r3([-L(A[1]/T)+j,-i(A[2],A[0])+j,0]),N.setRotationMode("xzy")):u===Lb&&(N.r3([-L(A[1]/T)-j,-i(A[2],A[0])+j,0]),N.setRotationMode("xzy")),u===Rd&&(N.r3([-L(A[1]/T)+D,-i(A[2],A[0])+j,D]),N.setRotationMode("zxy"))},lookAt:function(Y,k){return this.lookAtDirection(pd(Y,this.p3()),k)},lookAtX:function(){var r=new sc,A=new sc,d=new sc,x=new qm,z=new qm,L=new o.Math.Euler;return function(n,_,g){_===Qg||_===Td?x.makeRotationAxis(new o.Math.Vector3(0,1,0),Math.PI/2):_===Ij||_===Lb?x.makeRotationAxis(new o.Math.Vector3(1,0,0),Math.PI/2):x.identity(),_===Lb||_===Td||_===Rd?(r.fromArray(this.p3()),A.fromArray(n)):(r.fromArray(n),A.fromArray(this.p3())),z.lookAt(r,A,g?d.fromArray(g):d.set(0,1,0)),L.setFromRotationMatrix(z.multiply(x),di.ReverseOrder(this.getRotationMode())),this.r3([L.x,L.y,L.z])}}(),getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(I){var s=this;if(s!==I&&s._host!==I){var i=s._host;i&&i._removeAttach(s),s._host=I,s._host&&s._host._addAttach(s),s.fp("host",i,I),s.onHostChanged(i,I)}},getAttaches:function(){return this._69O},_addAttach:function(g){var v=this;v._69O||(v._69O=new vc),v._69O.add(g),v.fp("attaches",U,g)},_removeAttach:function(D){var l=this;l._69O.remove(D),l._69O.isEmpty()&&delete l._69O,l.fp("attaches",D,U)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(m){var C=this;C._44I||(C._44I=new vc),C._42I||(C._42I=new vc),C._44I.add(m),C._42I.add(m),C._20I()},_4I:function(d){var o=this;o._44I||(o._44I=new vc),o._43I||(o._43I=new vc),o._44I.add(d),o._43I.add(d),o._20I()},_16I:function(q){var o=this;o._44I.remove(q),o._42I.remove(q),o._44I.isEmpty()&&delete o._44I,o._42I.isEmpty()&&delete o._42I,o._20I()},_18I:function(W){var I=this;I._44I.remove(W),I._43I.remove(W),I._44I.isEmpty()&&delete I._44I,I._43I.isEmpty()&&delete I._43I,I._20I()},_20I:function(){var d=this;if(delete d._45I,!d._44I||d._44I.isEmpty())return delete d._70O,void 0;var g;d._44I.each(function(S){S.isLooped()&&(g||(g={}),g[S._id]||(d._45I||(d._45I=new vc),d._45I.add(S),g[S._id]=S))}),g?(d._70O=new vc,d._44I.each(function(k){g[k._id]?"A"===g[k._id]||(g[k._id]="A",d._70O.add(k)):d._70O.add(k)})):d._70O=d._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(y){var o=this;o._46I||(o._46I=new vc),o._48I||(o._48I=new vc),o._46I.add(y),o._48I.add(y),o._19I()},_3I:function(b){var u=this;u._47I||(u._47I=new vc),u._48I||(u._48I=new vc),u._47I.add(b),u._48I.add(b),u._19I()},_15I:function(E){var H=this;H._46I.remove(E),H._48I.remove(E),H._46I.isEmpty()&&delete H._46I,H._48I.isEmpty()&&delete H._48I,H._19I()},_17I:function(v){var l=this;l._47I.remove(v),l._48I.remove(v),l._47I.isEmpty()&&delete l._47I,l._48I.isEmpty()&&delete l._48I,l._19I()},_19I:function(){var k=this;delete k._49I;var u=k._48I;if(u&&!u.isEmpty()){var S={};u.each(function(l){S[l._id]?k._49I||(k._49I=new vc):S[l._id]=l}),k._49I?u.each(function(i){S[i._id]&&(k._49I.add(i),delete S[i._id])}):k._49I=u}},getImage:function(){if(this._pendingCheckImageJSON){var U=u.getImage(this._image);U&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof ji&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(v){var p=this,P=p._image,O=p.getWidth(),E=p.getHeight();p._image=v,p.fp("image",P,v)&&(null!=v&&(Bf(v)||Do(v)&&/\.json$/i.test(v))&&(this._pendingCheckImageJSON=!0),p.fp(ke,O,p.getWidth()),p.fp(ko,E,p.getHeight()))},getElevation:function(){return this._54O},setElevation:function(O){var E=this;if(!E._50O){E._50O=1;var c=E._54O;E._54O=O,E.fp(Cs,c,O),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(U){var x=this;if(!x._49O){x._49O=1;var t=x._64O;x._64O=U,x.fp(Kn,t,U),delete x._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(L){var E=this;if(!E._51O){E._51O=1;var f=E._rotationX;E._rotationX=L,E.fp("rotationX",f,L),delete E._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(f){var N=this;if(!N._52O){N._52O=1;
var B=N._53O;N._53O=f,N.fp("rotationZ",B,f),delete N._52O}},getPosition:function(){return this._position},setPosition:function(u,d){var I=this;if(!I._50I){I._50I=1;var X;if(X=2===arguments.length?{x:u,y:d}:u,X.x!==I._position.x||X.y!==I._position.y){var m=I._position;I._position=X,I.fp(_l,m,X)}delete I._50I}},translate:function(e,D){var m=this._position;this.p(m.x+e,m.y+D)},getWidth:function(){var p=this;if(p._width>=0)return p._width;var B=p.getStyle("shape3d");if(B){var l=yj(B);if(l&&l.rawS3)return l.rawS3[0];if("billboard"===B||"plane"===B){var F=Dl(p.getStyle("shape3d.image"));return F?Zb(F,p):20}}var F=Dl(p._image);return F?Zb(F,p):20},setWidth:function(F){var N=this,t=N._width;N._width=F,N.fp(ke,t,F)},getHeight:function(){var g=this;if(g._height>=0)return g._height;var $=g.getStyle("shape3d");if($){var A=yj($);if(A&&A.rawS3)return A.rawS3[2];if("plane"===$){var u=Dl(g.getStyle("shape3d.image"));return u?Qk(u,g):20}if("billboard"===$)return 2}var u=Dl(g._image);return u?Qk(u,g):20},setHeight:function(f){var p=this,R=p._height;p._height=f,p.fp(ko,R,f)},getTall:function(){var n=this;if(n._tall>=0)return n._tall;var z=n.getStyle("shape3d");if(z){var t=yj(z);if(t&&t.rawS3)return t.rawS3[1];if("billboard"===z){var o=Dl(n.getStyle("shape3d.image"));return o?Qk(o,n):20}if("plane"===z)return 2}return 20},setTall:function(b){var f=this,_=f._tall;f._tall=b,f.fp("tall",_,b)},setSize:function(S,f){var X=this;2===arguments.length?(X.setWidth(S),X.setHeight(f)):(X.setWidth(S.width),X.setHeight(S.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(U,e,z,m,c){var j=this,T=j.getAnchor(),p=j.getScale();arguments.length<=2&&(c=e,e=U.y,z=U.width,m=U.height,U=U.x);var v=c&&p.x<0?1-T.x:T.x,W=c&&p.y<0?1-T.y:T.y;j.p(U+z*v,e+m*W),c&&(z/=Math.abs(p.x),m/=Math.abs(p.y)),j.setWidth(z),j.setHeight(m)},getMatrix:function(){var K=this,p=K._64O,f=K._position,I=K.getScale();return new hm(p,f.x,f.y,I.x,I.y)},getAnchorRect:function(){var d=this,f=d.getWidth(),g=d.getHeight(),q=d.getAnchor();return{x:-f*q.x,y:-g*q.y,width:f,height:g}},toLocal:function(U){return this.getMatrix().tfi(U)},toGlobal:function(f){return this.getMatrix().tf(f)},getAttachPosition:function(){var U=new hm;return function(B,k,g,S){g=g||0,S=S||0;var $=this,d=$.getAnchor(),p=$._64O,f=$._position,R=$.getScale();return U.setFromTransform(p,f.x,f.y).tf({x:g+R.x*$.getWidth()*(B-d.x),y:S+R.y*$.getHeight()*(k-d.y)})}}(),isInRect:function(y){y=this.toLocal(y);var w=this.getWidth(),c=this.getHeight();return y.x+=w*this.getAnchorX(),y.y+=c*this.getAnchorY(),!(y.x<0||y.y<0||y.x>w||y.y>c)},getRect:function(){var p=this,y=p.getWidth(),o=p.getHeight(),f=p.getAnchor(),O={x:-y*f.x,y:-o*f.y,width:y,height:o},X=p.getMatrix();return O=Pb([X.tf(O.x,O.y),X.tf(O.x+O.width,O.y),X.tf(O.x+O.width,O.y+O.height),X.tf(O.x,O.y+O.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var W=this,p=W.getAnchor(),F=W._anchorElevation;return{x:p.x,y:F,z:p.y}},setAnchorElevation:function(T){var y=this,H=y._anchorElevation;return H!==T?(y._anchorElevation=T,y.fp("anchorElevation",H,T),!0):!1},setAnchor3d:function(n,H,k,T){var J,P=this;"number"==typeof n?J={x:n,y:H,z:k}:(J=n.length?{x:n[0],y:n[1],z:n[2]}:n,T=H);var Z=P.getDataModel();Z&&Z.beginTransaction();var m=P.getAnchor3d(),O=P.setAnchor(J.x,J.z);if(P.setAnchorElevation(J.y)&&(O=!0),O&&T&&!xd){P.getAnchor3d();var I=Nn(P),u=jf([J.x-m.x,J.y-m.y,J.z-m.z],I);P.p3(u)}return Z&&Z.endTransaction(),O},getAnchor:function(){var $=this;if($.hasOwnProperty("_anchor"))return $._anchor;var o=Dl($._image);return o&&o.anchorX!==g?{x:o.anchorX,y:o.anchorY}:$._anchor},setAnchor:function(g,C,p){var k,l=this;"number"==typeof g?k={x:g,y:C}:(k=g.length?{x:g[0],y:g[1]}:g,p=C);var u=l.getAnchor();if(u.x!==k.x||u.y!==k.y){var n=l.getDataModel();if(n&&n.beginTransaction(),l._anchor=k,l.fp("anchor",u,k),p&&!xd){var i=l.getPosition(),Z=l.getSize(),x=l.getRotation(),e=l.getScale(),z=-Z.width*(u.x-k.x)*e.x,f=-Z.height*(u.y-k.y)*e.y,K=G(x),F=R(x);l.setPosition(i.x+F*z-K*f,i.y+K*z+F*f)}return n&&n.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(o,y){var Z,g=this;Z=2===arguments.length?{x:o,y:y}:o;var m=g.getScale();(m.x!==Z.x||m.y!==Z.y)&&(g._scale=Z,g.fp("scale",m,Z))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var X=this,A=X._scaleTall,M=X.getScale();return[M.x,A,M.y]},getFinalScale3d:function(){var H=this,y=H.s3(),j=H._dynamicScale3d,Z=H.getScale3d();return y&&(Z[0]*=y[0],Z[1]*=y[1],Z[2]*=y[2]),j&&(Z[0]*=j[0],Z[1]*=j[1],Z[2]*=j[2]),Z},getFinalRotation3d:function(){var x=this;return x._dynamicRotation||x.r3()},setScaleTall:function(i){var k=this,X=k._scaleTall;X!==i&&(k._scaleTall=i,k.fp("scaleTall",X,i))},setScale3d:function(Y,m,r){var n,v=this;n="number"==typeof Y?{x:Y,y:m,z:r}:Y.length?{x:Y[0],y:Y[1],z:Y[2]}:Y,v.setScaleTall(n.y),v.setScale(n.x,n.z)},getCorners:function(J,k){J==U&&(J=0),k==U&&(k=J);var P=this,f=P.getAnchor(),z=P.getWidth(),c=P.getHeight(),A=-z*f.x-J,o=-c*f.y-k,I=z+2*J,g=c+2*k,O=P.getMatrix();return[O.tf(A,o),O.tf(A,o+g),O.tf(A+I,o+g),O.tf(A+I,o)]},getEditControlPoints:function(Z,A,I){A==U&&(A=0),I==U&&(I=A);var _=this,t=_.getAnchor(),r=_.getWidth(),X=_.getHeight(),$=-r*t.x-A,n=-X*t.y-I,D=r+2*A,k=X+2*I;if(Z)return[{x:$,y:n},{x:$,y:0},{x:$,y:n+k},{x:0,y:n+k},{x:$+D,y:n+k},{x:$+D,y:0},{x:$+D,y:n},{x:0,y:n}];var u=_.getMatrix();return[u.tf($,n),u.tf($,0),u.tf($,n+k),u.tf(0,n+k),u.tf($+D,n+k),u.tf($+D,0),u.tf($+D,n),u.tf(0,n)]},rotateAt:function(U,o,c){var _=this,d=_._position,X=_._64O,K=new hm(X,d.x,d.y).tf(U,o),r=P(U*U+o*o),j=i(d.y-K.y,d.x-K.x)+c;_.setRotation(X+c),_.p(K.x+r*R(j),K.y+r*G(j))},onParentChanged:function(){Dq.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(z){z._7I()})},onPropertyChanged:function(){var c={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(r){c[r]=!0}),function($){var B=this;Dq.superClass.onPropertyChanged.call(B,$),c[$.property]&&!B._layoutUpdating&&B.updateLayoutParameters(null,$.property),B._69O&&B._69O.each(function(H){H.handleHostPropertyChange($)}),B._49I&&B._49I.each(function(K){K.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(M){this.updateAttach(M)},onStyleChanged:function(Z){Dq.superClass.onStyleChanged.apply(this,arguments),lq[Z]&&this.updateAttach()},updateAttach:function(B){var a=this;a._51I||xd||(a._51I=1,a._71O(B),delete a._51I)},_71O:function(y){var E,p,A,_,P,C,l=this,T=l._host,t=y?y.property:U,Z=y?y.oldValue:U,e=y?y.newValue:U;if(T instanceof o.Grid){if(t===Cs)l.setElevation(l._54O+e-Z);else if(!y||jg[t]){if(E=l.s("attach.row.index"),p=l.s("attach.column.index"),A=T.getCellRect(E,p),!A)return;_=l.s("attach.row.span"),P=l.s("attach.column.span"),(1!==_||1!==P)&&(A=io(A,T.getCellRect(E+_-1,p+P-1))),ns(A,l,"attach.padding",1),l.setRect(A)}}else if(T instanceof ub&&(C=l.s("attach.index"))>=0&&(!y||Fe[t])){var w=l.s("attach.thickness");w!=U&&l.setHeight(T.getThickness()*w);var u=l.s("attach.offset"),O=T.getPoints(),H=O.size();if(H>C){var j=O.get(C),X=H===C+1?O.get(0):O.get(C+1),$=[X.x-j.x,X.y-j.y],x=Pq($);if(x){l.s("attach.offset.relative")&&(u*=x),l.s("attach.offset.opposite")&&(u=x-u);var D={x:j.x+$[0]/x*u,y:j.y+$[1]/x*u},K=l.s("attach.gap");K&&(l.s("attach.gap.relative")&&(K*=T.getThickness()),D=Kc(U,D,X,K)),l.p(D),l.setRotation(i($[1],$[0]))}}}else y&&(t===_l?l.translate(e.x-Z.x,e.y-Z.y):t===Cs?l.setElevation(l._54O+e-Z):kj[t]?l._11Q(T,t,e-Z):("anchor"===t||"width"===t||"height"===t||"scale"===t)&&l.layout(T))},_11Q:function(){var I=new o.Math.Euler,L=o.Math.Euler.ReverseOrder,i=new o.Math.Vector2,u=new o.Math.Vector2;return function(q,Z,n){var F=this,S=q.p3(),J=q.r3(),R=F.p3(),r=F.r3();if(Z===Kn&&(Z="rotationY",n=-n),(Z===Kn||"rotationY"===Z)&&0===r[0]&&0===r[2]&&0===J[0]&&0===J[2]&&0===R[1]&&0===S[1])return F.setRotation(-r[1]-n),i.set(R[0],R[2]).rotateAround(u.set(S[0],S[2]),-n),F.p(i.x,i.y),void 0;var f=_d[q.getRotationMode()],W=f[0],X=f[1],k=f[2],E=Kq[W],a=Kq[X],K=Kq[k],Y=vk();Z===Kn+W?(K(Y,J[Ip[k]]),a(Y,J[Ip[X]]),E(Y,n),a(Y,-J[Ip[X]]),K(Y,-J[Ip[k]])):Z===Kn+X?(K(Y,J[Ip[k]]),a(Y,n),K(Y,-J[Ip[k]])):Z===Kn+k&&K(Y,n);var P=pd(R,S);jf(P,Y),F.p3(S[0]+P[0],S[1]+P[1],S[2]+P[2]);var C=F.getRotationMode();xe(Y,F.r3(),C),I.setFromRotationMatrix(Y,L(C)),F.r3([I.x,I.y,I.z])}}(),isHostOn:function(c){var x=this;if(x._host&&c&&c._69O)for(var K={},_=x._host;_&&_!==x&&!K[_._id];){if(_===c)return!0;K[_._id]=_,_=_._host}return!1},isLoopedHostOn:function(t){return this.isHostOn(t)&&t.isHostOn(this)},getScaledSize:function(){var P=this.getSize(),W=this.getScale();return P.width*=Math.abs(W.x),P.height*=Math.abs(W.y),P},layout:function(X){if(X=X||this.getHost()){var Z=this,f=Z.s("layout.h")||"center",N=Z.s("layout.v")||"center";if("center"!==f||"center"!==N){var r=new o.Math.Vector2,z=X.getPosition(),c=X.getAnchor(),d=X.getScaledSize();Z.getPosition();var I,i,M,m,n,l=1,T=1;switch(Z._layoutUpdating=!0,f){case"left":r.setX(Z._layoutHValue-c.x*d.width);break;case"right":r.setX((1-c.x)*d.width-Z._layoutHValue);break;case"leftright":I=d.width-Z._layoutHValue[2],M=Z.getRotation()-X.getRotation(),m=Math.abs(Math.sin(M)),n=Math.abs(Math.cos(M)),l+=n*I/Z._layoutHValue[3],T+=m*I/Z._layoutHValue[4],r.setX(Z._layoutHValue[1]+(Z._layoutHValue[5]-c.x)*d.width);break;case"center":r.setX((.5-c.x)*d.width-Z._layoutHValue);break;case"scale":M=Z.getRotation()-X.getRotation(),m=Math.abs(Math.sin(M)),n=Math.abs(Math.cos(M)),r.setX((.5-c.x)*d.width-Z._layoutHValue[1]*d.width/Z._layoutHValue[0]),i=d.width/Z._layoutHValue[2]-1,l+=n*i,T+=m*i}switch(N){case"top":r.setY(Z._layoutVValue-c.y*d.height);break;case"bottom":r.setY((1-c.y)*d.height-Z._layoutVValue);break;case"topbottom":M||(M=Z.getRotation()-X.getRotation(),m=Math.abs(Math.sin(M)),n=Math.abs(Math.cos(M))),I=d.height-Z._layoutVValue[2],l+=m*I/Z._layoutVValue[3],T+=n*I/Z._layoutVValue[4],r.setY(Z._layoutVValue[1]+(Z._layoutVValue[5]-c.y)*d.height);break;case"center":r.setY((.5-c.y)*d.height-Z._layoutVValue);break;case"scale":M||(M=Z.getRotation()-X.getRotation(),m=Math.abs(Math.sin(M)),n=Math.abs(Math.cos(M))),r.setY((.5-c.y)*d.height-Z._layoutVValue[1]*d.height/Z._layoutVValue[0]),i=d.height/Z._layoutVValue[2]-1,l+=m*i,T+=n*i}(1!==l||1!==T)&&("leftright"===f||"scale"===f?Z.setSize(Z._layoutHValue[3]*l,Z._layoutHValue[4]*T):Z.setSize(Z._layoutVValue[3]*l,Z._layoutVValue[4]*T)),r.rotateAround(null,X.getRotation()),this.setPosition(r.x+z.x,r.y+z.y),Z._layoutUpdating=g}}},updateLayoutParameters:function(M,C){if(M=M||this.getHost()){var b=this,e=b.s("layout.h"),W=b.s("layout.v");if(e||W){var B,J,E,q,H,N,U=new o.Math.Vector2,s=M.getPosition(),G=M.getAnchor(),n=M.getScaledSize(),K=b.getPosition(),k=b.getSize();switch(U.set(K.x-s.x,K.y-s.y),U.rotateAround(null,-M.getRotation()),e){case"left":b._layoutHValue=U.x+G.x*n.width;break;case"right":b._layoutHValue=-U.x+(1-G.x)*n.width;break;case"center":b._layoutHValue=-U.x+(.5-G.x)*n.width;break;case"leftright":case"scale":"scale"===e?B=-U.x+(.5-G.x)*n.width:(J=b.getAnchor(),E=b.getRotation()-M.getRotation(),q=Math.cos(E),H=Math.sin(E),N=-Math.min(-J.x*q+J.y*H,-J.x*q-(1-J.y)*H,(1-J.x)*q+J.y*H,(1-J.x)*q-(1-J.y)*H),B=U.x-(N-G.x)*n.width),"position"===C&&"object"==typeof b._layoutHValue?(b._layoutHValue[0]=n.width,b._layoutHValue[1]=B):b._layoutHValue=[n.width,B,n.width,k.width,k.height,N]}switch(W){case"top":b._layoutVValue=U.y+G.y*n.height;break;case"bottom":b._layoutVValue=-U.y+(1-G.y)*n.height;break;case"center":b._layoutVValue=-U.y+(.5-G.y)*n.height;break;case"topbottom":case"scale":"scale"===W?B=-U.y+(.5-G.y)*n.height:(E||(J=b.getAnchor(),E=b.getRotation()-M.getRotation(),q=Math.cos(E),H=Math.sin(E)),N=-Math.min(-J.x*H-J.y*q,-J.x*H+(1-J.y)*q,(1-J.x)*H-J.y*q,(1-J.x)*H+(1-J.y)*q),B=U.y-(N-G.y)*n.height),"position"===C&&"object"==typeof b._layoutVValue?(b._layoutVValue[0]=n.height,b._layoutVValue[1]=B):b._layoutVValue=[n.height,B,n.height,k.width,k.height,N]}}}},getSerializableProperties:function(){var A=Dq.superClass.getSerializableProperties.call(this);return Pk(A,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),A}});var ic=o.Edge=function(S,W){var o=this;Sc(ic,o),o.setSource(S),o.setTarget(W)};oi("Edge",Ej,{_icon:"edge_icon",getUIClass:function(){return xn},_22Q:function(){return Qr},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(z){var M=this;if(M._source!==z){var c=M._source;M._source=z,c&&c._16I(M),z&&z._2I(M),M._7I(),M.fp("source",c,z)}},setTarget:function(j){var _=this;if(_._target!==j){var A=_._target;_._target=j,A&&A._18I(_),j&&j._4I(_),_._7I(),_.fp("target",A,j)}},isLooped:function(){var i=this;return i._source===i._target&&!!i._source&&!!i._target},onPropertyChanged:function(){},_7I:function(){var g,o=this,X=Zo(o);o._40I!==X&&(g=this._40I,g&&g._15I(o),o._40I=X,X&&X._1I(o),o.fp("sourceAgent",g,X),mj(g,o._41I),mj(X,o._41I));var L=Ac(o);o._41I!==L&&(g=o._41I,g&&g._17I(o),o._41I=L,L&&L._3I(o),o.fp("targetAgent",g,L),mj(g,o._40I),mj(L,o._40I))},_22I:function(L){this._52I=L,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var E=this;return E._52I&&E._52I.get(0)!==E&&!E.getStyle(oe)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var T=this,n=T._52I;return n&&!T.getStyle(oe)&&n.size()>1&&T===n.get(0)},toggle:function(){var l=this._52I,w=!this.s(oe);l&&l.size()>1&&(l.each(function(A){A.s(oe,w)}),l.getSiblings().each(function(v){v!==l&&v.each(function(m){m.fp("edgeGroup",U,v)})}))},setStyle:function(d,L){(d===er||"edge.segments"===d)&&(L=mi(L)),ic.superClass.setStyle.call(this,d,L)},onStyleChanged:function(J){ic.superClass.onStyleChanged.apply(this,arguments),Wf[J]&&mj(this._41I,this._40I)},getSerializableProperties:function(){var I=ic.superClass.getSerializableProperties.call(this);return Pk(I,{source:1,target:1}),I}});var cc=o.Group=function(){Sc(cc,this)};oi("Group",Dq,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Hj},onChildAdded:function(){cc.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){cc.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var W=this;if(!W._54I&&!xd){var q=W.getChildrenRect();q&&(W._53I=1,W.p(wd(W.s("group.position"),q,W.getSize())),delete W._53I)}},getChildrenRect:function(){var v,o=this;return o.eachChild(function(u){_h(u)&&(v=io(v,o.getChildRect(u)))}),v},getChildRect:function(k){var S;return _h(k)&&k.s(xh)&&(rg(k)&&k.isExpanded()&&k.eachChild(function(O){S=io(S,k.getChildRect(O))}),!S&&k.getRect&&(S=k.getRect())),S},setPosition:function(T,z){var W=this;if(!W._54I){var k;k=2===arguments.length?{x:T,y:z}:T,xd||W._53I||(W._54I=1,xq(W._children,k.x-W._position.x,k.y-W._position.y),delete W._54I),cc.superClass.setPosition.call(this,k)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(u){var G=this;if(G._57O!==u){var y=G._57O;G._57O=u,G.fp("expanded",y,G._57O),G._fireInvalidateDeep(),G._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(R){rg(R)?R._fireInvalidateDeep():R.iv()})},_8I:function(){cc.superClass._8I.call(this),this.eachChild(function(M){_h(M)&&M._8I()})},onStyleChanged:function(z){cc.superClass.onStyleChanged.apply(this,arguments),"group.position"===z&&this._81I()},getSerializableProperties:function(){var U=cc.superClass.getSerializableProperties.call(this);return U.expanded=1,U}});var Vf=o.Block=function(){Sc(Vf,this)};oi("Block",Dq,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return is},onChildAdded:function(){Vf.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Vf.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var Y=this;if(!xd&&!Y._updatingToChildren&&Y._syncSize&&!Y._freezeSyncFromChildren){var $,j,A,w,q,P=[],Z=Y.getRotation();if(Y.eachChild(function(G){_h(G)&&P.push.apply(P,G.getCorners())}),P.length){Y._updatingFromChildren=1;var J=R(-Z),n=G(-Z),e=1/0,H=-1/0,t=1/0,S=-1/0;for(w=0,q=P.length;q>w;w++)A=P[w],$=A.x,j=A.y,A.x=J*$-n*j,A.y=n*$+J*j,e=s(e,A.x),H=N(H,A.x),t=s(t,A.y),S=N(S,A.y);var B=Y.getScale();Y.setSize(v((H-e)/B.x),v((S-t)/B.y));var u;B.x<0&&(u=e,e=H,H=u),B.y<0&&(u=t,t=S,S=u),J=R(Z),n=G(Z);var z=Y.getAnchor();$=e+(H-e)*z.x,j=t+(S-t)*z.y,Y.setPosition(J*$-n*j,n*$+J*j),delete Y._updatingFromChildren}}},setPosition:function(n,M){var e=this;if(!e._updatingToChildren){var C;C=2===arguments.length?{x:n,y:M}:n,xd||e._updatingFromChildren||(e._updatingToChildren=1,xq(e._children,C.x-e._position.x,C.y-e._position.y),delete e._updatingToChildren),Vf.superClass.setPosition.call(this,C)}},setWidth:function(X){return this.setSize(X,this.getHeight())},setHeight:function($){return this.setSize(this.getWidth(),$)},setSize:function(l,V){1>l&&(l=1),1>V&&(V=1);var Q=this;if(!Q._updatingToChildren){2!==arguments.length&&(V=l.height,l=l.width);var n=Q.getWidth(),w=Q.getHeight();if(l!==n&&Vf.superClass.setWidth.call(Q,l),V!==w&&Vf.superClass.setHeight.call(Q,V),!xd&&!Q._updatingFromChildren){Q._updatingToChildren=1;var x=l/n,m=V/w;Q._adjustChildScaleOrSize(x,m,"size"),delete Q._updatingToChildren,Q.updateFromChildren()}}},_adjustChildScaleOrSize:function(w,J,W){var E=this;if(E._syncSize){var f=E.getPosition(),z=E.getRotation();E.getScale(),E.eachChild(function(T){if(_h(T)){var y=T.getPosition(),K=T.getRotation(),O=T.getWidth(),$=T.getHeight(),d=T.getScale(),Q=d.x*O,C=d.y*$,q=new hm(K,y.x,y.y,Q,C);q.translate(-f.x,-f.y),q.rotate(-z),K=i(q.b*Math.sign(Q),q.a*Math.sign(Q)),q.scale(w,J);var k,I,_,x=R(K);if(Math.abs(x)<.001?(k=G(K),I=q.b/k,_=-q.c/k):(I=q.a/x,_=q.d/x),"scale"===W)T.setScale(I/O,_/$);else if("size"===W){var p=I/d.x,l=_/d.y;T.setScale(Ai(I)*Math.abs(d.x),Ai(_)*Math.abs(d.y)),T.setSize(Math.max(.1,Math.abs(p)),Math.max(.1,Math.abs(l)))}q.rotate(z),q.translate(f.x,f.y),T.setPosition(q.tx,q.ty)}})}},_calcChangeFactor:function(Q,E,l,G){var y,V,k,H;return y=v(Q),V=v(l),k=y>V?y/V:V/y,y=v(E),V=v(G),H=y>V?y/V:V/y,N(k,H)},setAnchor:function(){var H=this;if(!H._updatingToChildren){var A=H.getAnchor();if(Vf.superClass.setAnchor.apply(H,arguments),!xd&&!H._updatingFromChildren&&H._syncSize){H._updatingToChildren=1;var f=H.getAnchor();H.getPosition();var I=H.getSize(),r=H.getScale(),$=H.getRotation(),V=-I.width*r.x*(A.x-f.x),F=-I.height*r.y*(A.y-f.y),E=G($),x=R($),s=x*V-E*F,D=E*V+x*F;H.eachChild(function(z){if(_h(z)){var k=z.getPosition();z.setPosition(k.x-s,k.y-D)}}),delete H._updatingToChildren}}},setRotation:function(q){var p=this;if(!p._updatingToChildren){var $=p.getRotation();if(Vf.superClass.setRotation.apply(p,arguments),!xd&&!p._updatingFromChildren){p._updatingToChildren=1;var N=p.getPosition(),X=q-$;p.eachChild(function(T){if(_h(T)){var k=T.getMatrix();k.translate(-N.x,-N.y),k.rotate(X),k.translate(N.x,N.y);var O=Math.sign(T.getScale().x);T.setRotation(i(k.b*O,k.a*O)),T.setPosition(k.tx,k.ty)}}),delete p._updatingToChildren}}},setScale:function(U,b){var M=this;if(!M._updatingToChildren){null==b&&(b=U.y,U=U.x);var q=M.getScale();if(v(U)<.01&&(U=.01*(Ai(U)||Ai(q.x))),v(b)<.01&&(b=.01*(Ai(b)||Ai(q.y))),Vf.superClass.setScale.call(M,U,b),!xd&&!M._updatingFromChildren){M._updatingToChildren=1;var z=U/q.x,L=b/q.y;M._adjustChildScaleOrSize(z,L,"size"),delete M._updatingToChildren,M.updateFromChildren()}}},getSerializableProperties:function(){var r=Vf.superClass.getSerializableProperties.call(this);return r.clickThroughEnabled=1,r.syncSize=1,r}});var Nd=o.Grid=function(){Sc(o.Grid,this)};oi("Grid",Dq,{IRotatable:!1,_icon:"grid_icon",_image:U,getUIClass:function(){return Mj},setRotation:function(){},getCellRect:function(e,x){var t=this,V=t.s("grid.row.count"),B=t.s("grid.column.count");if(0>=V||0>=B||0>e||e>=V||0>x||x>=B)return U;var q,K,Q,P=t.getRect(),C=t.s("grid.row.percents"),W=t.s("grid.column.percents");if(ns(P,t,"grid.border",-1),C&&C._as&&(C=C._as),W&&W._as&&(W=W._as),C&&C.length===V){for(Q=0,q=0;e>q;q++)Q+=P.height*C[q];P.y+=Q,P.height=P.height*C[e]}else P.height=P.height/V,P.y+=P.height*e;if(W&&W.length===B){for(K=0,q=0;x>q;q++)K+=P.width*W[q];P.x+=K,P.width=P.width*W[x]}else P.width=P.width/B,P.x+=P.width*x;return fo(P,-t.s("grid.gap")),P}});var xm=o.Text=function(){Sc(xm,this),this.setSize(100,50),this.s("text","TEXT")};oi("Text",Dq,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return ui},setWidth:function(U){U||(U=.001),xm.superClass.setWidth.call(this,U)},setHeight:function(F){F||(F=.001),xm.superClass.setHeight.call(this,F)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),nk("__text__",{width:{value:100,isSafeFunc:!0,func:function(C){return C._width}},height:{value:50,isSafeFunc:!0,func:function(b){return b._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var ub=o.Shape=function(){Sc(ub,this),this._59O=new vc};ub.__de__=Zi,oi("Shape",Dq,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Dg},_22Q:function(){return rc},getLength:function(i){return Lm(Wl(this._59O,this._58O,i,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var s=this._58O;return s?new vc(s._as.slice(0)):s},setSegments:function(M){var Q=this._58O;M=M?zc(M)?new vc(M.slice(0)):new vc(M._as.slice(0)):null,(Q&&M&&Q._as.join(",")!==M._as.join(",")||Q!==M)&&(this._58O=M,this.fp("segments",Q,M))},getPoints:function(){return this._59O},toPoints:function(){var J=this._59O;return new vc(J._as.slice(0))},setPoints:function(w,F){var l=this,Z=l._59O;w=w?zc(w)?new vc(w.slice(0)):new vc(w._as.slice(0)):new vc;var C,a,O,q,S,W;F&&(C=l.getPosition(),W=new hm(l.getRotation(),0,0,l.getScale().x,l.getScale().y)),(Z&&w&&Z._as.join(",")!==w._as.join(",")||Z!==w)&&(l._59O=w,l.fs(),l.fp("points",Z,w)),F&&(a=l.getPosition(),O=a.x-C.x,q=a.y-C.y,S=W.tf(O,q),l.setPosition(a.x-O+S.x,a.y-q+S.y))},addPoint:function(v,A,l){var y=this.toPoints();y.add(v,A),this.setPoints(y,l)},setPoint:function(C,N,I){var t=this.toPoints();t.set(C,N),this.setPoints(t,I)},removePointAt:function(q){var A=this.toPoints();A.removeAt(q),this.setPoints(A)},setWidth:function(k){var Y=this;if(1>k&&(k=1),!Y._55I&&!xd&&Y.getWidth()){Y._55I=1;var i=Y._position.x,_=k/Y.getWidth(),h=Y.toPoints(),Z=new vc;h.each(function(K){Z.add({x:(K.x-i)*_+i,y:K.y,e:K.e})}),Y.setPoints(Z),Ub(Y,[_,0,0,1,i*(1-_),0]),Y.fs(),delete Y._55I}ub.superClass.setWidth.call(Y,k)},setHeight:function(J){var $=this;if(1>J&&(J=1),!$._55I&&!xd&&$.getHeight()){$._55I=1;var A=$._position.y,t=J/$.getHeight(),j=$.toPoints(),T=new vc;j.each(function(N){T.add({x:N.x,y:(N.y-A)*t+A,e:N.e})}),$.setPoints(T),Ub($,[1,0,0,t,0,A*(1-t)]),$.fs(),delete $._55I}ub.superClass.setHeight.call($,J)},setAnchorElevation:function(s){var t=this;t._55I=!0;var L=t._updatingAnchor3d,I=!xd&&!L;if(I){var r,f=s,B=t.getAnchorElevation(),J=t.getTall();r=J*(B-f),t.shiftPointsElevation(r)}var P=ub.superClass.setAnchorElevation.apply(t,arguments);return L||delete t._55I,P},getShapeElevation:function(){var M=this,b=M._54O;return b-(M.getTall()||0)*(M._anchorElevation-.5)},setAnchor3d:function(G,o,b,I){var R,c=this;"number"==typeof G?R={x:G,y:o,z:b}:(R=G.length?{x:G[0],y:G[1],z:G[2]}:G,I=o),c._55I=!0,c._updatingAnchor3d=!0;var U=c.getDataModel();if(U&&U.beginTransaction(),!xd){var z=c.getAnchor3d(),M=c.getSize(),q=c.getTall(),t=M.width*(z.x-R.x),s=M.height*(z.z-R.z),$=q*(z.y-R.y);I||c.shiftPoints(t,s,$);var D=c.p3()}var j=ub.superClass.setAnchor3d.apply(c,arguments);if(!xd&&I){var e=c.p3();c.shiftPoints(e[0]-D[0]+t,e[2]-D[2]+s,e[1]-D[1]+$)}return U&&U.endTransaction(),delete c._updatingAnchor3d,delete c._55I,j},setAnchor:function(R,M,o){var X=this;X._55I=!0;var x=X._updatingAnchor3d,t=!xd&&!x;if(t){var H,q,O;"number"==typeof R?O={x:R,y:M}:(O=R.length?{x:R[0],y:R[1]}:R,o=M);var k=X.getAnchor(),S=X.getSize();H=S.width*(k.x-O.x),q=S.height*(k.y-O.y),o||X.shiftPoints(H,q);var w=X.getPosition()}var y=ub.superClass.setAnchor.apply(X,arguments);if(t){var j=X.getPosition();o&&X.shiftPoints(j.x-w.x+H,j.y-w.y+q)}return x||delete X._55I,y},shiftPoints:function(K,p,F){var I=this,P=I.getElevation()||0,z=I.toPoints(),l=new vc;z.each(function(G){var $=G.e;F&&($=($==U?P:$)+F),l.add({x:G.x+K,y:G.y+p,e:$})}),I.setPoints(l),I.fs()},shiftPointsElevation:function(i){return this.shiftPoints(0,0,i)},setPosition:function(z,i){var v,c=this;if(!c._28Q){if(c._28Q=1,!c._55I&&!xd){v=2===arguments.length?{x:z,y:i}:z;var T=v.x-c._position.x,n=v.y-c._position.y;if(0===T&&0===n)return delete c._28Q,void 0;c._55I=1,c.shiftPoints(T,n),Ub(c,[1,0,0,1,T,n]),delete c._55I}ub.superClass.setPosition.apply(c,arguments),delete c._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var B=this;if(2!==B._59O.size())return!1;var W=B._58O;return W?2===W.size()&&1===W.get(0)&&2===W.get(1)?!0:!1:!0},fireShapeChange:function(){var T=this;if(!T._55I&&!xd){var c=Pb(T._59O);c&&(T._55I=1,T.setRect(c),delete T._55I)}T.fp(wr,!1,!0)},getSerializableProperties:function(){var k=ub.superClass.getSerializableProperties.call(this);return k.segments=1,k.points=1,k.thickness=1,k.closePath=1,k}});var nn=o.Polyline=function(){Sc(nn,this),this.s({"shape.background":null,"shape.border.width":2})};oi("Polyline",ub,{_icon:"polyline_icon",_22Q:function(){return mk},getUIClass:function(){return So},setClosePath:function(){},setTall:function(H){var J=this;if(!J._55I&&!J._24Q&&!xd&&J.getTall()){J._24Q=1;var R=J._54O,s=H/J.getTall();J._59O.each(function(M){M.e=M.e==U?R:(M.e-R)*s+R}),J.fs(),delete J._24Q}nn.superClass.setTall.call(J,H)},setElevation:function(w){var t=this;if(!t._55I&&!t._24Q&&!xd){t._24Q=1;var D=w-t._54O;t._59O.each(function(F){F.e==U?F.e=w:F.e+=D}),t.fs(),delete t._24Q}nn.superClass.setElevation.apply(t,arguments)},fireShapeChange:function(){var V=this,$=V._59O;if(!V._55I&&!V._24Q&&!xd){var A=$.size();if(A){var X=1,I=$.get(0),w=V._54O;I.e==U&&(I.e=w);for(var P=I.e,K=0;A>X;X++){I=$.get(X),I.e==U&&(I.e=w);var x=s(P,I.e),S=N(P+K,I.e);P=x,K=S-x}V._24Q=1,V.setTall(K),V.setElevation(P+K*V._anchorElevation),delete V._24Q}}nn.superClass.fireShapeChange.apply(V,arguments)}});var jc=o.SubGraph=function(){Sc(jc,this)};oi("SubGraph",Dq,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){jc.superClass._8I.call(this),this.eachChild(function(J){_h(J)&&J._8I()})}}),u.loadingRefGraph=0;var ji=o.RefGraph=function(){Sc(ji,this)};oi("RefGraph",Vf,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(d){var Y=this._ref;this._ref=d,this.fp("ref",Y,d),this.updateRef()},_21I:function(){ji.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var R=this;if(u.loadingRefGraph++,R.clearChildrenFromDataModel(),u.loadingRefGraph--,R._ref&&R._dataModel){R._xhrLoadHandler&&(R._xhrLoadHandler.cancel=!0);var l=xd,n=R._xhrLoadHandler=function(P){if(P&&R._dataModel){u.loadingRefGraph++;var q=R._pendingUpdateInfo={needToRestore:l};l&&(q.position=R.p(),q.width=R.getWidth(),q.height=R.getHeight(),q.rotation=R.getRotation(),q.anchor=R.getAnchor(),q.scale=R.getScale()),R.p(0,0),R.setAnchor(.5,.5),R.setRotation(0),R.setScale(1,1);var i=u.parse(P),V=R._dataModel.deserialize(i,R,{justDatas:!0});V.each(function(s){s._refGraph=R}),R.checkPendingUpdateInfo(),u.loadingRefGraph--,u.handleRefGraphLoaded(R,V,i)}};n.xhrLoadCalled=!1,u.load(R._ref,function(U){n.cancel||(n.xhrLoadCalled?n(U):Sk(function(){n(U)}))}),n.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var O=this,_=O._pendingUpdateInfo;if(!_)return O.onPendingUpdated&&(u.loadingRefGraph++,O.onPendingUpdated(),u.loadingRefGraph--),void 0;var B=!0;this.eachChild(function(D){(D._pendingCheckImageJSON||D._pendingUpdateInfo)&&(B=!1)}),B&&(u.loadingRefGraph++,O._pendingUpdateInfo=null,O.updateFromChildren(),_.needToRestore&&(O.setSize(_.width,_.height),O.setAnchor(_.anchor),O.setRotation(_.rotation),O.setScale(_.scale),O.p(_.position)),this.getParent()instanceof ji&&this.getParent().checkPendingUpdateInfo(),O.onPendingUpdated&&O.onPendingUpdated(),u.loadingRefGraph--)},getSerializableProperties:function(){var Z=ji.superClass.getSerializableProperties.call(this);return Z.ref=1,Z}}),o.EdgeGroup=function(w,F){this._70O=w,this._siblings=F;for(var I,A,P=0,g=w.size(),$=V[oe];g>P;P++)if(I=w.get(P).getStyle(oe,!1),I!=U){$=I;break}$==U&&($=!0);var D=u.edgeGroupAgentFunc;for(D&&(A=D(w),A&&A!==w.get(0)&&(w.remove(A),w.add(A,0))),P=0;g>P;P++)w.get(P).s(oe,$)},oi("EdgeGroup",Z,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(I){return this._70O.get(I)},indexOf:function(B){return this._70O.indexOf(B)},each:function(Q,o){this._70O.each(Q,o)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(p,d){this._siblings.each(function(t){t._70O.each(p,d)})}});var Sn=function(g,b,j){var d=Cg[g]={type:g,action:b};if(j)for(var U in j)d[U]=j[U]};Pk(u,{setConnectAction:Sn,getConnectAction:function(P,I){if(!I){if(!P)return null;I=P.getCurrentConnectActionType()}return Cg[I]},doConnectAction:function(A,Q,F,v){v=v||A.getCurrentConnectActionType();var O=Cg[v];if(!O)return!1;var Z=O.action;return Z?(Q instanceof qd.Group?A.sm().getSelection().each(function(s){Z.call(null,A,s,F)}):Z.call(null,A,Q,F),!0):!1},doDeleteConnectionAction:function(t,d,J){J=J||t.getCurrentConnectActionType();var I=Cg[J];if(!I||!I.delete)return!1;var j=I.delete.action;return j?(d instanceof qd.Group?t.sm().getSelection().each(function(l){j.call(null,t,l)}):j.call(null,t,d),!0):!1}});var fp=o.JSONSerializer=function(M,G){this.dm=this._dataModel=M,this._hierarchical=u.forceHierarchicalSerialization?!0:G==U?M.isHierarchicalRendering():G};oi("JSONSerializer",Z,{ms_ac:["hierarchical"],serialize:function(b){return u.stringify(this.toJSON(),b)},toJSON:function(){var y=this,_=y.dm,w=_.getRoots(),X=y.json={v:u.getVersion(),p:{},a:{},d:[]},d=_.getSerializableAttrs();_.getInit()&&(X.init=_.getInit()),_.getName()&&(X.p.name=_.getName()),_.getBackground()&&(X.p.background=_.getBackground()),_.getLayers()&&(X.p.layers=_.getLayers()),_.getEnvmap()&&(X.p.envmap=_.getEnvmap()),X.p.autoAdjustIndex=_.isAutoAdjustIndex(),X.p.hierarchicalRendering=_.isHierarchicalRendering();for(var v in d){var t=_.a(v);t!==g&&y[hc](v,t,X.a)}return Fo(X.a)&&delete X.a,y._hierarchical?w.each(y.serializeData,this):_.each(function(U){y.serializeData(U)}),_.fireSerializeEvent({type:"serialize",json:X}),_.getPostProcessingData()&&(X.p.postProcessingData=_.getPostProcessingData()),X},isSerializable:function(){return!0},getProperties:function(D){return D.getSerializableProperties()},getStyles:function(r){return r.getSerializableStyles()},getAttrs:function(A){return A.getSerializableAttrs()},serializeData:function(l){var Y=this;if(Y.isSerializable(l)&&!l._refGraph){var i,q,L,T,s=Ir(l.getClassName())||l.getClass(),Q=new s,e={c:l.getClassName(),i:l.getId(),p:{},s:{},a:{}};Y.json.d.push(e),i=Y.getProperties(l);for(q in i)if(/^_/.test(q)){if(L=l[q],("_width"===q||"_height"===q)&&L===g){var d;((l.s("layout.h")||l.s("layout.v"))&&l.getHost()||l instanceof o.Node&&(d=l.getParent())&&d instanceof o.Block||l.s("fullscreen"))&&(L=l[q]="_width"===q?l.getWidth():l.getHeight())
}L!==Q[q]&&Y[hc](q.substr(1),L,e.p)}else T=yb(q),l[T]&&(L=l[T](),L!==Q[T]()&&Y[hc](q,L,e.p));i=Y.getStyles(l);for(q in i)L=l.s(q),L!==Q.s(q)&&Y[hc](q,L,e.s);i=Y.getAttrs(l);for(q in i)L=l.a(q),L!==Q.a(q)&&Y[hc](q,L,e.a);Fo(e.p)&&delete e.p,Fo(e.s)&&delete e.s,Fo(e.a)&&delete e.a}Y._hierarchical&&l.getChildren().each(Y.serializeData,Y)},serializeValue:function(O,c,u){Wh(c)?c={__a:c._as}:c instanceof Ej&&(c={__i:c.getId()}),u[O]=c},deserialize:function(r,E,T){var k=this;return Do(r)&&/.json$/.test(r)?(u.xhrLoad(r,function(s){k.deserializeImpl(s,E,T)}),void 0):k.deserializeImpl(r,E,T)},deserializeImpl:function(I,q,n){var p=this,M=p.dm;n=br(n)?{setId:n}:tf(n)?{finishFunc:n}:n||{},I=p.json=Do(I)?u.parse(I):I,I.a&&I.a.onPreDeserialize&&!n.disableOnPreDeserialize&&I.a.onPreDeserialize(I,M,n.view),M.beginTransaction(),xd++,p._82I={};var S=new vc,X=new vc,H=0,V=I.d.length;if(n.justDatas||(tf(I.init)&&I.init(M),M.setInit(I.init)),!n.justDatas){for(var r in I.a)M.a(r,p[hj](I.a[r]));for(var C in I.p)M[gg(C)](I.p[C])}for(;V>H;H++){var Y=I.d[H],O=Ir(Y.c),J=new O,x=Y.i;n.setId&&x!=U&&(J._id=x),p._82I[x]=J,S.add(J),X.add(Y)}for(H=0;V>H;H++)p.deserializeData(S.get(H),X.get(H));return S.each(function(d){q&&!d.getParent()&&d.setParent(q),M.add(d)}),M.fireSerializeEvent({type:"deserialize",json:I}),xd--,M.endTransaction(),I.a&&I.a.onPostDeserialize&&!n.disableOnPostDeserialize&&I.a.onPostDeserialize(I,M,n.view,S),n.finishFunc&&n.finishFunc(I,M,n.view,S),S},deserializeData:function(b,x){for(var v in x.p)b[gg(v)](this[hj](x.p[v]));for(v in x.s)b.s(v,this[hj](x.s[v]));for(v in x.a)b.a(v,this[hj](x.a[v]))},deserializeValue:function(u){if(Bf(u)){var o=u.__i;if(o!=U)return this._82I[o];if(o=u.__a,zc(o))return new vc(o)}return u}}),Pk(Ch,{serialize:function(z,E){return new fp(this,E).serialize(z)},toJSON:function(u){return new fp(this,u).toJSON()},deserialize:function(Y,q,N){return new fp(this).deserialize(Y,q,N)}});var Mr=o.OverlappingBox=function(P){this.gv=P,this.boxes={}};oi("OverlappingBox",Z,{clear:function(){var q,x,a=this.boxes;for(q in a)x=a[q],x.length=0},isOverlapping:function(J,f){var T,w,m=this,X=m.boxes,i=X[J];i?(T=i.rects,w=i.length):i=X[J]={rects:T=[],length:w=0};var t,K,f;for(t=0;w>t;t++)if(K=T[t],K.x<f.x+f.w&&K.x+K.w>f.x&&K.y<f.y+f.h&&K.h+K.y>f.y)return!0;return T.length<=w?(T.push(f),i.length++):T[i.length++]=f,!1}}),Pk(u,{fetch:function(e,r){var Y="GET",x=!1,k=null,n="";r&&(Y=r.method||"GET",x=r.sync,n=r.url,k=r.data||null),e.open(Y,n,!x),r.responseType?e.responseType=r.responseType:r.overrideMimeType&&e.overrideMimeType&&e.overrideMimeType(r.overrideMimeType),e.send(k)},convertImageSrc:function(X,D){D&&"function"==typeof D||(D=function(){}),D(X)}});var or=o.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};oi("Request",Z,{_responseType:null,_overrideMimeType:"text/plain",send:function(c){var J=this._xhr,L=this.onload,n=this.onerror;this.getResponseType()?c.responseType=this.getResponseType():this.getOverrideMimeType()&&(c.overrideMimeType=this.getOverrideMimeType()),J.onload=L,J.onerror=n,u.fetch(J,c)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(U){this._responseType=U},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(K){this._overrideMimeType=K},getResponseText:function(){var X=this._xhr;return X.response||X.responseText}}),To.GraphView=function(t){var f=this;f._24I={},f._34I=new vc,f._25I={},f._56I={},f._view=wm(1,f),f._canvas=Aj(f._view),f.dm(t?t:new Ch),this._coreInteractor=new $q(this),f.setEditable(!1),f.setScrollBarVisible(u.graphViewScrollBarVisible)},oc("GraphView",Z,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[iq,Yo,ol,bf,"resettable","editInteractor",Lp,"pannable","rectSelectable","autoScrollZone",ve,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:u.graphViewResettable,_pannable:u.graphViewPannable,_rectSelectable:u.graphViewRectSelectable,_autoScrollZone:u.graphViewAutoScrollZone,_rectSelectBackground:u.graphViewRectSelectBackground,_rectSelectBorderColor:u.graphViewRectSelectBorderColor,_editPointSize:u.graphViewEditPointSize,_editPointBorderColor:u.graphViewEditPointBorderColor,_editPointBackground:u.graphViewEditPointBackground,_scrollBarColor:Rb,_scrollBarSize:Gc,_autoHideScrollBar:jh,_autoMakeVisible:ok,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(K){this._dataModel.setLayers(K)},setEditable:function(s){var z=this,U=z.__interactorMap__;if(!U){var C=To.XEditInteractor;U=z.__interactorMap__={scrollBar:new Cb(z),select:new Gj(z),edit:C?new C(z):new lh(z),move:new us(z),"default":new Zf(z),touch:new be(z,{editable:!1})}}s?(z._uieditable=!0,z.setInteractors([U.scrollBar,U.select,U.edit,U.move,U.default,U.touch])):(z._uieditable=!1,z.setInteractors([U.scrollBar,U.select,U.move,U.default,U.touch]))},getCanvas:function(){return this._canvas},_33I:function(Y){var R=Y.getUIClass();return R?new R(this,Y):U},getDataUI:function(T){var F=this,p=F._25I[T._id];return p===g&&(p=F._33I(T),F._25I[T._id]=p),p},getNodeRect:function(I){return u.getNodeRect(this,I)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(a){var A=this.getDataUI(a);return A?(A._79o(),A._78o):null},getEdgeSourcePosition:function(S){var o=this,M=o.getDataUI(S),B=M.s,p=M._data._40I;return Li(o,p,B("edge.source.position"),B("edge.source.offset.x"),B("edge.source.offset.y"),B("edge.source.anchor.x"),B("edge.source.anchor.y"))},getEdgeTargetPosition:function(s){var $=this,R=$.getDataUI(s),Y=R.s,X=R._data._41I;return Li($,X,Y("edge.target.position"),Y("edge.target.offset.x"),Y("edge.target.offset.y"),Y("edge.target.anchor.x"),Y("edge.target.anchor.y"))},invalidateAll:function(J){var h=this;if(J){for(var Z in h._25I){var m=h._25I[Z];m&&m.dispose()}h._25I={},h._56I={},h._24I={},h._34I.clear(),h.redraw()}else h.dm().each(function(l){h.invalidateData(l)})},invalidateSelection:function(){var O=this;O.sm().each(function(m){O.invalidateData(m)})},invalidateData:function(Y){var t=this;t._24I[Y._id]=Y,t._21Q(Y),t.iv()},_21Q:function($){var x=this,z=x._24I;if(nr($)&&Jd[$.s(Zq)]){var W=$.getSourceAgent();W&&W.getAgentEdges().each(function(f){z[f._id]=f}),W=$.getTargetAgent(),W&&W.getAgentEdges().each(function(P){z[P._id]=P}),x.iv()}},redraw:function(F){var $=this;$._32I||(F?$._34I.add(F):($._32I=1,$._34I.clear()),$.iv())},each:function(x,H){var B,d,X,T=0,o=this.getLayers(),E=this._dataModel,F=E._datas._as,G=F.length;if(o){for(var i=o.length;i>T;T++)if(X=o[T],Bf(X)&&(X=X.name),E.isHierarchicalRendering()){var g=function($){return $._layer===X?H?x.call(H,$):x($):void 0};if(this._dataModel.eachByHierarchical(g)===!1)return}else for(var Y=0;G>Y;Y++)if(B=F[Y],B._layer===X&&(d=H?x.call(H,B):x(B),d===!1))return}else if(E.isHierarchicalRendering())this._dataModel.eachByHierarchical(x,null,H);else for(;G>T;T++)if(B=F[T],d=H?x.call(H,B):x(B),d===!1)return},reverseEach:function(e,Z){var O,r,S,z,Q=this._dataModel,d=Q._layers,g=Q._datas._as,R=g.length;if(d){for(O=d.length-1;O>=0;O--)if(z=d[O],Bf(z)&&(z=z.name),Q.isHierarchicalRendering()){var F=function(f){return f._layer===z?Z?e.call(Z,f):e(f):void 0};if(Q.reverseEachByHierarchical(F)===!1)return}else for(var K=R-1;K>=0;K--)if(r=g[K],r._layer===z&&(S=Z?e.call(Z,r):e(r),S===!1))return}else if(Q.isHierarchicalRendering())Q.reverseEachByHierarchical(e,null,Z);else for(O=R-1;O>=0;O--)if(r=g[O],S=Z?e.call(Z,r):e(r),S===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var q=this,W=q._84I;if(!W){var X=this.dm().a("width"),m=this.dm().a("height");X>0&&m>0?q._84I={x:0,y:0,width:X,height:m}:(q.each(function(L){q.isVisible(L)&&(W=io(W,q.getDataUIBounds(L)))}),q._84I=W?W:Ng)}return q._84I},getScrollRect:function(){return io(this.getContentRect(),this._29I)},makeCenter:function(R,q,z){var b=this;if(!b.getWidth()||!b.getHeight())return z||Sk(b.centerData,b,[R,q,!0],500),void 0;b.makeVisible(R),b.validate();var K=b.getDataUIBounds(R);if(K){var T=b.getWidth(),E=b.getHeight(),A=K.x+K.width/2,G=K.y+K.height/2,e=-A*b._zoom+T/2,B=-G*b._zoom+E/2;b.setTranslate(e,B,q)}},fitData:function(v,p,j,h,N){var l=this;if(!l.getWidth()||!l.getHeight())return N||Sk(l.fitData,l,[v,p,j,h,!0],500),void 0;var C=function(){l.makeVisible(v),l.validate();var $=l.getDataUIBounds(v);$&&($=Cn($),fo($,j==U?20:j),l.fitRect($,p,h))};p?u.callWhenLoaded(C):C()},fitContent:function(e,r,$,d){var K=this;if(!K.getWidth()||!K.getHeight())return d||Sk(K.fitContent,K,[e,r,$,!0],500),void 0;var k=function(){K.validate();var X=Cn(K.getContentRect());fo(X,r==U?20:r),K.fitRect(X,e,$)};e?u.callWhenLoaded(k):k()},fitRect:function(T,Y,h){var F=this,$=F.getWidth(),O=F.getHeight(),e=T.x+T.width/2,B=T.y+T.height/2,c=s($/T.width,O/T.height),N=F._zoom,W=-e*N+$/2,d=-B*N+O/2;0===c||isNaN(c)||(h&&(c=s(1,c)),Y?(F._65I&&(delete F._65I.finishFunc,F._65I.stop(!0)),F._14o&&F._14o.stop(!0),F.setTranslate(W,d,{finishFunc:function(){F.setZoom(c,Y)}})):(F.setTranslate(W,d),F.setZoom(c)))},toCanvas:function(M,L){L=L||this._zoom,this.validateImpl();var u=this,F=u.getContentRect();F.width||(F.width=10),F.height||(F.height=10);var b=Aj(),v=F.x*L,E=F.y*L,V=F.width*L,N=F.height*L;gl(b,V,N,1);var s=kc(b);return M=M||this._dataModel.getBackground(),M&&No(s,0,0,V,N,M),Jh(s,-v,-E),s.scale(L,L),u._42(s),s.restore(),b},toDataURL:function(u,E,b){return this.toCanvas(u,b).toDataURL(E||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(X,Y){var _=this,V=this.__htmlOrderList,f=[];if(_._93db(X,Y),_.each(function(s){var H=_.getDataUI(s);if(H){var x=_._56I[s._id],T=H._htmlView;if(x){var B=H._79o();if(T=H._htmlView,o.HtmlNode&&s instanceof o.HtmlNode)H._42(X);else{var y=_.getViewRect(),d=T&&T.layoutHTML;!Y||Mm(Y,B)?(d&&(T.layoutHTML(),H.__outerLayout&&delete H.__outerLayout),H._42(X)):Mm(y,B)||!d||H.__outerLayout||(T.layoutHTML(),H.__outerLayout=!0)}}T&&(f.push(T),T.getView&&(T=T.getView()),T.style.display=x?"block":De)}}),V&&f.length>0){var W=!1;if(V.length!==f.length)W=!0;else for(var x=0;x<f.length;x++)if(f[x]!==V[x]){W=!0;break}W&&(f.forEach(function(T){_.appendHTML(T,!0)}),this.__htmlOrderList=f)}else this.__htmlOrderList=f;_._92db(X,Y)},validateImpl:function(){this.tryUpdateRootData();var A,B,w,J,q,r=this,C=r.tx(),m=r.ty(),c=r._zoom,z=r._canvas,P=this.getWidth(),I=this.getHeight(),a=r._29I,V={x:-C/c,y:-m/c,width:P/c,height:I/c},p={},$=r._34I,M=r._24I,t=r._32I,L=r._23I;r._24I={},(P!==z.clientWidth||I!==z.clientHeight)&&(gl(z,P,I),t=1),t||uk(V,a)||(t=1),r._29I=V,r.each(function(P){B=P._id;var i=p[B]=r.isVisible(P);i!==r._56I[B]&&(M[B]=P,w=r.getDataUI(M[B]),w&&w._84o(i),r._84o(P,i))},r);for(B in M)w=r.getDataUI(M[B]),w&&(!t&&r._56I[B]&&(q=w._79o(),q&&$.add(q)),w.invalidate()),r._83I=1;if(r._56I=p,!t)for(B in M)p[B]&&(w=r.getDataUI(M[B]),w&&(q=w._79o(),q&&$.add(q)));if(t?J=V:($.each(function(X){Mm(V,X)&&(J=io(J,X))}),J&&(fo(J,N(1,1/c)),J.x=d(J.x*c)/c,J.y=d(J.y*c)/c,J.width=e(J.width*c)/c,J.height=e(J.height*c)/c,J=Hm(V,J))),r._74O=J,J){A=kc(z);var j=J.x,G=J.y,x=J.width,E=J.height;j=Math.floor((j*c+C)*rp),G=Math.floor((G*c+m)*rp),x=Math.ceil(x*c*rp)+1,E=Math.ceil(E*c*rp)+1,A.beginPath(),A.rect(j,G,x,E),A.clip(),A.clearRect(j,G,x,E),_f(A,C,m,c),r._42(A,J),A.restore(),delete r._74O}if($.clear(),delete r._32I,L&&P>0&&I>0){var w=r.getDataUI(L);if(w){var q=w._79o(),T=r._29I,_=T.x,X=T.y,k=T.width,D=T.height,c=r._zoom;q&&!Mm(q,T)&&(q.x+q.width<_&&r.tx(-q.x*c),q.x>_+k&&r.tx(-(q.x+q.width-k)*c),q.y+q.height<X&&r.ty(-q.y*c),q.y>X+D&&r.ty(-(q.y+q.height-D)*c))}delete r._23I}r._83I&&(delete r._83I,delete r._84I),r._98O(),r.countFrame(),Fo(r._24I)||Sk(r.iv,r)},tryUpdateRootData:function(){var Q,O=this.getFullscreenDatas();for(var s in O)Q=O[s],this.scaleRootData(Q)},scaleRootData:function(r){var I=r.s("fullscreen");if("uniform"===I||"fill"===I){r.setRotation(0);var c,k=r.s("fullscreen.gap")||0,C=this.getWidth()-2*k,B=this.getHeight()-2*k,h=r.getAnchor(),R=r.getScaledSize(),X=R.width,$=R.height,J=r.s("fullscreen.lock");if(J)return"uniform"===I?C/B>X/$?(c=B/$,X=$*C/B):(c=C/X,$=X*B/C):"v"===J?(c=B/$,X=C/c,r.setWidth(X)):(c=C/X,$=B/c,r.setHeight($)),this.setZoom(c),this.tx(k-(r.getX()-h.x*X)*c),this.ty(k-(r.getY()-h.y*$)*c),void 0;var b=this.tx(),H=this.ty();c=this._zoom;var F={x:(-b+k)/c,y:(-H+k)/c,width:C/c,height:B/c};if("uniform"===I){var z=X/$,y=Math.min(F.width,F.height*z),g=y/z;F.x+=.5*(F.width-y),F.y+=.5*(F.height-g),F.width=y,F.height=g}r.setSize(F.width/r.getScaleX(),F.height/r.getScaleY()),r.setPosition(F.x+h.x*F.width,F.y+h.y*F.height)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(D){var g=this;D!==g.isScrollBarVisible()&&(D?(Uo(g._view,g._79O=rr()),Uo(g._79O,g._27I=rr()),Uo(g._79O,g._28I=rr())):(Gp(g._79O),delete g._79O,delete g._27I,delete g._28I),g.fp("scrollBarVisible",!D,D))},getDebugTip:function(){return""},showScrollBar:function(){var w=this;w._79O&&(w._85I||(l(function(){w._86I()},Ck),w.iv()),w._85I=new Date)},_86I:function(){var p=this;if(p._85I){var b=new Date,K=b.getTime();K-p._85I.getTime()>=Ck?(delete p._85I,p.iv()):l(function(){p._86I()},Ck)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var g=this,E=this._27I,S=this._28I;if(g._79O){if(g._autoHideScrollBar&&!g._85I)return E.style.visibility=El,S.style.visibility=El,void 0;var Y=g.getScrollBarColor(),Z=g._zoom,r=g.getScrollBarSize(),d=g.getViewRect(),L=g.getScrollRect(),b=d.height*Z,H=L.height*Z,T=d.width*Z-r-2,x=b*((d.y-L.y)*Z/H),J=b*(b/H),h=E.style;H-.5>b?(Af>J&&(x=x+J/2-Af/2,0>x&&(x=0),x+Af>b&&(x=b-Af),J=Af),yk(E,T,x,r,J),h.visibility=Sp,h.background=Y,h.borderRadius=r/2+Wg):h.visibility=El;var A=d.width*Z,D=L.width*Z,x=d.height*Z-r-2,T=A*((d.x-L.x)*Z/D),z=A*(A/D),h=S.style;D-.5>A?(Af>z&&(T=T+z/2-Af/2,0>T&&(T=0),T+Af>A&&(T=A-Af),z=Af),yk(S,T,x,z,r),h.visibility=Sp,h.background=Y,h.borderRadius=r/2+Wg):h.visibility=El}},setDataModel:function(R){var v=this,A=v._dataModel,V=v._selectionModel;A!==R&&(A&&(A.ump(v.handleDataModelPropertyChange,v),A.umm(v.handleDataModelChange,v),A.umd(v.handleDataPropertyChange,v),A.removeIndexChangeListener(v._75O,v),A.removeHierarchyChangeListener(v.handleHierarchyChange,v),V||A.sm().ums(v.handleSelectionChange,v)),v._dataModel=R,R.mp(v.handleDataModelPropertyChange,v),R.mm(v.handleDataModelChange,v),R.md(v.handleDataPropertyChange,v),R.addIndexChangeListener(v._75O,v),R.addHierarchyChangeListener(v.handleHierarchyChange,v),V?V._21I(R):R.sm().ms(v.handleSelectionChange,v),v.invalidateAll(!0),v.fp(Og,A,R),v._canvas.style.background=R.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===g){var r=this.getLayers();r?(this._layersInfo={},r.forEach(function(m){var g=Bf(m)?m.name:m;this._layersInfo[g]=m},this)):this._layersInfo=null}return this._layersInfo},calculateAttachPoint:function(){var U=new po,K=new po,F=new po;return function(A,d){var a=this.getAttachPoints(A);if(!a||!a.length)return null;F.set(d.x,d.y);for(var L,p,Q,W,V=1/0,u=0,z=a.length;z>u;u++)Q=a[u],K.x=Q.x,K.y=Q.y,U.x=Q.offsetX||0,U.y=Q.offsetY||0,W=Li(this,A,0,U.x,U.y,K.x,K.y),p=F.distanceToSquared(W),V>p&&(L=u,V=p);V=Math.sqrt(V);var k=this.getAttachStyle(A);if("close"===k){var J=A.s("attach.close.threshold")/this._zoom;if(V>J)return null}return{index:L,distance:V,info:a[L]}}}(),getAttachPoints:function(I){var $=I.s("attach.points");if($)return $;var J=Dl(I._image);return J?ws(J.attachPoints,I,this)||null:void 0},getAttachStyle:function(k){var n=k.s("attach.style");if(n)return n;var K=Dl(k._image);return K?ws(K.attachStyle,k,this)||"close":void 0},updateLayers:function(){this._layersInfo=g,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(A){if("background"===A.property){var G=this._canvas.style.background,l=A.newValue||"";this._canvas.style.background=l,this.fp("canvasBackground",G,l)}else"a:width"===A.property||"a:height"===A.property?(this._83I=1,this.redraw()):"layers"===A.property?this.updateLayers():"hierarchicalRendering"===A.property&&this.redraw()},handleDataPropertyChange:function(O){this.dm().isHierarchicalRendering()&&"parent"===O.property&&O.data.hasChildren()&&this.redraw(),this.invalidateData(O.data)},onPropertyChanged:function(d){var V=this,l=d.property;if(V.redraw(),"zoom"===l){var M=V.sm().getSelection();M.size()&&M.each(function(Z){Z.invalidate()})}Um[l]?V.showScrollBar():l===Lp&&V.onCurrentSubGraphChanged(d)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(P){var J=this,k=P.kind,I=P.data;if(J._83I=1,"add"===k)J.invalidateData(I),nr(I)&&I.getEdgeGroup()&&I.getEdgeGroup().eachSiblingEdge(J.invalidateData,J);else if(k===Se){J._21Q(I);var q=I._id,y=J._25I[q];if(y){if(J._56I[q]){var b=y._79o();b&&J.redraw(b)}y.dispose(),delete J._25I[q],delete J._24I[q],delete J._56I[q]}I===J._currentSubGraph&&J.setCurrentSubGraph(U)}else k===sg&&(J.invalidateAll(!0),J.setCurrentSubGraph(U))},_75O:function(P){this.invalidateData(P.data)},handleHierarchyChange:function(D){this.dm().isHierarchicalRendering()&&D.data.hasChildren()&&this.redraw(),this.invalidateData(D.data)},adjustIndex:function(u){var T=this;if(T.isVisible(u)){T.dm().beginTransaction();for(var M=u;M._parent&&T.isVisible(M._parent);)M=M._parent;M&&M!==u&&T._dataModel.adjustIndex(M),T._dataModel.adjustIndex(u),T.dm().endTransaction()}},getImage:function(N){return N.getImage?N.getImage():g},getSelectWidth:function(Q){var z=Dl(this.getImage(Q));return z&&ws(z.disableSelectedBorder,Q,this)?0:Q.s("select.width")},getSelectColor:function(I){return I.s("select.color")},isSelectable:function(s,S){if(this.isSelected(s))return!0;if(!S&&s.getParent()instanceof Vf&&this.isSelectable(s.getParent(),!0)&&s.getParent().isSyncSize())return!1;var K=this.getLayersInfo();if(K){var C=K[s._layer];if(C&&C.selectable===!1)return!1}return s.s("2d.selectable")&&this.sm().isSelectable(s)},isMovable:function(Q){var X=this;if(nr(Q)&&Q.getStyle(Zq)!==Vm)return!1;var b=this.getLayersInfo();if(b){var e=b[Q._layer];if(e&&e.movable===!1)return!1}return Q.s("2d.movable")?X._movableFunc?X._movableFunc(Q):!0:!1},isEditable:function(w){var u=this;if(o._uiSerializing)return u._uieditable;if(!u._editInteractor||!u.isSelected(w))return!1;if(rg(w)){var Q=u.getDataUI(w);if(!Q||Q._88I)return!1}if(nr(w)&&w.getStyle(Zq)!==Vm)return!1;var R=this.getLayersInfo();if(R){var L=R[w._layer];if(L&&L.editable===!1)return!1}return w.s("2d.editable")?u._editableFunc?u._editableFunc(w):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(o){return _h(o)&&0!==o.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(o):!0},isRectEditable:function(I){return this._rectEditableFunc?this._rectEditableFunc(I):!0},isAnchorEditable:function(G){return this._anchorEditableFunc?this._anchorEditableFunc(G):!0},isRotationEditable:function(F){return F.setRotation&&F.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(F):!0:!1},getRotationPoint:function(Z){var M=Z.getAnchor(),n=Z.getScale(),r=this._zoom,w=_k(Z.getRotation(),0,-Z.getHeight()*n.y*M.y-(n.y<0?-1:1)*($d?32:16)/r),g=Z.p();return w.x+=g.x,w.y+=g.y,w},getLogicalPoint:function(d){var L=this;return Qj(d,L._canvas,L.tx(),L.ty(),L._zoom,L._zoom)},getScreenPoint:function(F,E){var I,X=this;return"object"==typeof F?F.x!==g?(I=F.x,E=F.y):(I=F[0],E=F[1]):I=F,es(I,E,X._canvas,X.tx(),X.ty(),X._zoom,X._zoom)},getSelectedDataAt:function(D){var v=this;return this.getDataAt(D,function(F){return v.isSelected(F)})},getDataInfoAt:function(b,G,j){var o,r=this.lp(b),l=this.getDataAt(r,G,j);if(l){var D=this.getDataUI(l);o={data:l,ui:D,point:r};var C=D._38o;if(C){var X=C.icons;for(var e in X){var S=X[e],A=C.rects[e];if(A)for(var H=ws(S.names,l,this),u=H?H.length:0,w=A.rotation,Z=u-1;Z>=0;Z--){var v=H[Z],c=A[Z];if(ce(c,r,w))return o.part="icons",o.name=e,o.icon=v,o.rect=c,o.index=Z,o.rotation=w,o}}}if(this.isNoteVisible(l)){if(D.note2Info&&ce(D.note2Info.clickRect,r,U,D.note2Info.scale))return o.part="note2",o;if(D.noteInfo&&ce(D.noteInfo.clickRect,r,U,D.noteInfo.scale))return o.part="note",o}if(this.isLabelVisible(l)){if(D.label2Info&&ce(D.label2Info.rect,r,D.label2Info.rotation,D.label2Info.scale))return o.part="label2",o;if(D.labelInfo&&ce(D.labelInfo.rect,r,D.labelInfo.rotation,D.labelInfo.scale))return o.part="label",o}if(l.isInRect&&l.isInRect(r))return o.part="body",o}return o},getDataAt:function(j,E,b){j.target&&(j=this.lp(j));var i,V=this._zoom;return this.reverseEach(function(U){return(E?E(U):this.isSelectable(U))&&this.rectIntersects(U,en(j.x,j.y,b,V))?(i=U,!1):void 0},this),i},getIconInfoAt:function(z,p){var L=this;if(z.target&&(z=L.lp(z)),p||(p=L.getDataAt(z)),p){var Y=L.getDataUI(p);if(Y&&Y._38o){var P,j=Y._38o,b=new vc;for(P in j.icons)b.add(P);for(var G=b.size()-1;G>=0;G--){P=b.get(G);for(var T=j.rects[P],h=T.rotation,e=T.length-1;e>=0;e--){var D=T[e],W=D.width,O=D.height,J={x:z.x-D.x-W/2,y:z.y-D.y-O/2};h!=U&&(J=_k(-h,J.x,J.y));var D={x:-W/2,y:-O/2,width:W,height:O};if(ce(D,J))return{key:P,index:e,name:j.icons[P].names[e],rect:T[e],point:z,rotation:h,relativeRect:D,relativePoint:J,data:p}}}}}return U},getDatasInRect:function(J,n,h){h===g&&(h=1);var G=this,Z=new vc;return G.reverseEach(function(c){h&&!G.isSelectable(c)||(n?G.rectIntersects(c,J):G.rectContains(c,J))&&Z.add(c)}),Z},moveSelection:function(T,l){var e=this;e.dm().beginTransaction(),xq(e.sm().toSelection(e.isMovable,e),T,l),e.dm().endTransaction()},moveDatas:function(x,H,s){var G=this;G.dm().beginTransaction(),x instanceof vc||(x=new vc(x)),xq(x,H,s),G.dm().endTransaction()},getDataUIBounds:function(k){var r=this.getDataUI(k);return r?r._79o():U},drawData:function(y,H,I){var t=this.getDataUI(H);if(t){var L=t._79o();(!I||Mm(I,L))&&(t._42(y),H instanceof o.Block&&H.eachChild(function(B){this.drawData(y,B,I)},this))}},getBoundsForGroup:function(b){return b.s(xh)?this.getDataUIBounds(b):U},isPixelPerfect:function(q){return q.s("pixelPerfect")},rectIntersects:function(t,c){this.validate();var m=U;if(this._56I[t._id]){var T=this._25I[t._id];if(T){var O=T._79o();if(Lj(c,O))m=!0;else if((c=Hm(c,O))&&(T.rectIntersects&&(m=T.rectIntersects(c)),m==U)){if(!this.isPixelPerfect(t))return!0;var v=c.x,K=c.y,A=c.width,B=c.height,P=this._zoom,b=u.hitMaxArea,S=A*B*P*P;if(S>b){var j=Math.sqrt(b/S);P*=j}A*=P,B*=P,2>A&&(A=2),2>B&&(B=2),v*=P,K*=P;var e=hn(A,B);Jh(e,-v,-K),e.scale(P,P),this._drawForChecking=!0,this.drawData(e,t,c),this._drawForChecking=!1;try{for(var I=0,k=e.getImageData(0,0,A,B).data;I<k.length;I+=4)if(0!==k[I+3]){m=!0;break}e.restore()}catch(n){Tl=U,m=!1}}}}return m?!0:!1},rectContains:function(z,m){if(this._56I[z._id]){var L=this._25I[z._id];if(L)return Lj(m,L._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(K){if(!u.isInput(K.target)){var b=this,w=b._focusData,g=w&&b._25I[w._id],v=0,F=b._dataModel._datas;if(!(w&&w._enabled&&w._editable&&g&&g.onKeyDown&&g.onKeyDown(K)===!0))if(9===K.keyCode&&(w&&(v=F.indexOf(w),Cl(K)?-1===--v&&(v=0):++v===F.size()&&(v=0)),b._focusData=w=F.get(v),b.sm().setSelection(w)),Co(K)?b.selectAll():Lo(K)&&b.isResettable()&&b.reset(),b.sm().isEmpty()){if(b._editing)return;var p=b.tx(),y=b.ty(),C=!1,n=Cl()?100:10;pf(K)&&(p-=n,C=!0),jl(K)&&(y-=n,C=!0),wf(K)&&(p+=n,C=!0),Lr(K)&&(y+=n,C=!0),C&&b.setTranslate(p,y)}else{Jc(K)&&b.handleDelete(K);var r=Cl()?10:1;pf(K)&&(b.moveSelection(-r,0),b.fi({kind:"moveLeft"})),jl(K)&&(b.moveSelection(0,-r),b.fi({kind:"moveUp"})),wf(K)&&(b.moveSelection(r,0),b.fi({kind:"moveRight"})),Lr(K)&&(b.moveSelection(0,r),b.fi({kind:"moveDown"}))}}},handleScroll:function(y,r){if(td(y),!this.getEditInteractor()){var A=this.getDataAt(y);if(A){var e=Dl(this.getImage(A));if(e&&ws(e.scrollable,A,this))return}}var a=this.lp(y);r>0?this.scrollZoomIn(a):0>r&&this.scrollZoomOut(a)},handlePinch:function(t,D,E){this._68I||(D>E?this.pinchZoomIn(t):this.pinchZoomOut(t))},checkDoubleClickOnNote:function(P,o){var y=this,B=y.lp(P),Z=y.getDataUI(o),i=Z.note2Info;return i&&o.s("note2.toggleable")&&ce(i.clickRect,B)?(o.s(As,!o.s(As)),y.fi({kind:"toggleNote2",event:P,data:o}),!0):(i=Z.noteInfo,i&&o.s("note.toggleable")&&ce(i.clickRect,B)?(o.s(yr,!o.s(yr)),y.fi({kind:"toggleNote",event:P,data:o}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(i,U){var j=this,t=j.getAutoScrollZone(),l=t/j.getZoom(),G=t/4,S=j._29I,Y=j.lp(i),m={x:j.tx(),y:j.ty()};return Y&&t>0&&S&&(Y.x-S.x<l?j.translate(G,0):S.x+S.width-Y.x<l&&j.translate(-G,0),Y.y-S.y<l?j.translate(0,G):S.y+S.height-Y.y<l&&j.translate(0,-G)),m.x=j.tx()-m.x,m.y=j.ty()-m.y,U&&(U.x+=m.x,U.y+=m.y),m},getMoveMode:function(C,A){var Y=A.s("2d.move.mode");return Y?Y:mf["88"]?"x":mf["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(T,G,n){var W=this;return"currentSubGraph"===G?{__i:T.getId()}:n.serializeProperty(T,G,W)},deserializeProperty:function(A,S,a){var I=this;if("currentSubGraph"===S){var k=I.dm(),c=k.__idMap;return c[A.__i]}return a.deserializeProperty(A,S,I)},setDefaultCursor:function(E,I){this._defaultCursor=E,I!==!1&&this.setCursor(E)},setCursor:function(E){"default"===E&&(E=this._defaultCursor||E);var v=this.getView().style;v.cursor=E,v.cursor="-webkit-"+E,v.cursor="-moz-"+E},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(a){return a===U||u.getConnectAction(null,a)?(this._currentActionType=a,this.redraw(),!0):!1},isConnectActionVisible:function(f){var $=u.getConnectAction(this);if(!$)return!1;var j=$.visible;return tf(j)&&(j=j(this,f)),j},isInteractive:function(Q){var O=Dl(this.getImage(Q));return O&&ws(O.interactive,Q,this)?!0:Q.s("interactive")},appendHTML:function(K,c){var S=this.getView();if(!(c||K&&K.parentNode!==S))return!1;var z=K.getView&&K.getView();if(!c&&z&&z.parentNode===S)return!1;if(K.isSelfViewEvent)return K.addToDOM(S),!0;K.getView&&(K=K.getView());var d=this.getEditInteractor();return d&&d._canvas?S.insertBefore(K,d._canvas):this.isScrollBarVisible()?S.insertBefore(K,this.getView().lastChild):Uo(S,K),!0},_layoutHTMLImpl:function(t,T,Q){if(arguments.length>1){var D,W=this,x=W._zoom;if(T.getView&&(D=T,T=T.getView()),T.style.position="absolute",Q){var g=t.getRect();yk(D||T,W.tx()+g.x*x,W.ty()+g.y*x,g.width*x,g.height*x)}else{var P=new Uj,g=t.getAnchorRect(),G=t.getPosition(),c=t.getScale(),M=T.style;yk(D||T,g),P.appendTranslate(W.tx(),W.ty()),P.appendScale(x,x),P.append(new Uj(t.getRotation(),G.x,G.y,c.x,c.y)),Tb(M,"transform","matrix("+P.a.toFixed(5)+", "+P.b.toFixed(5)+", "+P.c.toFixed(5)+",\n    "+P.d.toFixed(5)+", "+P.tx.toFixed(5)+", "+P.ty.toFixed(5)+")"),Tb(M,"transformOrigin",(-g.x).toFixed(5)+"px "+(-g.y).toFixed(5)+"px"),T.maxtrixAppend=P.invert().translate(-g.x,-g.y)}}else this._layoutHTML&&this._layoutHTML()}}),Z.defineProperties(To.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(B){this._layoutHTML=B}}});var tm=function(K,O){var l=this;l.gv=K,l.s=function(E){return O.getStyle(E)},l._data=O,l._87I=new vc};ob(tm,Z,{_6I:U,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var H=this,T=H.gv.isSelected(H._data);return!T||H.isShadowed()?0:H.gv.getSelectWidth(H._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(x){var D=this._data,C=this.gv.getBodyColor(D);return C?C:x?D.getStyle(x):U},_2Q:function(n){return this.s(n)},_1Q:function(j,Y,N,r){var q=this.s,K=q("2d.gray"),G=q(Y+".dash.color");if(K&&(G=u.toGrayColor(G)),j.strokeStyle=G,j.lineWidth=N,j.stroke(),q(Y+".dash.3d")){var S=q(Y+".dash.3d.color");Zj(j,G,K?u.toGrayColor(S):S,N,this.gv._zoom,q(Y+".dash.3d.accuracy"))}Zk(j,r)},invalidate:function(){this._6I=U},_79o:function(){var v=this;if(!v._6I){var k=v._data,c=v.gv;v.labelInfo=v.label2Info=v.noteInfo=v.note2Info=v._38o=U,v._87I.clear(),v.interactiveInfo=c.isInteractive(k)?{}:U,v._3O(),v._55O=c.isEditable(k)?{_42O:c.isRectEditable(k),_43O:c.isPointEditable(k),_56O:c.isRotationEditable(k)}:U,v._6I=v._81o()}return v._6I},_3O:function(){},getPosition:function(){return Ng},_68o:function(N,w){N&&this._87I.add(Ud(N,w))},_81o:function(){var r=this,l=r.s;r._24O(Fd,"getLabel"),r._24O(Le,"getLabel2"),r._26O(Hq,"getNote"),r._26O(Xi,"getNote2"),r._15O(),r._55O&&r._48O();var G;if(r._87I.each(function(J){G=io(G,J)}),G&&r.isShadowed()){var z=Cn(G);z.x+=l("shadow.offset.x"),z.y+=l("shadow.offset.y"),fo(z,l("shadow.blur")),G=io(G,z)}return r._87I.clear(),G},_42:function(g){var R=this,p=R._data,I=R.gv,s=R.s,A=s("opacity"),$=this.isShadowed();if($){var m=g.shadowOffsetX,t=g.shadowOffsetY,C=g.shadowBlur,P=g.shadowColor,S=I.getZoom();g.shadowOffsetX=s("shadow.offset.x")*S,g.shadowOffsetY=s("shadow.offset.y")*S,g.shadowBlur=s("shadow.blur")*S,g.shadowColor=R.getSelectColor()}if(A!=U){var u=g.globalAlpha;g.globalAlpha=A}R._80o(g),I.isLabelVisible(p)&&((!I._drawForChecking||s("label.selectable"))&&Nf(g,R.labelInfo),(!I._drawForChecking||s("label2.selectable"))&&Nf(g,R.label2Info)),I.isNoteVisible(p)&&(Vh(g,R.noteInfo),Vh(g,R.note2Info)),R._99O(g),A!=U&&(g.globalAlpha=u),$&&(g.shadowOffsetX=m,g.shadowOffsetY=t,g.shadowBlur=C,g.shadowColor=P)},_80o:function(){},_47O:function(){},_24O:function(B,l){var Y=this,A=Y._data,W=Y.gv,s=Y.s,t=W[l](A);if(t!=U){var T=s(B+".scale"),w=s(B+".max"),v=s(B+".position"),p=Y[B+"Info"]={label:t,scale:T,color:W[l+"Color"](A),font:s(B+".font"),opacity:s(B+".opacity"),align:s(B+".align"),rotation:Y.getRotation(s(B+".rotation"),!1,v),background:W[l+"Background"](A)},e=Bj(p,t);w>0&&w<e.width&&(p.labelWidth=e.width,e.width=w),1!==T&&(e.width*=T,e.height*=T);var M=Y.getPosition(v,s(B+".offset.x"),s(B+".offset.y"),e,s(B+".position.fixed"));if(e.x=M.x-e.width/2,e.y=M.y-e.height/2,Y._68o(p.rect=e,p.rotation),1!==T){var x=e.width/T,Z=e.height/T;p.rect={x:M.x-x/2,y:M.y-Z/2,width:x,height:Z}}}},_26O:function(a,x){var k=this,f=k.gv,W=k._data,G=k.s,g=f[x](W);if(g!=U){var Y,b,X=G(a+".scale"),l=k[a+"Info"]={note:g,scale:X,data:W,view:f,expanded:G(a+".expanded"),font:G(a+".font"),color:G(a+".color"),opacity:G(a+".opacity"),align:G(a+".align"),icon:G(a+".icon"),backgroundImage:G(a+".backgroundImage"),borderWidth:G(a+".border.width"),borderColor:G(a+".border.color"),background:f[x+"Background"](W)},O=k.getPosition(G(a+".position"),G(a+".offset.x"),G(a+".offset.y")),E=O.x,T=O.y;if(l.expanded){var S,P=G(a+".max"),N=G(a+".backgroundImage");N?(N=Dl(N),S={width:Zb(N,W),height:Qk(N,W)}):S=Bj(l,g),S.width+=6,S.height+=2,P>0&&P<S.width&&(l.labelWidth=S.width,S.width=P),Y=S.width,b=S.height+8,l.clickRect={x:E-Y*X/2,y:T-b*X,width:Y*X,height:b*X*S.height/b}}else{var m=G(a+".icon");m?(m=Dl(m),Y=Zb(m,W),b=Qk(m,W)):(Y=12,b=18),l.clickRect={x:E-Y*X/2,y:T-b*X,width:Y*X,height:b*X}}l.rect={x:E-Y/2,y:T-b*X/2-b/2,width:Y,height:b};var t=e(l.borderWidth/2)*X;k._68o({x:E-Y*X/2-t,y:T-b*X-t,width:Y*X+2*t,height:b*X+2*t})
}},_48O:function(){},_99O:function(X){var H=this,W=H._38o;if(W){var F=H.gv,o=H._data,I=W.icons,E=H.interactiveInfo;E&&(E._38o={});for(var R in I){var z=I[R],a=W.rects[R];if(a){E&&(E._38o[R]=[]);var l=ws(z.opacity,o,F),x=ws(z.names,o,F),g=x?x.length:0,p=a.rotation;if(l!=U){var h=X.globalAlpha;X.globalAlpha*=l}for(var e=0;g>e;e++){var L=x[e],j=Dl(L),m=a[e];if(p){var u=m.x+m.width/2,A=m.y+m.height/2;X.save(),Jh(X,u,A),Xk(X,p),Jh(X,-u,-A)}E&&E._38o[R].push(X.interactiveInfo={compInfos:[],matrix:p?new Uj(p,u,A).appendTranslate(-u,-A):new Uj}),Dj(X,j,ws(z.stretch,o,F),m.x,m.y,m.width,m.height,H._data,H.gv),X.interactiveInfo=U,p&&X.restore()}l!=U&&(X.globalAlpha=h)}}}}});var ki=function(O,i){Sc(ki,this,[O,i])};ob(ki,tm,{_checkEmptyRect:!0,_40O:function(s,l){var $=this,K=$.s,Z=s.rect;(s.borderColor=$.gv.getBorderColor($._data))&&(s.borderType=K("border.type"),s.borderWidth=K("border.width"),s.borderPadding=K("border.padding"),l=N(l,s.borderPadding+s.borderWidth/2));var i=$._data.getScale(),I=N(1,N(v(i.x),v(i.y)));if(s.selectWidth=$.getSelectWidth()){var m=$.gv._zoom;s.selectType=K("select.type"),s._97o=$.getSelectColor(),s.selectPadding=K("select.padding"),l=N(l,(s.selectPadding+s.selectWidth/2/m)/I)}l>0&&(l*=I,Z=Cn(Z),fo(Z,l)),$._68o(Z)},_39O:function(f,c){var d,e=this,_=c.rect;if(c.borderWidth>0&&(d=c.borderPadding,f.strokeStyle=c.borderColor,f.lineWidth=c.borderWidth,Im(f,c.borderType,{x:_.x-d,y:_.y-d,width:_.width+2*d,height:_.height+2*d}),f.stroke()),c.selectWidth>0){var D=e.gv._zoom;if(d=c.selectPadding,f.strokeStyle=c._97o,f.lineWidth=c.selectWidth/D,c.rotation!=U){f.save(),f.translate(c.position.x,c.position.y),f.rotate(c.rotation);var p=e._data,r=p.getWidth(),x=p.getHeight(),y=c.scale,n=c.anchor;_={x:y.x*-r*n.x,y:y.y*-x*n.y,width:y.x*r,height:y.y*x}}Im(f,c.selectType,{x:_.x-d,y:_.y-d,width:_.width+2*d,height:_.height+2*d}),c.rotation!=U&&f.restore(),f.stroke()}},dispose:function(){var t=this,E=t._htmlView;ki.superClass._3O.call(t),E&&(E.onHTMLRemoved&&E.onHTMLRemoved(),Gp(E))},_3O:function(){var Y=this,l=Y.s,e=Y._data,P=Y.gv,f=e.getStyle(wr),j=Y.getBodyColor(),J=Y._83o=f?{shape:f,_53o:Y.getBodyColor("shape.background"),_27Q:Dl(l("shape.repeat.image"),j),shapeGradientPack:l("shape.gradient.pack"),_54o:l("shape.border.width"),_55o:l("shape.border.color"),_56o:l("shape.border.3d"),_57o:l("shape.border.3d.color"),_58o:l("shape.border.3d.accuracy"),shapeGradient:l("shape.gradient"),_59o:l("shape.gradient.color"),_60o:l("shape.border.pattern"),_61o:l("shape.border.cap"),_62o:l("shape.border.join"),shapeForeground:l("shape.foreground"),bodyColor:j,gray:l("2d.gray")}:{img:Dl(P.getImage(e),j),bodyColor:j,gray:l("2d.gray"),stretch:l("image.stretch")};if(M&&!q);else{var h,G=J.img;G&&G.renderHTML?(Y._htmlInfo&&Y._htmlInfo.img!==G&&(Y._htmlInfo=U),Y._htmlInfo||(Y._htmlInfo={img:G,cache:{}}),h=G.renderHTML(e,P,Y._htmlInfo.cache)):Y._htmlInfo=U,Y._htmlView&&Y._htmlView!==h&&(Y._htmlView.onHTMLRemoved&&Y._htmlView.onHTMLRemoved(),Gp(Y._htmlView.getView?Y._htmlView.getView():Y._htmlView)),(Y._htmlView=h)&&P.appendHTML(h)&&h.onHTMLAdded&&h.onHTMLAdded(),J.rect=e.getRect(),J.position=e.p(),J.scale=e.getScale(),J.anchor=e.getAnchor(),J.rotation=e.getRotation(),f===Ui&&(J._63o=l("shape.depth"));var n=0;if(f)n=Or(U,J._54o/2,J._62o),Y.s("shape.dash")&&(n=N(n,(Y.s("shape.dash.width")||J._54o)/2));else if(G&&G.boundExtend)if(n=ws(G.boundExtend,e,P),G.boundExtendAbsolute){var g=e.getScale();n/=P._zoom*N(1,N(v(g.x),v(g.y)))}else if(!ws(G.fitSize,e,P)){var L=ws(G.width,e,P),W=ws(G.height,e,P);n*=N(e.getWidth()/L,e.getHeight()/W)}Y._40O(J,n);var _=l("clip.percentage");if(1>_&&(0>_&&(_=0),J.clipRect=rl(e.getAnchorRect(),l("clip.direction"),_)),f){var y=l("shape.fill.clip.percentage");1>y&&(0>y&&(y=0),J.shapeClipRect=rl(e.getAnchorRect(),l("shape.fill.clip.direction"),y));var s=l("shape.foreground.clip.percentage");1>s&&(0>s&&(s=0),J.shapeForegroundClipRect=rl(e.getAnchorRect(),l("shape.foreground.clip.direction"),s))}}},getPosition:function(A,I,q,t){var u=wd(A,this._83o.rect,t);return u.x+=I,u.y+=q,u},_80o:function(g){var K=this,q=K.s,b=K.gv,i=K._data,s=K._83o,A=s.rect,R=s.position,Z=s.rotation,y=s.anchor,N=s.scale,X=s.shape,B=s.clipRect;if(!K._checkEmptyRect||A.width>0&&A.height>0){var z=i.getSize();if(z.x=-z.width*y.x,z.y=-z.height*y.y,g.save(),Jh(g,R.x,R.y),Xk(g,Z),Di(g,N.x,N.y),B&&(g.beginPath(),g.rect(B.x,B.y,B.width,B.height),g.clip()),b._drawForChecking&&s.img&&ws(s.img.pixelPerfect,i,b)===!1)No(g,z.x,z.y,z.width,z.height,"#888888");else if(K.freeDraw)K.freeDraw(g,z,s);else if(X){var e,n,$,L,t=s._60o,Q=Ve(g,t),I=s._27Q,p=s._54o,H=s.shapeGradientPack,D=s.gray,G=g.lineJoin,M=g.lineCap,d=function(g){return D?u.toGrayColor(g):g};"roundRect"===X?e=q("shape.corner.radius"):"polygon"===X?e=q("shape.polygon.side"):"arc"===X&&(e=q("shape.arc.from"),n=q("shape.arc.to"),$=q("shape.arc.close"),L=q("shape.arc.oval")),g.lineJoin=s._62o,g.lineCap=s._61o;var c=d(s._53o);if(c||I||H){var J=s.shapeClipRect;J&&(g.save(),g.beginPath(),g.rect(J.x,J.y,J.width,J.height),g.clip()),Im(g,X,z,e,n,$,L),H?zk(g,H):I?Si(g,I,d(s.bodyColor),null,i,b):pj(g,c,s.shapeGradient,d(s._59o),z),g.fill(),J&&g.restore(),H&&g.restore(),g!==Q&&Im(Q,X,z,e,n,$,L)}else Im(Q,X,z,e,n,$,L);var V=s.shapeForeground;if(V){g.save();var m=s.shapeForegroundClipRect;m&&(g.beginPath(),g.rect(m.x,m.y,m.width,m.height),g.clip()),Im(g,X,z,e,n,$,L),pj(g,V,q("shape.foreground.gradient"),d(q("shape.foreground.gradient.color")),z),g.fill(),g.restore()}if(p>0){var Y=q("shape.border.width.absolute");Y&&(g.save(),g.setTransform(1,0,0,1,0,0)),g.lineWidth=p;var k=d(s._55o);g.strokeStyle=k,g.stroke(),Y&&g.restore(),s._56o&&Zj(g,k,d(s._57o),p,b._zoom,s._58o)}if(Zk(g,t),q("shape.dash")){var E=q("shape.dash.width")||p;if(E>0){t=q("shape.dash.pattern");var Q=Ve(g,t,K._2Q("shape.dash.offset"));Q!==g&&Im(Q,X,z,e,n,$,L),K._1Q(g,"shape",E,t)}}Bd(g,c,s._63o,z),g.lineJoin=G,g.lineCap=M}else{var w=K.interactiveInfo;w&&(g.interactiveInfo=w.bodyInfo={compInfos:[],matrix:new Uj(Z,R.x,R.y,N.x,N.y)}),s.gray&&(g.compGray=!0);var S=s.img;S&&S.cacheRule!=U&&(S=nj(g,S,s.stretch,z.width,z.height,i,b,s.bodyColor)),Dj(g,S,s.stretch,z.x,z.y,z.width,z.height,i,b,s.bodyColor),g.compGray=!1,g.interactiveInfo=U}g.restore()}K._39O(g,s)},_48O:function(){},_47O:function(){}});var xn=function(x,B){Sc(xn,this,[x,B])},jr=function(q,o,K,M){var G=Pq(q,o);return K=M?s(K,G):un(K,G),G?K/=G:K=0,{x:q.x+(o.x-q.x)*K,y:q.y+(o.y-q.y)*K}};ob(xn,tm,{_3O:function(){var L,x=this,w=x._data,m=x.gv,I=x.s,j=I(Zq),F=w.isLooped(),J=I("edge.width"),z=I("edge.center"),k=I("edge.offset"),b=m.getBorderColor(w),K=b?I("border.width"):0,V=x.getSelectWidth(),M=w._40I,v=w._41I,H=x._78o=M&&v?{looped:F,type:j,width:J,center:z,color:x.getBodyColor("edge.color"),borderColor:b,borderWidth:K,_97o:V?x.getSelectColor():U,selectWidth:V,pattern:I("edge.pattern"),cap:I("edge.cap"),join:I("edge.join"),is3d:I("edge.3d"),_67o:I("edge.3d.color"),_66o:I("edge.3d.accuracy"),gray:I("2d.gray")}:U;if(H){var y=u.getEdgeType(j);if(y){var W=y(w,Tq(x,m,w,F,j),m,x._19Q);W.points&&W.points.size()>1?(H.edgeTypeInfo=W,L=Pb(H.edgeTypeInfo.points)):W[th]&&W.rect&&(H.edgeTypeInfo=W,L=W.rect)}else{var t=I("edge.source.anchor.x"),p=I("edge.source.anchor.y"),e=I("edge.target.anchor.x"),c=I("edge.target.anchor.y"),f=Li(m,M,I("edge.source.position"),I("edge.source.offset.x"),I("edge.source.offset.y"),t,p),X=Li(m,v,I("edge.target.position"),I("edge.target.offset.x"),I("edge.target.offset.y"),e,c);if(j===Vm){var O=H.points=I(er)||zg,E=O.size();H.segments=I("edge.segments");var d=t!==g||p!==g,R=e!==g||c!==g;if(!z)if(k)d||(f=jr(f,E?O.get(0):X,k,E)),R||(X=jr(X,E?O.get(E-1):f,k,E));else{var r;d||(r=cg(f,E?O.get(0):X,bs(m,M)),r&&(f={x:r[0],y:r[1]})),R||(r=cg(E?O.get(E-1):f,X,bs(m,v)),r&&(X={x:r[0],y:r[1]}))}L=io(Pb(H.points),Pb(f,X))}else{var C=Tq(x,m,w,F,j);if(x._19Q||(C=-C),F)f=Cn(f),f.x=m.getNodeRect(M).x,H.radius=C,L={x:f.x-C,y:f.y-C,width:2*C,height:2*C};else{var o=Pq(f,X),Y=un(k,o),P={x:Y,y:C},A={x:o-Y,y:C},q=i(X.y-f.y,X.x-f.x),G=H.mat=new hm(q);if(H.orienAngle=q,H.angle=X.x<f.x?q+D:q,H.rect={x:P.x,y:P.y,width:A.x-P.x,height:0},H.origin=f,P=G.tf(P),P.x+=f.x,P.y+=f.y,A=G.tf(A),A.x+=f.x,A.y+=f.y,z){var s={x:o,y:0};s=G.tf(s),s.x+=f.x,s.y+=f.y,L=Pb([f,P,A,s]),H.c1=f,H.c2=s}else L=Pb(P,A);f=P,X=A}}H.sourcePoint=f,H.targetPoint=X,w._lastSourcePoint=f,w._lastTargetPoint=X}var Z=0;I("edge.dash")&&(Z=I("edge.dash.width")||J);var B="square"===H.cap?.71:.5;Or(L,N(Z*B,J*B+K+V),H.join),x._68o(L)}},getRotation:function(R,C,n){R=R||0;var Y=this._78o;if(Y){var z,k=Y.angle,m=Y.points,r=Y.edgeTypeInfo;if(k!=U)return C?Y.orienAngle+R:k+R;if(r&&r[th])return r.getRotation?r.getRotation(this,R,C,n):0;if(r&&r.points){var D=r.points;return z=D.size(),gn[n]?z&&0===z%2?Ap(D.get(z/2-1),D.get(z/2),C,R):R:Ur[n]?Ap(D.get(0),D.get(1),C,R):Ap(D.get(z-2),D.get(z-1),C,R)}if(m)return z=m.size(),gn[n]?z&&0===z%2?Ap(m.get(z/2-1),m.get(z/2),C,R):R:Ur[n]?Ap(Y.sourcePoint,z?m.get(0):Y.targetPoint,C,R):Ap(z?m.get(z-1):Y.sourcePoint,Y.targetPoint,C,R)}return R},getPosition:function(K,F,b,y,t){var k=this._78o;if(k){var w,d=k.type,g=k.points,E=k.edgeTypeInfo,N=k.sourcePoint,D=k.targetPoint;if(!d)return k.looped?{x:N.x-k.radius+F,y:N.y+b}:(t&&N&&D&&(N.x>D.x||N.x===D.x&&N.y>D.y)&&(K=dd[K],b=-b),w=wd(K,k.rect,y),w.x+=F,w.y+=b,w=k.mat.tf(w),w.x+=k.origin.x,w.y+=k.origin.y,w);if(E&&E[th])return E.getPosition?E.getPosition(this,K,F,b,y,t):{x:(N.x+D.x)/2,y:(N.y+D.y)/2};if(g){var w,B=g.size();if(gn[K]){if(B){var I=B%2;if(0===I)return ug(g.get(B/2-1),g.get(B/2),K,F,b,y,t);w=g.get((B-I)/2)}else w={x:(N.x+D.x)/2,y:(N.y+D.y)/2};return w=wd(K,{x:w.x,y:w.y,width:0,height:0},y),w.x+=F,w.y+=b,w}return Ur[K]?ug(N,B?g.get(0):D,K,F,b,y,t):ug(B?g.get(B-1):N,D,K,F,b,y,t)}if(E){var z=E.points,B=z.size();if(gn[K]){var I=B%2;return 0===I?ug(z.get(B/2-1),z.get(B/2),K,F,b,y,t):(w=z.get((B-I)/2),w=wd(K,{x:w.x,y:w.y,width:0,height:0},y),w.x+=F,w.y+=b,w)}return Ur[K]?ug(z.get(0),z.get(1),K,F,b,y,t):ug(z.get(B-2),z.get(B-1),K,F,b,y,t)}}return Ng},_42:function($){this._78o&&xn.superClass._42.call(this,$)},drawPath:function(Z,f){Z.beginPath();var $=f.type,U=f.points,z=f.segments,I=f.edgeTypeInfo;if(!$||U){var O=f.sourcePoint,V=O.x,v=O.y,D=f.targetPoint,P=D.x,Y=D.y;if($)if(z){var H=new vc({x:V,y:v});H.addAll(U),H.add({x:P,y:Y}),Ei(Z,H,z)}else Z.moveTo(V,v),U.each(function(e){Z.lineTo(e.x,e.y)}),Z.lineTo(P,Y);else f.looped?Z.arc(V,v,f.radius,0,E,!0):f.center?(Z.moveTo(f.c1.x,f.c1.y),Z.lineTo(V,v),Z.lineTo(P,Y),Z.lineTo(f.c2.x,f.c2.y)):(Z.moveTo(V,v),Z.lineTo(P,Y))}else I&&(I.points?Ei(Z,I.points,I.segments):I[th]&&I[th](Z,I))},_80o:function(y){var s=this,C=s.s,f=s._78o,m=f.width,r=f.selectWidth,h=f.borderWidth,B=y.lineJoin,Y=y.lineCap,T=f.gray,n=f.pattern;y.lineJoin=f.join,y.lineCap=f.cap,s.drawPath(Ve(y,n),f);var V=C("edge.width.absolute");V&&(y.save(),y.setTransform(1,0,0,1,0,0)),r&&(y.strokeStyle=f._97o,y.lineWidth=m+2*(h+r),y.stroke()),h&&(y.strokeStyle=T?u.toGrayColor(f.borderColor):f.borderColor,y.lineWidth=m+2*h,y.stroke());var _=T?u.toGrayColor(f.color):f.color,k=T?u.toGrayColor(f._67o):f._67o;if(y.strokeStyle=_,y.lineWidth=m,y.stroke(),f.is3d&&Zj(y,_,k,m,s.gv._zoom,f._66o),V&&y.restore(),Zk(y,n),C("edge.dash")){n=C("edge.dash.pattern");var I=Ve(y,n,s._2Q("edge.dash.offset"));I!==y&&s.drawPath(I,f),s._1Q(y,"edge",C("edge.dash.width")||m,n)}y.lineJoin=B,y.lineCap=Y},_48O:function(){},_47O:function(){},_71o:function(K,S){var c=this,C=c._data;if(c._19Q=!0,!C.getEdgeGroup())return K?C.s("edge.gap"):0;var G,X=0,h=0,_=0;if(C.getEdgeGroup().getSiblings().each(function(o){o.each(function(Z){if(c.gv.isVisible(Z)&&Z.s(Zq)==S){var R=Z.s("edge.gap");G?(h+=_/2+R/2,_=R):(G=Z,_=R),Z===C&&(X=h)}})}),K)return h-X+_;var z=X-h/2;return G&&C._40I!==G._40I&&(c._19Q=!1),z}});var Hj=function(e,n){Sc(Hj,this,[e,n])};ob(Hj,ki,{_3O:function(){var R,W,D=this,e=D.s,N=D._data,G=D.gv;if(D._88I=U,N.isExpanded()&&N.eachChild(function(F){if(_h(F)){var I=G.getBoundsForGroup(F);I&&(W||(W=[]),W.push(I),R=io(R,I))}}),R){var p=G.getLabel(N),o=e("group.type");R=sn(o,W,R),ns(R,N,"group.padding",1);var _=D._88I={type:o,rect:R,_64o:R};if(!o&&p!=U){var A,c=D.labelInfo={label:p,color:e("group.title.color"),font:e("group.title.font"),align:e("group.title.align")},P=Bj(c,p),H=P.width,M=P.height,s=e("group.title.align"),n=e("group.title.orientation");if((n===Ij||n===Lb)&&H>R.width?R.width=H:(n===Qg||n===Td)&&H>R.height&&(R.height=H),c.rect={y:R.y-M,width:P.width,height:M},A=s===Qg?R.x:s===Td?R.x+R.width-H:R.x+R.width/2-H/2,c.rect.x=A,n===Lb)_.titleRect={x:R.x,y:R.y+R.height,width:R.width,height:M},_.rect={x:R.x,y:R.y,width:R.width,height:R.height+M},c.rect={x:A,y:R.y+R.height,width:H,height:M};else if(n===Qg){var x=_.titleRect={x:R.x-M,y:R.y,width:M,height:R.height};_.rect={x:R.x-M,y:R.y,width:R.width+M,height:R.height},c.rect={x:x.x+M/2-R.height/2,y:x.y+R.height/2-M/2,width:R.height,height:M},c.rotation=-Math.PI/2}else if(n===Td){var x=_.titleRect={x:R.x+R.width,y:R.y,width:M,height:R.height};_.rect={x:R.x,y:R.y,width:R.width+M,height:R.height},c.rect={x:x.x+M/2-R.height/2,y:x.y+R.height/2-M/2,width:R.height,height:M},c.rotation=Math.PI/2}else _.titleRect={x:R.x,y:R.y-M,width:R.width,height:M+1},_.rect={x:R.x,y:R.y-M,width:R.width,height:R.height+M}}D._40O(_,e("group.border.width")/2)}else Hj.superClass._3O.call(D)},getPosition:function(l,A,v,V){var $=this._88I;if($){var w=wd(l,$.rect,V);return w.x+=A,w.y+=v,w}return Hj.superClass.getPosition.apply(this,arguments)},_24O:function(H,R){var s=this._88I;(!s||s.type||"label2"===H)&&Hj.superClass._24O.call(this,H,R)},_80o:function(g){var r=this,F=r._88I;if(F){var Q=r._data,K=r.s,x=r.gv,z=F.type,a=F.rect,o=F._64o,E=F.titleRect,O=r.getBodyColor(),l=Dl(K("group.image"),O),m=K("group.image.stretch"),s=r.getBodyColor("group.background"),u=Dl(K("group.repeat.image"),O),W=K("group.gradient.pack"),d=K("group.gradient"),y=K("group.gradient.color"),P=K("group.border.width"),q=K("group.border.color"),H=K("group.border.pattern"),c=K("group.title.orientation"),S=K("group.depth");if(z){var N=g.lineJoin,Y=g.lineCap;if(g.lineJoin=K("group.border.join"),g.lineCap=K("group.border.cap"),l){if(g.save(),Im(g,z,a),g.clip(),Dj(g,l,m,a.x,a.y,a.width,a.height,Q,x,O),g.restore(),P>0){var R=Ve(g,H);Im(R,z,a),g.lineWidth=P,g.strokeStyle=q,g.stroke(),Zk(g,H)}}else{var R=Ve(g,H);s||u||W?(Im(g,z,a),W?zk(g,W):u?Si(g,u,O,null,Q,x):pj(g,s,d,y,a),g.fill(),W&&g.restore(),g!==R&&Im(R,z,a)):Im(R,z,a),P>0&&(g.lineWidth=P,g.strokeStyle=K("group.border.color"),g.stroke()),Zk(g,H),z===Ui&&Bd(g,s,S,a)}g.lineJoin=N,g.lineCap=Y}else{var k=K("group.title.background"),h=K("group.border.radius");if(l)Dj(g,l,m,o.x,o.y,o.width,o.height,Q,x,r.getBodyColor());else if(s||u)if(u?Si(g,u,O,null,Q,x):pj(g,s,d,y,o),0===P)Im(g,Ui,o),g.fill(),Bd(g,s,S,o);else{switch(g.beginPath(),c){case Lb:ur(g,o.x,o.y,o.width,o.height,h,h,0,0);break;case Qg:ur(g,o.x,o.y,o.width,o.height,0,h,0,h);break;case Td:ur(g,o.x,o.y,o.width,o.height,h,0,h,0);break;case Ij:ur(g,o.x,o.y,o.width,o.height,0,0,h,h)}g.fill()}if(E&&k)if(0===P)No(g,E.x,E.y,E.width,E.height,k),Bd(g,k,S,E);else{switch(g.beginPath(),g.fillStyle=k,c){case Lb:ur(g,E.x,E.y,E.width,E.height,0,0,h,h);break;case Qg:ur(g,E.x,E.y,E.width,E.height,h,0,h,0);break;case Td:ur(g,E.x,E.y,E.width,E.height,0,h,0,h);break;case Ij:ur(g,E.x,E.y,E.width,E.height,h,h,0,0)}g.fill()}if(P>0){var R=Ve(g,H);if(Im(R,"roundRect",a,h),g.lineWidth=P,g.strokeStyle=q,E&&K("group.splitLine")){var v=E.x,L=E.y,$=E.width,J=E.height;c===Lb?(g.moveTo(v,L),g.lineTo(v+$,L)):c===Qg?(g.moveTo(v+$,L),g.lineTo(v+$,L+J)):c===Td?(g.moveTo(v,L),g.lineTo(v,L+J)):(g.moveTo(v,L+J),g.lineTo(v+$,L+J))}g.stroke(),Zk(g,H)}}r._39O(g,F)}else Hj.superClass._80o.call(r,g)}});var is=function(E,i){Sc(is,this,[E,i])};ob(is,ki,{_80o:function(H){this._39O(H,this._83o)}});var Dg=function(Q,t){Sc(Dg,this,[Q,t])};ob(Dg,ki,{_3O:function(){var C=this,x=C._data,q=C.s,J=C.gv,T=x.getPoints(),y=J.getBorderColor(x),Q=y?q("border.width"):0,R=C.getSelectWidth(),L=q("shape.border.width"),$=x.getRect(),l=J.getBodyColor(x),w=C._99o=T.isEmpty()?U:{rect:$,rotation:x.getRotation(),fillRule:q("shape.fill.rule"),scale:x.getScale(),position:x.p(),points:T,segments:x.getSegments(),bodyColor:l,borderColor:y,borderWidth:Q,_94o:q("shape.border.3d"),_95o:q("shape.border.3d.color"),_96o:q("shape.border.3d.accuracy"),_97o:R?C.getSelectColor():U,selectWidth:R,_53o:q("shape.background"),_27Q:Dl(q("shape.repeat.image"),l),shapeGradientPack:q("shape.gradient.pack"),_54o:L,_55o:q("shape.border.color"),shapeGradient:q("shape.gradient"),_59o:q("shape.gradient.color"),_60o:q("shape.border.pattern"),_61o:q("shape.border.cap"),_62o:q("shape.border.join"),shapeForeground:q("shape.foreground"),gray:q("2d.gray")};if(w){var A=x.getScale(),m=N(1,N(v(A.x),v(A.y)));q("shape.dash")&&q("shape.dash.width")>L&&(L=q("shape.dash.width"));var V=L*("square"===w._61o?.71:.5)+Q+R/C.gv._zoom/m;V&&(V*=m,$=Cn($),Or($,V,w._62o)),C._68o($);var S=q("clip.percentage");1>S&&(0>S&&(S=0),w.clipRect=rl(x.getAnchorRect(),q("clip.direction"),S));var o=q("shape.fill.clip.percentage");1>o&&(0>o&&(o=0),w.shapeClipRect=rl(x.getAnchorRect(),q("shape.fill.clip.direction"),o));var Z=q("shape.foreground.clip.percentage");1>Z&&(0>Z&&(Z=0),w.shapeForegroundClipRect=rl(x.getAnchorRect(),q("shape.foreground.clip.direction"),Z))}},getPosition:function(E,H,p,M){var m=this._99o;if(m){var b=wd(E,m.rect,M);return b.x+=H,b.y+=p,b}return Ng},_42:function(P){this._99o&&Dg.superClass._42.call(this,P)},_80o:function(o){var c,B=this,A=B.s,M=B._99o,Y=M.position,z=M.scale,K=M.rotation,$=M.borderWidth,L=M.selectWidth/B.gv._zoom,Z=M._27Q,G=M.shapeGradientPack,E=M._54o,q=M.clipRect,m=M.shapeClipRect,X=M.points,F=M.segments,T=B._data.isClosePath(),D=M.fillRule,n=M.gray,Q=function(T){return n?u.toGrayColor(T):T},l=Q(M._53o),a=l||Z||G;o.save(),Jh(o,Y.x,Y.y),Xk(o,K),Di(o,z.x,z.y),q&&(o.beginPath(),o.rect(q.x,q.y,q.width,q.height),o.clip()),a&&m&&(o.save(),o.beginPath(),o.rect(m.x,m.y,m.width,m.height),o.clip()),Jh(o,-Y.x,-Y.y);var g=M._60o,J=Ve(o,g),_=o.lineJoin,H=o.lineCap;o.lineJoin=M._62o,o.lineCap=M._61o;var j=Q(M.bodyColor);a?(Ei(o,X,F,T),G?zk(o,G):Z?Si(o,Z,j,null,B._data,B.gv):(c=j?j:l,pj(o,c,M.shapeGradient,Q(M._59o),M.rect)),o.fill(D),m&&(o.restore(),Jh(o,-Y.x,-Y.y)),G&&o.restore(),J!==o&&Ei(J,X,F,T)):Ei(J,X,F,T);var k=M.shapeForeground;if(k){o.save();var S=M.shapeForegroundClipRect;S&&(Jh(o,Y.x,Y.y),o.beginPath(),o.rect(S.x,S.y,S.width,S.height),o.clip(),Jh(o,-Y.x,-Y.y)),Ei(o,X,F,T),pj(o,k,A("shape.foreground.gradient"),Q(A("shape.foreground.gradient.color")),M.rect),o.fill(D),o.restore()}var s=A("shape.border.width.absolute");if(s&&(o.save(),o.setTransform(1,0,0,1,0,0)),L&&(o.strokeStyle=M._97o,o.lineWidth=E+2*($+L),o.stroke()),$&&(o.strokeStyle=Q(M.borderColor),o.lineWidth=E+2*$,o.stroke()),E&&(c=Q(M._55o),!l&&j&&(c=j),o.strokeStyle=c,o.lineWidth=E,o.stroke(),M._94o&&Zj(o,c,Q(M._95o),E,B.gv._zoom,M._96o)),s&&o.restore(),Zk(o,g),A("shape.dash")){var t=A("shape.dash.width")||E;if(t>0){g=A("shape.dash.pattern");var J=Ve(o,g,B._2Q("shape.dash.offset"));J!==o&&Ei(J,X,F,T),B._1Q(o,"shape",t,g)}}o.lineJoin=_,o.lineCap=H,o.restore()},_48O:function(){},_47O:function(){}});var So=function(f,m){Sc(So,this,[f,m])};ob(So,Dg,{getRotation:function(W,S,B){W=W||0;var X=this._data.getPoints(),y=X.size();return y>1?gn[B]?y&&0===y%2?Ap(X.get(y/2-1),X.get(y/2),S,W):W:Ur[B]?Ap(X.get(0),X.get(1),S,W):Ap(X.get(y-2),X.get(y-1),S,W):W},getPosition:function(h,P,R,S,M){var W=this._data.getPoints(),I=W.size();if(I>1){if(gn[h]){var w=I%2;if(0===w)return ug(W.get(I/2-1),W.get(I/2),h,P,R,S,M);var t=W.get((I-w)/2),l={x:t.x,y:t.y,width:0,height:0};return t=wd(h,l,S),t.x+=P,t.y+=R,t}return Ur[h]?ug(W.get(0),W.get(1),h,P,R,S,M):ug(W.get(I-2),W.get(I-1),h,P,R,S,M)}return Ng}});var Mj=function(q,x){Sc(Mj,this,[q,x])};ob(Mj,ki,{_3O:function(){var s=this;Mj.superClass._3O.call(s);var f=s.s,C=s._83o;s._82o=C.img||C.shape?U:{background:s.getBodyColor("grid.background"),depth:f("grid.depth"),rect:C.rect,_88o:f("grid.cell.depth"),cellBorderColor:f("grid.cell.border.color"),_89o:f("grid.row.count"),_90o:f("grid.column.count"),block:f("grid.block"),_91o:f("grid.block.color"),_92o:f("grid.block.padding"),_93o:f("grid.block.width")}},_80o:function(_){var c=this,A=c._82o;if(!A)return Mj.superClass._80o.call(c,_),void 0;var U,I,x=c._data,N=A.background,t=A.rect,y=A.block,n=A._91o,g=A._92o,u=A._93o,d=A._88o,J=A.cellBorderColor,S=A._89o,b=A._90o;if(N)if(No(_,t.x,t.y,t.width,t.height,N),Bd(_,N,A.depth,t),d)for(U=0;S>U;U++)for(I=0;b>I;I++)t=x.getCellRect(U,I),t&&Bd(_,N,d,t);else if(J){for(_.beginPath(),U=0;S>U;U++)for(I=0;b>I;I++)t=x.getCellRect(U,I),t&&_.rect(t.x,t.y,t.width,t.height);_.strokeStyle=J,_.lineWidth=1,_.stroke()}if("h"===y)for(U=0;S>U;U++)t=io(x.getCellRect(U,0),x.getCellRect(U,b-1)),fo(t,g),Ko(_,n,t.x,t.y,t.width,t.height,u);else if("v"===y)for(I=0;b>I;I++)t=io(x.getCellRect(0,I),x.getCellRect(S-1,I)),fo(t,g),Ko(_,n,t.x,t.y,t.width,t.height,u);c._39O(_,c._83o)}});var ui=function(v,C){Sc(ui,this,[v,C])};ob(ui,ki,{_checkEmptyRect:!1,_81o:function(){var R=this._data,I=ui.superClass._81o.call(this),S=R.s("text");if(S!=U){var k,Z,u=R.s("text.font"),N=R.s("text.align"),b=R.s("text.vAlign"),X=Go(u,S),y=X.width,w=X.height,E=R.getAnchor(),M=R.getWidth(),D=R.getHeight();"left"===N?k=-M*E.x:"center"===N?k=-M*E.x+(M-y)/2:"right"===N&&(k=M*(1-E.x)-X.width),"top"===b?Z=-D*E.y:"middle"===b?Z=-D*E.y+(D-w)/2:"bottom"===b&&(Z=D*(1-E.y)-X.height);var m,n=R.getMatrix();if(m=Pb([n.tf(k,Z),n.tf(k+y,Z),n.tf(k+y,Z+w),n.tf(k,Z+w)]),I=io(I,m),I&&R.s("text.shadow")){var l=Cn(I);l.x+=R.s("text.shadow.offset.x"),l.y+=R.s("text.shadow.offset.y"),fo(l,R.s("text.shadow.blur")),I=io(I,l)}}return I}});var Gh=To.Interactor=function(W){this.gv=this._graphView=W};oc("Interactor",Z,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(C){this.gv.fi(C)},setCursor:function(M){$d||this.gv.setCursor(M)},startDragging:function(P){var C=this;C._lastClientPoint=Zg(P),C._lastLogicalPoint=C.gv.lp(P),Ti(C,P)},clearDragging:function(){var X=this;X._lastClientPoint=X._lastLogicalPoint=X._logicalPoint=U},autoScroll:function(g){return this.gv.autoScroll(g,this._lastClientPoint)}});var Qi=U,Ib=function(T){Qi.handleWindowTouchMove(T)},id=function(Y){Qi.handleWindowTouchEnd(Y),_.removeEventListener(dp,Ib,O),_.removeEventListener(tp,id,O),Qi=U},Ho=function(g){Qi.handleWindowMouseMove(g)},re=function(B){Qi.handleWindowMouseUp(B),_.removeEventListener(up,Ho,O),_.removeEventListener(df,re,O),Qi=U},hr=function(g,D){g!==Qi&&(Qi?$d?Qi.handleWindowTouchEnd(D):Qi.handleWindowMouseUp(D):$d?(_.addEventListener(dp,Ib,O),_.addEventListener(tp,id,O)):(_.addEventListener(up,Ho,O),_.addEventListener(df,re,O)),Qi=g)},$q=function(V){var e=this;e.gv=V,e._is2d=V instanceof To.GraphView,e._is2d&&(e.filter=function(a){return V.isSelectable(a)&&V.isInteractive(a)}),V.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",Sh].forEach(function(b){e.addListener(b)}),e.initImageResource()};ob($q,Gh,{enableVR:function(y){var k=this;if(!!k._vrEnable!==y)if(k._vrEnable=y,y)k.gv.vr.mp(k.onVRControllerChange,k);else if(k.gv.vr.ump(k.onVRControllerChange,k),k._vrRayPolyline){var f=k.gv.dm();f.remove(k._vrRayPolyline),f.remove(k._vrRayHitPoint),k._vrRayPolyline=g,k._vrRayHitPoint=g}},onVRControllerChange:function(g){var T=this,j=g.property,Q=g.newValue,n=T.gv.vr.getController(Q.id),R=n.getRay();R&&("gamepad.button.trigger"===j?"down"===Q._62O?T.handle_mousedown(R):T.handleWindowMouseUp(R):"gamepad.pose"===j&&(T.handle_mousemove(R),T.handleWindowMouseMove(R)))},drawVRRay:function(S,O,L){var X,B=this,g=B.gv,Z=B._vrRayPolyline,d=!1;if(Z)X=B._vrRayHitPoint;else{var x=g.dm();B._vrRayPolyline=Z=new o.Polyline,B._vrRayHitPoint=X=new o.Node,X.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),X.setAnchor3d(.5,.5,.499);var K=.2/g.vr.measureOflength;X.s3(K,K,K),Z.s("intersect",!1),X.s("intersect",!1),x.add(Z),x.add(X),d=!0}if(O){var u=L.world,W=L.worldNormal,q=u.x,t=u.y,r=u.z;Z.s("shape.border.color","red"),Z.setPoints([{x:S.origin.x,y:S.origin.z,e:S.origin.y},{x:q,y:r,e:t}]),X.s("3d.visible",!0),X.p3(q,t,r),X.lookAtDirection([W.x,W.y,W.z],"front")}else{Z.s("shape.border.color","blue");var F=new o.Math.Vector3;F.copy(S.direction).setLength(1e3/B.gv.vr.measureOflength).add(S.origin),Z.setPoints([{x:S.origin.x,y:S.origin.z,e:S.origin.y},{x:F.x,y:F.z,e:F.y}]),X.s("3d.visible",!1)}g.fi({kind:"vrRayIntersect",ray:S,data:O,intersect:L,polyline:Z,hitNode:X,begin:d})},addListener:function(X){var d=this;d.gv.getView().addEventListener(X,function(H){u.preventDefault(H),d.disabled||d["handle_"+X](H)},O)},handleWindowTouchMove:function(u){this.handleWindowMouseMove(u)},handleWindowMouseMove:function(D){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",D):(this.handleDownInfo("onBeginDrag",D),this.isDragging=!0))},handleWindowTouchEnd:function(m){this.handleWindowMouseUp(m)},handleWindowMouseUp:function(C){if(this.isDragging&&(this.handleDownInfo("onEndDrag",C),this.isDragging=!1),this.downInfo){var B=this.handle("onUp",C);B&&B.data===this.downInfo.data?this.handleMissingUp(C):this.handleDownInfo("onUp",C),this.downInfo=U}},handle_mouseleave:function(Z){var m=this,l=m.gv,y=m.currentInfo?m.currentInfo.data:U;if(y){y.s("onLeave")&&y.s("onLeave")(Z,y,l),m.fire("data","onLeave",Z,y);var Y=m.currentInfo?m.currentInfo.hits:U;if(Y)for(var r in Y)m.handleLeave(Z,r);m.currentInfo=U}},handle_mousewheel:function(n){n.scrollDelta=n.wheelDelta/40,this.handle("onScroll",n)},handle_DOMMouseScroll:function(J){J.scrollDelta=2===J.axis?-J.detail:0,this.handle("onScroll",J)},handle_touchstart:function(N){this.handle_mousedown(N)},handle_touchmove:function(R){this.handle("onMove",R)},handle_mousedown:function(e){this.isDragging&&(this.handleDownInfo("onEndDrag",e),this.isDragging=!1),this.downInfo=this.handle("onDown",e),this.downInfo&&hr(this,e)},handle_mousemove:function(d){var z=this,C=z.gv;z._hoverTimer&&(t(z._hoverTimer),delete z._hoverTimer);var m,I,c,n=z.handle("onMove",d),y=this.currentInfo?this.currentInfo.data:U,x=this.currentInfo?this.currentInfo.hits:U;if(n&&(I=n.data,c=n.hits,z._hoverTimer=l(function(){t(z._hoverTimer),delete z._hoverTimer,z.handle("onHover",d,n)},C.getHoverDelay()||u.hoverDelay)),I!==y){if(y&&(y.s("onLeave")&&y.s("onLeave")(d,y,C),this.fire("data","onLeave",d,y)),I&&(I.s("onEnter")&&I.s("onEnter")(d,I,C),this.fire("data","onEnter",d,I)),x)for(m in x)this.handleLeave(d,m);if(c)for(m in c){var Y=c[m];Y.target.onEnter&&Y.target.onEnter(d,I,C,Y.point,Y.width,Y.height),this.fire(Y.type,"onEnter",Y.event,Y.data,Y.image,Y.comp,Y.point,Y)}}else{if(x)for(m in x)c&&c[m]||this.handleLeave(d,m);if(c)for(m in c)if(!x||!x[m]){var Y=c[m];Y.target.onEnter&&Y.target.onEnter(d,I,C,Y.point,Y.width,Y.height),this.fire(Y.type,"onEnter",Y.event,Y.data,Y.image,Y.comp,Y.point,Y)}}this.currentInfo=n},handle:function(U,W,O){var N,_=this,S=_.gv;if(_._is2d){if(O=O||S.getDataInfoAt(W,this.filter),!O)return;if(N=O.ui.interactiveInfo){var F,M=O.data;if(M.s(U)&&M.s(U)(W,M,S),this.fire("data",U,W,M),"body"===O.part&&N.bodyInfo)F="body",O.hits=this.handleImage(F,S.getImage(M),U,W,M,O.point,N.bodyInfo);else if("icons"===O.part&&N._38o){var l=N._38o[O.name];l&&l[O.index]&&(F="icons|"+O.name+"|"+O.index,O.hits=this.handleImage(F,O.icon,U,W,M,O.point,l[O.index]))}}return O}var M,q;if(!O)if(W&&W instanceof o.Math.Ray){var V=S.vr.intersectWorld(W);if(M=V.data,q=V.intersect,_.drawVRRay(W,M,q),!M)return;var K=S.getData3dUI(M);if(N=K.interactiveInfo,!N)return;O={data:M,part:q.part,ui:K}}else{if(O=S.getDataInfoAt(W),!O)return;O&&(O={data:O.data,part:O.part})}if(!q){M=O.data;var K=S.getData3dUI(M);if(O.ui=K,N=K.interactiveInfo,!N)return O;if(q=S.intersectObject(W,M),!q)return}M.s(U)&&M.s(U)(W,M,S),this.fire("data",U,W,M);var L,E=q.part;return"body"!==E&&(L=M.s(E+".image")||M.s("shape3d."+E+".image")),L||(L=M.s("all.image")||M.s("shape3d.image")),N="object"==typeof L?N[L.uuid]:N[L],N&&N.bodyInfo?(O.part="body",O.interactiveInfo=N,O.point=q.uv.multiply({x:N.bodyInfo.rect.width,y:N.bodyInfo.rect.height}),O.image=L,O.hits=this.handleImage("body",L,U,W,M,O.point,N.bodyInfo),O):O},_handleLeaveOrMissing:function($,q,W){var g="leave"===$?this.currentInfo:this.downInfo;if(g){var X=g.interactiveInfo||g.ui.interactiveInfo;if(X){var b,l,Y=g.data;if(this._is2d){if(l=this.gv.lp(q),"body"===g.part&&X.bodyInfo)b="body","leave"===$?this.handleLeaveImage(W,b,this.gv.getImage(Y),q,Y,l,X.bodyInfo):this.handleMissingUpImage(b,this.gv.getImage(Y),q,Y,l,X.bodyInfo);else if("icons"===g.part&&X._38o){var p=X._38o[g.name];p&&p[g.index]&&(b="icons|"+g.name+"|"+g.index,"leave"===$?this.handleLeaveImage(W,b,g.icon,q,Y,l,p[g.index]):this.handleMissingUpImage(b,g.icon,q,Y,l,p[g.index]))}}else{if(!X.bodyInfo)return;var P=this.gv.intersectObject(q,Y);l=P?P.uv.multiply({x:X.bodyInfo.rect.width,y:X.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===$?this.handleLeaveImage(W,"body",g.image,q,Y,l,X.bodyInfo):this.handleMissingUpImage("body",g.image,q,Y,l,X.bodyInfo)}}}},handleDownInfo:function(C,w){if(this.downInfo){var I=this.downInfo,v=this.gv,V=I.interactiveInfo||I.ui.interactiveInfo;if(V){var o,h=I.data;if(h.s(C)&&h.s(C)(w,h,v),this.fire("data",C,w,h),this._is2d){var F=v.lp(w);if("body"===I.part&&V.bodyInfo)o="body",this.handleDownInfoImage(o,v.getImage(h),C,w,h,F,V.bodyInfo);else if("icons"===I.part&&V._38o){var r=V._38o[I.name];r&&r[I.index]&&(o="icons|"+I.name+"|"+I.index,this.handleDownInfoImage(o,I.icon,C,w,h,F,r[I.index]))}}else{if(!V.bodyInfo)return;var Q=v.intersectObject(w,h);if(!Q)return;F=Q.uv.multiply({x:V.bodyInfo.rect.width,y:V.bodyInfo.rect.height}),this.handleDownInfoImage("body",I.image,C,w,h,F,V.bodyInfo)}}}},fire:function(y,O,C,D,n,f,h,$){this.gv.fi({kind:O,type:y,event:C,data:D,image:n,comp:f,view:this.gv,point:h,width:$?$.width:g,height:$?$.height:g})},handleImage:function(Y,p,y,c,i,I,e){var t={};if(p&&(p=Dl(p))){var G=this.gv,J=e.rect,F=this.convertPoint(I,e);F.inRect&&(p[y]&&p[y](c,i,G,F,J.width,J.height),this.fire("image",y,c,i,p,g,F,J),t[Y+"|image"]={target:p,type:"image",image:p,data:i,event:c,point:F,width:J.width,height:J.height});for(var k=e.compInfos,Q=p,Z=k.length-1;Z>=0;Z--){var $=k[Z],L=$.comp;F=this.convertPoint(I,$,Q,L,G,i),F.inRect&&(J=$.rect,L[y]&&L[y](c,i,G,F,J.width,J.height),this.fire("comp",y,c,i,p,L,F,J),(p=J.image)&&(p[y]&&p[y](c,i,G,F,J.width,J.height),this.fire("image",y,c,i,p,g,F,J)),t[Y+"|"+Z]={target:L,type:"comp",comp:L,image:p,data:i,event:c,point:F,width:J.width,height:J.height},p&&(t[Y+"|"+Z+"|image"]={target:p,type:"image",image:p,data:i,event:c,point:F,width:J.width,height:J.height}))}}return t},handleLeave:function(l,h){return this._handleLeaveOrMissing("leave",l,h)},handleMissingUp:function(z){return this._handleLeaveOrMissing("missing",z)},handleLeaveImage:function(y,w,v,s,B,M,Q){if(v&&(v=Dl(v))){var f=this.gv,$=Q.rect,x=this.convertPoint(M,Q);y===w+"|image"&&(v.onLeave&&v.onLeave(s,B,f,x,$.width,$.height),this.fire("image","onLeave",s,B,v,g,x,$));for(var n=Q.compInfos,p=v,N=n.length-1;N>=0;N--){var U=n[N],q=U.comp;x=this.convertPoint(M,U,p,q,f,B),$=U.rect,y===w+"|"+N&&(q.onLeave&&q.onLeave(s,B,f,x,$.width,$.height),this.fire("comp","onLeave",s,B,v,q,x,$)),(v=$.image)&&y===w+"|"+N+"|image"&&(v.onLeave&&v.onLeave(s,B,f,x,$.width,$.height),this.fire("image","onLeave",s,B,v,g,x,$))}}},handleMissingUpImage:function(F,p,O,h,m,_){var o="onUp",R=this.downInfo.hits;if(R&&p&&(p=Dl(p))){var d=this.gv,f=_.rect,Z=this.convertPoint(m,_);!Z.inRect&&R[F+"|image"]&&(p[o]&&p[o](O,h,d,Z,f.width,f.height),this.fire("image",o,O,h,p,g,Z,f));for(var S=_.compInfos,A=p,L=S.length-1;L>=0;L--){var a=S[L],k=a.comp;Z=this.convertPoint(m,a,A,k,d,h),Z.inRect||(f=a.rect,R[F+"|"+L]&&(k[o]&&k[o](O,h,d,Z,f.width,f.height),this.fire("comp",o,O,h,p,k,Z,f)),(p=f.image)&&R[F+"|"+L+"|image"]&&(p[o]&&p[o](O,h,d,Z,f.width,f.height),this.fire("image",o,O,h,p,g,Z,f)))}}},handleDownInfoImage:function(U,V,r,o,Y,z,s){var H=this.downInfo.hits;
if(H&&V&&(V=Dl(V))){var b=this.gv,Q=s.rect,P=this.convertPoint(z,s);H[U+"|image"]&&(V[r]&&V[r](o,Y,b,P,Q.width,Q.height),this.fire("image",r,o,Y,V,g,P,Q));for(var p=s.compInfos,n=V,M=p.length-1;M>=0;M--){var S=p[M],l=S.comp;P=this.convertPoint(z,S,n,l,b,Y),Q=S.rect,H[U+"|"+M]&&(l[r]&&l[r](o,Y,b,P,Q.width,Q.height),this.fire("comp",r,o,Y,V,l,P,Q)),(V=Q.image)&&H[U+"|"+M+"|image"]&&(V[r]&&V[r](o,Y,b,P,Q.width,Q.height),this.fire("image",r,o,Y,V,g,P,Q))}}},initImageResource:function(){u.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(L,d,X,Q,T,p){var C=d.rect,I=d.matrix.applyInverse(L).sub(C),Z=I.x>=0&&I.y>=0&&I.x<=C.width&&I.y<=C.height;if(!Z)return I;if(Q&&ws(Q.pixelPerfect,p,T)){var C,n=1;this._is2d?(n=T.getZoom(),C=en(L.x,L.y,g,n)):C=en(L.x,L.y);var a=!1,K=C.x,D=C.y,O=C.width,j=C.height,r=u.hitMaxArea,B=O*j*n*n;if(B>r){var e=Math.sqrt(r/B);n*=e}O*=n,j*=n,2>O&&(O=2),2>j&&(j=2),K*=n,D*=n;var o=hn(O,j),z=new Uj(0,-K,-D,n,n);z.append(d.matrix),T._drawForChecking=!0,Q.transform=z;var x=X.comps;X.comps=[Q],lm(o,X,0,0,O,j,p,self),X.comps=x,delete Q.transform,T._drawForChecking=!1;try{for(var H=0,c=o.getImageData(0,0,O,j).data;H<c.length;H+=4)if(0!==c[H+3]){a=!0;break}o.restore()}catch(N){Tl=U,a=!1}I.inRect=a}else I.inRect=!0;return I}});var Zf=To.DefaultInteractor=function(U){Sc(Zf,this,[U])};oc("DefaultInteractor",Gh,{handle_mousedown:function(O){td(O);var z=this,L=z.gv,r=L.getDataAt(O);!L.setFocus(O)||L._editing||L._scrolling||(qc(O)?L.handleDoubleClick(O,r):L.handleClick(O,r),!Lo()&&r&&(L.isMovable(r)||L.isInteractive(r))||!L.isPannable()||!lk(O)||ds(O)||(z._tx=L.tx(),z._ty=L.ty(),z.startDragging(O)))},handleWindowMouseUp:function(A){var M=this,K=M.gv;K._panning&&(delete K._panning,K.onPanEnded(),M.fi({kind:"endPan",event:A})),delete M._tx,delete M._ty,M.clearDragging()},handle_mousemove:function(y){var W=this,H=W.gv;W._hoverTimer&&(t(W._hoverTimer),delete W._hoverTimer),W._hoverTimer=l(function(){W.fi({kind:"hover",event:y}),t(W._hoverTimer),delete W._hoverTimer},H.getHoverDelay()||u.hoverDelay)},handle_touchmove:function(d){this.handle_mousemove(d)},handleWindowMouseMove:function(X){var g=this,T=g.gv,f=g._lastClientPoint;g.fi({kind:T._panning?"betweenPan":"beginPan",event:X}),T._panning=1,T.setTranslate(g._tx+X.clientX-f.x,g._ty+X.clientY-f.y)},handle_mousewheel:function(U){this.gv.handleScroll(U,U.wheelDelta)},handle_DOMMouseScroll:function(G){2===G.axis&&this.gv.handleScroll(G,-G.detail)},handle_keydown:function(S){this.gv.handleKeyDown(S)}});var Gj=To.SelectInteractor=function(n){Sc(Gj,this,[n])};oc("SelectInteractor",Gh,{_42:function(){var b=this,v=b.gv,G=v.getZoom(),A=b.mark,U=b.div;U||(U=b.div=rr(),Uo(b.getView(),U));var P={};P.x=A.x*G+v.tx(),P.y=A.y*G+v.ty(),P.width=A.width*G,P.height=A.height*G,yk(U,P),this.intersects()?(U.style.border="",U.style.background=v.getRectSelectBackground()):(U.style.background="",U.style.border="1px solid "+v.getRectSelectBorderColor())},handle_mousedown:function(k){var u=this,D=u.gv;if(u._57I=U,u.pendingClickThrough=U,!(D._editing||D._scrolling||Lo())){var y=D.getDataAt(k),q=D.sm();y?ds(k)?q.co(y)?q.rs(y):q.as(y):q.co(y)?y instanceof Vf&&y.isClickThroughEnabled()&&lk(k)&&(u.pendingClickThrough=Zg(k)):q.ss(y):ds(k)||!D.isPannable()?lk(k)&&(ds(k)||q.cs(),D.isRectSelectable()&&(u.startDragging(k),D._77O=1)):lk(k)&&(u._57I=Zg(k))}},handle_mouseup:function(V){var J=this,Y=J.gv,P=J._57I;if(P&&(Pq(P,Zg(V))<=1&&Y.sm().cs(),J._57I=U),J.pendingClickThrough){if(Pq(J.pendingClickThrough,Zg(V))<=1){var a=Y.getDataAt(V);if(a instanceof Vf&&a.isClickThroughEnabled()){var M=Y.getDataAt(V,function(y){var c=y.getParent()===a&&Y.isSelectable(y,!0);return c});M&&(V.clickThrough=!0,Y.sm().ss(M))}}J.pendingClickThrough=U}},handleWindowMouseUp:function(N){this.clear(N)},handleWindowMouseMove:function(Z){var d=this,R=d.gv;d._logicalPoint=R.lp(Z),d.mark?(d.fi({kind:"betweenRectSelect",event:Z}),R.isPannable()&&d.autoScroll(Z),d.redraw()):d.fi({kind:"beginRectSelect",event:Z}),d.mark=Pb(d._lastLogicalPoint,d._logicalPoint),d.redraw()},intersects:function(){var S=this,l=S._lastLogicalPoint,d=S._logicalPoint;return l.x>d.x||l.y>d.y},clear:function(t){var n=this,B=n.gv,r=n.mark;if(n._57I=U,n.pendingClickThrough=U,n._lastLogicalPoint){if(r){if(0!==r.width&&0!==r.height){var y=B.getDatasInRect(r,n.intersects());if(!y.isEmpty()){var g=B.sm(),q=g.toSelection();y.each(function(T){g.co(T)?q.remove(T):q.add(T)}),g.ss(q)}}Gp(n.div),delete n.div,delete n.mark,n.redraw(),n.fi({kind:"endRectSelect",event:t}),B.onRectSelectEnded()}n.clearDragging(),delete B._77O}},redraw:function(){var Y=this;Y._draw||(Y._draw=1,l(function(){Y.mark&&Y._42(),delete Y._draw},16))}});var us=To.MoveInteractor=function(q){Sc(us,this,[q])};oc("MoveInteractor",Gh,{handle_mousedown:function(h){var j=this,c=j.gv;if(lk(h)&&!c._editing&&!c._scrolling&&!Lo()){var P=c.getSelectedDataAt(h);!P||c.isInteractive(P)&&!c.isMovable(P)?c._focusData=U:(j._data=P,c.handleMouseDown&&c.handleMouseDown(h,P),j.startDragging(h),c.isMovable(P)&&(c._moving=1))}},handleWindowMouseUp:function(X){var d=this,l=d.gv;l.handleMouseUp&&l.handleMouseUp(X,d._data),d.clear(X)},handleWindowMouseMove:function(K){var P=this,r=P._data,v=P.gv;if((!v._93O||!v._93O(K,r))&&v._moving){P._logicalPoint||P.fi({kind:"prepareMove",event:K});var J=P._logicalPoint?"betweenMove":"beginMove",V={kind:J,event:K},q=P._logicalPoint=v.lp(K);"beginMove"!==J||P._alreadyBeginTransaction||(P._alreadyBeginTransaction=!0,v.getDataModel().beginTransaction());var L=P._calcShift(J,K),H=L.x,j=L.y,C=P.gv.getMoveMode(K,r);C&&("x"===C?j=0:"y"===C?H=0:"xy"!==C&&(H=j=0)),v.moveSelection(H,j),P._lastLogicalPoint=q,P.autoScroll(K),P.fi(V)}},_calcShift:function(){var t=this,B=t._logicalPoint,Z=t._lastLogicalPoint,w=B.x-Z.x,O=B.y-Z.y;return{x:w,y:O}},clear:function(V){var g=this,h=g.gv;g._lastLogicalPoint&&(g._lastLogicalPoint=g._data=h._moving=U,g._logicalPoint&&(g.fi({kind:"endMove",event:V}),h.onMoveEnded()),g.clearDragging()),g._alreadyBeginTransaction&&(g._alreadyBeginTransaction=!1,h.getDataModel().endTransaction())}});var Cb=To.ScrollBarInteractor=function(y){Sc(Cb,this,[y])};oc("ScrollBarInteractor",Gh,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(R){var w=this.gv.getViewRect();return this._41o()&&(w.x+w.width-this.gv.lp(R).x)*this.gv.getZoom()<cp},isH:function(b){var y=this.gv.getViewRect();return this._40o()&&(y.y+y.height-this.gv.lp(b).y)*this.gv.getZoom()<cp},handle_mousemove:function(J){this.handle_touchmove(J)},handle_touchmove:function(k){if(!Hf&&lk(k)&&this.gv.isScrollBarVisible()){var z=this,r=z.isV(k),f=z.isH(k);(r||f)&&z.gv.showScrollBar(),z.gv._scrolling=r||f}},handleWindowMouseUp:function(v){this.handleWindowTouchEnd(v)},handleWindowTouchEnd:function(h){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=U,this.fi({kind:"endScroll",event:h})},handle_mousedown:function(l){this.handle_touchstart(l)},handle_touchstart:function(n){var V=this;if(V.gv.setFocus(n),td(n),V.handle_touchmove(n),!(Xh(n)>1)&&V.gv._scrolling&&V.gv.isScrollBarVisible()){V._cp=Zg(n),V._tx=V.gv.tx(),V._ty=V.gv.ty();var c=V.isV(n);V._state=c?"vScroll":"hScroll",Ti(V,n),V.fi({kind:"beginScroll",event:n})}},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(c){var x=Zg(c),o=this.gv.getViewRect(),r=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-x.y)*r.height/o.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-x.x)*r.width/o.width),this.fi({kind:"betweenScroll",event:c})}});var be=To.TouchInteractor=function(I,S){S=S||{},S.selectable===g&&(S.selectable=!0),S.movable===g&&(S.movable=!0),S.pannable===g&&(S.pannable=!0),S.pinchable===g&&(S.pinchable=!0),S.editable===g&&(S.editable=!0),this.params=S,Sc(be,this,[I])};oc("TouchInteractor",Gh,{ms_edit:1,setUp:function(){var c=this;be.superClass.setUp.call(c),$d&&c.params.editable&&c.gv.setEditInteractor(c)},tearDown:function(){var g=this;be.superClass.tearDown.call(g),$d&&g.params.editable&&g.gv.setEditInteractor(U)},clear:function(v){var O=this,F=O.gv;F._moving&&(O.fi({kind:"endMove",event:v}),delete F._moving,F.onMoveEnded(),F.dm().endTransaction()),F._panning&&(O.fi({kind:"endPan",event:v}),delete F._panning,F.onPanEnded()),F._pinching&&(O.fi({kind:"endPinch",event:v}),delete F._pinching,F.onPinchEnded()),F._editing&&(O._46O(v),O._77I=O._node=O._edge=O._shape=O._rect=O._89I=O._index=F._editing=U),O._moving=O._panning=O._pinching=O._editing=O._57I=O._data=O._beginHistory=U,O.clearDragging()},handle_touchstart:function(Q){var c=this;if(!c.gv._editing){td(Q),c._57I=U;var t=c.params,X=c.gv,n=X.sm(),i=X.getDataAt(Q),x=Xh(Q);if(1===x){if(qc(Q))return X.handleDoubleClick(Q,i),void 0;X.handleClick(Q,i),i&&(X.handleMouseDown&&X.handleMouseDown(Q,i),c._data=i),t.selectable||(i=U),i?(n.co(i)||n.ss(i),t.editable&&X.isEditable(i)&&c._79I(Q,i,!0)?(c._editing=1,c.startDragging(Q)):t.movable&&X.isMovable(i)&&(c._moving=1,c.startDragging(Q))):(c._57I=Zg(Q),t.pannable&&X.isPannable()&&(c._panning=1,c.startDragging(Q),c._translate={x:X.tx(),y:X.ty()}))}else if(t.pinchable&&2===x){c._pinching=1,c.startDragging(Q);var V=X.getView(),s=X.getZoom(),T=V.getBoundingClientRect(),z=Q.touches[0],W=Q.touches[1],N={x:(z.clientX+W.clientX)/2-T.left,y:(z.clientY+W.clientY)/2-T.top};N.x-=X.tx(),N.y-=X.ty(),N.x/=s,N.y/=s,c._p=N,c._d=yi(Q)}}},handle_touchend:function(j){var u=this,l=u.gv,q=u._57I,P=u._data;q&&(Pq(q,Zg(j))<=1&&l.sm().cs(),u._57I=U),P&&l.handleMouseUp&&l.handleMouseUp(j,P)},handleWindowTouchEnd:function(b){this.clear(b)},handleWindowTouchMove:function(c){var V=this,F=V.gv,W=Xh(c);if(1===W){if(V._editing&&(V._beginHistory||(V._beginHistory=1,F.dm().beginTransaction()),F._editing=1,V._78I(c)),V._moving)V._beginHistory||(V._beginHistory=1,F.dm().beginTransaction()),V.handleMove(c);else if(V._panning){var f=Zg(c);F.setTranslate(V._translate.x+f.x-V._lastClientPoint.x,V._translate.y+f.y-V._lastClientPoint.y),V.fi({kind:F._panning?"betweenPan":"beginPan",event:c}),F._panning=1}}else if(2===W&&V._pinching){var M=yi(c);F.handlePinch(V._p,M,V._d),V._d=M,V.fi({kind:F._pinching?"betweenPinch":"beginPinch",event:c}),F._pinching=1}},handleMove:function(c){var L=this,Z=L.gv,S=Z.lp(c);Z._93O&&Z._93O(c,L._data)||(Z.moveSelection(S.x-L._lastLogicalPoint.x,S.y-L._lastLogicalPoint.y),L._lastLogicalPoint=S,L.autoScroll(c),L.fi({kind:Z._moving?"betweenMove":"beginMove",event:c}),Z._moving=1)}});var o=_.ht,qd=o.graph._editor={Math:o.Math,Guide:{}};qd.getStyle=function(y){var K,I=qd.StyleMap;return I&&(K=I[y],K!==g)?K:qd.DefaultStyleMap[y]},qd.setStyle=function(S,n){var G=qd.StyleMap;G||(G=qd.StyleMap={}),G[S]=n},qd.inEdit=function(v){return v._inXEdit===!0},qd.startEdit=function(p){p._inXEdit=!0,qd.Inject.doInject(p)},qd._46O=function(h){h._inXEdit=!1,qd.Inject.undoInject(h)},qd.toScreenPosition=function(S,H){var N=S.tx(),V=S.ty(),C=S._zoom;return new qd.Math.Vector2(H.x*C+N,H.y*C+V)},qd.checkHit=function(F,n,W){return F.distanceTo(n)<W?!0:!1},qd.toWorldPosition=function(s,S){var $=s.tx(),Q=s.ty(),F=s._zoom;return{x:(S.x-$)/F,y:(S.y-Q)/F}},qd.setAntialias=function(h,m){for(var K,U=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],f=0,v=U.length;v>f&&(K=U[f],!(K in h));f++);h[K],h[K]=m},qd.getTargetCornersOnScreen=function(S,B){if(!B)return null;var k,K=[];if(Ml(B,S)){var G=bs(S,B);k=[{x:G.x,y:G.y},{x:G.x+G.width,y:G.y},{x:G.x+G.width,y:G.y+G.height},{x:G.x,y:G.y+G.height}]}else{if(!B.getCorners)return null;k=B.getCorners()}return k.forEach(function(k){var w=qd.toScreenPosition(S,k);K.push(w.x,w.y)}),K},qd.log=function(){};var nh=qd.Inject={_modules:[]};nh.registAsModule=function(l,d){var E={},n={};for(var v in l){var x=d.prototype[v];E[v]=x}l.getBackup=function(o){return E[o]},l.getBackups=function(){return E},n.doInject=function(){for(var j in l)"getBackup"!==j&&(d.prototype[j]=l[j])},n.undoInject=function(){for(var Q in l)"getBackup"!==Q&&(d.prototype[Q]=E[Q])},nh._modules.push(n)},nh.doInject=function(h){for(var X,_=nh._modules,x=0,e=_.length;e>x;x++)X=_[x],X.doInject(h)},nh.undoInject=function(c){for(var V,k=nh._modules,i=0,o=k.length;o>i;i++)V=k[i],V.undoInject(c)};var Gh=o.graph.EditInteractor=function(y){var c=this,h=z.createElement("canvas");h.className="editCanvas",h.style.position="absolute",c._styleMap={},c._canvas=h,c._context=h.getContext("2d"),Gh.superClass.constructor.call(c,y),qd.setAntialias(c._context,!1),c._subModules=[new qd.Anchor(c),new qd.RotateX(c),new qd.Rect(c),new qd.Curve(c),new qd.MoveHelper(c)],c._gridGuide=new qd.Guide.Grid(c),c._rectGuide=new qd.Guide.Rect(c)},lh=Gh;o.Default.def(Gh,o.graph.Interactor,{ms_edit:1,ms_fire:1}),Z.defineProperties(Gh.prototype,{editDetail:{get:function(){var A=!!this._editDetail;return A},set:function(B){var $=this,J=$._editDetail;J!==B&&($._editDetail=B,$.gv._editing=B,$.fp("editDetail",J,B),$.fp("pointsEditingMode",J,B),$.fi({kind:B?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(M){(!this._editDetail||M)&&(this.gv._editing=M,M||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(o){this._editing=o,this.gvEditing=o}},pointsEditingMode:{get:function(){return this.editDetail},set:function(u){var k=this;k.editDetail!==u&&(u?k._tryEnterEditDetailMode():k._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var g=this._gridEnabled;if(!g)return!1;var A=this.gv;return A?!0:!0},set:function(e){e!==this._gridEnabled&&(this._gridEnabled=e,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(J){J!==this._agEnabled&&(this._agEnabled=J,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Gh.prototype.getSubModule=function(M){var Q,y,Z,o=this._subModules;for(y=0,Z=o.length;Z>y;y++)if(Q=o[y],Q.catalog===M)return Q},Gh.prototype.invokeSubModule=function(a,F){var f=this,c=f._subModules;if(c)for(var l,H,k,i=Array.prototype.slice.call(arguments,2),b=0,y=c.length;y>b;b++)if(l=c[b],H=l[a],H&&(k=H.apply(l,i),k!=g&&F))return l},Gh.prototype.invokeSubModuleInverse=function(m,G){var t=this,Z=t._subModules;if(Z)for(var T,K,u,W=Array.prototype.slice.call(arguments,2),v=Z.length-1;v>=0;v--)if(T=Z[v],K=T[m],K&&(u=K.apply(T,W),u!=g&&G))return T},Gh.prototype.setUp=function(){qd.log("setUp");var d=this,p=d.gv,v=p.getView(),Q=d._canvas;Gh.superClass.setUp.call(d),p.setEditInteractor(d),p._79O?v.insertBefore(Q,p._79O):v.appendChild(Q),qd.startEdit(p),d.invokeSubModule("setUp"),p.dm().mm(d._onDataModelChanged,d),p.dm().md(d._onDataPropertyChanged,d)},Gh.prototype.tearDown=function(){qd.log("tearDown");var g=this,p=g.gv,V=p.getView();g._resetCustomCursorStyle(),Gh.superClass.tearDown.call(g),p.dm().umm(g._onDataModelChanged,g),p.dm().umd(g._onDataPropertyChanged,g),p.setEditInteractor(null),V.removeChild(g._canvas),g._drawTimer&&(t(g._drawTimer),g._drawTimer=null),qd._46O(p),g.invokeSubModule("tearDown")},Gh.prototype._onDataModelChanged=function(O){var D=this;("clear"===O.kind||"remove"===O.kind&&D.editDetail&&O.data===D.getSubModule("Curve").target)&&(D.editDetail=!1,D._42())},Gh.prototype._onDataPropertyChanged=function(t){var N=this;if(N.editDetail){var A=N.getSubModule("Curve"),z=t.data;z===A.target&&(z._writing||A._handleDataChanged())}},Gh.prototype.clear=function(){qd.log("clear")},Gh.prototype.redraw=function(){this._42()},Gh.prototype._42=function(){var Q=this;Q._drawTimer||(Q._drawTimer=l(function(){Q._drawTimer=null,Q.drawImpl()},0))},Gh.prototype.drawImpl=function(){var j;for(j in{_42:!0})break;return function(){var u=this,y=u._canvas,m=u.gv,x=m.getWidth(),Y=m.getHeight(),W=u._context,k=o.Default.getInternal();(y.width!==x||y.height!==Y)&&k.setCanvas(y,x,Y),W.clearRect(0,0,y.width,y.height);var i=u._getValidSelection();W.save();var C=o.Default.devicePixelRatio;W.scale(C,C),u._gridGuide._42(),u.invokeSubModuleInverse(j,!1,W,m,i),u._rectGuide._42(),W.restore()}}(),Gh.prototype._getValidSelection=function(){var c=this,i=c.gv,U=i.sm().getSelection(),p=[];return U.each(function(O){i.isVisible(O)&&i.isEditable(O)&&p.push(O)}),p},Gh.prototype.handle_touchmove=function(p){return this.handle_mousemove(p)},Gh.prototype.handle_mousemove=function(X){if(!o.Default.isDragging()){var g=this;(g.editDetail||!Lo())&&(g.gvEditing=!1,g._checkEdit(X)&&(g.gvEditing=!0))}},Gh.prototype.handle_touchstart=function(n){return this.handle_mousedown(n)},Gh.prototype.handle_mousedown=function(U){td(U);var s=this;if(s.editDetail||!Lo()){if(qc(U)&&!U.clickThrough){if(s.editDetail){if(s._tryQuitEditDetailMode(U))return}else if(s._tryEnterEditDetailMode())return;s.gv.dm().beginTransaction();var j=s.invokeSubModule("handleDoubleClick",!0,U);if(s.gv.dm().endTransaction(),j)return}var A=s._checkEdit(U);A&&(s._downPosition=s._getLogicalPoint(U),s.gv.dm().beginTransaction(),A.startEdit(s,U),s.editing=!0)}},Gh.prototype._checkEdit=function(A){var r=this,p=r.gv,Q=r._getLogicalPoint(A),b=r.invokeSubModule("check",!0,p,A,Q)||null;return r._editMod=b,b},Gh.prototype.handleWindowTouchMove=function(N){return this.handleWindowMouseMove(N)},Gh.prototype.handleWindowMouseMove=function(O){var w=this,f=w._downPosition;if(f){var r=w._getLogicalPoint(O);if(r.distanceTo(f)<w.getStyle("moveSensitivity"))return;delete w._downPosition}var K=w._editMod;K&&K.handleEdit(w.gv,O)},Gh.prototype._getLogicalPoint=function(L){var H=this,N=o.Default.getLogicalPoint(L,H._canvas);return new qd.Math.Vector2(N)},Gh.prototype.handleWindowTouchEnd=function(e){return this.handleWindowMouseUp(e)},Gh.prototype.handleWindowMouseUp=function(){var s;for(s in{_46O:!0})break;return function(a){var B=this;B.editing=!1,B.setCursor("default"),B.invokeSubModule(s,!1,a),B._42(),B.gv.dm().endTransaction()}}(),Gh.prototype.handle_mousewheel=function(f){var q=this;td(f),q.invokeSubModule("preHandleScroll",!0)||q.gv.handleScroll(f,f.wheelDelta)},Gh.prototype.handleDelete=function(){var E=this;if(!E.editDetail){E.gv.dm().beginTransaction();var V=E.invokeSubModule("handleNormalStateDelete",!0);return E.gv.dm().endTransaction(),V||E.gv.removeSelection(),void 0}E.gv.dm().beginTransaction(),E.invokeSubModule("handleDelete",!0),E.gv.dm().endTransaction(),E._42()},Gh.prototype.handle_keydown=function(F){var t=this;if((F.metaKey||F.ctrlKey)&&t._42(),Lo(F)&&!t.editing)return t.gvEditing=!1,t.setCursor("default"),t._42(),void 0;var r=Hh(F);return t.editDetail?((r||ip(F))&&(t.editDetail=!1,t._42()),t.gv.dm().beginTransaction(),t.invokeSubModule("handle_keydown",!0,F),t.gv.dm().endTransaction(),void 0):(t.gv.dm().beginTransaction(),t.invokeSubModule("handleNormalStateKeyDown",!0,F),t.gv.dm().endTransaction(),r&&t._tryEnterEditDetailMode(),void 0)},Gh.prototype.handle_keyup=function(Y){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,Y),this.gv.dm().endTransaction()},Gh.prototype._tryEnterEditDetailMode=function(){var x=this;return!x.editDetail&&x.invokeSubModule("canEnterEditDetailMode",!0)&&1===x._getValidSelection().length?(x.editDetail=!0,x._42(),!0):void 0},Gh.prototype._tryQuitEditDetailMode=function(v){var X=this;return X.editDetail?!v||X.invokeSubModule("canQuitEditDetailMode",!0,v)?(X.editDetail=!1,X._42(),!0):!1:!1},Gh.prototype.setStyle=function(G,p,U){var R=this;U?qd.setStyle(G,p):R._styleMap[G]=p,R.fp("styleChanged",null,{key:G,value:p,base:U}),R._42()},Gh.prototype.getStyle=function(J){var H=this,L=H._styleMap[J];return L!==g?L:qd.getStyle(J)},Gh.prototype.setCursor=function(n){this._resetCustomCursorStyle(),o.graph.EditInteractor.superClass.setCursor.call(this,n)},Gh.prototype._resetCustomCursorStyle=function(){var R=this;if(R._customStyle){var o=this.gv.getView();o.classList&&o.classList.remove&&o.classList.remove(R._customStyle),R._customStyle=null}},Gh.prototype._setRotateCursor=function(k){var b=this,m=b._cursorFactory;m||(m=b._cursorFactory=new qd.CursorFactory(b));var p=m.getRotateCursor(k),P=b.gv.getView();b._resetCustomCursorStyle(),b._customStyle=p,P.classList&&P.classList.add&&P.classList.add(p)};var rs=qd.Group=function(p){var F=this;F._entities=p,F._64O=0,F._position={x:0,y:0},F._scale={x:1,y:1},F._anchor={x:.5,y:.5},F._anchor2={x:.5,y:.5}};rs.prototype={},rs.prototype.constructor=rs;var nf=null;rs.findOrCreateGroup=function(i){if(nf&&nf.checkIsMe(i))return nf;var g=new qd.Group(i);return g.getKeyOb()?(nf=g,g):void 0},rs.prototype.checkIsMe=function(Q){var N=this._entities;if(N.length!==Q.length)return!1;var y,Y={},r=Q.length;for(y=0;r>y;y++)Y[Q[y]._id]=!0;for(y=0;r>y;y++)if(!Y[N[y]._id])return!1;return!0},rs.prototype.getRotation=function(){return this._64O},rs.prototype.getPosition=function(){return this._position},rs.prototype.getAnchor=function(){return this._anchor},rs.prototype.getWidth=function(){return this._width},rs.prototype.getScale=function(){return this._scale},rs.prototype.getSize=function(){return{width:this._width,height:this._height}},rs.prototype.getHeight=function(){return this._height},rs.prototype.getKeyOb=function(){for(var o=this._entities,e=o.length-1;e>=0;e--){var l=o[e];if(this.isNode(l))return l}},rs.prototype.getAnchor2=function(){var c=this,u=c.rotateCenter;if(u)return u;var t=c.getKeyOb();if(!t)return c._anchor;var H=c._anchor2,f=t.getMatrix();return f.tf({x:t.getWidth()*(H.x-t.getAnchor().x),y:t.getHeight()*(H.y-t.getAnchor().y)})},rs.prototype.setAnchor2=function(v,E){var i=this,Z=i.getKeyOb();if(Z){var D,I=Z.getMatrix();D="number"==typeof v?{x:v,y:E}:v;var k=I.tfi(D);i._anchor2={x:Z.getAnchor().x+k.x/Z.getWidth(),y:Z.getAnchor().y+k.y/Z.getHeight()}}},rs.prototype.setRotation=function(){},rs.prototype.beginRotate=function(S){this.rotateCenter=S.pos,this.rotateMode=S.groupRotateMode},rs.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},rs.prototype.addRotation=function(p,w){return"batch"===w?this._addRotationInBatchMode(p):"block"===w?this._addRotationInBlockMode(p):void 0},rs.prototype._addRotationInBlockMode=function(x){var S=this,o=S.rotateCenter||S.getPosition();S._entities.forEach(function(F){if(S.isNode(F)){var V=F.getMatrix();V.translate(-o.x,-o.y),V.rotate(x),V.translate(o.x,o.y);var R=Math.sign(F.getScale().x);F.setRotation(i(V.b*R,V.a*R)),F.setPosition(V.tx,V.ty)}})},rs.prototype._addRotationInBatchMode=function(t){var f=this,W=f._anchor2;f._entities.forEach(function(_){if(f.isNode(_)){var q=_.getAnchor(),X=_.getMatrix(),Y=X.tf({x:_.getWidth()*(W.x-q.x),y:_.getHeight()*(W.y-q.y)}),m=new qd.Math.Matrix2d;m.set(X.a,X.b,X.c,X.d,X.tx,X.ty),m.translate(-Y.x,-Y.y),m.rotate(t),m.translate(Y.x,Y.y);var P=Math.sign(_.getScale().x);_.setRotation(i(m.b*P,m.a*P)),_.setPosition(m.tx,m.ty)}})},rs.prototype.setPosition=function(J){var i,t,p,O,Z=this,N=Z._position,o=J.x-N.x,s=J.y-N.y,r=Z._entities;for(t=0,p=r.length;p>t;t++)i=r[t],_h(i)&&(O=i.getPosition(),i.setPosition(O.x+o,O.y+s));Z._position=J},rs.prototype.setScale=function(K,W){var o=this,c=K/o._scale.x,H=W/o._scale.y;o._adjustChildScaleOrSize(c,H,"size"),o._scale={x:K,y:W}},rs.prototype.getRect=function(){var K=this,T=K._position,A=K._width,b=K._height;return{x:T.x-A/2,y:T.y-b/2,width:A,height:b}},rs.prototype.setSize=function(w,R){var i=this,w=Math.max(1,w),R=Math.max(1,R),f=w/i._width,W=R/i._height;i._adjustChildScaleOrSize(f,W,"size"),i._width=w,i._height=R},rs.prototype._adjustChildScaleOrSize=function(K,Z,C){var W,V,I,s,z,E,M,j,d,y,D,w,u,n,m=this,J=m._position,q=m._entities,T=new qd.Math.Matrix2d;for(V=0,I=q.length;I>V;V++)if(W=q[V],m.isNode(W)){if(s=W.getPosition(),z=W.getRotation(),E=W.getWidth(),M=W.getHeight(),j=W.getScale(),D=j.x*E,w=j.y*M,T.identity().scale(D,w).rotate(z).translate(s.x,s.y).translate(-J.x,-J.y).rotate(-m._64O),z=i(T.b*Math.sign(D),T.a*Math.sign(D)),T.scale(K,Z),d=Math.cos(z),y=Math.sin(z),Math.abs(d)<.001?(u=T.b/y,n=-T.c/y):(u=T.a/d,n=T.d/d),"scale"===C)W.setScale(u/E,n/M);else if("size"===C){var l=u/j.x,O=n/j.y;W.setScale(Ai(u)*Math.abs(j.x),Ai(n)*Math.abs(j.y)),W.setSize(Math.max(.1,Math.abs(l)),Math.max(.1,Math.abs(O)))}T.rotate(m._64O).translate(J.x,J.y),W.setPosition(T.tx,T.ty)}},rs.prototype.getMatrix=function(){var B=this,V=B._position,v=o.Default.getInternal(),E=B._scale;return new v.Mat(B._64O,V.x,V.y,E.x,E.y)},rs.prototype.toGlobal=function(u){return this.getMatrix().tf(u)},rs.prototype.getCorners=function(){var L=this,l=L._width,T=L._height,R=L._anchor,Z=-l*R.x,s=-T*R.y,i=L.getMatrix();return[i.tf(Z,s),i.tf(Z,s+T),i.tf(Z+l,s+T),i.tf(Z+l,s)]},rs.prototype.calcInfo=function(){var u,i,t,A,k,R,Z=this,o=[],B=Z._entities,w=Z._64O;for(A=0,k=B.length;k>A;A++)R=B[A],Z.isNode(R)&&R.getCorners&&o.push.apply(o,R.getCorners());if(o.length){var h=Math.cos(-w),d=Math.sin(-w),e=1/0,q=-1/0,p=1/0,V=-1/0;for(A=0,k=o.length;k>A;A++)t=o[A],u=t.x,i=t.y,t.x=h*u-d*i,t.y=d*u+h*i,e=Math.min(e,t.x),q=Math.max(q,t.x),p=Math.min(p,t.y),V=Math.max(V,t.y);Z._width=(q-e)/Z._scale.x,Z._height=(V-p)/Z._scale.y,h=Math.cos(w),d=Math.sin(w);var C=Z._anchor;u=e+(q-e)*C.x,i=p+(V-p)*C.y,Z._position={x:h*u-d*i,y:d*u+h*i}}},rs.prototype.isNode=function(G){return _h(G)?Ml(G)?!1:!0:!1},rs.prototype._42=function(D,y,r){var z,C,o,c,P,q,W,E,i=this,V=i._entities,Z=i.rotateMode;for("batch"===Z&&(E=i.getKeyOb()),z=0,C=V.length;C>z;z++)o=V[z],i.isNode(o)&&(q=o.getRect(),c=qd.toScreenPosition(r,{x:q.x,y:q.y}),P=qd.toScreenPosition(r,{x:q.x+q.width,y:q.y+q.height}),W={min:c,max:P},o===E&&(W.isKeyOb=!0),qd.Icons.DrawIcon(D,y,qd.Icons.GroupSubEntityRect,W))};var Tr=qd.CurveActiving=function(t,L){this._curve=t,this._interactor=t._interactor;for(var $ in L)this[$]=L[$]};Tr.prototype={},Tr.prototype.constructor=Tr,Z.defineProperties(Tr.prototype,{point:{get:function(){return this._point},set:function(Z){var J=this;J._point=Z,J.editingCtrl||J._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(B){var L=this;L._pairs=B,L.editingCtrl&&L._firePointChange()}}}),Tr.prototype._firePointChange=function(){var p=this,u=p.getCurrentEditingPoint();if(!u)return T.fi({kind:"selectPoint"}),void 0;var T=p._interactor,Z=this._curve.target;if(Z){var I=qd.getDataMatrix(Z).invert(),e=u.e;u=I.apply(qd.toWorldPosition(T.gv,u)),u.e=e;var D=p._lastFirePoint;D&&Math.abs(u.x-D.x)<1e-5&&Math.abs(u.y-D.y)<1e-5&&(u.e==g&&D.e==g||Math.abs(u.e-D.e)<1e-5)||(p._lastFirePoint=u,T.fi({kind:"selectPoint",x:u.x,y:u.y,e:u.e}))}},Tr.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Tr.prototype.getCurrentEditingPoint=function(){var O=this,N=O.editingCtrl;if(N){var Q=O.pairs;if(Q){var B=Q[N.pairId],S=B[N.type];if(S)return S}}return O._point};var Tp=qd.CursorFactory=function(N){var v=this;v._interactor=N,v._rotateCursorStyles={}};Tp.prototype={},Tp.prototype.constructor=Tp,Tp.prototype.getRotateCursor=function(z){var Z=this;0>z&&(z+=2*Math.PI);var R=Z._interactor,w=R.getStyle("rotateCursorSize"),$=R.getStyle("rotateCursorRound"),E=Math.round(180*(z/Math.PI)/$);E*$>=360&&(E=0);var D=Z._rotateCursorStyles,P="htCustomRotateStyle_"+w+"_"+$+"_"+E;return D[P]||(Z._produceRotateCursor(P,w,$,E),D[P]=!0),P},Tp.prototype._produceRotateCursor=function(T,o,Y,$){var p=this;p._interactor;var P=p._canvas;P||(P=p._canvas=z.createElement("canvas")),P.width=P.height=o*devicePixelRatio,P.style.width=P.style.height=o+" px";var m=P.getContext("2d");qd.setAntialias(m,!1),m.scale(devicePixelRatio,devicePixelRatio);var v,b,W,q,f,d=Math.round(o/2),s=""+d+" "+d+",auto !important;";v=Math.PI/180*$*Y,m.clearRect(0,0,o,o),m.save(),m.scale(o/32,o/32),m.translate(16,16),m.rotate(v+Math.PI/2),m.beginPath(),m.moveTo(-8,0),m.lineTo(-8,3),m.lineTo(-5,3),m.moveTo(8,0),m.lineTo(8,3),m.lineTo(5,3),m.moveTo(-8,3),m.quadraticCurveTo(0,-6,8,3),m.restore(),m.strokeStyle="white",m.lineWidth=4,m.stroke(),m.strokeStyle="black",m.lineWidth=2,m.stroke(),b=JSON.stringify(P.toDataURL()),q="cursor:url("+b+")"+s,1!==devicePixelRatio&&(W='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+o+'px" height="'+o+'px"><image xlink:href='+b+' width="'+o+'" height="'+o+'"/></svg>',q+="cursor:url(data:image/svg+xml;base64,"+btoa(W)+")"+s,q+="cursor:-webkit-image-set(url("+b+")"+devicePixelRatio+"x,url("+b+")1x)"+s),f=z.createElement("style"),f.textContent="body."+T+" *, ."+T+"{"+q+"}",z.head.appendChild(f)};var Nd=qd.Guide.Grid=function(P){var g=this;g._interactor=P,g._alignmentGuideId=0,g._xAlignmentGuide=[],g._yAlignmentGuide=[]};Nd.prototype={},Nd.prototype.constructor=Nd,Z.defineProperties(Nd.prototype,{gridBlockSize:{get:function(){var m=this;return m._gridBlockSize||m._interactor.getStyle("gridBlockSize")},set:function(v){this._gridBlockSize=v,this._interactor._42()}},gridThickLinesEvery:{get:function(){var w=this;return w._gridThickLinesEvery||w._interactor.getStyle("gridThickLinesEvery")},set:function(W){this._gridThickLinesEvery=W,this._interactor._42()}},gridEnabled:{get:function(){var h=this,y=h._interactor;return y.gridEnabled&&h.isValidGrid()}}}),Nd.prototype._42=function(){var c=this,n=c._interactor;c.gridEnabled&&c.drawGrid(),n.alignmentGuideEnabled&&c.drawAlignmentGuide()},Nd.prototype.makeMatrix=function(){var V=this,Z=V._interactor.getStyle("gridAngle"),i=V._interactor.getStyle("gridRotation"),y=new qd.Math.Matrix2d,U=Math.sin(Z),J=Math.cos(Z);return y.set(1,0,J,U,0,0),y.rotate(i),y},Nd.prototype.isValidGrid=function(){var Z=this,S=Math.PI,f=Z._interactor,K=f.gv;if(K._zoom<f.getStyle("gridZoomThreshold"))return!1;var O=f.getStyle("gridAngle"),V=Math.abs(180*(O%S/S)),p=1-1e-8;return p>V||V>180-p?!1:!0},Nd.prototype.drawAlignmentGuide=function(){var K=this,$=K._interactor,O=$.gv,v=$._canvas,j=$._context,G=v.width,x=v.height,u=O.tx(),y=O.ty(),A=O._zoom;j.beginPath(),j.strokeStyle=$.getStyle("gridAlignmentGuideColor"),j.lineWidth=1,K._xAlignmentGuide.forEach(function(S){var w=S.p*A+u;j.moveTo(w,0),j.lineTo(w,x)}),K._yAlignmentGuide.forEach(function(x){var S=x.p*A+y;j.moveTo(0,S),j.lineTo(G,S)}),j.stroke()},Nd.prototype.drawGrid=function(){function D(A,W,Q,B){var N=qd.toScreenPosition(m,v.apply({x:A,y:W})),o=qd.toScreenPosition(m,v.apply({x:Q,y:B}));y.moveTo(N.x,N.y),y.lineTo(o.x,o.y)}var C=this,K=C._interactor,e=C.gridBlockSize,_=C.gridThickLinesEvery,T=K.getStyle("gridThickColor"),f=K.getStyle("gridLightColor"),m=K.gv,b=K._canvas,y=K._context,h=b.width,M=b.height,v=C.makeMatrix(),l=v.applyInverse(qd.toWorldPosition(m,{x:0,y:0})),p=v.applyInverse(qd.toWorldPosition(m,{x:h,y:0})),$=v.applyInverse(qd.toWorldPosition(m,{x:0,y:M})),x=v.applyInverse(qd.toWorldPosition(m,{x:h,y:M})),B=Math.min(l.x,p.x,$.x,x.x),O=Math.max(l.x,p.x,$.x,x.x),I=Math.min(l.y,p.y,$.y,x.y),j=Math.max(l.y,p.y,$.y,x.y);h=O-B,M=j-I;var k=Math.ceil(B/e),R=Math.floor(O/e),G=Math.ceil(I/e),V=Math.floor(j/e);m.tx(),m.ty(),m._zoom;var L,S,W;for(y.save(),y.lineWidth=1,y.beginPath(),y.strokeStyle=T,W=Math.ceil(k/_)*_;R>=W;W+=_)L=W*e,D(L,I,L,j);for(W=Math.ceil(G/_)*_;V>=W;W+=_)S=W*e,D(B,S,O,S);for(y.stroke(),y.beginPath(),y.strokeStyle=f,W=k;R>=W;W++)0!==W%_&&(L=W*e,D(L,I,L,j));for(W=G;V>=W;W++)0!==W%_&&(S=W*e,D(B,S,O,S));y.stroke(),y.restore()},Nd.prototype.getAlignmentGuides=function(){var M=this;return{x:M._xAlignmentGuide,y:M._yAlignmentGuide}},Nd.prototype.addAlignmentGuide=function(o,d,O){var t=this,X="x"===o?t._xAlignmentGuide:t._yAlignmentGuide,O=O?O:++t._alignmentGuideId,j={p:d,id:O};if(X.length){var F=t._findClosestAlignmentGuide(j.p,X);F.dis<0?X.splice(F.index+1,0,j):X.splice(F.index,0,j)}else X.push(j);return t._interactor._42(),O},Nd.prototype.findClosest=function(Z,R,l){var c=this,T=c._interactor,p=T.gv;l&&(Z=qd.toWorldPosition(p,Z));var C,n,E,D=1/0,A=1/0,F=Z.x,h=Z.y;if(c.gridEnabled){var Y=c.gridBlockSize,x=c.makeMatrix(),z=x.applyInverse(Z);
z=x.apply({x:Math.round(z.x/Y)*Y,y:Math.round(z.y/Y)*Y}),D=z.x-F,A=z.y-h,E=!0}if(T.alignmentGuideEnabled&&(C=c._findClosestAlignmentGuide(F,c._xAlignmentGuide).dis,n=c._findClosestAlignmentGuide(h,c._yAlignmentGuide).dis,Math.abs(C)<Math.abs(D)&&(D=C,E=!0),Math.abs(n)<Math.abs(A)&&(A=n,E=!0)),E){E=!1;var a=p._zoom,N=T.getStyle("smartGuideSensitivity")/a,P={};if(Math.abs(D)<N&&"y"!==R&&(P.x=l?D*a:D,E=!0),Math.abs(A)<N&&"x"!==R&&(P.y=l?A*a:A,E=!0),E)return P}},Nd.prototype._findClosestAlignmentGuide=function(Q,a){if(!a.length)return{dis:1/0};for(var h,l=0,u=a.length-1;u-l>1;)h=Math.floor((l+u)/2),a[h].p<Q?l=h:u=h;var S=a[l].p-Q,P=a[u].p-Q;return Math.abs(S)<=Math.abs(P)?{line:a[l],dis:S,index:l}:{line:a[u],dis:P,index:u}},Nd.prototype.removeAllAlignmentGuide=function(Q){var p=this;"y"!==Q&&(p._xAlignmentGuide=[]),"x"!==Q&&(p._yAlignmentGuide=[]),p._interactor._42()},Nd.prototype.removeAlignmentGuide=function(C){for(var x,S,R,l=this,m=l._xAlignmentGuide,O=0;2>O;O++)for(m=0===O?l._xAlignmentGuide:l._yAlignmentGuide,x=0,S=m.length;S>x;x++)if(R=m[x],R.id===C)return m.splice(x,1),l._interactor._42(),{axis:0===O?"x":"y",position:R.p};return!1},Nd.prototype.adjustAlignmentGuide=function(x,W){var u=this,p=u.removeAlignmentGuide(x);return p?(u.addAlignmentGuide(p.axis,W,x),!0):!1};var mr=qd.Guide.Rect=function(Y){var M=this;M._interactor=Y};mr.prototype={},mr.prototype.constructor=mr,mr.prototype.gatherRects=function(){var B,R,E,D,n=this,u=n._interactor.gv,I=[],t=[],W={x:I,y:t},S={},Y=u.getDataModel(),r=Y.a("width"),P=Y.a("height");r&&P&&(B=0,R=0,E=r,D=P,I.push({node:Y,type:0,p:B},{node:Y,type:1,p:B+E/2},{node:Y,type:2,p:B+E}),t.push({node:Y,type:0,p:R},{node:Y,type:1,p:R+D/2},{node:Y,type:2,p:R+D}),S[Y._id||0]={x:B,y:R,width:E,height:D}),Y.each(function(G){if(_h(G)&&!u.isSelected(G)&&u.isVisible(G)){var x=!1;if(u.sm().getSelection().each(function(C){x||(G.isHostOn(C)?x=!0:G.isDescendantOf(C)&&(x=!0))}),!x){var v=G.getRect();B=v.x,R=v.y,E=v.width,D=v.height,I.push({node:G,type:0,p:B},{node:G,type:1,p:B+E/2},{node:G,type:2,p:B+E}),t.push({node:G,type:0,p:R},{node:G,type:1,p:R+D/2},{node:G,type:2,p:R+D}),S[G._id]=v}}}),I.sort(function(V,E){return V.p-E.p}),t.sort(function(W,c){return W.p-c.p}),n._grid=W,n._87I=S},mr.prototype.gatherLines=function(d,W,L){var I,r,H,x,k,$,e,V,P,X,C,a,g=this,v=[g.findClosest({x:d.x,y:d.y},W),g.findClosest({x:d.x+d.w/2,y:d.y+d.h/2},W),g.findClosest({x:d.x+d.w,y:d.y+d.h},W)],y={},K=g._87I;L=L||255;var j,G;for(g._guideLine=[],I=0;2>I;I++)for(y={},0===I?(x="y",V=d.x,P=V+d.w):(x="x",V=d.y,P=V+d.h),r=0;3>r;r++)k=v[r],k&&isFinite(k[x])&&(j=1<<3*I+r,L&j&&($=k[x+"Line"],e=$.node,G=e._id||0,y[G]||(y[G]=!0,a=K[G],"y"===x?(X=a.x,C=a.x+a.width):(X=a.y,C=a.y+a.height),H=$.p,g._guideLine.push({type:x,a:V,b:P,c:X,d:C,p:H,center:1===$.type}))))},mr.prototype._binarySearchClosest=function(D,_){if(!_.length)return{dis:1/0};for(var l,E=0,C=_.length-1;C-E>1;)l=Math.floor((E+C)/2),_[l].p<D?E=l:C=l;var I=_[E].p-D,o=_[C].p-D;return Math.abs(I)<=Math.abs(o)?{line:_[E],dis:I}:{line:_[C],dis:o}},mr.prototype.findClosest=function(g,x,v){var s=this,I=s._interactor,L=I.gv,m=s._grid;v&&(g=qd.toWorldPosition(L,g));var y,u=s._binarySearchClosest(g.x,m.x),f=s._binarySearchClosest(g.y,m.y),D=u.dis,o=f.dis,d=L._zoom,J=I.getStyle("smartGuideSensitivity")/d,H={};return Math.abs(D)<J&&"y"!==x&&(H.x=v?D*d:D,H.xLine=u.line,y=!0),Math.abs(o)<J&&"x"!==x&&(H.y=v?o*d:o,H.yLine=f.line,y=!0),y?H:void 0},mr.prototype._42=function(){var i=this,S=i._guideLine;if(S&&!o.Default.isCtrlDown()){var _,L,$,m,N,U,h,x,T,b,O,G,Q,j,e,n,y,V=i._interactor,s=V.gv,k=V._context,W=s.tx(),P=s.ty(),A=s._zoom,f=V.getStyle("guideLineTextSpacing");for(_=0,L=S.length;L>_;_++)$=S[_],x=$.type,T=$.p,b=$.a,O=$.b,G=$.c,Q=$.d,j=Math.min(b,G),e=Math.max(O,Q),"x"===x?(m=T*A+W,N=j*A+P,U=m,h=e*A+P):(m=j*A+W,N=T*A+P,U=e*A+W,h=N),qd.Icons.DrawIcon(V,k,qd.Icons.MoveLineGuide,{rect:[m,N,U,h],center:$.center}),Q>=b&&O>=G||(j=b>Q?Q:O,e=b>Q?b:G,y=e-j,"x"===x?($.center2center||(m-=f,U=m),N=j*A+P,h=e*A+P,n=qd.Icons.MoveLineGuideDistanceV):"y"===x&&($.center2center||(N-=f,h=N),m=j*A+W,U=e*A+W,n=qd.Icons.MoveLineGuideDistanceH),qd.Icons.DrawIcon(V,k,n,{x0:m,y0:N,x1:U,y1:h,dis:y}))}},mr.prototype.clear=function(){this._guideLine=null},qd.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var zh=qd.Icons={},vn=1e4,ri=null,Pe="rgb(51,153,255)",oo="rgb(183,232,135)",Jk="rgb(255,204,153)",Kr=6;o.Default.setImage("Icons.RectPoint",{width:Kr,height:Kr,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:Pe,rect:[0,0,Kr,Kr]}]});var fh="#e000e0";zh.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var P=zh.GroupSubEntityRect.data;if(!P)return[];var j=P.min,A=P.max;return[j.x,j.y,j.x,A.y,A.x,A.y,A.x,j.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return zh.GroupSubEntityRect.data.isKeyOb?fh:"#666666"}}}]},zh.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[zh.Line.data.P1.x,zh.Line.data.P1.y],Kr,Kr]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[zh.Line.data.P2.x,zh.Line.data.P2.y],Kr,Kr]}}}]},zh.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return zh.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},zh.Rect={comps:[{type:"shape",points:{func:function(){var X=zh.Rect.data;if(!X)return[];var I=X.LT,Z=X.LB,D=X.RB,M=X.RT;return[I.x,I.y,Z.x,Z.y,D.x,D.y,M.x,M.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:Pe},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zh.Rect.data.rotation}},rect:{func:function(){return[[zh.Rect.data.LT.x,zh.Rect.data.LT.y],Kr,Kr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zh.Rect.data.rotation}},rect:{func:function(){return[[zh.Rect.data.LB.x,zh.Rect.data.LB.y],Kr,Kr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zh.Rect.data.rotation}},rect:{func:function(){return[[zh.Rect.data.RB.x,zh.Rect.data.RB.y],Kr,Kr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zh.Rect.data.rotation}},rect:{func:function(){return[[zh.Rect.data.RT.x,zh.Rect.data.RT.y],Kr,Kr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zh.Rect.data.rotation}},visible:{func:function(){return zh.Rect.data.L?!0:!1}},rect:{func:function(){return[[zh.Rect.data.L.x,zh.Rect.data.L.y],Kr,Kr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zh.Rect.data.rotation}},visible:{func:function(){return zh.Rect.data.R?!0:!1}},rect:{func:function(){return[[zh.Rect.data.R.x,zh.Rect.data.R.y],Kr,Kr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zh.Rect.data.rotation}},visible:{func:function(){return zh.Rect.data.T?!0:!1}},rect:{func:function(){return[[zh.Rect.data.T.x,zh.Rect.data.T.y],Kr,Kr]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return zh.Rect.data.rotation}},visible:{func:function(){return zh.Rect.data.B?!0:!1}},rect:{func:function(){return[[zh.Rect.data.B.x,zh.Rect.data.B.y],Kr,Kr]}}}]};var Rf=16;o.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:Pe,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:Pe,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),zh.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[zh.Anchor.data.POS.x,zh.Anchor.data.POS.y],Rf,Rf]}}}]},zh.TipShiftX=12,zh.TipShiftY=12;var Ef=[8,28];zh.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[zh.TipHelper.data.helperPos.x,zh.TipHelper.data.helperPos.y,Ef[0]*zh.TipHelper.data.size,Ef[1]]}},background:{func:function(){return ri.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return zh.TipHelper.data.text}},rect:{func:function(){return[zh.TipHelper.data.helperPos.x,zh.TipHelper.data.helperPos.y,Ef[0]*zh.TipHelper.data.size,Ef[1]]}},color:{func:function(){return ri.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var pm=7;zh.ShapePoint={comps:[{type:"circle",rect:{func:function(){var E=zh.ShapePoint.data.point;return[E,pm,pm]}},background:{func:function(){var z=zh.ShapePoint.data.isEnd;return z?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:Pe}]},zh.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return zh.ShapeBgCurve.data.P}},segments:{func:function(){return zh.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:Pe}]};var tc=8;zh.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var t=zh.ShapeHighlighPoint.data;return[[t.x,t.y],tc,tc]}},background:{func:function(){return ri.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Ne=10;zh.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var c=zh.ShapeHighlighRealPoint.data;return[[c.x,c.y],Ne,Ne]}},background:"#ffffff",borderWidth:2,borderColor:Pe}]};var Yd=8;zh.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var Y=zh.ShapeHighlighCtrlPoint.data,D=Y.x,H=Y.y,w=Yd/2;return[D-w,H-w,D-w,H+w,D+w,H+w,D+w,H-w]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ri.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return ri.getStyle("shapeCtrlPointBorderColor")||Pe}}}]};var eh=3;zh.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return zh.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:eh,borderColor:{func:function(){return ri.getStyle("curveHighlightColor")}}}]},zh.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return zh.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},zh.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return zh.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return zh.MoveLineGuide.data.center?oo:Jk}}}]};var qb=5;zh.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var z=zh.MoveLineGuideDistanceH.data,D=z.x0,T=z.y0;return[D,T-qb,D,T+qb]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Jk},{type:"shape",points:{func:function(){var e=zh.MoveLineGuideDistanceH.data,f=e.x1,v=e.y1;return[f,v-qb,f,v+qb]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Jk},{type:"text",text:{func:function(){return Math.round(zh.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var E=zh.MoveLineGuideDistanceH.data;return[[(E.x0+E.x1)/2,E.y0-10],20,20]}},color:Jk,font:"12px Arial",align:"center"}]},zh.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var M=zh.MoveLineGuideDistanceV.data,H=M.x0,d=M.y0;return[H-qb,d,H+qb,d]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Jk},{type:"shape",points:{func:function(){var g=zh.MoveLineGuideDistanceV.data,C=g.x1,N=g.y1;return[C-qb,N,C+qb,N]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Jk},{type:"text",text:{func:function(){return Math.round(zh.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var Y=zh.MoveLineGuideDistanceV.data;return[[Y.x0-10,(Y.y0+Y.y1)/2],20,20]}},color:Jk,font:"12px Arial",align:"center"}]},o.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),zh.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var e=zh.EdgeElevationGuide.data,V=e.x,v=e.y,R=ri.getStyle("curveElevationIntersectSize"),d=ri.getStyle("curveElevationGuideShift");return V+=d[0],v+=d[1],[V-R,v-R,2*R,2*R]}}}]},o.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),o.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),zh.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return zh.ConnectGuide.data.rotation}},rect:{func:function(){var B=zh.ConnectGuide.data.connect;B.x,B.y;var b=ri.getStyle("connectGuideIntersectSize");return[[B.x,B.y],2*b,2*b]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var z=zh.ConnectGuide.data.cursorPos||zh.ConnectGuide.data.connect,d=ri.getStyle("connectGuideIntersectSize");return[[z.x,z.y],2*d-2,2*d-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var r=zh.ConnectGuide.data.connect,H=zh.ConnectGuide.data.cursorPos||r;return[r.x,r.y,r.x+.5*(H.x-r.x),r.y,H.x+.5*(r.x-H.x),H.y,H.x,H.y]}}}]},o.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),o.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),zh.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var x=zh.ConnectGuideGarbage.data.hover;return x?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var E=zh.ConnectGuideGarbage.data,L=ri.getStyle("connectGuideGarbageIntersectsize");return E.hover&&(L+=5),[[E.x,E.y],2*L,2*L]}}}]};var Jj=6;zh.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return zh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var $=zh.ShapeActivingCtrl.data;return[$.point.x,$.point.y,$.c1.x,$.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Pe},{type:"shape",visible:{func:function(){return zh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var k=zh.ShapeActivingCtrl.data;return[k.point.x,k.point.y,k.c2.x,k.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Pe},{type:"shape",visible:{func:function(){return zh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var o=zh.ShapeActivingCtrl.data.c1,D=o.x,H=o.y,M=Jj/2;return"c1"===zh.ShapeActivingCtrl.data.hl&&(M+=.5),[D-M,H-M,D-M,H+M,D+M,H+M,D+M,H-M]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ri.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===zh.ShapeActivingCtrl.data.hl?ri.getStyle("shapeCtrlPointHighlightBorder")||Pe:ri.getStyle("shapeCtrlPointBorderColor")||Pe}}},{type:"shape",visible:{func:function(){return zh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var D=zh.ShapeActivingCtrl.data.c2,O=D.x,B=D.y,e=Jj/2;return"c2"===zh.ShapeActivingCtrl.data.hl&&(e+=.5),[O-e,B-e,O-e,B+e,O+e,B+e,O+e,B-e]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return ri.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===zh.ShapeActivingCtrl.data.hl?ri.getStyle("shapeCtrlPointHighlightBorder")||Pe:ri.getStyle("shapeCtrlPointBorderColor")||Pe}}}]},zh.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:Pe,rect:{func:function(){return[[zh.RoundPoint.data.x,zh.RoundPoint.data.y],Kr,Kr]}}}]},zh.AttachPoint={comps:[{type:"rect",background:{func:function(){return zh.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:Pe,rect:{func:function(){var m=zh.AttachPoint.data.isAttach?Kr+4:Kr;return[[zh.AttachPoint.data.x,zh.AttachPoint.data.y],m,m]}}}]},qd.Icons.DrawIcon=function(r,v,C,N){C.width=C.height=vn,C.data=N,ri=r,o.Default.drawImage(v,C,0,0,vn,vn)},qd.Icons.MapPoints=function(l,S){for(var t=0,o=l.length;o>t;t++)l[t]/=S},qd.roundTo=function(P,i,t){var C=Math.abs(P%i);return t>C||t>i-C?i*Math.round(P/i):P},qd.toFixed=function(r){return Math.round(100*r)/100},qd.getDataMatrix=function(m){if(m instanceof o.Shape){var L=new o.Math.Matrix2d,d=m.getPosition();return L.translate(-d.x,-d.y).scale(m.getScale().x,m.getScale().y).rotate(m.getRotation()).translate(d.x,d.y),L}return m.getMatrix?m.getMatrix():new o.Math.Matrix2d};var Ym=qd.Math.Curve=function(){this._curves=[]};Ym.prototype={},Ym.prototype.constructor=Ym,Ym.prototype.createFromHtShape=function(G,t,Z){t instanceof o.List&&(t=t.toArray());var r,Y,A,w,Q,d,z,h=this,H=null,i=null,v=0,c=qd.Math.Vector2,q=qd.Math.CubicBezier,p=function(R){return new c(G[R],G[R+1],Z?Z[R/2]:g)};for(Y=0,A=t.length;A>Y;Y++){switch(w=t[Y],Q=null,w){case 1:i=p(v),H=i,v+=2;break;case 2:r=p(v),v+=2,Q=new q(i,i.clone(),r.clone(),r),i=r;break;case 3:d=p(v),r=p(v+2),v+=4,Q=new q(i,d.clone().sub(i).multiplyScalar(2/3).add(i),d.clone().sub(r).multiplyScalar(2/3).add(r),r),i=r;break;case 4:d=p(v),z=p(v+2),r=p(v+4),v+=6,Q=new q(i,d,z,r),i=r;break;case 5:if(!H)break;Q=new q(i,i.clone(),H.clone(),H),i=null,H=null}Q&&(Q._index=h._curves.length,h._curves.push(Q))}},Ym.prototype.checkPoint=function(b,q){var j,Z,I,c,F,G=this,s=G._curves;for(j=0,Z=s.length;Z>j;j++)if(c=s[j],F=c.intersectRect(b,q,q),F.length)return I=0,F.forEach(function(_){I+=_.t}),I/=F.length,b=c.getPointAt(I),b.t=I,{bezier:c,intersection:b}},Ym.prototype.insertKnot=function(c,R){var C=c.insertKnot(R),v=this,o=v._curves;o.splice(c._index,1,C[0],C[1])},Ym.prototype._isCloseEnough=function(Q,e){return Math.abs(Q.x-e.x)<1e-6&&Math.abs(Q.y-e.y)<1e-6},Ym.prototype._isSamePoint=function(a,x){return a===x},Ym.prototype.moveRealPoint=function(P,f){var T=this,v=T._curves,y=f.clone().sub(P);v.forEach(function(Q){var I=Q._p1;Q._p2,Q._p3;var _=Q._p4;T._isSamePoint(I,P)&&(Q._p2.add(y),Q._p1=f),T._isSamePoint(_,P)&&(Q._p3.add(y),Q._p4=f)})},Ym.prototype.moveCtrlDueToRealPointMovement=function(j,d){var w=this,i=w._curves,P=function(S){S.add(d),S.e&&d.e&&(S.e+=d.e)};i.forEach(function(t){var I=t._p1;t._p2,t._p3;var F=t._p4;w._isSamePoint(I,j)&&P(t._p2),w._isSamePoint(F,j)&&P(t._p3)})},Ym.prototype.moveCtrlPoint=function(V,N,Y){var J=V[Y];if(J){J.e!==g&&(N.e=J.e);var K=this,v=K._curves;N.clone().sub(J),v.forEach(function(D){var X;"c2"===Y?X="_p2":"c1"===Y&&(X="_p3"),K._isSamePoint(D[X],J)&&(D[X]=N)}),V[Y]=N}},Ym.prototype.deleteRealPoint=function(U,G){var y,_,z,$,I,p,w,E=this,F=E._curves,M={},X=[],v=qd.Math.CubicBezier;for(_=0,z=F.length;z>_;_++)y=F[_],$=y._p1,I=y._p2,p=y._p3,w=y._p4,(M[_]||!E._isSamePoint($,U))&&(E._isSamePoint(w,U)?z>_+1&&E._isSamePoint(F[_+1]._p1,U)&&(G||X.push(new v($,I,F[_+1]._p3,F[_+1]._p4))):X.push(y));E._curves=X},Ym.prototype.findPairs=function(z,T){var U,N,y,A,c,$,Z,l,B=this,v=B._curves,R={},q=[];for(N=0,y=v.length;y>N;N++)U=v[N],A=U._p1,c=U._p2,$=U._p3,Z=U._p4,!R[N]&&B._isSamePoint(A,z)&&(T?q.push({point:A,r2:Z}):q.push({point:A,c2:c})),B._isSamePoint(Z,z)&&(l=T?{point:Z,r1:A}:{point:Z,c1:$},y>N+1&&B._isSamePoint(v[N+1]._p1,z)&&(T?l.r2=v[N+1]._p4:l.c2=v[N+1]._p2,R[N+1]=!0),q.push(l));return q},Ym.prototype.toHtShape=function(){var C=this,t=C._curves,I=[],M=[],N={x:1/0,y:1/0};return t.forEach(function(c){var Q=c._p1,x=c._p2,a=c._p3,J=c._p4;return C._isCloseEnough(Q,N)||(I.push(1),M.push(Q.clone())),N=J,C._isCloseEnough(Q,x)&&C._isCloseEnough(a,J)?(I.push(2),M.push(J.clone()),void 0):(I.push(4),M.push(x.clone(),a.clone(),J.clone()),void 0)}),{segments:I,points:M}};var Oi=qd.Math.CubicBezier=function(R,G,K,j){var l=this;l._id=qd.Math.CubicBezier._globalId++,l._p1=R,l._p2=G,l._p3=K,l._p4=j};Oi._globalId=1,Oi.prototype={},Oi.prototype.constructor=Oi,Oi.prototype.toString=function(){return this._id},Oi.prototype.intersectRect=function(Z,i,R){var X=i/2,$=R/2,j=Z.x,O=Z.y,v=qd.Math.Vector2,G=new v(-X+j,-$+O),m=new v(X+j,$+O),l=new v(m.x,G.y),W=new v(G.x,m.y),P=this,g=P.intersectLine(G,l),N=P.intersectLine(l,m),H=P.intersectLine(m,W),r=P.intersectLine(W,G),J=g.concat(N).concat(H).concat(r);return J},Oi.prototype.intersectLine=function(_,s){var x,r,I,E,k,v,l,A,T,p,$,i,B,y=this,e=_.clone().min(s),z=_.clone().max(s);E=y._p1,k=y._p2,v=y._p3,l=y._p4,x=E.clone().multiplyScalar(-1),r=k.clone().multiplyScalar(3),I=v.clone().multiplyScalar(-3),$=x.add(r).add(I).add(l),x=E.clone().multiplyScalar(3),r=k.clone().multiplyScalar(-6),I=v.clone().multiplyScalar(3),p=x.add(r).add(I),x=E.clone().multiplyScalar(-3),r=k.clone().multiplyScalar(3),T=x.add(r),A=E.clone(),B=new qd.Math.Vector2(_.y-s.y,s.x-_.x),i=_.x*s.y-s.x*_.y;for(var L=y.getRoots(B.dot($),B.dot(p),B.dot(T),B.dot(A)+i),Z=new Array,W=0,M=L.length;M>W;W++){var X=L[W];if(!(0>X||X>1)){var U=E.clone().lerp(k,X),Y=k.clone().lerp(v,X),H=v.clone().lerp(l,X),J=U.lerp(Y,X),C=Y.lerp(H,X),w=J.lerp(C,X);w.t=X,_.x==s.x?e.y<=w.y&&w.y<=z.y&&Z.push(w):_.y==s.y?e.x<=w.x&&w.x<=z.x&&Z.push(w):w.x>=e.x&&w.y>=e.y&&w.x<=z.x&&w.y<=z.y&&Z.push(w)}}return Z},Oi.prototype.solveTForPoint=function(f){var p,k,o,E,T=this;p=T._p1.x-f.x,k=T._p2.x-f.x,o=T._p3.x-f.x,E=T._p4.x-f.x;for(var Q=T.getRoots(E-3*o+3*k-p,3*o-6*k+3*p,3*k-3*p,p),B=g,G=1/0,b=0,I=Q.length;I>b;b++){var F=Q[b];if(!(0>F||F>1)){var h=T._p1.clone().lerp(T._p2,F),S=T._p2.clone().lerp(T._p3,F),j=T._p3.clone().lerp(T._p4,F),W=h.lerp(S,F),s=S.lerp(j,F),i=W.lerp(s,F);i.t=F;var N=Math.abs(i.y-f.y);G>N&&(G=N,B=i)}}return B},Oi.prototype.getPointAt=function(o){var t=this,L=t._p1,w=t._p2,M=t._p3,C=t._p4,b=L.clone().lerp(w,o),J=w.clone().lerp(M,o),e=M.clone().lerp(C,o),a=b.lerp(J,o),X=J.lerp(e,o);return a.lerp(X,o)},Oi.prototype.getRoots=function(M,S,i,m){var Q,T,y,q,L,E=new Array;if(Math.abs(M)<1e-6){var Q=S,T=i/Q,y=m/Q,q=T*T-4*y;if(q>0){var L=Math.sqrt(q);E.push(.5*(-T+L)),E.push(.5*(-T-L))}else 0==q&&E.push(.5*-T)}S/=M,i/=M,m/=M,Q=(3*i-S*S)/3,T=(2*S*S*S-9*i*S+27*m)/27;var V=S/3,b=T*T/4+Q*Q*Q/27,C=T/2;if(Math.abs(b)<=1e-6&&(b=0),b>0){var x,$,L=Math.sqrt(b);x=-C+L,$=x>=0?Math.pow(x,1/3):-Math.pow(-x,1/3),x=-C-L,x>=0?$+=Math.pow(x,1/3):$-=Math.pow(-x,1/3),E.push($-V)}else if(0>b){var O=Math.sqrt(-Q/3),g=Math.atan2(Math.sqrt(-b),-C)/3,I=Math.cos(g),N=Math.sin(g),c=Math.sqrt(3);E.push(2*O*I-V),E.push(-O*(I+c*N)-V),E.push(-O*(I-c*N)-V)}else{var x;x=C>=0?-Math.pow(C,1/3):Math.pow(-C,1/3),E.push(2*x-V),E.push(-x-V)}return E},Oi.prototype._70I=function(){var Z=this;return Z._p1.distanceToSquared(Z._p2)<1e-10&&Z._p3.distanceToSquared(Z._p4)<1e-10},Oi.prototype.insertKnot=function(d){var n=this,o=n._p1,U=n._p2,F=n._p3,A=n._p4,C=o.clone().lerp(U,d),G=U.clone().lerp(F,d),O=F.clone().lerp(A,d),j=C.clone().lerp(G,d),r=G.clone().lerp(O,d),B=j.clone().lerp(r,d);return n._70I()?(o.clone().lerp(A,d),[new qd.Math.CubicBezier(o,o.clone(),B.clone(),B),new qd.Math.CubicBezier(B,B.clone(),A.clone(),A)]):[new qd.Math.CubicBezier(o,C,j,B),new qd.Math.CubicBezier(B,r,O,A)]};var xn=o.Default.getInternal().ui().EdgeUI,uj={_47O:function(w){var m=this,i=uj.getBackups()._47O;qd.inEdit(m.gv)||i.call(m,w)}};qd.Inject.registAsModule(uj,xn);var ki=o.Default.getInternal().ui().NodeUI,sh={_47O:function(A){var P=this,z=sh.getBackups()._47O;qd.inEdit(P.gv)||z.call(P,A)},getSelectWidth:function(){var r=this,c=r.gv,K=r._data;if(c.isEditable(K)&&qd.inEdit(c))return 0;var q=sh.getBackup("getSelectWidth");return q.call(r)}};qd.Inject.registAsModule(sh,ki);var ie=o.graph.GraphView,aj={_editPointSize:function(){var w=o.Default.isTouchable,T=qd.getStyle("pointSize");return T[w?0:1]}(),isPointEditable:function(P){var A=this;if(qd.inEdit(A))return A._pointEditableFunc?A._pointEditableFunc(P):!0;var x=aj.getBackup("isPointEditable");x.call(A,P)},isEditable:function(N){var K,U=this,S=aj.getBackup("isEditable");if(K=N instanceof qd.Group?!0:S.call(U,N),!qd.inEdit(U))return K;if(!(N instanceof o.Edge))return K;if(!N.s("2d.editable"))return!1;var C=U.getEditableFunc();return C?C(N):!0},_42:function(C,t){var I=this,b=aj.getBackups()._42;if(b.call(I,C,t),qd.inEdit(I)){var A=I.getEditInteractor();A.drawImpl()}}};qd.Inject.registAsModule(aj,ie);var Dg=o.Default.getInternal().ui().ShapeUI,ak={_47O:function(N){var Y=this,v=ak.getBackups()._47O;qd.inEdit(Y.gv)||v.call(Y,N)}};qd.Inject.registAsModule(ak,Dg);var Zf=o.graph.DefaultInteractor,Xr={handle_mousewheel:function(F){var M=this,h=Xr.getBackup("handle_mousewheel");qd.inEdit(M.gv)||h.call(M,F)}};qd.Inject.registAsModule(Xr,Zf);var us=o.graph.MoveInteractor,je={_calcShift:function(c,Q){var K=this,o=je.getBackup("_calcShift"),A=K.gv;if(!qd.inEdit(A))return o.call(K,c,Q);var z=A.getEditInteractor(),E=z.getSubModule("Move").calcShift(c,Q,K);return E||o.call(K,c,Q)},clear:function(W){var H=this,R=je.getBackup("clear");R.call(H,W);var C=H.gv;if(qd.inEdit(C)){var u=C.getEditInteractor();u.getSubModule("Move").clear(W)}}};qd.Inject.registAsModule(je,us);var mr=qd.Rect=function(l){this.catalog="Rect",this._interactor=l};mr.prototype={},mr.prototype.constructor=mr,mr.prototype.gatherInfo=function(f,c){var z=this;if(1===c.length){var g=c[0];return g instanceof o.Shape&&g._70I()?z.gatherLine(f,g):Ml(g,f)?!1:z.gatherSingleTarget(f,g)}return c.length>1?z.gatherMultiTargets(f,c):!1},mr.prototype.gatherSingleTarget=function(t,$){if($.getCorners){var v,Q=this,O=Q.info;Q.target=$,v=Q.screenInfo={};var b=$.getCorners();O.LT=new qd.Math.Vector2(b[0]),O.LB=new qd.Math.Vector2(b[1]),O.RB=new qd.Math.Vector2(b[2]),O.RT=new qd.Math.Vector2(b[3]),O.T=O.LT.clone().add(O.RT).divideScalar(2),O.B=O.LB.clone().add(O.RB).divideScalar(2),O.L=O.LT.clone().add(O.LB).divideScalar(2),O.R=O.RT.clone().add(O.RB).divideScalar(2);for(var h in O)v[h]=qd.toScreenPosition(t,O[h]);var _=Q._interactor,X=_.getStyle("checkSize"),V=function(l,Q,U){var k=Q.clone().sub(l).setLength(-X),M=U.clone().sub(l).setLength(-X),P=k.add(M).add(l);return P};return v.rotLT=V(v.LT,v.RT,v.LB),v.rotLB=V(v.LB,v.LT,v.RB),v.rotRB=V(v.RB,v.LB,v.RT),v.rotRT=V(v.RT,v.LT,v.RB),v.rotT=v.rotLT.clone().add(v.rotRT).divideScalar(2),v.rotB=v.rotLB.clone().add(v.rotRB).divideScalar(2),v.rotL=v.rotLT.clone().add(v.rotLB).divideScalar(2),v.rotR=v.rotRT.clone().add(v.rotRB).divideScalar(2),v.rotation=$.getRotation(),Q.gatherConnectInfo(),!0}},mr.prototype.gatherConnectInfo=function(){var S=this,z=S.target,L=S._interactor,v=S.screenInfo,y=L.gv;if(y.isConnectActionVisible(z)&&L.getStyle("connectGuideVisible")){var h;z.s&&(h=z.s("connectGuideShift")),h||(h=L.getStyle("connectGuideShift"));var m=z.getAnchor(),w=z.getSize(),E=z.toGlobal({x:w.width*(h[0]-m.x),y:w.height*(h[1]-m.y)});E=qd.toScreenPosition(y,E),v.P1?E.add(v.P2.clone().sub(v.P1).setLength(h[2])):(E.add(v.RT.clone().sub(v.LT).setLength(h[2])),E.add(v.LB.clone().sub(v.LT).setLength(h[3]))),v.connect=E}},mr.prototype.gatherMultiTargets=function(W,h){var G=qd.Group.findOrCreateGroup(h);if(!G)return!1;var f=this;return f.editing&&"rotate"!==f.editing.mode||G.calcInfo(),f.gatherSingleTarget(W,G)},mr.prototype.gatherLine=function(L,o){this.target=o;var A=this.screenInfo={},p=o.getPoints(),t=qd.getDataMatrix(o);return A.P1=qd.toScreenPosition(L,t.apply(p.get(0))),A.P2=qd.toScreenPosition(L,t.apply(p.get(1))),this.gatherConnectInfo(),!0},mr.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],mr.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],mr.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],mr.prototype.check=function(w,v,s){if(o.Default.isLeftButton(v)){var t=this;if(t.editing=null,t.tipInfo=null,t.screenInfo){var V=t.target,L=w.isEditable(V),N=t.screenInfo;if(L&&N.connect){var T=t._checkConnect(s);if(T)return T}if(N.P1)return t._checkLine(s);var i,S,I,J=null,P=t._interactor,H=P.getStyle("checkSize");if(L&&w.isRectEditable(V))for(S=0;S<qd.Rect.ResizeKeys.length;S++)if(I=qd.Rect.ResizeKeys[S],qd.checkHit(s,N[I],H)){J=I,i="resize";break}if(!J&&L&&w.isRotationEditable(V)&&!P.getStyle("rotateAsClock")){var M=P.getStyle("rotateCheckSize");for(S=0;S<qd.Rect.RotateKeys.length;S++)if(I=qd.Rect.RotateKeys[S],qd.checkHit(s,N[I],M)){J=I,i="rotate";break}}if(!J)return P.setCursor("default"),void 0;if("rotate"===i){var E,$=w.lp(v);if(V instanceof qd.Group){var B=P.getStyle("groupRotateModeKey");"string"==typeof B&&(B=[B]);for(var Z=!1,Q=0,D=B.length;D>Q;Q++)if(v[B[Q]]){Z=!0;break}var z=P.getStyle("groupRotateModeDefault");E=Z?"batch"===z?"block":"batch":z}var a="batch"===E?V.getAnchor2():V.getPosition(),R=Math.atan2($.y-a.y,$.x-a.x);P._setRotateCursor(R),t.editing={mode:i,key:J,pos:a,flipY:V.getScale().y<0,rotation:V.getRotation(),hitRot:R},E&&(t.editing.groupRotateMode=E)}else{var C=qd.Rect.ResizeKeys.indexOf(J),c=qd.Rect.ResizeDirection[C],F=Math.cos(V.getRotation()),U=Math.sin(V.getRotation()),u=c.x*Math.sign(V.getScale().x),f=c.y*Math.sign(V.getScale().y),y=Math.atan2(-U*u-F*f,F*u-U*f),e=(Math.round(y/(Math.PI/4))+8)%8,K=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][e];
this._interactor.setCursor(K);var p=V.getWidth(),G=V.getHeight(),d=V.getAnchor();t.editing={mode:i,key:J,rect:{x:-p*d.x,y:-G*d.y,width:p,height:G},anchor:d,matrix:V.getMatrix()}}return J}}},mr.prototype._checkLine=function(t){var U=this;U.screenInfo;var N,b=U._interactor.getStyle("checkSize");if(qd.checkHit(t,U.screenInfo.P1,b))N="P1";else{if(!qd.checkHit(t,U.screenInfo.P2,b))return this._interactor.setCursor("default"),void 0;N="P2"}return U.editing={mode:"line",key:N},N},mr.prototype._checkConnect=function(Q){var V=this,v=V.screenInfo,T=V._interactor,W=T.getStyle("connectGuideIntersectSize"),C=v.connect,z=Q.x,O=C.x;if(O>z&&W>O-z&&Math.abs(C.y-Q.y)<W||z>=O&&qd.checkHit(Q,C,W)){var D="connect",N=u.getConnectAction(T.gv);if(V.editing={mode:D},N&&N.delete)if(V.target instanceof qd.Group){var S=!0;T.gv.sm().getSelection().each(function(P){N.delete.visible.call(null,T.gv,P)||(S=!1)}),V.editing.hasDeleteAction=S}else N.delete.visible.call(null,T.gv,V.target)&&(V.editing.hasDeleteAction=!0);return T.setCursor("default"),D}},mr.prototype._fireEditEvent=function(k,S){var m=this._interactor,C=this.editing;if(C){var A=C.mode;A="rotate"===A?"Rotation":"connect"===A?"Connection":A[0].toUpperCase()+A.slice(1),m.fi({kind:k+"Edit"+A,event:S})}},mr.prototype.startEdit=function(x,e){x.startDragging(e);var L=this;L._interactor.fi({kind:"prepareEdit",event:e});var l=L.editing,T=L.target;if(l){if(L._fireEditEvent("begin",e),"rotate"===l.mode)return l.groupRotateMode&&T.beginRotate(l),void 0;if("connect"!==l.mode)("line"===l.mode||T&&0===T.getRotation())&&(L._inSmartGuide=!0,L._interactor.rectGuide.gatherRects());else if(l.hasDeleteAction){var u=x.gv,O=L._interactor.getStyle("connectGuideGarbageShift");l.garbageInfo={x:u.getWidth()*O[0]+O[2],y:u.getHeight()*O[1]+O[3],size:L._interactor.getStyle("connectGuideGarbageIntersectsize")},x._42()}}},mr.prototype._46O=function(m){var y,I,z=this,Y=z.editing,l=z.target;if(Y){if("connect"===Y.mode&&!Y.canceled&&!Y.deleted)try{Y.garbageInfo&&Y.garbageInfo.hover?u.doDeleteConnectionAction(z._interactor.gv,l):u.doConnectAction(z._interactor.gv,l,Y.target)}catch(J){console.error(J)}I=Y.freezeFlag,y=z.editing.groupRotateMode,z._fireEditEvent("end",m),z.editing=null}z.tipInfo=null,z._inSmartGuide&&(z._interactor.rectGuide.clear(),z._inSmartGuide=!1),y&&l&&l.endRotate(),l instanceof o.Block&&(I===g?delete l._freezeSyncFromChildren:l._freezeSyncFromChildren=I,l.updateFromChildren())},mr.prototype.handleNormalStateDelete=function(){var f=this,J=f.editing;if(J&&"connect"===J.mode&&!J.canceled&&!J.deleted){if(J.garbageInfo){try{u.doDeleteConnectionAction(f._interactor.gv,f.target)}catch(j){console.error(j)}J.garbageInfo=null}return J.cursorPos=null,J.targetCorners=null,J.deleted=!0,f._interactor._42(),!0}},mr.prototype.handleNormalStateKeyDown=function(v){var _=this,O=_.editing;return!O||"connect"!==O.mode||O.canceled||O.deleted?void 0:o.Default.isEsc(v)?(O.cursorPos=null,O.targetCorners=null,O.canceled=!0,_._interactor._42(),!0):void 0},mr.prototype.handleEdit=function(Q,X){var x=this,U=x.editing;if(U){var N,e,i,C,q,T=x.target,u=U.key,V=U.mode,Z=Q.lp(X),k=x._interactor;if("connect"===V){if(U.canceled)return;if(U.deleted)return;U.cursorPos=k._getLogicalPoint(X);var s=U.garbageInfo;return s&&qd.checkHit(U.cursorPos,s,s.size)?(s.hover=!0,U.target=null,U.targetCorners=null):(s&&(s.hover=!1),U.target=Q.getDataAt(Z,function(z){return Q.isSelectable(z)?_h(z)?!0:!1:!1})||null,U.targetCorners=qd.getTargetCornersOnScreen(Q,U.target)),k._42(),void 0}if("rotate"===V){var K,p,v=U.pos,t=Math.atan2(Z.y-v.y,Z.x-v.x);if(U.groupRotateMode?p=t-U.hitRot:(K=t-U.hitRot,p=U.rotation+K),p%=2*Math.PI,0>p&&(p+=2*Math.PI),!o.Default.isCtrlDown(X)){var y,E;Cl(X)?(y=k.getStyle("shiftRotateRound"),E=y/2):(y=k.getStyle("rotateRound"),E=k.getStyle("rotateSensitivity")),p=qd.roundTo(p,y,E)}U.groupRotateMode?(K=p-(U.lastRotation||0),0!==K&&(T.addRotation(K,U.groupRotateMode),U.lastRotation=p)):T.setRotation(p),k._setRotateCursor(t),p>Math.PI&&(p-=2*Math.PI);var d=180*(p/Math.PI);d=d.toFixed(2),N=""+d+""}else if("resize"===V){var H=U.rect;i=H.x,C=H.y;var h,J=H.width,c=H.height,f=U.anchor,$=U.matrix,I=T.s&&T.s("keepAspectRatio")||k.getStyle("keepAspectRatio");Cl(X)&&(I=!I);var z=x._unionPointMode1,F=x._unionPointMode2;if(x._inSmartGuide&&!o.Default.isCtrlDown(X)&&!I){var r;"L"===u||"R"===u?r="x":("T"===u||"B"===u)&&(r="y"),x._adsorbedToClosest(Z,r),q=!0}h=$.tfi(Z);var O;"LT"===u?(H=z(h,{x:i+J,y:C+c},J,c,I),O=9):"T"===u?(H=F({x:i,y:h.y},{x:i+J,y:C+c},J,c,I,"v"),O=1):"RT"===u?(H=z(h,{x:i,y:C+c},J,c,I),O=33):"L"===u?(H=F({x:h.x,y:C},{x:i+J,y:C+c},J,c,I,"h"),O=8):"R"===u?(H=F({x:i,y:C},{x:h.x,y:C+c},J,c,I,"h"),O=32):"LB"===u?(H=z(h,{x:i+J,y:C},J,c,I),O=12):"B"===u?(H=F({x:i,y:C},{x:i+J,y:h.y},J,c,I,"v"),O=4):"RB"===u&&(H=z(h,{x:i,y:C},J,c,I),O=36);var g=$.tf(H.x+H.width*f.x,H.y+H.height*f.y);T instanceof o.Block&&(U.hasOwnProperty("freezeFlag")||(U.freezeFlag=T._freezeSyncFromChildren,T._freezeSyncFromChildren=!0)),T.setPosition(g),T.setSize(H.width,H.height),q&&(e=T.getRect(),k.rectGuide.gatherLines({node:T,x:e.x,y:e.y,w:e.width,h:e.height},r,O)),N=""+Math.round(H.width)+" * "+Math.round(H.height)}else if("line"===V){if(Cl(X)){var D=T.getPoints(),P="P1"===u?D.get(1):D.get(0),M={x:Z.x-P.x,y:Z.y-P.y},B=k.getStyle("shiftLineRotateRound"),w=x._shiftDirList;if(!w||x._shiftRotateRound!==B){x._shiftRotateRound=B,x._shiftDirList=w=[];for(var j=0;j<Math.PI;j+=B)w.push({x:G(j),y:R(j)})}for(var n,L=0,m=0,W=w.length;W>m;m++){var _=w[m],S=_.x*M.x+_.y*M.y;Math.abs(S)>Math.abs(L)&&(L=S,n=_)}Z={x:P.x+n.x*L,y:P.y+n.y*L},k.rectGuide.clear()}else x._inSmartGuide&&!o.Default.isCtrlDown(X)&&(x._adsorbedToClosest(Z),q=!0);var A=qd.getDataMatrix(T).applyInverse(Z);T.setPoint("P1"===u?0:1,A,!0);var b=T.getPoints(),Y=b.get(0),l=b.get(1);i=Y.x-l.x,C=Y.y-l.y,N=" "+Math.round(Math.sqrt(i*i+C*C))+" ",q&&(e=T.getRect(),k.rectGuide.gatherLines({node:T,x:e.x,y:e.y,w:e.width,h:e.height}))}if(N){var a=o.Default.getLogicalPoint(X,k._canvas);a.x+=qd.Icons.TipShiftX,a.y+=qd.Icons.TipShiftY,x.tipInfo={helperPos:a,text:N,size:N.length}}x._fireEditEvent("between",X)}},mr.prototype._unionPointMode1=function(S,z,q,i,D){if(D&&q&&i){var d=S.x-z.x,N=S.y-z.y;Math.abs(d*i)<Math.abs(N*q)?(N=Math.sign(N)*Math.abs(d*i/q),S.y=z.y+N):(d=Math.sign(d)*Math.abs(N*q/i),S.x=z.x+d)}return o.Default.unionPoint(S,z)},mr.prototype._unionPointMode2=function(k,g,Q,i,s,t){var Z=o.Default.unionPoint(k,g);if(s&&Q&&i){var m;"v"===t?(m=Z.x+Z.width/2,Z.width=Q*Z.height/i,Z.x=m-Z.width/2):(m=Z.y+Z.height/2,Z.height=i*Z.width/Q,Z.y=m-Z.height/2)}return Z},mr.prototype._adsorbedToClosest=function(R,$){var q=this,n=q._interactor,T=n.rectGuide.findClosest(R,$),Y=n.gridGuide.findClosest(R,$),K=1/0,c=1/0;T&&(isFinite(T.x)&&(K=T.x),isFinite(T.y)&&(c=T.y)),Y&&(isFinite(Y.x)&&Math.abs(Y.x)<Math.abs(K)&&(K=Y.x),isFinite(Y.y)&&Math.abs(Y.y)<Math.abs(c)&&(c=Y.y)),isFinite(K)&&(R.x+=K),isFinite(c)&&(R.y+=c)},mr.prototype._42=function(k,N,w){var d=this;d.info={},d.screenInfo=null;var I=d._interactor;if(!I.editDetail&&d.gatherInfo(N,w)){var i=d.editing,$=i?i.groupRotateMode:null,j=d.screenInfo;"block"!==$&&(j.P1?qd.Icons.DrawIcon(I,k,qd.Icons.Line,j):qd.Icons.DrawIcon(I,k,qd.Icons.Rect,j),j.connect&&(qd.Icons.DrawIcon(I,k,qd.Icons.ConnectGuide,{rotation:j.rotation,connect:j.connect,cursorPos:i?i.cursorPos:null}),i&&(i.targetCorners&&qd.Icons.DrawIcon(I,k,qd.Icons.NodeHoverGuide,i.targetCorners),i.garbageInfo&&qd.Icons.DrawIcon(I,k,qd.Icons.ConnectGuideGarbage,i.garbageInfo))),d.tipInfo&&qd.Icons.DrawIcon(I,k,qd.Icons.TipHelper,d.tipInfo)),d.target instanceof qd.Group&&d.target._42(I,k,N)}};var ye=qd.Anchor=function(q){this.catalog="Anchor",this._interactor=q};ye.prototype={},ye.prototype.constructor=ye,ye.prototype.gatherInfo=function(O,w){var s=this;if(1===w.length){var T=w[0];if(!T.getAnchor)return;if(T instanceof o.Shape&&T._70I())return;if(Ml(T,O))return;return s.gatherSingleTarget(O,w[0])}return w.length>1?s.gatherMultiTargets(O,w):!1},ye.prototype.gatherSingleTarget=function(r,h){var f=this;return f.info.POS=h.getPosition(),f.screenInfo.POS=qd.toScreenPosition(r,f.info.POS),f.target=h,!0},ye.prototype.gatherMultiTargets=function(u,l){var J=this,s=qd.Group.findOrCreateGroup(l);return s?(J.screenInfo.POS=qd.toScreenPosition(u,s.getAnchor2()),J.target=s,!0):!1},ye.prototype.isVisible=function(){var z=this,C=z._interactor;if(C.getStyle("anchorVisible")===!1)return!1;var Z=z.target;if(Z){if(this.editing)return!0;var e=Z.getAnchor(),d=C.getStyle("anchorOutsideVisibleThreshold");if(e.x<-d||e.x>1+d||e.y<-d||e.y>1+d)return!0;var $=Z.getSize(),o=Z.getScale(),R=Math.min(Math.abs($.width*o.x),Math.abs($.height*o.y));if(R*C.gv._zoom<C.getStyle("anchorHideThreshold"))return!1}return!0},ye.prototype.check=function(Q,n,T){if(o.Default.isLeftButton(n)){var k=this,O=k._interactor;if(k.isVisible()&&O.getStyle("anchorMovable")!==!1){k.editing=null,k.tipInfo=null;var y=k.target;if(y&&Q.isAnchorEditable(y)&&Q.isEditable(y)){var B;if(k.screenInfo&&(B=k.screenInfo.POS)&&qd.checkHit(T,new qd.Math.Vector2(B),O.getStyle("checkSize"))){if(y instanceof qd.Group)return k.editing={},!0;var N=y.getWidth(),v=y.getHeight(),t=y.getAnchor();return k.editing={rect:{x:-N*t.x,y:-v*t.y,width:N,height:v},anchor:t,matrix:y.getMatrix()},!0}}}}},ye.prototype.startEdit=function(B,s){B.startDragging(s),B.fi({kind:"beginEditAnchor",event:s})},ye.prototype._46O=function(Z){var n=this;n.editing&&(n.editing=null,n._interactor.fi({kind:"endEditAnchor",event:Z})),n.tipInfo=null},ye.prototype.handleEdit=function(z,M){var m=this,l=m.target;if(l){var $=m.editing;if($){var U=z.lp(M),t=m._interactor;if(l instanceof qd.Group)return l.setAnchor2(U),t._42(),void 0;var B=$.matrix,F=B.tfi(U),r=$.rect,s=(F.x-r.x)/r.width,k=(F.y-r.y)/r.height;if(!o.Default.isCtrlDown(M)){var L=t.getStyle("anchorRound"),u=t.getStyle("anchorSensitivity");s=qd.roundTo(s,L,u),k=qd.roundTo(k,L,u)}l.setAnchor(s,k,!0);var S=o.Default.getLogicalPoint(M,t._canvas);S.x+=qd.Icons.TipShiftX,S.y+=qd.Icons.TipShiftY;var q=""+s.toFixed(2)+", "+k.toFixed(2);m.tipInfo={helperPos:S,text:q,size:q.length},t.fi({kind:"betweenEditAnchor",event:M})}}},ye.prototype._42=function(O,Z,u){var V=this;V.info={},V.screenInfo={};var K=V._interactor;K.editDetail||V.gatherInfo(Z,u)&&V.isVisible()&&(qd.Icons.DrawIcon(K,O,qd.Icons.Anchor,V.screenInfo),V.tipInfo&&qd.Icons.DrawIcon(K,O,qd.Icons.TipHelper,V.tipInfo))};var nl=qd.RotateX=function(L){this.catalog="RotateX",this._interactor=L};nl.prototype={},nl.prototype.constructor=nl,nl.prototype.gatherInfo=function(m,T){var c=this;if(1===T.length){var f=T[0];return f instanceof o.Shape&&f._70I()||Ml(f,m)?!1:c.gatherSingleTarget(m,f)}return T.length>1?c.gatherMultiTargets(m,T):!1},nl.prototype.gatherSingleTarget=function(){var Q=new o.Math.Vector2,M=new o.Math.Vector2,z=new o.Math.Vector2,b=new o.Math.Vector2,y=function(Q,j){var v=Q.x-j.x,s=Q.y-j.y;return v*v+s*s};return function(h,k){if(k.getCorners){var P=this,B=k.getCorners(),X=15,J=k.getPosition();Q.copy(B[0]),z.copy(B[1]),b.copy(B[3]),M.copy(Q).add(b).divideScalar(2).add(Q.sub(z).setLength(X/h.getZoom()));var q=Math.max(y(J,B[0]),y(J,B[1]),y(J,B[2]),y(J,B[3]));return P.info.POS=M.clone(),P.screenInfo.POS=qd.toScreenPosition(h,P.info.POS),P.screenInfo.LEN=Math.sqrt(q)*h.getZoom()+X,P.screenInfo.CENTER=qd.toScreenPosition(h,J),P.target=k,!0}}}(),nl.prototype.gatherMultiTargets=function(o,h){var Z=this,$=qd.Group.findOrCreateGroup(h);if(!$)return!1;var Z=this;return Z.gatherSingleTarget(o,$)},nl.prototype.isVisible=function(){var T=this._interactor;if(!T.getStyle("rotateAsClock"))return!1;var l=this.target;if(!l)return!0;var K=T.gv;return K.isEditable(l)&&K.isRotationEditable(l)?!0:!1},nl.prototype.check=function(k,f,L){var T=this,m=T._checkImpl(k,f,L);return(m||T._clockPainted)&&T._interactor._42(),m},nl.prototype._checkImpl=function(r,c,M){if(o.Default.isLeftButton(c)){var R=this;R.editing=null,R.tipInfo=null;var $;if(R.screenInfo&&($=R.screenInfo.POS)&&R.isVisible()){var _=R._interactor;if(qd.checkHit(M,$,_.getStyle("checkSize"))){var Y=R.target,Q=r.lp(c),n=Y.getPosition(),v=Math.atan2(Q.y-n.y,Q.x-n.x);return _._setRotateCursor(v),R.editing={pos:n,rotation:Y.getRotation(),hitRot:v,groupRotateMode:"block",screenInfo:{CENTER:R.screenInfo.CENTER,LEN:R.screenInfo.LEN}},!0}}}},nl.prototype.startEdit=function(D,A){D.startDragging(A),D.fi({kind:"beginEditRotation",event:A}),this.target instanceof qd.Group&&this.target.beginRotate(this.editing)},nl.prototype._46O=function(G){var r=this;r.editing&&(r.editing=null,r._interactor.fi({kind:"endEditRotation",event:G})),r.target instanceof qd.Group&&r.target.endRotate(),r.tipInfo=null},nl.prototype.handleEdit=function(k,C){var G=this,R=G.editing;if(R){var i,c,n=G.target,Q=k.lp(C),t=G._interactor,y=R.pos,B=Math.atan2(Q.y-y.y,Q.x-y.x),b=n instanceof qd.Group;if(b?c=B-R.hitRot:(i=B-R.hitRot,c=R.rotation+i),c%=2*Math.PI,0>c&&(c+=2*Math.PI),!o.Default.isCtrlDown(C)){var Y,F;Cl(C)?(Y=t.getStyle("shiftRotateRound"),F=Y/2):(Y=t.getStyle("rotateRound"),F=t.getStyle("rotateSensitivity")),c=qd.roundTo(c,Y,F)}b?(i=c-(R.lastRotation||0),0!==i&&(n.addRotation(i,R.groupRotateMode),R.lastRotation=c)):n.setRotation(c),t._setRotateCursor(B),c>Math.PI&&(c-=2*Math.PI);var v=180*(c/Math.PI),J=""+v.toFixed(2)+"",x=o.Default.getLogicalPoint(C,t._canvas);x.x+=qd.Icons.TipShiftX,x.y+=qd.Icons.TipShiftY,G.tipInfo={helperPos:x,text:J,size:J.length},t.fi({kind:"betweenEditRotation",event:C})}},nl.prototype._42=function(r,X,w){var j=this;j._clockPainted=!1,j.info={},j.screenInfo={};var m=j._interactor;m.editDetail||j.gatherInfo(X,w)&&j.isVisible()&&(qd.Icons.DrawIcon(m,r,qd.Icons.RoundPoint,j.screenInfo.POS),j.tipInfo&&qd.Icons.DrawIcon(m,r,qd.Icons.TipHelper,j.tipInfo),j.editing&&j.drawClock(r))},nl.prototype.drawClock=function(K){K.save();var x=this;x._clockPainted=!0;var u=x.editing||{},E=u.screenInfo||x.screenInfo,P=E.LEN,L=P+8,t=P+18;K.save(),K.translate(E.CENTER.x,E.CENTER.y),K.beginPath(),K.strokeStyle="rgb(150, 150, 150)";for(var y,c,o,a,S,n=0;360>n;n++)y=n*Math.PI/180,0===n%5&&(c=R(y)*P,o=G(y)*P,a=R(y)*L,S=G(y)*L,K.moveTo(c,o),K.lineTo(a,S)),0===n%45&&(c=R(y)*P,o=G(y)*P,a=R(y)*t,S=G(y)*t,K.moveTo(c,o),K.lineTo(a,S));K.stroke(),K.rotate(-j);var D=u.lastRotation||x.target.getRotation();K.beginPath(),K.fillStyle="rgba(255, 0, 0, 0.1)",K.strokeStyle="rgb(157, 157, 157)",K.moveTo(0,0),K.arc(0,0,t,0,D,!1),K.fill(),K.beginPath(),K.moveTo(0+t,0),K.arc(0,0,t,0,D,!1),K.stroke(),K.restore()};var Ym=qd.Curve=function(U){this.catalog="Curve",this._interactor=U};Ym.prototype={},Ym.prototype.constructor=Ym,Z.defineProperties(Ym.prototype,{activing:{get:function(){return this._activing},set:function(J){var u=this;if(J)u._activing=new qd.CurveActiving(this,J);else{var Q=u._activing;Q&&Q.dispose(),u._activing=null}}}}),Ym.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Ym.prototype.setUp=function(){var H=this,o=H._interactor;o&&o.gv.mp(H._onGraphviewPropertyChanged,H)},Ym.prototype._onGraphviewPropertyChanged=function(Z){("zoom"===Z.property||"translateX"===Z.property||"translateY"===Z.property)&&this._handleDataChanged()},Ym.prototype.tearDown=function(){var G=this,J=G._interactor;J&&J.gv.ump(G._onGraphviewPropertyChanged,G)},Ym.prototype.canEnterEditDetailMode=function(){var E=this,P=E._interactor,U=P._getValidSelection();if(1===U.length){var R=U[0],u=R instanceof o.Edge;if(R instanceof o.Shape||u){if(u){var q=R.s("edge.type");if(q&&"points"!==q)return}var e=P.gv;if(e.isPointEditable(R)&&e.isEditable(R))return E.target=R,!0}}},Ym.prototype.canQuitEditDetailMode=function(l){var Q=this,G=Q._interactor._getLogicalPoint(l);return Q._checkEditRealPoint(G)?void 0:Q._interactor.gv.getDataAt(l)!==Q.target?!0:void 0},Ym.prototype.preHandleScroll=function(){var d=this.editing;return d&&d.inEdit?!0:void 0},Ym.prototype.getCurrentSelectintStatus=function(){var D=this;if(D.activing&&!D.activing.selections){if(D.activing.status!=g)return D.activing.status;var P=function(n){var m=D.activing.status;D.activing.status=n,D._interactor.fp("shapePointStatus",m,n)},s=qd.Curve.PointType,j=D.activing.point,x=D.activing.pairs;if(!x||1!==x.length)return P(s.Mirrored);var b=x[0],w=b.c1&&b.c1.isNearEnough(j),I=b.c2&&b.c2.isNearEnough(j);if(!b.c1||!b.c2)return w||I?P(s.Straight):P(s.Disconnected);if(w&&I)return P(s.Straight);if(w||I)return P(s.Asymmetric);var r=b.c1.clone().sub(j),A=b.c2.clone().sub(j);return Math.abs(r.x*A.y-r.y*A.x)>1e-5||r.x*A.x>0?P(s.Disconnected):Math.abs(r.length()-A.length())>1e-5?P(s.Asymmetric):P(s.Mirrored)}},Ym.prototype.handle_keydown=function(p){var C=this;if(C._interactor.editDetail){var R=qd.Curve.PointType;"1"===p.key?C._setCurrentSelectionStatus(R.Straight):"2"===p.key?C._setCurrentSelectionStatus(R.Mirrored):"3"===p.key?C._setCurrentSelectionStatus(R.Disconnected):"4"===p.key&&C._setCurrentSelectionStatus(R.Asymmetric)}},Ym.prototype.setCurrentSelectionStatus=function(x){var T=this,m=T._interactor;if(m){var X=m.gv;X.dm().beginTransaction(),this._setCurrentSelectionStatus(x),X.dm().endTransaction()}},Ym.prototype._setCurrentSelectionStatus=function(F){var J=this,g=J.activing;if(g){var a=J.getCurrentSelectintStatus();if(null!==a&&a!==F){g.status=F;var l=J.activing.point,i=J.activing.pairs;if(i&&1===i.length){var C=i[0],O=J.screenInfo.curve,S=qd.Curve.PointType,M=function(){J._writeToHt(),J._interactor.fp("shapePointStatus",a,F)};if(F===S.Straight)return O.moveCtrlPoint(C,l,"c1"),O.moveCtrlPoint(C,l,"c2"),M(),void 0;if(a===S.Straight){var V=O.findPairs(l,!0),x=V[0],p=x.r1||l,n=x.r2||l,h=n.clone().sub(p).multiplyScalar(.25);return O.moveCtrlPoint(C,l.clone().sub(h),"c1"),O.moveCtrlPoint(C,l.clone().add(h),"c2"),M(),void 0}var X=C.c1,u=C.c2;if(X&&u){if(F===S.Mirrored)return O.moveCtrlPoint(C,l.clone().multiplyScalar(2).sub(u),"c1"),M(),void 0;if(F===S.Asymmetric&&a===S.Disconnected){var E=X.clone().sub(l).length(),h=l.clone().sub(u).setLength(E).add(l);return O.moveCtrlPoint(C,h,"c1"),M(),void 0}}g._firePointChange(),J._interactor.fp("shapePointStatus",a,F)}}}},Ym.prototype._handleDataChanged=function(A){var o=this;if(o.screenInfo&&o.target){var a=o._interactor;o.gatherSingleTarget(a.gv,o.target,!0),o.check(a.gv,null,A?a._getLogicalPoint(A):new qd.Math.Vector2(a._lastClientPoint)),a._42()}},Ym.prototype.gatherSingleTarget=function(y,p,N){var Q,T,k=this;k.screenInfo&&k.screenInfo.curve&&(T=k.screenInfo.curve._curves);var v=k.editing;Q=v?k.screenInfo:k.screenInfo={};var g,X,O=p instanceof o.Edge;O?(g=p.s("edge.segments"),X=p.s("edge.points")||new o.List):(g=p._58O,X=p._59O),Q.S=g;var Z,e=Q.P=[],W=qd.getDataMatrix(p);if(p instanceof o.Polyline&&(Z=p.getElevation()||0,Q.E=[]),X.each(function(R){Q.E&&Q.E.push(R.e||Z),R=W.apply(R);var w=qd.toScreenPosition(y,R);e.push(w.x,w.y)}),O){var u=qd.toScreenPosition(y,p._lastSourcePoint),P=qd.toScreenPosition(y,p._lastTargetPoint);e.splice(0,0,u.x,u.y),e.push(P.x,P.y)}if(!Q.S||!Q.S.size()){Q.S=new o.List,Q.S.add(1);for(var c=0;c<e.length/2-1;c++)Q.S.add(2)}if((!v||N)&&k.convertToCubicBezier(T),k.activing&&(N||!k.editing||"realPoint"===k.editing.type)){var _=Q.curve.findPairs(k.activing.point);k.activing.pairs=_}O&&"points"!==p.s("edge.type")&&k._writeToHt()},Ym.prototype._convertToNewPoint=function($,O,g){var q,p,b;for(q=0,p=O.length;p>q;q++){if(b=O[q],b._p1.isNearEnough($))return b._p1;if(b._p4.isNearEnough($))return b._p4}if(g)for(q=0,p=Math.min(g.length,p);p>q;q++){if(b=g[q],b._p1===$)return O[q]._p1;if(b._p4===$)return O[q]._p4}},Ym.prototype.convertToCubicBezier=function(c){var g,n,r=this,l=new qd.Math.Curve,U=r.screenInfo;if(l.createFromHtShape(U.P,U.S,U.E),U.curve=l,r.activing){var e=l._curves;if(g=r.activing.point,n=r._convertToNewPoint(g,e,c),n&&(r.activing.point=n),r.activing.selections){var P=-1,H=r.activing.selections;H.forEach(function(L){P++,n=r._convertToNewPoint(L,e,c),n&&(H[P]=n)})}}},Ym.prototype.check=function(y,L,e){if(!L||o.Default.isLeftButton(L)){var f=this;if(f._interactor.setCursor("default"),f.editing=null,f.highlight=null,f.tipInfo=null,f.screenInfo){if(Lo())return f._interactor._42(),!0;if(f._checkEditCtrlPoint(e))return f._interactor._42(),!0;if(f._checkEditRealPoint(e))return f._interactor._42(),!0;if(f._checkEditElevation(e))return f._interactor._42(),!0;var E=f.screenInfo.curve,S=E.checkPoint(e,f._interactor.getStyle("curveIntersectSize"));if(S){var d=f.highlight={};d.type="insertKnot",d.bezier=S.bezier,d.point=S.intersection}return f._interactor._42(),!0}}},Ym.prototype._checkEditRealPoint=function(y){var e,J,W,G,Q,d,n=this,E=n.screenInfo.curve._curves,T=n._interactor.getStyle("curvePointIntersectSize"),I=1/0;for(T*=T,W=0,G=E.length;G>W;W++)e=E[W],Q=e._p1,d=y.distanceToSquared(Q),I>d&&(I=d,J=Q),Q=e._p4,d=y.distanceToSquared(Q),I>d&&(I=d,J=Q);if(I>T)return!1;var m=n.highlight={};return m.type="changeRealPoint",m.point=J,n.editing={type:"realPoint",point:J,shiftGuide:{point:J.clone(),dir:"x",limit:0}},n._interactor.setCursor("crosshair"),!0},Ym.prototype._checkEditElevation=function(B){var A=this;if(!A._interactor.getStyle("curveElevationVisible"))return!1;var T=A.activing;if(!T)return!1;var q=T.getCurrentEditingPoint();if(!q)return!1;var e=A._interactor,m=e.getStyle("curveElevationGuideShift"),Q=e.getStyle("curveElevationIntersectSize"),N=B.distanceToSquared({x:q.x+m[0],y:q.y+m[1]});if(!(N>Q*Q)){var M=A.highlight={};M.type="elevation";var o=new qd.Math.Vector2(B.x,B.y,q.e);return A.editing={type:"elevation",startPoint:o},A._interactor.setCursor("crosshair"),!0}},Ym.prototype._checkEditCtrlPoint=function(P){var T=this;if(T.activing&&!T.activing.selections){var A=T.getCurrentSelectintStatus();if(A!==qd.Curve.PointType.Straight){var J=T.activing.pairs;if(J){var n=T._interactor.getStyle("curvePointIntersectSize");n*=n;var l,y,Y,m,v,L,G,B,F,b=1/0;for(G=0,F=J.length;F>G;G++)for(m=J[G],B=0;2>B;B++)v=0===B?"c1":"c2",m[v]&&(L=P.distanceToSquared(m[v]),b>L&&(b=L,l=m,y=G,Y=v));if(b>n)return!1;T.activing.hlpair=l,T.activing.hltype=Y;var e=T.highlight={};return e.type="changeCtrlPoint",e.point=l[Y],T.editing={type:"ctrlPoint",pair:l,pairId:y,ctrlType:Y,direction:l[Y].clone().sub(T.activing.point).normalize()},T._interactor.setCursor("crosshair"),!0}}}},Ym.prototype.startEdit=function(v,u){v.startDragging(u);var L=this;L.highlight&&"insertKnot"===L.highlight.type&&(L.insertKnot(),L.gatherSingleTarget(L._interactor.gv,L.target),L.activing=null,L._checkEditRealPoint(L._interactor._getLogicalPoint(u)));var V=L._activing;if(V){var j=L.editing?L.editing.type:null;"ctrlPoint"===j?V.editingCtrl={pairId:L.editing.pairId,type:V.hltype}:"realPoint"===j&&(V.editingCtrl=!1)}var P=L.highlight,R=o.Default.isCtrlDown(u);if(!P||Lo()){var I=L._interactor.gv;if(!I.setFocus(u)||I._scrolling)return;return I.isPannable()&&lk(u)&&!R&&(L._pan={tx:I.tx(),ty:I.ty()},v.fi({kind:"beginPan",event:u})),void 0}if("changeRealPoint"===P.type){var t,q=L.activing?L.activing.point:null,b=L.activing?L.activing.selections:null;if(R&&L.activing)q===P.point?(b?(L.activing={point:b[0]},b.length>1&&(b.splice(0,1),L.activing.selections=b)):L.activing=null,L.editing=null):b&&(t=b.indexOf(P.point))>=0?(b.length>1?b.splice(t,1):delete L.activing.selections,L.editing=null):b?(b.push(q),L.activing={point:P.point,selections:b}):L.activing={point:P.point,selections:[q]};else if(b)q===P.point||((t=b.indexOf(P.point))>=0?(b.splice(t,1,q),L.activing={point:P.point,selections:b}):L.activing={point:P.point});else{var C;q===P.point&&(C=L.activing.status),L.activing={point:P.point},C&&(L.activing.status=C)}v.fi({kind:"beginEditPoint",event:u})}},Ym.prototype.insertKnot=function(){var q=this,p=q.highlight,X=q.screenInfo.curve;X.insertKnot(p.bezier,p.point.t),q._writeToHt()},Ym.prototype._writeToHt=function(){var f,O,t,y,h=this,l=h.screenInfo.curve,M=l.toHtShape(),B=M.points,N=[],X=M.segments,F=h._interactor.gv,I=h.target,x=I instanceof o.Edge,u=qd.getDataMatrix(I).invert();y=I instanceof o.Polyline,y&&(t=I.getElevation());for(var j=0,W=B.length;W>j;j++)f=B[j],O=qd.toWorldPosition(F,f),O=u.apply(O),f.e!=g&&f.e!==t&&(O.e=f.e),N.push(O);if(I._writing=!0,x){I.s("edge.type","points"),I.setStyle("edge.segments",X),I.setStyle("edge.points",N.slice(1,N.length-1)),I.setStyle("edge.source.offset.x",0),I.setStyle("edge.source.offset.y",0),I.setStyle("edge.target.offset.x",0),I.setStyle("edge.target.offset.y",0);var P=h._nextChangeEdgeHost;delete h._nextChangeEdgeHost,P&&("source"===P.type?I.setSource(P.host):I.setTarget(P.host)),h._writeEdgeHostAnchor("source",N[0]),h._writeEdgeHostAnchor("target",N[N.length-1])}else N.length?(I.setSegments(X),I.setPoints(N,!0)):I.removeFromDataModel();delete I._writing},Ym.prototype._writeEdgeHostAnchor=function($,r){var U=this,G=U.target,k=U._calcHostAnchor(G,$,r);G.s("edge."+$+".anchor.x",k.x),G.s("edge."+$+".anchor.y",k.y),k.offsetX||k.offsetY?(G.s("edge."+$+".offset.x",k.offsetX),G.s("edge."+$+".offset.y",k.offsetY)):(G.s("edge."+$+".offset.x",0),G.s("edge."+$+".offset.y",0))},Ym.prototype._calcHostAnchor=function(p,W,H,d){d||(d="source"===W?p.getSource():p.getTarget());var c=this._interactor.gv,U=c.calculateAttachPoint(d,H);if(U)return U.info;var I=d.getRotation(),n=d.getAnchor();if(Ml(d,c)&&(I=0),I){var F=d.getMatrix(),k=F.tfi(H),t=d.getSize();return{x:k.x/t.width+n.x,y:k.y/t.height+n.y}}var w=bs(c,d),r={x:(H.x-w.x)/w.width,y:(H.y-w.y)/w.height};return r},Ym.prototype._handlePanning=function(j){var L=this,Z=L._pan;if(Z){Z.started=!0;var H=L._interactor,p=H.gv,Q=H._lastClientPoint,v=Zg(j);p.setTranslate(Z.tx+v.x-Q.x,Z.ty+v.y-Q.y),L.gatherSingleTarget(H.gv,L.target),H._42(),H.fi({kind:"betweenPan",event:j})}},Ym.prototype.handleEdit=function(R,p){var X=this,i=X.editing;if(X._pan)return X._handlePanning(p),void 0;if(i){i.inEdit=!0;var V,U,y,q=X._interactor._getLogicalPoint(p),S=o.Default.isCtrlDown(p),G=o.Default.isShiftDown(p),n=i.type,I=X.activing;if(X._guideInfo=null,"ctrlPoint"===n&&G){var f=X.editing.direction.clone();V=I.point;var E=f.dot(q.clone().sub(V));q=f.setLength(E).add(V)}else if("ctrlPoint"===n||"realPoint"===n){var f;if("realPoint"===n&&G){var b=X.editing.shiftGuide;U=b.point;var A=Math.abs(q.x-U.x),O=Math.abs(q.y-U.y);A>O&&A>b.limit&&"y"===b.dir&&(b.dir="x"),O>A&&O>b.limit&&"x"===b.dir&&(b.dir="y"),f=b.dir,"x"===f?(q.y=U.y,b.limit=Math.max(b.limit,A)):"y"===f&&(q.x=U.x,b.limit=Math.max(b.limit,O))}var B=X._isEditEdgeSourceTarget();if(B){var Y=X._editEdgeSourceTarget(B,q,S);Y&&(y=Y.tipText)}else if(!S){var z=X._guidingToEdit(q,f),H="realPoint"===n?X._interactor.gridGuide.findClosest(q,f,!0):null,c=1/0,r=1/0;H&&(H.x&&(c=H.x),H.y&&(r=H.y));var K=!1;z&&(z.xList&&(Math.abs(z.x)<=Math.abs(c)?(K=!0,c=z.x):delete z.xList),z.yList&&(Math.abs(z.y)<=Math.abs(r)?(K=!0,r=z.y):delete z.yList),K&&(X._guideInfo=z)),isFinite(c)&&(q.x+=c),isFinite(r)&&(q.y+=r),K&&(z.v=q)}}var D=X.screenInfo.curve;if("realPoint"===i.type){V=i.point,V.e!==g&&(q.e=V.e),D.moveRealPoint(V,q),i.point=q,X.highlight.point=q;var Q=I.status,N=I.selections;if(X.activing={point:q,status:Q},N){var P=q.clone().sub(V),e=0;N.forEach(function(n){var Y=n.clone().add(P);D.moveRealPoint(n,Y),N[e++]=Y}),X.activing.selections=N}}else if("ctrlPoint"===i.type){var _=I.pairs,C=_[i.pairId];D.moveCtrlPoint(C,q,i.ctrlType);var v=I.status,t=qd.Curve.PointType;if((v===t.Mirrored||v===t.Asymmetric)&&C.c1&&C.c2){var V=new qd.Math.Vector2(I.point),L="c1"===i.ctrlType?"c2":"c1";if(v===qd.Curve.PointType.Mirrored)D.moveCtrlPoint(C,V.clone().multiplyScalar(2).sub(q),L);else if(v===t.Asymmetric){var E=C[L].clone().sub(V).length(),h=V.clone().sub(C[i.ctrlType]).setLength(E).add(V);isNaN(h.x)||D.moveCtrlPoint(C,h,L)}}I._firePointChange()}else if("elevation"===i.type){U=i.startPoint;var T=U.e+(U.y-q.y)/R._zoom;X._setCurrentPointImpl("e",T),I._firePointChange(),y="E: "+qd.toFixed(T)}var k=o.Default.getLogicalPoint(p,X._interactor._canvas);if(k.x+=qd.Icons.TipShiftX,k.y+=qd.Icons.TipShiftY,!y){var F=qd.toWorldPosition(R,q);y=""+qd.toFixed(F.x)+", "+qd.toFixed(F.y)}X.tipInfo={helperPos:k,text:y,size:y.length},X._writeToHt(),X._interactor.fi({kind:"betweenEditPoint",event:p})}},Ym.prototype._setCurrentPointImpl=function($,h){var i=this,d=i._activing;if(!d)return!1;var r=i.target;if(!r)return!1;var n=d.getCurrentEditingPoint();if(!n)return!1;var x=d.editingCtrl;if(!x)var D=n.clone();if("e"===$)n.e=h;else{var f;if("x"===$||"y"===$){var I=d._lastFirePoint;f="x"===$?{x:h,y:I?I.y:0}:{x:I?I.x:0,y:h}}else"object"==typeof $?(f=$,$.e!==g&&(n.e=$.e)):(f={x:arguments[0],y:arguments[1]},arguments[2]!==g&&(n.e=arguments[2]));var B=qd.getDataMatrix(r);f=qd.toScreenPosition(i._interactor.gv,B.apply(f)),n.x=f.x,n.y=f.y}if(!x){var S=D.multiplyScalar(-1).add(n);n.e&&D.e&&(S.e=n.e-D.e),i.screenInfo.curve.moveCtrlDueToRealPointMovement(n,S)}return!0},Ym.prototype.setCurrentPoint=function(t,w){return this._setCurrentPointImpl(t,w)?(this._writeToHt(),!0):!1},Ym.prototype._isEditEdgeSourceTarget=function(){var d=this,M=d.target;if(!(M instanceof o.Edge))return!1;var j=d.editing.point,K=d.screenInfo.curve._curves;return j===K[0]._p1?"source":j===K[K.length-1]._p4?"target":!1},Ym.prototype._editEdgeSourceTarget=function(x,k,z){var V,Z=this,N=Z.target;if(V="source"===x?N.getSource():N.getTarget()){var J=Z._interactor.gv,Y=qd.toWorldPosition(J,k),S=Z._calcHostAnchor(N,x,Y,V);if(Z._interactor.getStyle("edgeHostDetectPerFrame")||S.x<0||S.x>1||S.y<0||S.y>1){var _=J.getDataAt(Y,function(l){return J.isSelectable(l)?_h(l)?!0:!1:!1});if(_){var h=Z._calcHostAnchor(N,x,Y,_);V=_,Z._nextChangeEdgeHost={type:x,host:_},S=h}}var L;if(!z){var q=Z._interactor.getStyle("anchorRound"),F=Z._interactor.getStyle("anchorSensitivity");L=J.calculateAttachPoint(V,Y),L?S=L.info:(S.x=qd.roundTo(S.x,q,F),S.y=qd.roundTo(S.y,q,F))}if(!z){var D=V.getAttachPosition(S.x,S.y,S.offsetX,S.offsetY),P=qd.toScreenPosition(J,D);k.x=P.x,k.y=P.y}Z._edgeHostGuideInfo={corners:qd.getTargetCornersOnScreen(J,V),attach:L?L.index:-1,host:V};var B=""+S.x.toFixed(2)+", "+S.y.toFixed(2);return(S.offsetX||S.offsetY)&&(B+=" offset: "+S.offsetX.toFixed(2)+", "+S.offsetY.toFixed(2)),{host:V,anchor:S,tipText:B}}},Ym.prototype._guidingToEdit=function(Q,f){var n,b,k=this;if(n=k.screenInfo.curve){b=n._curves;var F,J,S,T,q,Y,B,W,t=1/0,m=1/0,N=[];for(k.editing&&"realPoint"===k.editing.type&&(W=k.editing.point),q=0,Y=2*b.length;Y>q;q++)B=b[Math.floor(q/2)][q%2?"_p4":"_p1"],N.indexOf(B)>=0||(N.push(B),W&&W===B||(S=B.x-Q.x,T=B.y-Q.y,Math.abs(S)<Math.abs(t)?(t=S,F=[B]):S===t&&F.push(B),Math.abs(T)<Math.abs(m)?(m=T,J=[B]):T===m&&J.push(B)));var x=k._interactor.getStyle("smartGuideSensitivity");if((Math.abs(t)>x||"y"===f)&&(F=null),(Math.abs(m)>x||"x"===f)&&(J=null),F||J){var p=!1,l={};if(F&&(p=!0,l.xList=F,l.x=t),J&&(p=!0,l.yList=J,l.y=m),p)return l}}},Ym.prototype._46O=function(i){var o=this;o.editing&&(o.editing=null,o._interactor.fi({kind:"endEditPoint",event:i})),o._guideInfo=null,o._edgeHostGuideInfo=null,o._pan&&(o._pan=null,o._interactor.fi({kind:"endPan",event:i})),o.tipInfo=null},Ym.prototype._canDeletePoint=function(E,N){var c=this.target;if(!(c instanceof o.Edge))return!0;var V=E._curves[0],g=E._curves[E._curves.length-1];return V._p1===N||g._p4===N?!1:!0},Ym.prototype.handleDelete=function(){var a=this;if(a.activing&&a.screenInfo){var p=o.Default.isShiftDown(),f=a.screenInfo.curve;a._canDeletePoint(f,a.activing.point)&&f.deleteRealPoint(a.activing.point,p),a.activing.selections&&a.activing.selections.forEach(function(b){a._canDeletePoint(f,b)&&f.deleteRealPoint(b,p)}),a.activing=null,delete a.editing,delete a.tipInfo,delete a._pan,a._writeToHt(),a._interactor.fp("deleteShapePoint",!1,!0)}},Ym.prototype.handleDoubleClick=function(O){var I=this,d=I._interactor._getLogicalPoint(O);if(I.screenInfo&&I._checkEditRealPoint(d)){var h=I.getCurrentSelectintStatus(),i=qd.Curve.PointType;return h=h===i.Mirrored?i.Straight:i.Mirrored,I._setCurrentSelectionStatus(h),I._interactor._42(),!0}},Ym.prototype._drawHighlight=function(C){var B=this,z=B.highlight;if(z){var O=z.bezier,d=B._interactor;O&&qd.Icons.DrawIcon(d,C,qd.Icons.ShapeHighlightCurve,[O._p1.x,O._p1.y,O._p2.x,O._p2.y,O._p3.x,O._p3.y,O._p4.x,O._p4.y]);var o=z.point;
o&&"insertKnot"===z.type&&qd.Icons.DrawIcon(d,C,qd.Icons.ShapeHighlighPoint,o)}},Ym.prototype._drawGuide=function(b){var N=this,F=N._guideInfo;if(F){var v,G,y,m,x=F.v;for(v=0;2>v;v++)if(m=0===v?F.xList:F.yList)for(G=0,y=m.length;y>G;G++)qd.Icons.DrawIcon(N._interactor,b,qd.Icons.ShapeGuideLine,[x.x,x.y,m[G].x,m[G].y])}},Ym.prototype._drawCurrentPoint=function(E){var M=this;if(M.activing){var p=M.activing,v=M.getCurrentSelectintStatus(),w=M._interactor;if(v!==qd.Curve.PointType.Straight){var $=p.pairs;p.hlpair,p.hltype;var x=p.selections,N=p.editingCtrl;if($&&!x){var n,W,Q;for(W=0,Q=$.length;Q>W;W++)n=$[W],N&&W===N.pairId&&n[N.type]?qd.Icons.DrawIcon(w,E,qd.Icons.ShapeActivingCtrl,{point:n.point,c1:n.c1,c2:n.c2,hl:N.type}):qd.Icons.DrawIcon(w,E,qd.Icons.ShapeActivingCtrl,n)}}qd.Icons.DrawIcon(w,E,qd.Icons.ShapeHighlighRealPoint,M.activing.point),x&&x.forEach(function(p){qd.Icons.DrawIcon(w,E,qd.Icons.ShapeHighlighRealPoint,p)})}},Ym.prototype.clear=function(){var B=this;B.editing=null,B._guideInfo=null,B.activing=null,B.highlight=null},Ym.prototype._42=function(e){var R=this;R.info={},R.editing||(R.screenInfo=null);var v=R._interactor;if(!v.editDetail)return R.clear(),void 0;var d=v.gv;if(!R.target||!d.isSelected(R.target)||!d.isVisible(R.target))return v.editDetail=!1,R.clear(),void 0;if(R.gatherSingleTarget(d,R.target),qd.Icons.DrawIcon(v,e,qd.Icons.ShapeBgCurve,R.screenInfo),R._drawHighlight(e),R._drawCurrentPoint(e),R._getRealPoint().forEach(function(R){qd.Icons.DrawIcon(v,e,qd.Icons.ShapePoint,R)}),R._drawGuide(e),R.tipInfo&&qd.Icons.DrawIcon(v,e,qd.Icons.TipHelper,R.tipInfo),R._edgeHostGuideInfo){qd.Icons.DrawIcon(v,e,qd.Icons.NodeHoverGuide,R._edgeHostGuideInfo.corners);var P=R._edgeHostGuideInfo.host;if(P){var Y=d.getAttachPoints(P);if(Y&&Y.length)for(var L=0,y=Y.length;y>L;L++){var $=Y[L],J=P.getAttachPosition($.x,$.y,$.offsetX,$.offsetY);J=qd.toScreenPosition(d,J),J.isAttach=R._edgeHostGuideInfo.attach===L,qd.Icons.DrawIcon(v,e,qd.Icons.AttachPoint,J)}}}if(R._interactor.getStyle("curveElevationVisible")&&R.target instanceof o.Polyline&&R.activing){var W=R.activing.getCurrentEditingPoint();W&&qd.Icons.DrawIcon(v,e,qd.Icons.EdgeElevationGuide,W)}},Ym.prototype._getRealPoint=function(){var H,D=this.screenInfo,j=D.P,m=D.S,f=-1,n=[],p=-1,P=m.length;return m.each(function(h){p++;var d=1;if(3===h)d=2;else if(4===h)d=3;else if(5===h)return;f+=d,H=p+1>=P?!0:1===m.get(p+1)?!0:!1,n.push({point:{x:j[2*f],y:j[2*f+1]},segmentIndex:p,pointIndex:f,isEnd:H})}),n},Ym.prototype.getEditingPointsInfo=function(y){var x=this,A=x.activing;if(!A)return!1;var N=A.point;if(!N)return!1;var t=this._getRealPoint(),w=[{screen:N}];A.selections&&A.selections.forEach(function(z){w.push({screen:z})});var C,u,f=t.length;return w.forEach(function(G){for(C=0;f>C;C++)if(u=t[C],G.screen.isNearEnough(u.point)){G.segmentIndex=u.segmentIndex,G.pointIndex=u.pointIndex,G.point=x.target.getPoints().get(u.pointIndex);break}}),y&&w.sort(function(q,h){return q.segmentIndex-h.segmentIndex}),w};var Jg=qd.MoveHelper=function(v){var E=this;E.catalog="Move",E._interactor=v};Jg.prototype={},Jg.prototype.constructor=Jg,Jg.prototype.calcShift=function(V,q,n){var O,Q,D=this,I=D._interactor.gv,j=I.lp(q);if("beginMove"===V&&D._gatherGridInfo(n._lastLogicalPoint||j),O=D._target){var N=O.downPosition;if(N){var m=D._interactor.getStyle("moveSensitivity")/I._zoom;if(N.distanceTo(j)<m)return{x:0,y:0};delete O.downPosition}var u;Q=o.Default.isShiftDown(q),Q&&(j=D._dealShiftDown(j),u=O.shiftGuide.dir);var $,l=O.rawPos={x:O.pos.x+j.x-O.lp.x,y:O.pos.y+j.y-O.lp.y};if(o.Default.isCtrlDown(q)){if($=D._calcShiftByAddon(),D._target.node instanceof qd.Group){var H=D._target.node;H._position.x+=$.x,H._position.y+=$.y}return $}for(var v,U=O.x+l.x,p=O.y+l.y,T={x:U,y:p},L={x:U+O.w/2,y:p+O.h/2},d={x:U+O.w,y:p+O.h},K=D._interactor.rectGuide,e=D._interactor.gridGuide,P=[K.findClosest(T,u),K.findClosest(L,u),K.findClosest(d,u),e.findClosest(T,u),e.findClosest(L,u),e.findClosest(d,u)],h=1/0,C=1/0,G=0,y=P.length;y>G;G++)v=P[G],v&&(U=v.x,p=v.y,isFinite(U)&&Math.abs(U)<Math.abs(h)&&(h=U),isFinite(p)&&Math.abs(p)<Math.abs(C)&&(C=p));if(isFinite(h)||(h=0),isFinite(C)||(C=0),$=D._calcShiftByAddon(h,C),D._target.node instanceof qd.Group){var H=D._target.node;H._position.x+=$.x,H._position.y+=$.y}var B=O.node;if(!Ml(B,I)){var F=l.x+h,Y=l.y+C;D._interactor.rectGuide.gatherLines({node:B,x:O.x+F,y:O.y+Y,w:O.w,h:O.h},u)}return $}},Jg.prototype._calcShiftByAddon=function(B,W){var m=this._target,C=m.rawPos,G=m.node.getPosition();return B=B||0,W=W||0,{x:C.x-G.x+B,y:C.y-G.y+W}},Jg.prototype._dealShiftDown=function(Y){var k=this,O=k._target.shiftGuide,G=k._target.lp,e=Math.abs(Y.x-G.x),s=Math.abs(Y.y-G.y);e>s&&e>O.limit&&"y"===O.dir&&(O.dir="x"),s>e&&s>O.limit&&"x"===O.dir&&(O.dir="y");var y=O.dir;return"x"===y?(Y.y=G.y,O.limit=Math.max(O.limit,e)):"y"===y&&(Y.x=G.x,O.limit=Math.max(O.limit,s)),Y},Jg.prototype._gatherGridInfo=function(A){var P,i=this,j=i._interactor,o=j._getValidSelection();if(o.length){if(1===o.length){if(P=o[0],!P.getRect)return i._target=null,void 0}else if(P=qd.Group.findOrCreateGroup(o),!P)return i._target=null,void 0}else{var o=j.gv.sm().getSelection();if(o.length&&(P=o.get(0),!P.getRect))return i._target=null,void 0}var n=P.getPosition(),V=P.getRect();i._target={node:P,x:V.x-n.x,y:V.y-n.y,w:V.width,h:V.height,lp:{x:A.x,y:A.y},pos:{x:n.x,y:n.y},shiftGuide:{dir:"x",limit:0},downPosition:new qd.Math.Vector2(A)},j.rectGuide.gatherRects()},Jg.prototype.clear=function(){var O=this;O._interactor.rectGuide.clear(),O._interactor._42()};var oj="directional",Ak="point",qi="spot",Eg="light.color",Nh=function(J,k){Do(k)&&wo.test(k)?Lc(J,k):Bf(k)&&k.modelType?Jm(J,k):Te[J]=k},yj=function(V){if(Bf(V))return V.modelType?V.uuid?Te[V.uuid]:(V.uuid=o.Math.generateUUID(),Jm(V.uuid,V),g):V;var F=Te[V];return V&&F===g&&wo.test(V)&&(zl&&zl[V]||Lc(V,V)),F};Pk(u,{graph3dViewAttributes:U,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:D/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Nc,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:D/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:Nh,getShape3dModel:yj,createMatrix:function(l,D){zc(l)||(l=[l]);for(var G=l.length-1;G>=0;G--){var K=l[G];D=tk(K.mat,K.s3,K.r3,K.rotationMode,K.t3,D)}return D},transformVec:function(F,w){return jf(F,w)},createBoxModel:function(){return{vs:dh,ns:Uc,uv:ar,is:vr}},createRoundRectModel:function(y,_){return cj.roundRect(y,_)},createStarModel:function(w,m){return cj.star(w,m)},createRectModel:function(F,Y){return cj.rect(F,Y)},createTriangleModel:function(n,k){return cj.triangle(n,k)},createRightTriangleModel:function(y,R){return cj.rightTriangle(y,R)},createParallelogramModel:function(P,T){return cj.parallelogram(P,T)},createTrapezoidModel:function(m,J){return cj.trapezoid(m,J)},createSmoothSphereModel:function(Z,C,Y,E,G,O,b){return Vi(new uo(Z,C,Y,E,G,O,b))},createSphereModel:function(E,Z,f,S,p,F){return E?fm(E,Z,f,S,p,F):u.createSmoothSphereModel()},createSmoothConeModel:function(N,x,d,P,o){return Wc(N,x,d,P,o)},createConeModel:function(B,H,i,e,G,r){return B?Vl(B,H,i,e,G,r):Wc(r)},createSmoothCylinderModel:function(A,R,j,W,H,S,v,c){return Vi(new Dp(A,R,j,W,H,S,v,c))},createCylinderModel:function(g,Z,x,f,y,t,b){return g?Eo(g,Z,x,f,y,t,b):Ql(t,b)},createSmoothTorusModel:function(O,f,B,y,e,X){return Vi(new ae(O,f,B,y,e,X))},createTorusModel:function(a,x,r,i,L,J,E){return a?ue(a,x,r,i,L,J,E):Yn(J,E)},createExtrusionModel:function(S,a,r,e,v,b,X,l){return ng(S,a,r,e,v,b,X,l)},createSmoothRingModel:function(O,T,N,G,b,w){for(var y=[],i=0;i<O.length-1;i+=2)y.push({x:O[i],y:O[i+1]});for(O=Wl(y,T,N)[0],y=[],i=0;i<O.length;i++){var C=O[i];y.push(new fq(C.x,0,C.y))}return Vi(new lo(y,w,G,b))},createTextGeometry:function(Y,k){return Vi(new Ye(Y,k))},loadFontFace:function($,t){u.xhrLoad($,function(i){if(!i)return t();var D;try{D=JSON.parse(i)}catch(L){D=JSON.parse(i.substring(65,i.length-2))}Wk.loadFace(D),t&&t(D.familyName.toLowerCase())},t?null:{sync:!0})},createRingModel:function(m,F,w,I,s,T,v,X,J,k){for(var j=[],S=0;S<m.length-1;S+=2)j.push({x:m[S],y:m[S+1]});T=T||u.shapeSide,v=v||0,X=X||T;var D,H,o,c,n,N,P,d,L,t,S,h,Y,Z,z,K,A,O,l=[],e=[],$=J?[]:U,f=J?[]:U,V=k?[]:U,r=k?[]:U,E=I?[]:U,W=I?[]:U,y=s?[]:U,p=s?[]:U,m=Wl(j,F,w),C=Lm(m),Q=0,q=2*Math.PI/T;return m.forEach(function(i){if(o=i.length,o>1){if(c=i[0],I)for(N=c.x,d=c.y,S=v;X>S;S++)h=S+1,Y=S*q,Z=h*q,z=R(Y),K=G(Y),A=R(Z),O=G(Z),E.push(z*N,d,-K*N,A*N,d,-O*N,0,d,0),W.push(.5-.5*z,.5-.5*K,.5-.5*A,.5-.5*O,.5,.5);for(t=0;o>t;t++){for(n=i[t],N=c.x,P=n.x,d=c.y,L=n.y,D=Q/C,Q+=Pq(c,n),H=Q/C,S=v;X>S;S++)h=S+1,Y=S*q,Z=h*q,z=R(Y),K=G(Y),A=R(Z),O=G(Z),l.push(z*P,L,-K*P,A*P,L,-O*P,z*N,d,-K*N,A*P,L,-O*P,A*N,d,-O*N,z*N,d,-K*N),e.push(S/T,H,h/T,H,S/T,D,h/T,H,h/T,D,S/T,D),J&&S===v&&($.push(0,d,0,0,L,0,z*P,L,-K*P,z*P,L,-K*P,z*N,d,-K*N,0,d,0),f.push(0,.5-d,0,.5-L,2*P,.5-L,2*P,.5-L,2*N,.5-d,0,.5-d)),k&&h===X&&(V.push(0,d,0,A*P,L,-O*P,0,L,0,A*P,L,-O*P,0,d,0,A*N,d,-O*N),r.push(1,.5-d,1-2*P,.5-L,1,.5-L,1-2*P,.5-L,1,.5-d,1-2*N,.5-d));c=n}if(s)for(N=c.x,d=c.y,S=v;X>S;S++)h=S+1,Y=S*q,Z=h*q,z=R(Y),K=G(Y),A=R(Z),O=G(Z),y.push(A*N,d,-O*N,z*N,d,-K*N,0,d,0),p.push(.5-.5*A,.5+.5*O,.5-.5*z,.5+.5*K,.5,.5)}}),{vs:l,uv:e,bottom_vs:y,bottom_uv:p,top_vs:E,top_uv:W,from_vs:$,from_uv:f,to_vs:V,to_uv:r}}},!0),Pk(V,{"3d.move.mode":g,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":g,"edge.gradient.color":g,"edge.source.t3":g,"edge.target.t3":g,"light.type":Ak,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":D/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":Ke,"wf.short":!1,"wf.mat":g,"wf.geometry":!1,batch:g,"transparent.mask":!1,brightness:g,"select.brightness":.7,"repeat.uv.length":g,alphaTest:.4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":nd,"label.t3":g,"label.r3":g,"label.texture.scale":2,"label.rotationMode":_r,"label.light":!1,"label.blend":g,"label.reverse.flip":!1,"label.reverse.color":Ug,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":nd,"label2.t3":g,"label2.r3":g,"label2.texture.scale":2,"label2.rotationMode":_r,"label2.light":!1,"label2.blend":g,"label2.reverse.flip":!1,"label2.reverse.color":Ug,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":nd,"note.t3":g,"note.r3":g,"note.texture.scale":2,"note.rotationMode":_r,"note.light":!1,"note.blend":g,"note.reverse.flip":!1,"note.reverse.color":Ug,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":nd,"note2.t3":g,"note2.r3":g,"note2.texture.scale":2,"note2.rotationMode":_r,"note2.light":!1,"note2.blend":g,"note2.reverse.flip":!1,"note2.reverse.color":Ug,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:g,"shape3d.color":fe,"shape3d.top.color":g,"shape3d.bottom.color":g,"shape3d.from.color":g,"shape3d.to.color":g,"shape3d.image":g,"shape3d.top.image":g,"shape3d.bottom.image":g,"shape3d.from.image":g,"shape3d.to.image":g,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":g,"shape3d.side.to":g,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":g,"shape3d.opacity":g,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Ug,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":g,"shape3d.uv.scale":g,"shape3d.top.uv.offset":g,"shape3d.top.uv.scale":g,"shape3d.bottom.uv.offset":g,"shape3d.bottom.uv.scale":g,"shape3d.from.uv.offset":g,"shape3d.from.uv.scale":g,"shape3d.to.uv.offset":g,"shape3d.to.uv.scale":g,"shape3d.top.cap":g,"shape3d.bottom.cap":g,"shape3d.start.angle":0,"shape3d.sweep.angle":E,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":g,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":fe,"all.image":g,"all.blend":g,"all.opacity":g,"all.reverse.flip":!1,"all.reverse.color":Ug,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":g,"all.uv.offset":g,"all.uv.scale":g,"all.discard.selectable":!0,mat:g,"left.mat":g,"right.mat":g,"top.mat":g,"bottom.mat":g,"front.mat":g,"back.mat":g},!0);var Re,kn=!1,Xf=[0,0,0,0],Dr={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Qg,2:Td,3:Ij,4:Lb,5:nd,6:Rd}},_g=function(s,i,W,S){if(i.getFaceVisible(s,W)){zr(i,Nn(s,i.getFaceMat(s,W)||i.getMat(s)));var t=i._26I;i.getFaceReverseCull(s,W)?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),bj(t,i._prg.uFixPickReverseColor,Dr[W]),Nr(t),bd(t,S,6),zj(t),Gn(i)}},mp=function(q){return q instanceof cr},zm=function(H){return[H.x,H.e||0,H.y]},Br=function(J,R,c){for(var R=Tk(R),s=R[0],r=R[1],V=R[2];c--;)J.push(s,r,V)},db=function(v,N,w){for(var N=Tk(N),u=N[0],a=N[1],T=N[2],W=N[3];w--;)v.push(u,a,T,W)},ml=function(o,Y,y){if(Y)for(var j,e,n,c=Y[0],d=Y[1],V=Y[2],I=Y[4],W=Y[5],U=Y[6],p=Y[8],u=Y[9],g=Y[10],F=Y[12],C=Y[13],A=Y[14],K=y.length,b=0,b=0;K>b;b+=3)j=y[b],e=y[b+1],n=y[b+2],o.push(c*j+I*e+p*n+F,d*j+W*e+u*n+C,V*j+U*e+g*n+A);else Je(o,y)},vd=function(C,r){var Q=r.s("light.intensity"),j=Tk(r.s(Eg)),f=j[0],x=j[1],A=j[2];1!==Q&&(f*=Q,x*=Q,A*=Q),C.push(f,x,A,r.s("light.disabled")?1:0)},vh=function(E,x,Y){bj(x,Y.uHeadlightRange,E._headlightRange);var p=E._headlightIntensity,q=Tk(E._headlightColor);1!==p&&(q=[q[0]*p,q[1]*p,q[2]*p]),bj(x,Y.uHeadlightColor,[q[0],q[1],q[2],E._headlightDisabled?1:0]);var G=E._59O,s=E._spots,Q=E._dirs;if(G.length){var d=[],j=[],M=[];G.forEach(function(v){vd(d,v),Je(j,E._transformPointToViewSpace(v.p3())),M.push(v.s("light.range"))}),x.uniform4fv(Y.uPointColor,d),x.uniform1fv(Y.uPointRange,M),x.uniform3fv(Y.uPointPosition,j)}if(s.length){var w=[],u=[],y=[],f=[],P=[],U=[];s.forEach(function(t){vd(w,t),Je(u,E._transformPointToViewSpace(t.p3())),Je(P,E._transformDirectionToViewSpace(t.p3(),t.s("light.center"))),y.push(t.s("light.range")),f.push(R(t.s("light.angle")/2)),U.push(t.s("light.exponent"))}),x.uniform4fv(Y.uSpotColor,w),x.uniform1fv(Y.uSpotRange,y),x.uniform1fv(Y.uSpotAngle,f),x.uniform1fv(Y.uSpotExponent,U),x.uniform3fv(Y.uSpotPosition,u),x.uniform3fv(Y.uSpotDirection,P)}if(Q.length){var T=[],J=[];Q.forEach(function(L){vd(T,L),Je(J,E._transformDirectionToViewSpace(L.p3()))}),x.uniform4fv(Y.uDirColor,T),x.uniform3fv(Y.uDirDirection,J)}},Il=function(N){return N>0&&0===(N-1&N)},kb=function(m){return m=N(0,s(D,m)),m=N(vl,s(D-vl,m))},Ek=function(){return.05+J()/2},pn=function(p,m,O,H){var X,A=p.getEye();return p.isOrtho()?(X=pd(p.getCenter(),A),X[0]+=H[0],X[1]+=H[1],X[2]+=H[2]):X=A,Xl(m,O,H,X)},Xl=function(u,y,H,G){var f=pe(u,y),F=pd(G,H,!0),R=pe(F,y);if(v(R)<vl)return U;var s=(f-pe(H,y))/R;return[H[0]+F[0]*s,H[1]+F[1]*s,H[2]+F[2]*s]},Dk=function(I,w){return{x:2*I.x-w.x,y:2*I.y-w.y}},Kc=function(g,Q,F,M){var D,H;if(!g)return D=i(Q.y-F.y,F.x-Q.x),{x:Q.x+M*G(D),y:Q.y+M*R(D)};if(!F)return D=i(g.y-Q.y,Q.x-g.x),{x:Q.x+M*G(D),y:Q.y+M*R(D)};var $=pd([g.x,g.y,0],[Q.x,Q.y,0],!0),Z=pd([F.x,F.y,0],[Q.x,Q.y,0],!0),S=-($[0]+Z[0])/2,s=-($[1]+Z[1])/2,C=P(S*S+s*s);if(vl>C)return D=i(g.y-Q.y,Q.x-g.x),{x:Q.x+M*G(D),y:Q.y+M*R(D)};var L=g.x-Q.x,W=g.y-Q.y,q=F.x-Q.x,o=F.y-Q.y,a=P(L*L+W*W),w=P(q*q+o*o);D=r(pe($,Z))/2,H=$[1]*Z[0]-$[0]*Z[1]>0?-1:1,S/=C,s/=C;var f=M/G(D),d=N(a,w)/R(D);C=Math.min(f,d);var v={x:Q.x+H*C*S,y:Q.y+H*C*s};return F.b&&f>w/R(D)&&(v.adjust=!0),v},Pd=function(B){var x=B[1],s=B[2],T=B[3],z=B[6],b=B[7],d=B[11];B[1]=B[4],B[2]=B[8],B[3]=B[12],B[4]=x,B[6]=B[9],B[7]=B[13],B[8]=s,B[9]=z,B[11]=B[14],B[12]=T,B[13]=b,B[14]=d},ig=function(D){var k=D[0],x=D[1],c=D[2],W=D[3],L=D[4],u=D[5],$=D[6],w=D[7],C=D[8],h=D[9],I=D[10],B=D[11],E=D[12],Z=D[13],G=D[14],g=D[15],m=k*u-x*L,b=k*$-c*L,F=k*w-W*L,r=x*$-c*u,n=x*w-W*u,R=c*w-W*$,q=C*Z-h*E,e=C*G-I*E,v=C*g-B*E,M=h*G-I*Z,K=h*g-B*Z,z=I*g-B*G,i=m*z-b*K+F*M+r*v-n*e+R*q;return i?(i=1/i,D[0]=(u*z-$*K+w*M)*i,D[1]=(c*K-x*z-W*M)*i,D[2]=(Z*R-G*n+g*r)*i,D[3]=(I*n-h*R-B*r)*i,D[4]=($*v-L*z-w*e)*i,D[5]=(k*z-c*v+W*e)*i,D[6]=(G*F-E*R-g*b)*i,D[7]=(C*R-I*F+B*b)*i,D[8]=(L*K-u*v+w*q)*i,D[9]=(x*v-k*K-W*q)*i,D[10]=(E*n-Z*F+g*m)*i,D[11]=(h*F-C*n-B*m)*i,D[12]=(u*e-L*M-$*q)*i,D[13]=(k*M-x*e+c*q)*i,D[14]=(Z*b-E*r-G*m)*i,D[15]=(C*r-h*b+I*m)*i,void 0):U},hk=function(W,z){if(z){var U=z[0],r=z[1],J=z[2];W[12]=W[0]*U+W[4]*r+W[8]*J+W[12],W[13]=W[1]*U+W[5]*r+W[9]*J+W[13],W[14]=W[2]*U+W[6]*r+W[10]*J+W[14],W[15]=W[3]*U+W[7]*r+W[11]*J+W[15]}},si=function(e,o){if(o){var K=o[0],M=o[1],m=o[2];e[0]=e[0]*K,e[1]=e[1]*K,e[2]=e[2]*K,e[3]=e[3]*K,e[4]=e[4]*M,e[5]=e[5]*M,e[6]=e[6]*M,e[7]=e[7]*M,e[8]=e[8]*m,e[9]=e[9]*m,e[10]=e[10]*m,e[11]=e[11]*m}},Wq=function(I,l,Z){var a=l[0],q=l[1],Q=l[2],X=l[3],K=l[4],P=l[5],t=l[6],O=l[7],F=l[8],i=l[9],$=l[10],g=l[11],k=l[12],x=l[13],s=l[14],d=l[15],V=Z[0],v=Z[1],o=Z[2],u=Z[3];return I[0]=V*a+v*K+o*F+u*k,I[1]=V*q+v*P+o*i+u*x,I[2]=V*Q+v*t+o*$+u*s,I[3]=V*X+v*O+o*g+u*d,V=Z[4],v=Z[5],o=Z[6],u=Z[7],I[4]=V*a+v*K+o*F+u*k,I[5]=V*q+v*P+o*i+u*x,I[6]=V*Q+v*t+o*$+u*s,I[7]=V*X+v*O+o*g+u*d,V=Z[8],v=Z[9],o=Z[10],u=Z[11],I[8]=V*a+v*K+o*F+u*k,I[9]=V*q+v*P+o*i+u*x,I[10]=V*Q+v*t+o*$+u*s,I[11]=V*X+v*O+o*g+u*d,V=Z[12],v=Z[13],o=Z[14],u=Z[15],I[12]=V*a+v*K+o*F+u*k,I[13]=V*q+v*P+o*i+u*x,I[14]=V*Q+v*t+o*$+u*s,I[15]=V*X+v*O+o*g+u*d,I},cf=function(f,y,$,p){var G,Q,x,q,C,W,k,m,s,O,Z=y[0],j=y[1],l=y[2],r=p[0],V=p[1],b=p[2],I=$[0],g=$[1],R=$[2];return v(Z-I)<vl&&v(j-g)<vl&&v(l-R)<vl?cs(f):(k=Z-I,m=j-g,s=l-R,O=1/P(k*k+m*m+s*s),k*=O,m*=O,s*=O,G=V*s-b*m,Q=b*k-r*s,x=r*m-V*k,O=P(G*G+Q*Q+x*x),O?(O=1/O,G*=O,Q*=O,x*=O):(G=0,Q=0,x=0),q=m*x-s*Q,C=s*G-k*x,W=k*Q-m*G,O=P(q*q+C*C+W*W),O?(O=1/O,q*=O,C*=O,W*=O):(q=0,C=0,W=0),f[0]=G,f[1]=q,f[2]=k,f[3]=0,f[4]=Q,f[5]=C,f[6]=m,f[7]=0,f[8]=x,f[9]=W,f[10]=s,f[11]=0,f[12]=-(G*Z+Q*j+x*l),f[13]=-(q*Z+C*j+W*l),f[14]=-(k*Z+m*j+s*l),f[15]=1,f)},Ff=function(T,B,s,R,F){var t=1/w(B/2),i=1/(R-F);return T[0]=t/s,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=t,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=(F+R)*i,T[11]=-1,T[12]=0,T[13]=0,T[14]=2*F*R*i,T[15]=0,T},wc=function(G,R,D,t,Q,z,u){var h=1/(R-D),J=1/(t-Q),p=1/(z-u);return G[0]=-2*h,G[1]=0,G[2]=0,G[3]=0,G[4]=0,G[5]=-2*J,G[6]=0,G[7]=0,G[8]=0,G[9]=0,G[10]=2*p,G[11]=0,G[12]=(R+D)*h,G[13]=(Q+t)*J,G[14]=(u+z)*p,G[15]=1,G},Ue=function(l,n){var Q=n[0],L=n[1],Z=n[2],p=n[3],t=Q*Q+L*L+Z*Z+p*p,M=t?1/t:0;return l[0]=-Q*M,l[1]=-L*M,l[2]=-Z*M,l[3]=p*M,l},_m=function(h,b){var z=b[0]+b[5]+b[10],x=0;return z>0?(x=2*Math.sqrt(z+1),h[3]=.25*x,h[0]=(b[6]-b[9])/x,h[1]=(b[8]-b[2])/x,h[2]=(b[1]-b[4])/x):b[0]>b[5]&b[0]>b[10]?(x=2*Math.sqrt(1+b[0]-b[5]-b[10]),h[3]=(b[6]-b[9])/x,h[0]=.25*x,h[1]=(b[1]+b[4])/x,h[2]=(b[8]+b[2])/x):b[5]>b[10]?(x=2*Math.sqrt(1+b[5]-b[0]-b[10]),h[3]=(b[8]-b[2])/x,h[0]=(b[1]+b[4])/x,h[1]=.25*x,h[2]=(b[6]+b[9])/x):(x=2*Math.sqrt(1+b[10]-b[0]-b[5]),h[3]=(b[1]-b[4])/x,h[0]=(b[8]+b[2])/x,h[1]=(b[6]+b[9])/x,h[2]=.25*x),h},lj=function(f,y,G){var r=y[0],t=y[1],S=y[2],p=y[3],h=r+r,b=t+t,O=S+S,M=r*h,w=r*b,u=r*O,H=t*b,K=t*O,N=S*O,F=p*h,J=p*b,d=p*O;return f[0]=1-(H+N),f[1]=w+d,f[2]=u-J,f[3]=0,f[4]=w-d,f[5]=1-(M+N),f[6]=K+F,f[7]=0,f[8]=u+J,f[9]=K-F,f[10]=1-(M+H),f[11]=0,f[12]=G[0],f[13]=G[1],f[14]=G[2],f[15]=1,f},qk=function(){var x=[0,0,0],f=[0,0,0],_=[0,0,0],E=function(J,C,O){J[0]=C[1]*O[2]-C[2]*O[1],J[1]=C[2]*O[0]-C[0]*O[2],J[2]=C[0]*O[1]-C[1]*O[0]},r=function(s){return s[0]*s[0]+s[1]*s[1]+s[2]*s[2]},k=function(t){var H=Math.sqrt(r(t));t[0]/=H,t[1]/=H,t[2]/=H},F=function($,E,M){$[0]=E[0]-M[0],$[1]=E[1]-M[1],$[2]=E[2]-M[2]};return function(c,t,Q){var L=vk();return F(_,c,t),0===r(_)&&(_[2]=1),k(_),E(x,Q,_),0===r(x)&&(1===Math.abs(Q[2])?_[0]+=1e-4:_[2]+=1e-4,k(_),E(x,Q,_)),k(x),E(f,_,x),L[0]=x[0],L[4]=f[0],L[8]=_[0],L[1]=x[1],L[5]=f[1],L[9]=_[1],L[2]=x[2],L[6]=f[2],L[10]=_[2],L}}(),wh=function(u,A){if(u.vr.enable){var E=u.vr.getViewMatrix(A);if(E)return E}return cf(A?A:vk(),u._eye,u._center,u._up)},ai=function(M){if(M.vr.enable){var F=M.vr.getProjectMatrix();if(F)return F}var z=M.getAspect(),S=M._near,H=M._far,D=vk();if(M._ortho){var V=M._orthoWidth/2,k=V/z;wc(D,-V,V,-k,k,S,H)}else Ff(D,M._fovy,z,S,H);return D},_p=function(V,B){if(!V)return U;var W=0,T=1,$=2,g=[],D=0,i=V.length,y=i/3;if(B){for(;i>D;D++)g[D]=0;for(D=0;D<B.length;D+=3){var n=[],b=[],E=[];n[W]=V[3*B[D+1]+W]-V[3*B[D]+W],n[T]=V[3*B[D+1]+T]-V[3*B[D]+T],n[$]=V[3*B[D+1]+$]-V[3*B[D]+$],b[W]=V[3*B[D+2]+W]-V[3*B[D+1]+W],b[T]=V[3*B[D+2]+T]-V[3*B[D+1]+T],b[$]=V[3*B[D+2]+$]-V[3*B[D+1]+$],E[W]=n[T]*b[$]-n[$]*b[T],E[T]=n[$]*b[W]-n[W]*b[$],E[$]=n[W]*b[T]-n[T]*b[W];for(var l=0;3>l;l++)g[3*B[D+l]+W]+=E[W],g[3*B[D+l]+T]+=E[T],g[3*B[D+l]+$]+=E[$]}}else for(D=0;y>D;D+=3){var n=[],b=[],E=[];n[W]=V[3*(D+1)+W]-V[3*D+W],n[T]=V[3*(D+1)+T]-V[3*D+T],n[$]=V[3*(D+1)+$]-V[3*D+$],b[W]=V[3*(D+2)+W]-V[3*(D+1)+W],b[T]=V[3*(D+2)+T]-V[3*(D+1)+T],b[$]=V[3*(D+2)+$]-V[3*(D+1)+$],E[W]=n[T]*b[$]-n[$]*b[T],E[T]=n[$]*b[W]-n[W]*b[$],E[$]=n[W]*b[T]-n[T]*b[W];for(var l=0;3>l;l++)g[3*(D+l)+W]=E[W],g[3*(D+l)+T]=E[T],g[3*(D+l)+$]=E[$]}for(D=0;i>D;D+=3){var k=[];k[W]=g[D+W],k[T]=g[D+T],k[$]=g[D+$];var Z=P(k[W]*k[W]+k[T]*k[T]+k[$]*k[$]);0===Z&&(Z=vl),k[W]=k[W]/Z,k[T]=k[T]/Z,k[$]=k[$]/Z,g[D+W]=k[W],g[D+T]=k[T],g[D+$]=k[$]}return new Nm(g)},xi=function(q,j,X,d){if(X||(X=q.createTexture()),j){var N=q.TEXTURE_2D,i=q.REPEAT,I=q.CLAMP_TO_EDGE,W=q.TEXTURE_MIN_FILTER;d!==q.NEAREST&&(d=q.LINEAR),Pc(q,X),q.texImage2D(N,0,q.RGBA,q.RGBA,q.UNSIGNED_BYTE,j),ne(q,q.TEXTURE_MAG_FILTER,d);var Z=j.naturalWidth||j.width,e=j.naturalHeight||j.height;Il(Z)&&Il(e)&&!j.clampToEdge?(ne(q,q.TEXTURE_WRAP_S,i),ne(q,q.TEXTURE_WRAP_T,i),ne(q,W,q.LINEAR_MIPMAP_LINEAR),q.generateMipmap(N)):(ne(q,q.TEXTURE_WRAP_S,I),ne(q,q.TEXTURE_WRAP_T,I),ne(q,W,d)),Pc(q,U)}return X},Om=function(I,$){var o=new Uint8Array(4);return $=$||I.createTexture(),Pc(I,$),ne(I,I.TEXTURE_MIN_FILTER,I.LINEAR),I.texImage2D(I.TEXTURE_2D,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,o),$},Rq=function(x){x._26I&&x._prg&&(x._26I.deleteProgram(x._prg),x._prg=U)},Lf=function(z,M,B,V){var N=z.createShader(B);return z.shaderSource(N,V),z.compileShader(N),z.attachShader(M,N),N},hh=function(G){return G.createBuffer()},Pc=function(V,x){V.bindTexture(V.TEXTURE_2D,x)},We=function(G,H){G.frameStack?G.frameStack.push(H):G.frameStack=[H],G.bindFramebuffer(G.FRAMEBUFFER,H)},wp=function(C){var $=C.frameStack;if($){if($.pop(),$.length)return C.bindFramebuffer(C.FRAMEBUFFER,$[$.length-1]),void 0;C.frameStack=null}C.bindFramebuffer(C.FRAMEBUFFER,null)},ne=function(l,f,m){l.texParameteri(l.TEXTURE_2D,f,m)},Bc=function($,n){$.enable($.POLYGON_OFFSET_FILL),$.polygonOffset(n[0],n[1])},Ad=function(i){i.disable(i.POLYGON_OFFSET_FILL)},wl=function(v,L){if(L){var L=Tk(L);v.clearColor(L[0],L[1],L[2],L[3])}},xg=function(m,S){bj(m,S.uFix,!0),Km(m,S.aNormal)},fl=function(B,e){bj(B,e.uFix,!1),Gb(B,e.aNormal)},Db=function(C,W,R,s,r,g,E,P){C._picking||(R?(bj(C,W.uBlend,!0),bj(C,W.uBlendColor,R)):bj(C,W.uBlend,!1),bj(C,W.uLight,s==U?!0:s),Rm(r)&&1!==r&&bj(C,W.uPartOpacity,r),bj(C,W.uReverseFlip,g==U?!1:g),bj(C,W.uFixPickReverseColor,E||Ug)),P?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE)},ze=function(U,k){U._picking||bj(U,k.uPartOpacity,1)},Nr=function(){var T=[0,0,1,1];return function(o,_,d,P,e,G,I,Q,t){return d?(bj(o,_.uTexture,!0),bj(o,_.uDiscardSelectable,br(P)?P:!0),Gb(o,_.aUv),Pl(o,e,G,_.aUv,2),t?(bj(o,_.uBlendTexture,!0),o.activeTexture(o.TEXTURE1),Pc(o,t),o.uniform1i(_.uBlendSampler,1)):(bj(o,_.uBlendTexture,!1),o.activeTexture(o.TEXTURE1),Pc(o,o._emptyBlendTexture)),o.activeTexture(o.TEXTURE0),Pc(o,d),o.uniform1i(_.uSampler,0),I?(T[0]=I[0],T[1]=I[1]):(T[0]=0,T[1]=0),Q?(T[2]=Q[0],T[3]=Q[1]):(T[2]=1,T[3]=1),bj(o,_.uOffsetScale,T),void 0):(o.activeTexture(o.TEXTURE0),Pc(o,o._emptyTexture),o.activeTexture(o.TEXTURE1),Pc(o,o._emptyBlendTexture),void 0)}}(),zj=function(f,V,e){f.activeTexture(f.TEXTURE0),Pc(f,U),f.activeTexture(f.TEXTURE1),Pc(f,U),e&&(Km(f,V.aUv),bj(f,V.uTexture,!1),bj(f,V.uBlendTexture,!1))},kr=function(p,d,i,z,f,S){!i||F||rb||p.lineWidth(i),z&&!p._picking&&bj(p,d.uFixPickReverseColor,z),f&&Pl(p,f,S,d.aPosition)},mh=function(p,x,t,d){Re&&(d=p[Re]),p.drawArrays(d==U?p.TRIANGLES:d,x,t);var n=p._renderInfo;n&&(n.calls++,n.vertices+=t,(d==U||d===p.TRIANGLES)&&(n.faces+=t/3),d===p.LINES&&(n.lines+=t/2))},bd=function(Y,j,D,x){Re&&(x=Y[Re]),Y.drawElements(x==U?Y.TRIANGLES:x,D,Y.UNSIGNED_SHORT,j==U?0:2*j);var S=Y._renderInfo;S&&(S.calls++,S.vertices+=D,(x==U||x===Y.TRIANGLES)&&(S.faces+=D/3),x===Y.LINES&&(S.lines+=D/2))},yp=function(K,N,Y,D,w){var E=K.ARRAY_BUFFER;K.bindBuffer(E,N),Y&&K.bufferData(E,Y,K.STATIC_DRAW),D!=U&&K.vertexAttribPointer(D,w?w:3,K.FLOAT,!1,0,0)},Pl=function(Z,f,I,L,T){return I?(gh(Z,Z.ARRAY_BUFFER,f,I),L!=U&&Z.vertexAttribPointer(L,T?T:3,Z.FLOAT,!1,0,0),void 0):yp(Z,f,I,L,T)},Qm=function(W,_,b){var q=W.ELEMENT_ARRAY_BUFFER;W.bindBuffer(q,_),b&&W.bufferData(q,b,W.STATIC_DRAW)},yl=function(z,N,O){gh(z,z.ELEMENT_ARRAY_BUFFER,N,O)},gh=function(R,q,O,A){var G=A._bufId;G||(G=A._bufId=o.Math.generateIncreasingID());var O,_=R._bufPool;(O=_[G])&&O._buf?R.bindBuffer(q,O._buf):(O=_[G]={_buf:hh(R)},R.bindBuffer(q,O._buf),R.bufferData(q,A,R.STATIC_DRAW)),O._fid=R._renderInfo.frame},bj=function(u,W,j){if(j!=U&&W!=U){j=Tk(j);var F=j.length;3===F?u.uniform3fv(W,j):4===F?u.uniform4fv(W,j):16===F?u.uniformMatrix4fv(W,!1,j):br(j)?u.uniform1i(W,j?1:0):2===F?u.uniform2fv(W,j):u.uniform1f(W,j)}},Gb=function(z,v){v!=U&&v>=0&&z.enableVertexAttribArray(v)},Km=function(d,M){M!=U&&M>=0&&d.disableVertexAttribArray(M)},Gn=function(A,f){var Y=A.getGL(),L=A._prg;A._7O=A._8O.pop(),f&&(bj(Y,L.uMVMatrix,A._7O),A._6O=f,bj(Y,L.uNMatrix,f))},yg=function(v,j){return j||(j=vk()),ek(j,v),ig(j),Pd(j),j},zr=function(h,K){var s=h.getGL(),u=h._prg,z=h._7O;K&&(h._8O.push(no(z)),bj(s,u.uMMatrix,K),Wq(z,z,K),h._7O=z),bj(s,u.uMVMatrix,z),bj(s,u.uNMatrix,yg(z,h._6O))},$p=function(h,w,V,S,H,F){if(V){if(S){var $=V.value++,K=2147483648|$,E=[(255&K>>16)/255,(255&K>>8)/255,(255&K)/255,(255&K>>24)/255];V[$]={data:H,part:F}}else E=Xf;return bj(h,w.uFixPickReverseColor,E),E}},Bs=function(){var k={center:function(j,U,k,J,X){var M=-U[1]/2,s={x:-U[0]/2,y:M,width:U[0],height:U[1]},m=wd(j,s,k);return[m.x+J,-m.y-X,Ek()]},front:function(J,g,Z,y,d){var A=-g[1]/2,O={x:-g[0]/2,y:A,width:g[0],height:g[1]},c=wd(J,O,Z);return[c.x+y,-c.y-d,g[2]/2+Ek()]},back:function(K,E,M,Y,m){var w=-E[0]/2,W=-E[1]/2,s={x:w,y:W,width:E[0],height:E[1]},t=wd(K,s,M);return[-t.x-Y,-t.y-m,-E[2]/2-Ek()]},left:function(P,s,u,k,j){var h=-s[1]/2,g={x:-s[2]/2,y:h,width:s[2],height:s[1]},$=wd(P,g,u);return[-s[0]/2-Ek(),-$.y-j,$.x+k]},right:function($,X,T,r,H){var A=-X[2]/2,O=-X[1]/2,q={x:A,y:O,width:X[2],height:X[1]},i=wd($,q,T);return[X[0]/2+Ek(),-i.y-H,-i.x-r]},top:function(e,D,M,f,T){var A={x:-D[0]/2,y:-D[2]/2,width:D[0],height:D[2]},b=wd(e,A,M);return[b.x+f,D[1]/2+Ek(),b.y+T]},bottom:function(I,j,o,V,z){var H=-j[2]/2,d={x:-j[0]/2,y:H,width:j[0],height:j[2]},Z=wd(I,d,o);return[Z.x+V,-j[1]/2-Ek(),-Z.y-z]}};return function(p,E,U,W,c,H){return k[W](p,E,U,c||0,H||0)}}(),Zp=function(b,U,Y,k,T,H,R,o,z,O){if(T&&(U[0]+=T[0],U[1]+=T[1],U[2]+=T[2]),hk(b,Y),o){var h=vk();if(xe(h,z,O),jf(U,h),hk(b,U),b.auto=o,b.pos=jf([0,0,0],b),H){var d=b.mat2=vk();xe(d,H,R)}}else xe(b,z,O),hk(b,U),k===Qg?Kj(b,-j):k===Td?Kj(b,j):k===Ij?Al(b,-j):k===Lb?Al(b,j):k===Rd&&Kj(b,D),xe(b,H,R);return b},xp=function(Y,B){var f=B.auto,i=B.mat2,F=Y.gv;if(f){var c,v=vk(),W=[0,0,0,0];c="string"==typeof f?[f.indexOf("x")<0?F._eye[0]:F._center[0],f.indexOf("y")<0?F._eye[1]:F._center[1],f.indexOf("z")<0?F._eye[2]:F._center[2]]:F._eye,_m(W,cf(vk(),c,F._center,F._up)),lj(v,Ue(W,W),B.pos),i&&Wq(v,v,i),zr(F,v)}else zr(F,B)},Rc=function(S,A,g,I,J){var d=S.s,U=S.gv,H=U.getGL(),a=U._prg,s=U._buffer,P=U._1O;xi(H,Tl,P),xp(S,g),Db(H,a,d(A+".blend"),d(A+".light"),d(A+".opacity"),d(A+".reverse.flip"),d(A+".reverse.color"),d(A+".reverse.cull")),Nr(H,a,P,J,s.uv,Qe),Pl(H,s.vs,I,a.aPosition),Pl(H,s.ns,Yi,a.aNormal),yl(H,s.is,pl),bd(H,0,pl.length),zj(H,a,P),ze(H,a),Gn(U)},wj=function(t,I,g){var u=t.gv,y=t.data,H=t[I]={blend:u.getBodyColor(y)||u.getFaceBlend(y,I),light:u.getFaceLight(y,I),color:u.getFaceColor(y,I),opacity:u.getFaceOpacity(y,I),transparent:u.getFaceTransparent(y,I),reverseFlip:u.getFaceReverseFlip(y,I),reverseColor:u.getFaceReverseColor(y,I),reverseCull:u.getFaceReverseCull(y,I),texture:u.getFaceImage(y,I),blendTexture:u.getFaceBlendImage(y,I),discardSelectable:u.getFaceDiscardSelectable(y,I)};if("csg"!==I){H.uv=u.getFaceUv(y,I)||g&&g[I+"Uv"],H.uvScale=u.getFaceUvScale(y,I)||g&&g[I+"UvScale"],H.uvOffset=u.getFaceUvOffset(y,I)||g&&g[I+"UvOffset"];var Q=u.getFaceMat(y,I);Q&&(H.mat=Nn(y,Q))}return H},qq=function(x,c,G,S,i){if(S){if(!i(S.transparent))return;var q=x.data,B=x.gv,g=B._buffer,R=B.getTexture(S.texture,q),l=B.getTexture(S.blendTexture,q);Nr(c,G,R,S.discardSelectable,g.uv,S.tuv,S.uvOffset,S.uvScale,l),Db(c,G,S.blend,S.light,S.opacity,S.reverseFlip,S.reverseColor,S.reverseCull),bj(c,G.uDiffuse,S.color||V["color.empty"]),Pl(c,g.vs,S.vs,G.aPosition),Pl(c,g.ns,S.ns,G.aNormal),mh(c,0,S.vs.length/3),ze(c,G),zj(c,G,R)}},Ah=function(n,M,a,E,O,c){var $,i,G,f,K,J,B,e,y,N,L,R=[E-M,O-a],o=n?n.length:0;for(G=0;o>G;G++){for(f=2,$=n[G],K=$[0],J=$[1];f+1<$.length;){if(B=$[f],e=$[f+1],i=eo(M,a,E,O,K,J,B,e,!0)){y=[B-K,e-J],N=Pq(y),y[0]/=N,y[1]/=N,N=pe(R,y),N=N>0?c:-c,L=[y[0]*N,y[1]*N];break}K=B,J=e,f+=2}if(L)break}if(L)for(E=M+L[0],O=a+L[1],G=0;o>G;G++)for(f=2,$=n[G],K=$[0],J=$[1];f+1<$.length;){if(B=$[f],e=$[f+1],i=eo(M,a,E,O,K,J,B,e,!0))return[0,0];K=B,J=e,f+=2}return L?L:[E-M,O-a]},gf=o.graph3d={},lf=function(w,Y,W){ob(m+".graph3d."+w,Y,W)},eb="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",tb="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
Pk(u,{setBatchInfo:function(c,D){Mk[c]=D},getBatchInfo:function(_){return Mk[_]}},!0);var Yq=[1,1,1],Gm=[1,0,0,0,0,1,0,1,1,1,1,0],If=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],cb=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],ec=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Fc=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Gr=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],zo=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],km=function(S,W){an(S,W,"_batchModelMap","_batchIndexMap"),pq(S,W,"_wireframeModelMap","_wireframeIndexMap"),pq(S,W,"_polylineModelMap","_polylineIndexMap"),pq(S,W,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),pq(S,W,"_polylineModelMapSwap","_polylineIndexMapSwap")},an=function(h,U,K,w){if(!U)return h[K]={},h[w]={},void 0;var E=U._id,j=h[w],P=j[E];if(P){var t=h[K],B=P.batch,z=t[B],Q=z.ds,n=P.index;if(z.invalidate=!0,delete j[E],Q.splice(n,1),vb(Q))return delete t[B],void 0;for(var x=P.begin,f=P.size,O=3*x,W=3*f,N=4*x,$=4*f,m=z.vs,o=z.ps,s=z.uv,G=z.cs,V=z.bs,C=z.rs,d=z.ns,L=z.ls;n<Q.length;n++)P=j[Q[n]._id],P.index--,P.begin-=f;m.splice(O,W),o.splice(N,$),s&&s.splice(2*x,2*f),G&&G.splice(N,$),V&&V.splice(O,W),C&&C.splice(x,f),d&&d.splice(O,W),L&&L.splice(x,f)}},pq=an,ap=function(y,i,B,v){if(!v)return U;var J=i[v];if(!J){var j=Mk[v]||dg,z=j.image?[]:U;J=i[v]={vs:[],ns:[],uv:z,cs:z?U:j.color?U:[],bs:j.blend?[]:U,ps:[],rs:j.brightness?[]:U,ds:[]}}return J.invalidate=!0,y[B._id]={index:J.ds.length,begin:J.vs.length/3,batch:v},J.ds.push(B),J},yn=function(i,k){return k!=U&&1!==k?[i[0]*k,i[1]*k,i[2]*k,i[3]]:i},fr=function(z,R,q){var u=z.getBrightness(R),m=Tk(q.color||"white"),c=m[3]<1,P=Math.ceil(q.width)||1,p=(c?"T":"O")+P,X=z._wireframeIndexMap,U=z._wireframeModelMap,t=U[p];t||(t=U[p]={vs:[],cs:[],ps:[],ds:[],T:c,W:P});var M,H=z.getData3dUI(R),Q=xc(H);if(q.geometry){if(!Q)return;if(M=Ii(Q),!M)return}else M=q.short?ys:om;t.invalidate=!0;var G=t.vs,C=t.cs,b=t.ds,J=X[R._id]={index:b.length,begin:G.length/3,batch:p};b.push(R);var e=Nn(R,q.mat),r=H._calcAnchorMat(R);r&&Wq(e,e,r),ml(G,e,M);var x=J.size=G.length/3-J.begin;db(C,yn(m,u),x)},qr=function(y,N,K,q,n,J,F,z,G){var b=y.getBrightness(N);b==U&&(b=1);var H=yn(Tk(q),b),m=H[3]<1;J=Math.ceil(J)||1;var h=(m?"T":"O")+J;if(F){var Y=F[0],s=(F[1]||Y)+Y;h+="-"+Y+"-"+s,G&&(h+="-"+Pj(G)+"-"+b,G=yn(Tk(G),b))}var T=y._polylineIndexMap,V=y._polylineModelMap,Z=V[h];Z||(Z=V[h]={vs:[],cs:[],ps:[],ds:[],ls:F?[]:U,T:m,W:J},F&&(Z.D=Y,Z.G=s,Z.A=G)),Z.invalidate=!0;var g,f=Z.vs,a=Z.cs,X=Z.ds,P=Z.ls,O=T[N._id]={index:X.length,begin:f.length/3,batch:h};X.push(N),Je(f,K);var v,r=O.size=f.length/3-O.begin,k=K.length,L=0,w=[];if(F||n)for(g=0;k>g;g+=6)v=Pq([K[g],K[g+1],K[g+2]],[K[g+3],K[g+4],K[g+5]]),w.push(v),L+=v;if(L&&n){var i,t=yn(Tk(n),b),l=[t[0]-H[0],t[1]-H[1],t[2]-H[2],t[3]-H[3]],$=0;for(g=0;k>g;g+=6)i=$/L,db(a,[H[0]+l[0]*i,H[1]+l[1]*i,H[2]+l[2]*i,H[3]+l[3]*i],1),$+=w[g/6],i=$/L,db(a,[H[0]+l[0]*i,H[1]+l[1]*i,H[2]+l[2]*i,H[3]+l[3]*i],1)}else db(a,H,r);if(F)for($=z||0,g=0;k>g;g+=6)P.push($),$+=w[g/6],P.push($)},eg=function(R,z,U){if(z)for(var f=4*z.begin,S=U[z.batch].ps,T=0;T<z.size;T++)S[f++]=R[0],S[f++]=R[1],S[f++]=R[2],S[f++]=R[3]},Kf=function(o,N){var G=N+["32"],l=o[N],m=o[G];l?m&&m.length===l.length?(m.set(l),m._bufId=null):o[G]=new Nm(l):delete o[G]},$b=function(O,y,z,U,A,L,M,k,q){if(zc(z))z.forEach(function(X){$b(O,y,X,U,A,L,M,k,q)});else if(Do(z))$b(O,y,xc(U,z),U,A,L,M,k,q);else if(Bf(z)){var Z,i=ws(z.mat,y,O),w=ws(z.s3,y,O),V=ws(z.t3,y,O),v=ws(z.r3,y,O);if((w||v||V||i)&&(Z=tk(i,w,v,ws(z.rotationMode,y,O),V),L.push(Z)),z.shape3d)$b(O,y,z.shape3d,U,A,L,M,k,z);else{var x=U.s;q=q||dg;var d=L[0],f=L.length,n=x("shape3d.color",z.color,q.color);if(A||(A=x("shape3d.blend",z.blend,q.blend)),f>1){d=no(d);for(var p=1;f>p;p++)Wq(d,d,L[p])}z.vs&&x(lc,z.visible,q.visible)&&Ll(d,M,k,z.vs,z.uv,z.is,A,n),z.top_vs&&x(Yj,z.topVisible,q.topVisible)&&Ll(d,M,k,z.top_vs,z.top_uv,z.top_is,A,x("shape3d.top.color",z.topColor,q.topColor)||n),z.bottom_vs&&x(Pn,z.bottomVisible,q.bottomVisible)&&Ll(d,M,k,z.bottom_vs,z.bottom_uv,z.bottom_is,A,x("shape3d.bottom.color",z.bottomColor,q.bottomColor)||n),z.from_vs&&x(gq,z.fromVisible,q.fromVisible)&&Ll(d,M,k,z.from_vs,z.from_uv,z.from_is,A,x("shape3d.from.color",z.fromColor,q.fromColor)||n),z.to_vs&&x(Fr,z.toVisible,q.toVisible)&&Ll(d,M,k,z.to_vs,z.to_uv,z.to_is,A,x("shape3d.to.color",z.toColor,q.toColor)||n)}Z&&L.pop()}},Ll=function(H,J,B,C,t,y,I,o){var m,X=J.cs,i=J.uv,a=J.bs;if(y){m=y.length;for(var g=0;m>g;g++){var G=y[g];ml(B,H,[C[3*G],C[3*G+1],C[3*G+2]]),i&&Je(i,[t[2*G],t[2*G+1]])}}else m=C.length/3,ml(B,H,C),i&&Je(i,t);X&&db(X,o,m),a&&(I?Br(a,I,m):Je(a,Yq,m))},Ol=function(g,b,t,m){var A=[];m?$b(g.gv,g.data,m,g,g.getBodyColor(),[b],t,A):(Ki(g,Qg,b,t,A),Ki(g,Td,b,t,A),Ki(g,nd,b,t,A),Ki(g,Rd,b,t,A),Ki(g,Ij,b,t,A),Ki(g,Lb,b,t,A),Ki(g,"csg",b,t,A)),A.length&&(Je(t.vs,A),Je(t.ns,_p(A)))},Ki=function(l,h,v,e,Z){var J=l[h];if(J){var d=J.tuv;if(d){var T,X,x,W,Y=J.uvScale,o=J.uvOffset;if(Y)for(T=d.length,X=Y[0],x=Y[1],W=0;T>W;W+=2)d[W]*=X,d[W+1]*=x;if(o)for(T=d.length,X=o[0],x=o[1],W=0;T>W;W+=2)d[W]+=X,d[W+1]+=x}Ll(v,e,Z,J.vs,d,U,J.blend,J.color)}},Lq=function(Z,N,E,Q,q,e,F,T){var J,K=E.cs,U=E.uv,c=E.bs;if(Z.getFaceVisible(N,e)){var o=Z.getFaceMat(N,e);if(o&&(q=Nn(N,o)),ml(F,q,T),K&&db(K,Z.getFaceColor(N,e),6),U){var b=Z.getFaceUv(N,e)||Q[e+"Uv"],u=Z.getFaceUvScale(N,e)||Q[e+"UvScale"],B=Z.getFaceUvOffset(N,e)||Q[e+"UvOffset"];b=b?[b[6],b[7],b[0],b[1],b[2],b[3],b[2],b[3],b[4],b[5],b[6],b[7]]:Gm;var j=b[0],d=b[1],W=b[2],V=b[3],w=b[4],A=b[5],n=b[6],S=b[7],g=b[8],v=b[9],P=b[10],x=b[11];if(u){var H=u[0],O=u[1];j*=H,d*=O,W*=H,V*=O,w*=H,A*=O,n*=H,S*=O,g*=H,v*=O,P*=H,x*=O}if(B){var L=B[0],r=B[1];j+=L,d+=r,W+=L,V+=r,w+=L,A+=r,n+=L,S+=r,g+=L,v+=r,P+=L,x+=r}U.push(j,d,W,V,w,A,n,S,g,v,P,x)}c&&(J=Z.getBodyColor(N)||Z.getFaceBlend(N,e),J?Br(c,J,6):Je(c,Yq,6))}},tq=function(D,P,j,s){var b=D.getGL(),T=D._prg,B=D._buffer;if(!D.drawFilter&&!Fo(P)){zr(D),xg(b,T);for(var z in P){var A=P[z];if(!(s&&!A.T||!s&&A.T)){A.invalidate?(A.invalidate=!1,Kf(A,"vs"),Kf(A,"cs"),Kf(A,"ls"),Kf(A,"ps")):j&&Kf(A,"ps");var O=A.vs32,J=j?A.ps32:A.cs32;kr(b,T,A.W,U,B.vs,O);var w=A.D,a=!D._dashDisabled&&w;bj(b,T.uAlphaTest,V.alphaTest),a&&(bj(b,T.uDash,!0),bj(b,T.uDashDistance,w),bj(b,T.uDashGapDistance,A.G),Gb(b,T.aLineDistance),Pl(b,B.lineDistance,A.ls32,T.aLineDistance,1),bj(b,T.uDiffuse,A.A||V["color.empty"]));var e=!D._batchColorDisabled;e&&(bj(b,T.uBatchColor,!0),Gb(b,T.aBatchColor),Pl(b,B.batchColor,J,T.aBatchColor,4)),Nr(b),mh(b,0,O.length/3,b.LINES),zj(b),e&&(bj(b,T.uBatchColor,!1),Km(b,T.aBatchColor)),a&&(bj(b,T.uDash,!1),Km(b,T.aLineDistance))}}fl(b,T)}},tj=function(b,A,S){var d,H,t,L,z,n,e,B,m,G,D,q=b.getGL(),o=b._prg,W=b._buffer,k=b._batchModelMap;if(!Fo(k)){zr(b);for(d in k)if(H=Mk[d]||dg,!(S&&!H.transparent||!S&&H.transparent)&&(t=k[d],A||!H.transparentMask)){var O=S&&H.autoSort!==!1&&(b._33Q||t.invalidate);if(t.invalidate?(t.invalidate=!1,Kf(t,"vs"),Kf(t,"ns"),Kf(t,"cs"),Kf(t,"rs"),Kf(t,"ps"),Kf(t,"bs"),Kf(t,"uv")):A&&Kf(t,"ps"),z=t.vs32,n=A?t.ps32:t.cs32,m=t.uv32,e=t.bs32,B=t.rs32,D=z.length/3,O&&(t.is=Qf(z,b.getEye())),D){L=H.light,G=b.getTexture(H.image),Db(q,o,U,H.light,H.opacity,H.reverseFlip,H.reverseColor,H.reverseCull),n?b._batchColorDisabled||(bj(q,o.uBatchColor,!0),Gb(q,o.aBatchColor),Pl(q,W.batchColor,n,o.aBatchColor,4)):bj(q,o.uDiffuse,H.color||V["color.empty"]);var Y=H.alphaTest;bj(q,o.uAlphaTest,Y===g?V.alphaTest:Y);var x=e&&!b._batchBlendDisabled;x&&(bj(q,o.uBatchBlend,!0),Gb(q,o.aBatchBlend),Pl(q,W.batchBlend,e,o.aBatchBlend));var M=B&&!b._batchBrightnessDisabled;M&&(bj(q,o.uBatchBrightness,!0),Gb(q,o.aBatchBrightness),Pl(q,W.batchBrightness,B,o.aBatchBrightness,1)),m?Nr(q,o,G,H.discardSelectable,W.uv,m,H.uvOffset,H.uvScale):Nr(q),Pl(q,W.vs,z,o.aPosition),Pl(q,W.ns,t.ns32,o.aNormal),t.is?(Qm(q,W.is,t.is),bd(q,0,D)):mh(q,0,D),m?zj(q,o,G):zj(q),n&&!b._batchColorDisabled&&(bj(q,o.uBatchColor,!1),Km(q,o.aBatchColor)),x&&(bj(q,o.uBatchBlend,!1),Km(q,o.aBatchBlend)),M&&(bj(q,o.uBatchBrightness,!1),Km(q,o.aBatchBrightness)),ze(q,o)}}}},Qf=function(N,S){for(var d=N.length/3,C=new Array(d),D=d/3,B=new Array(D),l=0;D>l;l++)B[l]=l;B.sort(function(t,w){var H=9*t,u=[(N[H]+N[H+3]+2*N[H+6])/4,(N[H+1]+N[H+4]+2*N[H+7])/4,(N[H+2]+N[H+5]+2*N[H+8])/4];H=9*w;var e=[(N[H]+N[H+3]+2*N[H+6])/4,(N[H+1]+N[H+4]+2*N[H+7])/4,(N[H+2]+N[H+5]+2*N[H+8])/4],n=Pq(S,u)-Pq(S,e);return n>0?-1:0>n?1:0});for(var l=0;D>l;l++){var k=3*l,Y=3*B[l];C[k]=Y,C[k+1]=Y+1,C[k+2]=Y+2}return new Fq(C)},wk={obj:function(d,t){var V={mat:d.mat,s3:d.s3,r3:d.r3,rotationMode:d.rotationMode,t3:d.t3,cube:d.cube==U?!0:d.cube,center:d.center==U?!0:d.center,ignoreMtls:d.ignoreMtls,ignoreTransparent:d.ignoreTransparent,ignoreColor:d.ignoreColor,ignoreImage:d.ignoreImage,ignoreNormal:d.ignoreNormal,prefix:d.prefix,flipY:d.flipY,flipFace:d.flipFace,reverseFlipMtls:d.reverseFlipMtls,finishFunc:function(F,S){if(F){var S=[];for(var L in F){var Z=F[L];S.rawS3=Z.rawS3,S.push(Z),d.eachModel&&d.eachModel(L,Z)}S.json=d,t(S)}else t()}};u.loadObj(d.obj,d.mtl,V)}};u.getModelTypeHandlers=function(){return wk},u.setModelTypeHandler=function(b,h){wk[b]=h},u.getModelTypeHandler=function(s){return wk[s]},u.handleModelLoaded=function(){},u.handleUnfoundModel=function(){};var zl=U,Fm=U,os=function(v){zl&&!v._loadingModelView_&&(Fm||(Fm={}),Fm[v._loadingModelView_=Cr()]=v)},Lc=function(m,Y){zl||(zl={});var g=zl[m];if(g){if(g.url===Y)return;g.request.onload=mg,g.request.onerror=mg}var w=new or;if(zl[m]={request:w,url:Y},Y=u.beforeLoadURL(Y),Y.data){var D=u.parse(Y.data);Jm(m,D,Y)}else{w.onload=function(P){if(200===this.status||0===this.status){delete zl[m];var s=u.parse(P.target.response||P.target.responseText);Jm(m,s,Y)}else rh(m,u.handleUnfoundModel(m,Y)||U)},w.onerror=function(){rh(m,u.handleUnfoundModel(m,Y)||U)};var h={};h.url=encodeURI(Y),h.sync=!1,w.send(h)}},Jm=function(q,I,J){var A=I.modelType;if(!A)return rh(q,I),u.handleModelLoaded(q,I),void 0;var K=u.getModelTypeHandler(A);if(K){if(zl||(zl={}),zl[q])return;zl[q]=!0;var V=function(h){h?(rh(q,h),u.handleModelLoaded(q,h)):rh(q,u.handleUnfoundModel(q,J)||U)};K(I,V)}else rh(q,u.handleUnfoundModel(q,J)||U)},rh=function(H,f){if(Te[H]=f,delete zl[H],Fo(zl)&&(zl=U,Fm)){for(var J in Fm){var t=Fm[J];t._2O&&(t._2O={}),t.invalidateAll&&t.invalidateAll(g,"modelLoaded",H),t.redraw&&t.redraw(),t.iv(),delete t._loadingModelView_}Fm=U}if(f&&Fm)for(var J in Fm){var t=Fm[J];t.invalidateAll&&t.invalidateAll(g,"modelLoading",H),t.redraw&&t.redraw(),t.iv()}},Qe=new Nm([0,0,0,1,1,1,1,0]),Yi=new Nm([0,0,1,0,0,1,0,0,1,0,0,1]),pl=new Fq([0,1,2,2,3,0]),dh=new Nm([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),vr=new Fq([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),ar=new Nm([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Uc=_p(dh,vr),Cp=(new Nm([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Fq([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Qg,nd,Td,Rd,Ij,Lb]),om=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],ys=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],fm=function($,Z,P,j,Y,S){S=S||16,$=$||16,Z=Z||0,P=P||$;var O,f,d,o,a,c,t,l,V=.5,u=[],g=[],k=E/$,L=D/S;for(O=0;S>O;O++)for(a=O+1,o=O*L,l=a*L,f=Z;P>f;f++)c=f+1,d=f*k,t=c*k,u.push(V*G(o)*R(d),V*R(o),-V*G(o)*G(d),V*G(l)*R(t),V*R(l),-V*G(l)*G(t),V*G(o)*R(t),V*R(o),-V*G(o)*G(t),V*G(o)*R(d),V*R(o),-V*G(o)*G(d),V*G(l)*R(d),V*R(l),-V*G(l)*G(d),V*G(l)*R(t),V*R(l),-V*G(l)*G(t)),g.push(f/$,O/S,c/$,a/S,c/$,O/S,f/$,O/S,f/$,a/S,c/$,a/S);if(j){var W=[],B=[];for(d=Z*k,O=0;S>O;O++)a=O+1,o=O*L,l=a*L,W.push(0,0,0,V*G(l)*R(d),V*R(l),-V*G(l)*G(d),V*G(o)*R(d),V*R(o),-V*G(o)*G(d)),B.push(0,.5,Z/$,a/S,Z/$,O/S)}if(Y){var F=[],v=[];for(d=P*k,O=0;S>O;O++)a=O+1,o=O*L,l=a*L,F.push(0,0,0,V*G(o)*R(d),V*R(o),-V*G(o)*G(d),V*G(l)*R(d),V*R(l),-V*G(l)*G(d)),v.push(1,.5,P/$,O/S,P/$,a/S)}return{vs:u,uv:g,from_vs:W,from_uv:B,to_vs:F,to_uv:v}},Yn=function(A,M,S){A=A||.17,M=M||12,S=S||18,0>A?A=0:A>.25&&(A=.25);var k,N,F,V,c,Y,T,p=.5,W=[],X=[],B=[],v=E/S,j=E/M,e=p-A;for(N=0;M>=N;N++)for(V=-D+N*j,Y=R(V),c=G(V),k=0;S>=k;k++)F=k*v,T=e+A*Y,W.push(R(F)*T,c*A,-G(F)*T),X.push(k/S,1-N/M);for(N=0;M>N;N++){var x=N*(S+1),H=(N+1)*(S+1);for(k=0;S>k;k++)B.push(x+k,H+k+1,H+k,x+k,x+k+1,H+k+1)}return{vs:W,uv:X,is:B}},ue=function(o,z,I,v,Z,K,h){h=h||12,o=o||18,z=z||0,I=I||o,K=K||.17,0>K?K=0:K>.25&&(K=.25);var f,W,L,m,s,C,q,P,Y,u,d=.5,V=[],B=[],j=E/o,F=E/h,b=d-K;for(L=0;h>L;L++)for(m=L+1,q=-D+L*F,P=-D+m*F,f=z;I>f;f++)W=f+1,s=f*j,C=W*j,Y=b+K*R(q),u=b+K*R(P),V.push(R(s)*Y,G(q)*K,-G(s)*Y,R(C)*Y,G(q)*K,-G(C)*Y,R(C)*u,G(P)*K,-G(C)*u,R(s)*Y,G(q)*K,-G(s)*Y,R(C)*u,G(P)*K,-G(C)*u,R(s)*u,G(P)*K,-G(s)*u),B.push(f/o,1-L/h,W/o,1-L/h,W/o,1-m/h,f/o,1-L/h,W/o,1-m/h,f/o,1-m/h);if(v){var x=[],M=[];for(L=0;h>L;L++)m=L+1,q=-D+L*F,P=-D+m*F,s=z*j,Y=b+K*R(q),u=b+K*R(P),x.push(R(s)*Y,G(q)*K,-G(s)*Y,R(s)*u,G(P)*K,-G(s)*u,R(s)*b,0,-G(s)*b),M.push(.5+.5*R(q),.5-.5*G(q),.5+.5*R(P),.5-.5*G(P),.5,.5)}if(Z){var n=[],X=[];for(L=0;h>L;L++)m=L+1,q=-D+L*F,P=-D+m*F,s=I*j,Y=b+K*R(q),u=b+K*R(P),n.push(R(s)*Y,G(q)*K,-G(s)*Y,R(s)*b,0,-G(s)*b,R(s)*u,G(P)*K,-G(s)*u),X.push(.5-.5*R(q),.5-.5*G(q),.5,.5,.5-.5*R(P),.5-.5*G(P))}return{vs:V,uv:B,from_vs:x,from_uv:M,to_vs:n,to_uv:X}},Ql=function(J,v){for(var p,z,q,l=.5,i=16,H=[],N=[],I=[],h=E/i,t=0;i>=t;t++)p=t*h,z=R(p)*l,q=G(p)*l,H.push(z,-l,q,z,l,q),N.push(1-t/i,1,1-t/i,0);for(t=0;i>t;t++)I.push(2*t,2*t+1,2*t+3,2*t,2*t+3,2*t+2);if(v){var M=[],a=[],K=[];for(M.push(0,-l,0),a.push(.5,.5),t=0;i>=t;t++)p=t*h,z=R(p),q=G(p),M.push(z*l,-l,-q*l),a.push(.5+.5*z,.5+.5*q);for(t=0;i>t;t++)K.push(0,t+2,t+1)}if(J){var Z=[],m=[],f=[];for(Z.push(0,l,0),m.push(.5,.5),t=0;i>=t;t++)p=t*h,z=R(p),q=G(p),Z.push(z*l,l,-q*l),m.push(.5+.5*z,.5-.5*q);for(t=0;i>t;t++)f.push(0,t+1,t+2)}return{vs:H,uv:N,is:I,bottom_vs:M,bottom_uv:a,bottom_is:K,top_vs:Z,top_uv:m,top_is:f}},Eo=function(c,_,y,u,H,P,F){c=c||12,_=_||0,y=y||c;for(var h,L,g,K,s,O,p,m,o=.5,V=[],b=[],z=E/c,j=_;y>j;j++)h=j+1,L=j*z,g=h*z,K=R(L)*o,s=G(L)*o,O=R(g)*o,p=G(g)*o,V.push(K,-o,-s,O,-o,-p,K,o,-s,O,-o,-p,O,o,-p,K,o,-s),b.push(j/c,1,h/c,1,j/c,0,h/c,1,h/c,0,j/c,0);if(F){var x=[],Z=[];for(j=_;y>j;j++)L=z*j,g=z*(j+1),K=R(L),s=G(L),O=R(g),p=G(g),x.push(K*o,-o,-s*o,0,-o,0,O*o,-o,-p*o),Z.push(.5+.5*K,.5+.5*s,.5,.5,.5+.5*O,.5+.5*p)}if(P){var M=[],J=[];for(j=_;y>j;j++)L=z*j,g=z*(j+1),K=R(L),s=G(L),O=R(g),p=G(g),M.push(K*o,o,-s*o,O*o,o,-p*o,0,o,0),J.push(.5+.5*K,.5-.5*s,.5+.5*O,.5-.5*p,.5,.5)}if(u){var C=[],U=[];L=z*_,K=R(L)*o,s=G(L)*o,m=_/c,C.push(0,o,0,0,-o,0,K,-o,-s,K,-o,-s,K,o,-s,0,o,0),U.push(0,0,0,1,m,1,m,1,m,0,0,0)}if(H){var d=[],D=[];L=z*y,K=R(L)*o,s=G(L)*o,m=y/c,d.push(0,-o,0,0,o,0,K,o,-s,K,o,-s,K,-o,-s,0,-o,0),D.push(1,1,1,0,m,0,m,0,m,1,1,1)}return{vs:V,uv:b,bottom_vs:x,bottom_uv:Z,top_vs:M,top_uv:J,from_vs:C,from_uv:U,to_vs:d,to_uv:D}},Wc=function(A,P,y,b,N){P=P||18,y=y||0,b=b==U?E:b,N=N==U?.5:N;for(var w,Y,_,v,B,J,T=[0,.5,.75,.875,.9375],X=[],o=[],a=[],Z=b/P,h=0;h<T.length;h++){var k=0===h%2?0:.5;for(w=0;P>=w;w++)Y=(w+k)*Z+y,_=1-T[h],X.push(R(Y)*N*_,-N+2*T[h]*N,-G(Y)*N*_),o.push((w+k)/P,_)}for(h=0;h<T.length-1;h++){var O=h*(P+1),r=(h+1)*(P+1);for(w=0;P>w;w++)a.push(O+w,r+w+1,r+w,O+w,O+w+1,r+w+1)}for(J=X.length/3-(P+1),w=0;P>w;w++)X.push(0,N,0),o.push((w+.5)/P,0);for(w=0;P>w;w++)a.push(J+w,J+w+1,J+(P+1)+w);if(A){var u=[],F=[],t=[];for(u.push(0,-N,0),F.push(.5,.5),w=0;P>=w;w++)Y=w*Z+y,v=R(Y),B=G(Y),u.push(v*N,-N,-B*N),F.push(.5+.5*v,.5+.5*B);for(w=0;P>w;w++)t.push(0,w+2,w+1)}return{vs:X,uv:o,is:a,bottom_vs:u,bottom_uv:F,bottom_is:t}},Vl=function(U,S,K,y,$,v){U=U||16,S=S||0,K=K||U;for(var W=.5,V=[],A=[],k=E/U,s=S;K>s;s++){var g=s+1,J=k*s,Z=k*g;V.push(R(J)*W,-W,-G(J)*W,R(Z)*W,-W,-G(Z)*W,0,W,0),A.push(s/U,1,g/U,1,(s+g)/2/U,0)}if(v){var n=[],T=[];for(s=S;K>s;s++){J=k*s,Z=k*(s+1);var H=R(J),B=G(J),z=R(Z),a=G(Z);n.push(H*W,-W,-B*W,0,-W,0,z*W,-W,-a*W),T.push(.5+.5*H,.5+.5*B,.5,.5,.5+.5*z,.5+.5*a)}}if(y){var f=[],i=[];J=k*S,f.push(0,W,0,0,-W,0,R(J)*W,-W,-G(J)*W),i.push(0,0,0,1,S/U,1)}if($){var N=[],C=[];J=k*K,N.push(0,-W,0,0,W,0,R(J)*W,-W,-G(J)*W),C.push(1,1,1,0,K/U,1)}return{vs:V,uv:A,bottom_vs:n,bottom_uv:T,from_vs:f,from_uv:i,to_vs:N,to_uv:C}},ng=function(e,b,d,L,T,c,z,N){for(var y=[],F=0;F<e.length-1;F+=2)y.push({x:e[F],y:e[F+1]});return mc(y,b,d,L,T,c,z,N,!1)},cj={roundRect:function(C,o){return ng([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],C,o,3)},star:function(I,n){return ng([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],I,n)},rect:function(w,Q){return ng([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],w,Q)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(e,j){return ng([0,-.5,.5,.5,-.5,.5],[1,2,2,5],e,j)},rightTriangle:function(C,h){return ng([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],C,h)},parallelogram:function(q,s){return ng([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],q,s)},trapezoid:function(u,E){return ng([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],u,E)}},tg={sphere:1,cylinder:1,cone:1,torus:1},ud={torus:1,sphere:1},wn=Pk(Cn(cj),{cylinder:1}),dj=Pk(Cn(cj),{cylinder:1,cone:1}),$m=function(p,u,B){var i,m=ws(p.anchor3d,B,u),n=ws(p.mat,B,u),T=ws(p.s3,B,u),L=ws(p.t3,B,u),O=ws(p.r3,B,u),I=T||O||L||n;if(m||I){i=no(u._6O);var g=I?tk(n,T,O,ws(p.rotationMode,B,u),L):vk();m&&hk(g,[.5-m[0],.5-m[1],.5-m[2]]),zr(u,g)}return i},Ab=function(C,D,q,l,U,S,O){if(zc(q))q.forEach(function(d){Ab(C,D,d,l,U,S,O)});else if(Do(q))Ab(C,D,xc(l,q),l,U,S,O);else if(Bf(q))if(q.shape3d){var w=$m(q,C,D);Ab(C,D,q.shape3d,l,U,S,q),w&&Gn(C,w)}else Am(C,D,q,l.s,U,S,O)},Am=function(i,w,l,s,L,N,k){if(k=k||dg,!N||N(s("shape3d.transparent",l.transparent,k.transparent))){var b=$m(l,i,w);op(l);var f=i._26I,P=i._prg,v=i._buffer,Z=s("shape3d.color",l.color,k.color);L||(L=s("shape3d.blend",l.blend,k.blend));var m,g=l.opacity==U?k.opacity:l.opacity,$=s("shape3d.opacity");m=$!=U&&g!=U?g*$:g!=U?g:$,Db(f,P,L,s("shape3d.light",l.light,k.light),m,s("shape3d.reverse.flip",l.reverseFlip,k.reverseFlip),s("shape3d.reverse.color",l.reverseColor,k.reverseColor),s("shape3d.reverse.cull",l.reverseCull,k.reverseCull));var j=s("polygonOffset",l.polygonOffset,k.polygonOffset);l.vs&&s(lc,l.visible,k.visible)&&uq(f,P,v,Z,i.getTexture(s("shape3d.image",l.image,k.image),w),s("shape3d.discard.selectable",l.discardSelectable,k.discardSelectable),l.vs,l.uv,l.ns,l.is,s("shape3d.uv.offset",l.uvOffset,k.uvOffset),s("shape3d.uv.scale",l.uvScale,k.uvScale),j),l.top_vs&&s(Yj,l.topVisible,k.topVisible)&&uq(f,P,v,s("shape3d.top.color",l.topColor,k.topColor)||Z,i.getTexture(s("shape3d.top.image",l.topImage,k.topImage),w),s("shape3d.top.discard.selectable",l.topDiscardSelectable,k.topDiscardSelectable),l.top_vs,l.top_uv,l.top_ns,l.top_is,s("shape3d.top.uv.offset",l.topUvOffset,k.topUvOffset),s("shape3d.top.uv.scale",l.topUvScale,k.topUvScale),j),l.bottom_vs&&s(Pn,l.bottomVisible,k.bottomVisible)&&uq(f,P,v,s("shape3d.bottom.color",l.bottomColor,k.bottomColor)||Z,i.getTexture(s("shape3d.bottom.image",l.bottomImage,k.bottomImage),w),s("shape3d.bottom.discard.selectable",l.bottomDiscardSelectable,k.bottomDiscardSelectable),l.bottom_vs,l.bottom_uv,l.bottom_ns,l.bottom_is,s("shape3d.bottom.uv.offset",l.bottomUvOffset,k.bottomUvOffset),s("shape3d.bottom.uv.scale",l.bottomUvScale,k.bottomUvScale),j),l.from_vs&&s(gq,l.fromVisible,k.fromVisible)&&uq(f,P,v,s("shape3d.from.color",l.fromColor,k.fromColor)||Z,i.getTexture(s("shape3d.from.image",l.fromImage,k.fromImage),w),s("shape3d.from.discard.selectable",l.fromDiscardSelectable,k.fromDiscardSelectable),l.from_vs,l.from_uv,l.from_ns,l.from_is,s("shape3d.from.uv.offset",l.fromUvOffset,k.fromUvOffset),s("shape3d.from.uv.scale",l.fromUvScale,k.fromUvScale),j),l.to_vs&&s(Fr,l.toVisible,k.toVisible)&&uq(f,P,v,s("shape3d.to.color",l.toColor,k.toColor)||Z,i.getTexture(s("shape3d.to.image",l.toImage,k.toImage),w),s("shape3d.to.discard.selectable",l.toDiscardSelectable,k.toDiscardSelectable),l.to_vs,l.to_uv,l.to_ns,l.to_is,s("shape3d.to.uv.offset",l.toUvOffset,k.toUvOffset),s("shape3d.to.uv.scale",l.toUvScale,k.toUvScale),j),ze(f,P),b&&Gn(i,b)}},uq=function(_,R,K,x,F,Z,k,C,L,O,I,Y,s){k&&(s&&Bc(_,s),bj(_,R.uDiffuse,x||V["color.empty"]),C?Nr(_,R,F,Z,K.uv,C,I,Y):Nr(_),Pl(_,K.vs,k,R.aPosition),Pl(_,K.ns,L,R.aNormal),O?(yl(_,K.is,O),bd(_,0,O.length)):mh(_,0,k.length/3),C?zj(_,R,F):zj(_),s&&Ad(_))},xc=function(O,t){var G=O.s;if(t||(t=G(Hg)),!t)return U;var T=yj(t);if(T)return T;if("text"===t){var s={amount:G("shape3d.text.amount"),size:G("shape3d.text.size"),font:G("shape3d.text.font"),style:G("shape3d.text.style"),weight:G("shape3d.text.weight"),fill:G("shape3d.text.fill"),curveSegments:G("shape3d.text.curveSegments"),spacing:G("shape3d.text.spacing")},X=O.gv.getShape3dText(O.data),W=X;for(var $ in s)W+="_"+(s[$]===g?"U":s[$]);return O._cachedTextKey===W?O._cachedTextGeometry:(O._cachedTextKey=W,O._cachedTextGeometry=u.createTextGeometry(X,s))}var $=t;if(tg[t]){var F=G("shape3d.side"),Y=G("shape3d.side.from"),V=G("shape3d.side.to"),P=G(gq),p=G(Fr);3>F?(F=0,Y=0,V=0,P=!1,p=!1):((Y==U||0>Y)&&(Y=0),(V==U||V>F)&&(V=F),0===Y&&V===F&&(P=!1,p=!1)),$+="-"+F+"-"+Y+"-"+V+"-"+P+"-"+p}if(wn[t]){var z=G(Yj);$+="-"+z}if(dj[t]){var C=G(Pn);$+="-"+C}if("torus"===t){var K=G("shape3d.torus.radius");0>K?K=0:K>.25&&(K=.25),$+="-"+K}if(ud[t]){var N=G(Er);$+="-"+N}return T=Jl[$],T||("box"===t?T=u.createBoxModel():cj[t]?T=cj[t](z,C):"sphere"===t?T=u.createSphereModel(F,Y,V,P,p,N):t===ab?T=u.createCylinderModel(F,Y,V,P,p,z,C):"cone"===t?T=u.createConeModel(F,Y,V,P,p,C):"torus"===t&&(T=u.createTorusModel(F,Y,V,P,p,K,N)),Jl[$]=T),T},op=function(){var r=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],n=["is","top_is","bottom_is","from_is","to_is"];return k=_c(eb.substr(eb.indexOf("^#")+2)),Bp(u[yb(vg+r[15]+"n"+r[16])]())&&gp()?function(f){f&&!f._complete_&&(f._complete_=!0,f.vs&&vb(f.ns)&&(f.ns=_p(f.vs,f.is)),f.top_vs&&vb(f.top_ns)&&(f.top_ns=_p(f.top_vs,f.top_is)),f.bottom_vs&&vb(f.bottom_ns)&&(f.bottom_ns=_p(f.bottom_vs,f.bottom_is)),f.from_vs&&vb(f.from_ns)&&(f.from_ns=_p(f.from_vs,f.from_is)),f.to_vs&&vb(f.to_ns)&&(f.to_ns=_p(f.to_vs,f.to_is)),r.forEach(function(h){var U=f[h];zc(U)&&(f[h]=new Nm(U))}),n.forEach(function(z){var S=f[z];zc(S)&&(f[z]=new Fq(S))}))}:void 0}(),Vc=function(z,v){var H=z[v];zc(H)&&(z[v]=new Nm(H))};Pk(kq,{_25Q:function(q){q._16O=function(R,T,w,W,d,H,O,s,F){var n=this.info;if(n){var Y,V,M,A,e,y,m=vk();if(gn[T]?(Y=n.p3,V=n.c1,M=n.c2):Ur[T]?(V=n.s1||n.c1,M=n.s2||n.c2):(V=n.t1||n.c1,M=n.t2||n.c2),Y)y=Bs(T,$j,w,W,s,F);else{var p=pd(M,V),N=Pq(V,M);A=[0,-i(p[2],p[0]),L(p[1]/N)],e="zyx",Y=[(V[0]+M[0])/2,(V[1]+M[1])/2,(V[2]+M[2])/2],y=Bs(T,[N,0,0],w,W,s,F)}return Zp(m,y,Y,W,d,H,O,R,A,e)}return Mp},q._80o=function(C,K,p){var i=this,x=i.shapeModel;if(x){var Q=i.gv;zr(Q),Ab(Q,i.data,x,i,i.getBodyColor(),p)}},q.createLineModel=function(e,v,w,t,G){for(var Y=this,F=Y.s,D=Dm(e,v,F(Er)),u=[],k=0;k<D.length;k++){var H=D[k],P=H.length;if(P>1){var m=H[0];u.push(m.x,m.y,m.z);for(var y=1;P-1>y;y++)m=H[y],u.push(m.x,m.y,m.z),u.push(m.x,m.y,m.z);m=H[P-1],u.push(m.x,m.y,m.z)}}var A,K,b,J=F(t+".color"),V=F(G),W=0;return V&&(K=F(G+".color"),A=F(G+".pattern"),W=F(G+".offset"),b=J),qr(Y.gv,Y.data,u,K||J,b?U:F(t+".gradient.color"),w,A||F(t+".pattern"),W,b),D},q.createTubeModel=function(f,x,M,Y){for(var D=this,P=D.s,B=P("shape3d.side")||Mb,V=P("shape3d.start.angle"),e=P("shape3d.sweep.angle"),g=P(Yj)?P("shape3d.top.cap"):U,j=P(Pn)?P("shape3d.bottom.cap"):U,z="flat"===g,b="flat"===j,r=z&&(Y?Y.uv:P("shape3d.top.image")),T=b&&(Y?Y.uv:P("shape3d.bottom.image")),d=Y?Y.uv:P("shape3d.image"),s={vs:[],uv:d?[]:U,top_vs:z?[]:U,top_uv:r?[]:U,bottom_vs:b?[]:U,bottom_uv:T?[]:U},k=Dm(f,x,P(Er),M),L=0,w=k.length;w>L;L++)pr(s,k[L],P(ph),M,B,V,e,g,j);if(Y){var C=[];$b(D.gv,D.data,s,D,D.getBodyColor(),[],Y,C),C.length&&(Je(Y.vs,C),Je(Y.ns,_p(C)))}else D.shapeModel=s;return k},q.getCache=function(){var V=this.info;if(V){var h=V.list;if(h){var C=V.cache;return C||(C=V.cache=jq(h)),C}}return U}}});var Qh=function(z,s){for(var S,I=0,c=z.length,x=0,j=c-1;j>=x;)if(I=d(x+(j-x)/2),S=z[I].length-s,0>S)x=I+1;else{if(!(S>0)){j=I;break}j=I-1}I=j;var h=z[I],F=h.point;return I===c-1||h.length===s||(F=(new fq).subVectors(z[I+1].point,F).normalize().multiplyScalar(s-h.length).add(F)),{point:F,tangent:h.tangent}},jq=function(W){for(var w,M,s=[],K=0,r=0;r<W.length;r++){for(var z=W[r],$=0;$<z.length;$++){w=z[$],M&&(K+=M.distanceTo(w));var p=new fq,t=z[$+1];t?p.subVectors(t,w):M?p.subVectors(w,M):p.x=1,p.normalize(),s.push({point:w,length:K,tangent:p}),M=w}M=null}return s},Dm=function(O,t,W,Y){W=W||Qn;for(var G=[],x=0,A=O.size();A>x;x++){var K=O.get(x);G.push(new fq(K.x,K.e||0,K.y))}t&&(Wh(t)&&(t=t._as),t.length||(t=null));for(var e,M,k,N,V,S=[],z=0,g=0,w=t?t.length:A;w>g;g++)if(V=t?t[g]:0===g?1:2,1===V)S.push(k=[]),k.push(G[z++]);else if(2===V||5===V)if(N=2===V?G[z++]:k[0],Y){var L=t?t[g+1]:w>g+1?2:U;if(2===L||5===L){var F=k[k.length-1],v=2===L?G[z]:k[0],p=(new fq).subVectors(F,N),f=(new fq).subVectors(v,N),E=p.length(),H=f.length();if(E&&H)if(Y>E/2&&Y>H/2)k.push(N);else for(p.multiplyScalar(s(Y,E/2)/E).add(N),f.multiplyScalar(s(Y,H/2)/H).add(N),e=new Io(p,N,f).getPoints(W),M=0;W>=M;M++)k.push(e[M])}else k.push(N)}else k.push(N);else if(3===V)for(e=new Io(k[k.length-1],G[z++],G[z++]).getPoints(W),M=1;W>=M;M++)k.push(e[M]);else if(4===V)for(e=new Tm(k[k.length-1],G[z++],G[z++],G[z++]).getPoints(W),M=1;W>=M;M++)k.push(e[M]);return S},sm=function(t){for(var R,f,G=new fq,n=[],k=[],g=[],c=0,N=t.length;N>c;c++)R=t[c],f=t[c+1],f?G.subVectors(f,R):G.subVectors(R,t[c-1]),n.push(G.normalize().clone());var E,_,q,K,J=new fq,x=new fq,e=new on,O=1e-4,h=Number.MAX_VALUE,i=n[0],F=k[0]=new fq,p=g[0]=new fq;for(_=v(i.x),q=v(i.y),K=v(i.z),h>=_&&(h=_,J.set(1,0,0)),h>=q&&(h=q,J.set(0,1,0)),h>=K&&J.set(0,0,1),x.crossVectors(i,J).normalize(),F.crossVectors(i,x),p.crossVectors(i,F),c=1;N>c;c++)k[c]=k[c-1].clone(),g[c]=g[c-1].clone(),x.crossVectors(n[c-1],n[c]),x.length()>O&&(x.normalize(),E=r(vo(n[c-1].dot(n[c]),-1,1)),k[c].applyMatrix4(e.makeRotationAxis(x,E))),g[c].crossVectors(n[c],k[c]);return{B:g,T:n,N:k}},pr=function(){var r=function(N){for(var p=1;p<arguments.length;p++){var G=arguments[p];N.push(G.x,G.y,G.z)}},J=function(Q){for(var h=1;h<arguments.length;h++){var c=arguments[h].uv;Q.push(c[0],c[1])}},A=function(j,l,d,Z,w){var v=-Z*R(w),T=Z*G(w);return new fq(j.x+v*d.x+T*l.x,j.y+v*d.y+T*l.y,j.z+v*d.z+T*l.z)},y=function(K,j,Y,p,i,F,e,I){e=e||E;for(var d=[],R=e/i,D=0;i>=D;D++){var l=A(K,j,Y,p,D*R+F);d.push(l),I!=U&&(l.uv=[I,D/i])}return d},u=function(e,J,Y,q,o,a,L,l,f){f=f||E;var D=J?e.top_vs:e.bottom_vs;if(D)for(var h=J?e.top_uv:e.bottom_uv,u=f/L,M=0;L>M;M++){var y,m;J?(y=M*u+l,m=(M+1)*u+l):(m=M*u+l,y=(M+1)*u+l),r(D,A(Y,q,o,a,y),A(Y,q,o,a,m),Y),h&&h.push(.5-.5*R(y),.5-.5*G(y),.5-.5*R(m),.5-.5*G(m),.5,.5)}};return function(I,W,t,d,Q,c,L,A,V){var h=W.length;if(h>1){var n,F,x,S,s,_,o,M=sm(W),p=M.T,l=M.N,N=M.B;"flat"===A&&u(I,!0,W[0],N[0],l[0],d,Q,c,L),"flat"===V&&u(I,!1,W[h-1],N[h-1],l[h-1],d,Q,c,L);var k,i,m=[],$=e(Q/2),w="round"===A,v="round"===V,X=W[0],z=p[0],R=N[0],j=l[0],C=W[h-1],H=p[h-1],f=N[h-1],D=l[h-1];if(w){for(x=1;$>=x;x++)l.splice(0,0,j),N.splice(0,0,R),p.splice(0,0,z),i=-x/$*d,W.splice(0,0,z.clone().multiplyScalar(i).add(X)),m[$-x]=P(d*d-i*i);h+=$}if(v){for(x=1;$>=x;x++)l.push(D),N.push(f),p.push(H),i=x/$*d,W.push(H.clone().multiplyScalar(i).add(C)),m[W.length-1]=P(d*d-i*i);h+=$}if(I.uv){var a=0,Y=0,q=[];for(t&&(a=t),s=W[0],q[0]=0,x=1;h>x;x++)S=W[x],q[x]=s.distanceTo(S),s=S,t||(a+=q[x]);for(k=[],x=0;h>x;x++)Y+=q[x],k[x]=a?Y/a:0}for(x=0;h>x;x++){if(S=W[x],_=N[x],o=l[x],n=y(S,_,o,m[x]===g?d:m[x],Q,c,L,k?k[x]:U),F)for(var E=0;Q>E;E++){var b=F[E],G=F[E+1]||F[0],K=n[E],O=n[E+1]||n[0];r(I.vs,G,b,K,K,O,G),I.uv&&J(I.uv,G,b,K,K,O,G)}F=n}}}}();Pk(u,{getLineLength:function(v){return v[v.length-1].length},getLineOffset:function(w,p){return Qh(w,p)},getLineCacheInfo:function(m,O,P,f){return jq(Dm(m,O,P,f))}});var gc=o.graph3d.RenderLite={},Qo=new Array(0),Oc=gc.Buffer=function(S,G,B,d){this.gl=S,this.buffer=S.createBuffer(),this.type=G||S.ARRAY_BUFFER,this.drawType=d||S.STATIC_DRAW,this.data=Qo,B&&this.upload(B)};Oc.prototype.upload=function(S,w,A){A||this.bind();var r=this.gl;S=S||this.data,w=w||0,this.data.byteLength>=S.byteLength?r.bufferSubData(this.type,w,S):r.bufferData(this.type,S,this.drawType),this.data=S},Oc.prototype.bind=function(){var U=this.gl;U.bindBuffer(this.type,this.buffer)},Oc.createVertexBuffer=function(x,S,t){return new Oc(x,x.ARRAY_BUFFER,S,t)},Oc.createIndexBuffer=function(o,J,u){return new Oc(o,o.ELEMENT_ARRAY_BUFFER,J,u)},Oc.create=function(p,S,d,X){return new Oc(p,S,X)},Oc.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var li=gc.Shader=function(Z,L,G){this.gl=Z,this.program=gr(Z,L,G),this.attributes=sp(Z,this.program);var r=fk(Z,this.program);this.uniforms=bh(Z,r)};li.prototype.bind=function(){this.gl.useProgram(this.program)},li.prototype.destroy=function(){this.gl};var gr=function(G,y,$){var h=Zr(G,G.VERTEX_SHADER,y),Q=Zr(G,G.FRAGMENT_SHADER,$);G.getShaderParameter(Q,G.COMPILE_STATUS)||console.error(G.getError());var d=G.createProgram();return G.attachShader(d,h),G.attachShader(d,Q),G.linkProgram(d),G.getProgramParameter(d,G.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",G.getProgramParameter(d,G.VALIDATE_STATUS)),console.error("gl.getError()",G.getError()),""!==G.getProgramInfoLog(d)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",G.getProgramInfoLog(d)),G.deleteProgram(d),d=null),G.deleteShader(h),G.deleteShader(Q),d},Zr=function(T,J,e){var S=T.createShader(J);return T.shaderSource(S,e),T.compileShader(S),T.getShaderParameter(S,T.COMPILE_STATUS)?S:(console.log(T.getShaderInfoLog(S)),null)},fk=function(X,N){for(var S={},o=X.getProgramParameter(N,X.ACTIVE_UNIFORMS),y=0;o>y;y++){var A=X.getActiveUniform(N,y),J=A.name.replace(/\[.*?\]/,""),B=Ep(X,A.type);S[J]={type:B,size:A.size,location:X.getUniformLocation(N,J),value:Oj(B,A.size)}}return S},sp=function(v,G){for(var y={},C=v.getProgramParameter(G,v.ACTIVE_ATTRIBUTES),W=0;C>W;W++){var d=v.getActiveAttrib(G,W),p=Ep(v,d.type);y[d.name]={type:p,size:Ic(p),gl:v,location:v.getAttribLocation(G,d.name),pointer:bb}}return y},bb=function($,D,R,w,V){var L=this.gl;L.enableVertexAttribArray(this.location),L.bindBuffer($.type,$.buffer),L.vertexAttribPointer(this.location,this.size,D||L.FLOAT,R||!1,w||0,V||0)},Ic=function(q){return Pf[q]},Pf={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Ep=function(F,o){if(!gm){var G=Z.keys(dk);
gm={};for(var D=0;D<G.length;++D){var C=G[D];gm[F[C]]=dk[C]}}return gm[o]},gm=null,dk={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Oj=function(U,d){switch(U){case"float":return 0;case"vec2":return new Float32Array(2*d);case"vec3":return new Float32Array(3*d);case"vec4":return new Float32Array(4*d);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*d);case"ivec3":return new Int32Array(3*d);case"ivec4":return new Int32Array(4*d);case"bool":return!1;case"bvec2":return pi(2*d);case"bvec3":return pi(3*d);case"bvec4":return pi(4*d);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},pi=function(i){for(var l=new Array(i),X=0;X<l.length;X++)l[X]=!1;return l},bh=function(k,K){var U={data:{}};U.gl=k;for(var u=Z.keys(K),C=0;C<u.length;C++){var r=u[C],t=r.split("."),b=t[t.length-1],y=Ao(t,U),x=K[r];y.data[b]=x,y.gl=k,Z.defineProperty(y,b,{get:hd(b),set:ni(b,x)})}return U},hd=function(B){var K=qs.replace("%%",B);return new Function(K)},ni=function(L,d){var o,B=af.replace(/%%/g,L);return o=1===d.size?ei[d.type]:Yf[d.type],o&&(B+="\nthis.gl."+o+";"),new Function("value",B)},Ao=function($,c){for(var N=c,D=0;D<$.length-1;D++){var S=N[$[D]]||{data:{}};N[$[D]]=S,N=S}return N},qs=["return this.data.%%.value;"].join("\n"),af=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),ei={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Yf={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},cr=o.Light=function(){Sc(cr,this),this.s(Eg,V[Eg]),this.s(Hg,"sphere"),this.s3(20,20,20)};oi("Light",Dq,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(P,m,e){cr.superClass.onStyleChanged.apply(this,arguments),P===Eg&&this.s("shape3d.color",e)}});var Ln=gf.Graph3dView=function(j,K){var p=this;p._attributes=K||u.graph3dViewAttributes,p._25I={},p._view=wm(1,p);var D=p._canvas=Aj(p._view);D.addEventListener("webglcontextlost",function(N){N.preventDefault(),Rq(p),p._26I&&p._doBufferGC(p._26I,!0),p._26I=U,p._1o.texture=U,p._35O=!0},O),D.addEventListener("webglcontextrestored",function(){p._35O=!1,p.iv()},O),p._batchIndexMap={},p._batchModelMap={},p._wireframeIndexMap={},p._wireframeModelMap={},p._wireframeIndexMapSwap={},p._wireframeModelMapSwap={},p._polylineIndexMap={},p._polylineIndexMap={},p._polylineIndexMapSwap={},p._polylineIndexMapSwap={},p._8O=[],p._7O=vk(),p._6O=vk(),p._1o=new Od(p),p._30O=new ac(p),p._31O=new ls(p),p._32O=new jj(p),p._raycaster=new gi(p),p._highlightHelper=new Wd(p),p._postProcessing=new tn(p),p.vr=new ym(p),p._33Q=!0,p._eye=Cn(u.graph3dViewEye),p._center=Cn(u.graph3dViewCenter),p._up=Cn(u.graph3dViewUp),p._lightChanged=!1,p._59O=[],p._spots=[],p._dirs=[],p._frameId=0,p.overlappingBox=new Mr(p),p.dm(j?j:new Ch),p._coreInteractor=new $q(this),p.setInteractors([new bk(p)])},Op={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},te=0;lf("Graph3dView",Z,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Lp,ol,"firstPersonMode",ve,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Ee,fs,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:u.graph3dViewEditHelperDisabled,_devicePixelRatio:g,_boundaries:g,_moveStep:u.graph3dViewMoveStep,_rotateStep:u.graph3dViewRotateStep,_pannable:u.graph3dViewPannable,_rotatable:u.graph3dViewRotatable,_walkable:u.graph3dViewWalkable,_resettable:u.graph3dViewResettable,_zoomable:u.graph3dViewZoomable,_firstPersonMode:u.graph3dViewFirstPersonMode,_mouseRoamable:u.graph3dViewMouseRoamable,_gridVisible:u.graph3dViewGridVisible,_gridSize:u.graph3dViewGridSize,_gridGap:u.graph3dViewGridGap,_gridColor:u.graph3dViewGridColor,_originAxisVisible:u.graph3dViewOriginAxisVisible,_centerAxisVisible:u.graph3dViewCenterAxisVisible,_axisXColor:u.graph3dViewAxisXColor,_axisYColor:u.graph3dViewAxisYColor,_axisZColor:u.graph3dViewAxisZColor,_ortho:u.graph3dViewOrtho,_orthoWidth:u.graph3dViewOrthoWidth,_fovy:u.graph3dViewFovy,_near:u.graph3dViewNear,_far:u.graph3dViewFar,_headlightColor:u.graph3dViewHeadlightColor,_headlightIntensity:u.graph3dViewHeadlightIntensity,_headlightRange:u.graph3dViewHeadlightRange,_headlightDisabled:u.graph3dViewHeadlightDisabled,_rectSelectable:u.graph3dViewRectSelectable,_rectSelectBackground:u.graph3dViewRectSelectBackground,_editSizeColor:u.graph3dViewEditSizeColor,_autoMakeVisible:ok,_fogDisabled:u.graph3dViewFogDisabled,_fogColor:u.graph3dViewFogColor,_fogNear:u.graph3dViewFogNear,_fogFar:u.graph3dViewFogFar,_dashDisabled:u.graph3dViewDashDisabled,_batchColorDisabled:u.graph3dViewBatchColorDisabled,_batchBlendDisabled:u.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:u.graph3dViewBatchBrightnessDisabled,setEye:function(y,q,l){1===arguments.length&&(q=y[1],l=y[2],y=y[0]);var C=this._eye;C[0]=y,C[1]=q,C[2]=l,this.fp(Ee,U,C)},setCenter:function(g,P,Q){1===arguments.length&&(P=g[1],Q=g[2],g=g[0]);var r=this._center;r[0]=g,r[1]=P,r[2]=Q,this.fp(fs,U,r)},setUp:function(K,B,u){1===arguments.length&&(B=K[1],u=K[2],K=K[0]);var D=this._up;D[0]=K,D[1]=B,D[2]=u,this.fp("up",U,D)},getDevicePixelRatio:function(){return this._devicePixelRatio||rp},isTransparentMask:function(D){return D.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var l=this,f=l._aspect;return f?f:(f=l.getWidth()/l.getHeight(),f||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(Q){var M=this,W=M._dataModel,m=M._selectionModel;W!==Q&&(W&&(W.ump(M.handleDataModelPropertyChange,M),W.umm(M.handleDataModelChange,M),W.umd(M.handleDataPropertyChange,M),m||W.sm().ums(M.handleSelectionChange,M)),M._dataModel=Q,Q.mp(M.handleDataModelPropertyChange,M),Q.mm(M.handleDataModelChange,M),Q.md(M.handleDataPropertyChange,M),m?m._21I(Q):Q.sm().ms(M.handleSelectionChange,M),M._postProcessing.handleDataModleChange(W,Q),M.invalidateAll(!0),M.invalidateLight(),M.fp(Og,W,Q),M._canvas.style.background=Q.getBackground()||"")},handleDataModelPropertyChange:function(E){if("background"===E.property){var d=this._canvas.style.background,Z=E.newValue||"";this._canvas.style.background=Z,this.fp("canvasBackground",d,Z)}else"envmap"===E.property&&this.iv()},handleDataPropertyChange:function(Z){var h=Z.data;this.invalidateData(h),mp(h)&&"s:light.type"===Z.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(m){var B=this,f=m.property;B.iv(),B._18Q=U,"eye"===f?B._33Q=!0:"devicePixelRatio"===f?B._42(U,B.getDevicePixelRatio()):Op[f]&&Rq(B)},_5O:function(x){var V=x._22Q();return V?new V(this,x):U},getData3dUI:function(j){var _=this._25I[j._id];return _===g&&(_=this._5O(j),this._25I[j._id]=_),_},invalidateAll:function(E){var b=this;if(E){for(var o in b._25I){var K=b._25I[o];K&&K.dispose()}b._25I={},b.iv(),km(b)}else km(b),b.dm().each(function(I){b.invalidateData(I)})},invalidateSelection:function(){var k=this;k.sm().each(function(q){k.invalidateData(q)})},invalidateData:function(E){var L=this,p=L.getData3dUI(E);p&&(p.iv(),L.iv()),km(L,E)},getShape3dText:function(T){return T.getStyle("shape3d.text")||this.getLabel(T)},invalidateBatch:function(x){var e=this,v=e._batchModelMap,D=v[x],l=[],r={};if(D){D.ds.forEach(function(H){var V=e.getData3dUI(H);V&&V.iv(),delete e._batchIndexMap[H._id],l.push(H._id)}),delete v[x];for(var q,G,f,h,d,y,I,a,H,Q=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],p=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],w=0;w<Q.length;w++){var C=e[Q[w]],O=e[p[w]];for(r={},a=0;a<l.length;a++){var i=O[l[a]];if(i){delete O[l[a]],H=i.batch,q=C[H];var J=i.begin,A=i.size,c=3*J,P=3*A,_=4*J,n=4*A;for(G=q.ds,f=q.vs,h=q.cs,d=q.ps,y=q.ls,I=i.index,q.invalidate=!0,G[I]=g,I=c;c+P>I;I++)f[I]=g;for(I=_;_+n>I;I++)h[I]=g;for(I=_;_+n>I;I++)d[I]=g;if(y)for(I=c;c+P>I;I++)y[I]=g;r[H]=!0}}for(H in r){q=C[H],G=q.ds,f=q.vs,h=q.cs,d=q.ps,y=q.ls;var L=[];for(I=0;I<G.length;I++)G[I]!==g&&L.push(G[I]);if(0===L.length)delete C[H];else{for(q.ds=L,L=[],I=0;I<f.length;I++)f[I]!==g&&L.push(f[I]);for(q.vs=L,L=[],I=0;I<h.length;I++)h[I]!==g&&L.push(h[I]);for(q.cs=L,L=[],I=0;I<d.length;I++)d[I]!==g&&L.push(d[I]);if(q.ps=L,y){for(L=[],I=0;I<y.length;I++)y[I]!==g&&L.push(y[I]);q.ls=L}}}}e.iv()}},handleDataModelChange:function(b){var g=this,$=b.kind,E=b.data;if("add"===$)g.invalidateData(E),nr(E)&&E.getEdgeGroup()&&E.getEdgeGroup().eachSiblingEdge(g.invalidateData,g),mp(E)&&g.invalidateLight();else if($===Se){var _=E._id,v=g._25I[_];v&&(v.dispose(),delete g._25I[_],g.iv()),E===g._currentSubGraph&&g.setCurrentSubGraph(U),km(g,E),mp(E)&&g.invalidateLight()}else $===sg&&(g.invalidateAll(!0),g.setCurrentSubGraph(U),km(g),g.invalidateLight())},toCanvas:function(S,r,O){var X=this,Y=X.getGL();if(X.validate(),S){var C=Y.getParameter(Y.COLOR_CLEAR_VALUE);wl(Y,S)}X._42(U,1);var v=X.getWidth(),q=X.getHeight(),R=new Uint8Array(4*v*q),l=Aj(),I=l.getContext("2d");Y.readPixels(0,0,v,q,Y.RGBA,Y.UNSIGNED_BYTE,R),gl(l,v,q,1);for(var W=I.getImageData(0,0,v,q),c=W.data,h=0;h<c.length;h+=4){var s=h/4,z=d(s/v),n=s-z*v;s=4*((q-1-z)*v+n),c[s]=R[h],c[s+1]=R[h+1],c[s+2]=R[h+2],c[s+3]=R[h+3]}if(I.putImageData(W,0,0),S&&wl(Y,C),X._42(U,X.getDevicePixelRatio()),r&&O){var e=Aj(),w=e.getContext("2d");return r=r,O=O,gl(e,r,O,1),u.drawImage(w,l,0,0,r,O),e}return l},toDataURL:function(u,e){var x=this,h=x.getGL();if(x.validate(),u){var J=h.getParameter(h.COLOR_CLEAR_VALUE);wl(h,u)}x._42(U,1);var d=x._canvas.toDataURL(e||"image/png",1);return u&&wl(h,J),x._42(U,x.getDevicePixelRatio()),d},getGL:function(){var f=this,R=f._26I;if(f._prg,!R)try{f._2O={},R=f._26I=f._canvas.getContext("webgl",f._attributes)||f._canvas.getContext("experimental-webgl",f._attributes),R._emptyTexture=Om(R),R._emptyBlendTexture=Om(R),R._bufPool={},R._id=++te,f._buffer={vs:hh(R),ns:hh(R),is:hh(R),uv:hh(R),batchColor:hh(R),batchBlend:hh(R),batchBrightness:hh(R),lineDistance:hh(R)},f._1O=xi(R);var X=f._cube={vs:hh(R),ns:hh(R),is:hh(R),uv:hh(R)};yp(R,X.vs,dh),yp(R,X.ns,Uc),yp(R,X.uv,ar),Qm(R,X.is,vr)}catch(p){}return f.acquireProgram(),R},acquireProgram:function(){var f=this,j=f._26I;if(j){var u=o.Default.getImage(f.dm().getEnvmap())?!0:!1,Q=f._prg&&f._prg.envMapFlag?!0:!1;if(!f._prg||u!==Q){var l=f._prg=j.createProgram();if(!l)return U;l.envMapFlag=u;var Y=f._dirs.length,q=f._spots.length,y=f._59O.length,A=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];Y&&A.push("uDirColor","uDirDirection"),q&&A.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),y&&A.push("uPointColor","uPointRange","uPointPosition"),wl(j,[0,0,0,0]),j.clearDepth(1),j.enable(j.DEPTH_TEST),j.depthFunc(j.LEQUAL),j.enable(j.BLEND),j.blendFuncSeparate(j.SRC_ALPHA,j.ONE_MINUS_SRC_ALPHA,j.ONE,j.ONE_MINUS_SRC_ALPHA),kn||(eb=_c(eb.substring(0,eb.indexOf("^#"))),tb=_c(tb),kn=!0);var T=["#define MAX_DIR "+Y,"#define MAX_SPOT "+q,"#define MAX_POINT "+y,f._fogDisabled?"":"#define FOG",f._dashDisabled?"":"#define DASH",u?"#define USE_ENVMAP":"",f._batchColorDisabled?"":"#define BATCHCOLOR",f._batchBlendDisabled?"":"#define BATCHBLEND",f._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),G=Lf(j,l,j.VERTEX_SHADER,eb.replace("PREFIX",T));j.getShaderParameter(G,j.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",j.getShaderInfoLog(G));var H=Lf(j,l,j.FRAGMENT_SHADER,tb.replace("PREFIX",T));j.getShaderParameter(H,j.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",j.getShaderInfoLog(H)),F?A.push("aPosition"):(l.aPosition=0,j.bindAttribLocation(l,0,"aPosition")),j.linkProgram(l),A.forEach(function(f){l[f]=/^u/.test(f)?j.getUniformLocation(l,f):j.getAttribLocation(l,f)}),j.useProgram(l),j.deleteShader(G),j.deleteShader(H)}}},getBrightness:function(Y){var v=Y.s("brightness"),K=this.isSelected(Y)?Y.s("select.brightness"):U;return v==U?K:K==U?v:v*K},setHighlightMode:function(w){var n;n="selection"===w?Wd.Mode.Selection:"mouseover"===w?Wd.Mode.MouseOver:Wd.Mode.Disable,this._highlightHelper.mode=n},getHighlightMode:function(){var U=this._highlightHelper.mode;return U===Wd.Mode.Selection?"selection":U===Wd.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(w){var y=this,c=y._prg,L=5,R=y.dm().getEnvmap(),Z=o.Default.getImage(R);if(Z){if(R!==y._lastEnvMap){y._envMapTexture&&w.deleteTexture(y._envMapTexture);var S=y._envMapTexture=w.createTexture();w.bindTexture(w.TEXTURE_CUBE_MAP,S),w.texParameteri(w.TEXTURE_CUBE_MAP,w.TEXTURE_MAG_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_CUBE_MAP,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,Z),w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,Z),w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,Z),w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,Z),w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,Z),w.texImage2D(w.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,Z),w.bindTexture(w.TEXTURE_CUBE_MAP,null),y._lastEnvMap=R}w.activeTexture(w.TEXTURE0+L),w.bindTexture(w.TEXTURE_CUBE_MAP,y._envMapTexture),w.uniform1i(c.uEnvMap,L)}},getWireframe:function(N){var r=N.s("wf.visible"),$=N.s("wf.width");return r===!0||$>0&&"selected"===r&&this.isSelected(N)?{color:N.s("wf.color"),width:$,"short":N.s("wf.short"),mat:N.s("wf.mat")}:void 0},_transformPointToViewSpace:function(w){var S=[w[0],w[1],w[2]];return jf(S,this._viewMatrix),S},_transformDirectionToViewSpace:function(B,i){var y=[B[0],B[1],B[2]];jf(y,this._viewMatrix);var l=i?[i[0],i[1],i[2]]:[0,0,0];jf(l,this._viewMatrix);var c=l[0]-y[0],q=l[1]-y[1],G=l[2]-y[2],b=Math.sqrt(c*c+q*q+G*G);return b?[c/b,q/b,G/b]:[c,q,G]},getWireframeGeometry:function(S){return S.s("wf.geometry")?{color:S.s("wf.color"),width:S.s("wf.width"),mat:S.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(R){return R.s("body.color")},getMat:function(q){return q.getMat?q.getMat():q.s("mat")},getFaceMat:function(Z,Y){return Z.getFaceMat?Z.getFaceMat(Y):Z.s(Y+".mat")},getFaceBlend:function(d,N){return d.s(N+".blend")||d.s("all.blend")},getFaceColor:function(R,O){return R.s(O+".color")||R.s("all.color")},getFaceImage:function(P,Y){return P.s(Y+".image")||P.s("all.image")},getFaceBlendImage:function(v,A){return v.s(A+".blend.image")||v.s("all.blend.image")},getFaceDiscardSelectable:function(x,r){var J=x.s(r+".discard.selectable");return J==U?x.s("all.discard.selectable"):J},getFaceUv:function(b,d){return b.s(d+".uv")||b.s("all.uv")},getFaceUvOffset:function(j,d){return j.s(d+".uv.offset")||j.s("all.uv.offset")},getFaceUvScale:function(U,a){return U.s(a+".uv.scale")||U.s("all.uv.scale")},getFaceLight:function(y,P){var G=y.s(P+".light");return G==U?y.s("all.light"):G},getFaceVisible:function(T,S){var g=T.s(S+".visible");return g==U?T.s("all.visible"):g},getFaceOpacity:function(m,b){var K=m.s(b+".opacity");return K==U?m.s("all.opacity"):K},getFaceTransparent:function(b,Z){var O=b.s(Z+".transparent");return O==U?b.s("all.transparent"):O},getFaceReverseColor:function(Z,x){return Z.s(x+".reverse.color")||Z.s("all.reverse.color")},getFaceReverseFlip:function(P,G){var z=P.s(G+".reverse.flip");return z==U?P.s("all.reverse.flip"):z},getFaceReverseCull:function(E,H){var C=E.s(H+".reverse.cull");return C==U?E.s("all.reverse.cull"):C},getTextureMap:function(){return this._2O},deleteTexture:function(I){var e=this,K=e._2O[I];K&&(delete e._2O[I],e.getGL().deleteTexture(K))},invalidateShape3dCachedImage:function(E){var T=this.getData3dUI(E);T.invalidateCachedTexture(this.getGL())},isInteractive:function(S){return S.s("interactive")},getTexture:function(r,x){if(!r)return U;var c=this,L=c.getGL(),A=c._2O[r];if(!A){var F=Dl(r);if(!F)return L._emptyTexture;if(F.tagName){if(F.dynamic)return xi(L,F,c._1O);A=c._2O[r]=xi(L,F)}else{var K,H=x&&x.s("shape3d.image.cache")&&!c.isInteractive(x),B=c.vr.isPresenting();B&&(x._textureUpdateFrame===L._renderInfo.frame?H=!0:x._textureUpdateFrame=L._renderInfo.frame),H&&(K=c.getData3dUI(x),A=K.getCachedTexture());var d;if(!A){var S=x&&x.s("shape3d.fixSizeOnScreen"),e=S?L.NEAREST:L.LINEAR;S||x&&x.s("shape3d.vector.dynamic")&&(K||(K=c.getData3dUI(x)),S=K.getVectorDynamicSize(),S&&(d=c.getDevicePixelRatio(),S[0]*=d,S[1]*=d));var z,E,W=x&&x.s("shape3d.texture.scale")||1;if(S?(d||(d=c.getDevicePixelRatio()),z=S[0]>0?S[0]:W*Zb(F,x)*d,E=S[1]>0?S[1]:W*Qk(F,x)*d):(z=W*Zb(F,x),E=W*Qk(F,x)),z>=1&&E>=1){var m=hn(z,E);if(!K&&x&&(K=c.getData3dUI(x)),K&&K.interactiveInfo){var O=r;"object"==typeof O&&(O=O.uuid||(O.uuid=o.Math.generateUUID()));var u=K.interactiveInfo[O]={};m.interactiveInfo=u.bodyInfo={compInfos:[],matrix:new Uj,rect:{x:0,y:0,width:z,height:E}}}lm(m,F,0,0,z,E,x,c),m.interactiveInfo&&(m.interactiveInfo=null),m.restore(),(H||B)&&Rl(F,x)?(A=xi(L,Tl,null,e),K.setCachedTexture(A),Tl=null):A=xi(L,Tl,c._1O,e)}}}}return A},redraw:function(){this.iv()},validateImpl:function(){var h=this;if(h._lightChanged){h._lightChanged=!1;var b=[],j=[],F=[];h.dm().each(function(V){if(mp(V)){var J=V.s("light.type");J===Ak?b.push(V):J===qi?j.push(V):J===oj&&F.push(V)}}),(b.length!==h._59O.length||j.length!==h._spots.length||F.length!==h._dirs.length)&&Rq(h),h._59O=b,h._spots=j,h._dirs=F}h._42(),h._1o.iv()},getRenderInfo:function(){var S=this.getGL();return S?S._renderInfo:void 0},getDebugTip:function(){var h=this,J=h.getRenderInfo();if(J){var T=h.getGL()._validBufCount||0,L="Draw Calls: "+J.calls+"<br/>"+"Vertices: "+J.vertices+"<br/>"+"Faces: "+J.faces+"<br/>"+"Lines: "+J.lines+"<br/>"+"Buffer Count: "+T;return h.vr.isPresenting()&&(L+="<br/>VR fps: "+h.vr.getFps()),L}},_42:function(o,Q){var e=this;if(!e._35O&&(!Yb||qp(Yb))){var K,_;o&&(o instanceof Dq?_=o:K=o);var c=e._canvas,O=e.getGL(),A=e._prg;if(O){var k=e.getWidth(),F=e.getHeight();Q?o||gl(c,k,F,Q):(Q=e.getDevicePixelRatio(),o||k===c.clientWidth&&F===c.clientHeight||gl(c,k,F,Q)),O.clear(O.COLOR_BUFFER_BIT),e.drawFilter||(O._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:o?e._frameId:++e._frameId});var l=function(){if(e.overlappingBox.clear(),e._81O=U,O.clear(O.DEPTH_BUFFER_BIT),bj(O,A.uBrightness,1),bj(O,A.uOpacity,1),bj(O,A.uPartOpacity,1),O._picking=!!o,bj(O,A.uPick,!!o),bj(O,A.uTexture,!1),bj(O,A.uBlendTexture,!1),bj(O,A.uAlphaTest,V.alphaTest),bj(O,A.uTransparent,!1),bj(O,A.uFix,!1),bj(O,A.uBatchColor,!1),bj(O,A.uBatchBlend,!1),bj(O,A.uBatchBrightness,!1),bj(O,A.uReflectivity,e._envmapReflectivity||.5),bj(O,A.uCameraPosition,e.getEye()),bj(O,A.uPMatrix,e._projectMatrix=ai(e)),bj(O,A.uViewMatrix,wh(e,e._7O)),e.bindEnvMap(O),e._viewMatrix=no(e._7O),o||(vh(e,O,A),e._fogDisabled||(bj(O,A.uFogColor,e._fogColor),bj(O,A.uFogNear,e._fogNear),bj(O,A.uFogFar,e._fogFar))),Gb(O,A.aPosition),Gb(O,A.aNormal),Km(O,A.aUv),Km(O,A.aBatchColor),Km(O,A.aBatchBlend),Km(O,A.aBatchBrightness),Km(O,A.aLineDistance),_){var N=O.getParameter(O.COLOR_CLEAR_VALUE);O.clearColor(0,0,0,0),O.disable(O.BLEND),Km(O,A.aNormal),yp(O,e._cube.vs,U,A.aPosition),Qm(O,e._cube.is),_g(_,e,Qg,0),_g(_,e,nd,6),_g(_,e,Td,12),_g(_,e,Rd,18),_g(_,e,Ij,24),_g(_,e,Lb,30),Gb(O,A.aNormal),wl(O,N)}else if(K){K.value=2;var N=O.getParameter(O.COLOR_CLEAR_VALUE);O.clearColor(0,0,0,0),O.disable(O.BLEND),e._95I(O,A,K),tj(e,K),tq(e,e._polylineModelMap,K),tq(e,e._wireframeModelMap,K),bj(O,A.uTransparent,!0),e._95I(O,A,K,!0),tj(e,K,!0),tq(e,e._polylineModelMap,K,!0),tq(e,e._wireframeModelMap,K,!0),bj(O,A.uTransparent,!1),O.clear(O.DEPTH_BUFFER_BIT),e._swapLineMap(),e._95I(O,A,K,!1,!0),tq(e,e._polylineModelMap,K),tq(e,e._wireframeModelMap,K),e._swapLineMap(),e._swapLineMap(),e._95I(O,A,K,!1,!0),tq(e,e._polylineModelMap,K),tq(e,e._wireframeModelMap,K),bj(O,A.uTransparent,!0),e._95I(O,A,K,!0,!0),tq(e,e._polylineModelMap,K,!0),tq(e,e._wireframeModelMap,K,!0),bj(O,A.uTransparent,!1),e._swapLineMap(),O.disable(O.DEPTH_TEST),e.drawFilter||e._30O._42(O,A,K),O.enable(O.DEPTH_TEST),wl(O,N)}else O.disable(O.BLEND),e.drawSky(O,A),e._31O._42(O,A),e._95I(O,A),tj(e),tq(e,e._polylineModelMap),tq(e,e._wireframeModelMap),O.enable(O.BLEND),bj(O,A.uTransparent,!0),O.depthMask(!1),e._95I(O,A,U,!0),tj(e,U,!0),tq(e,e._polylineModelMap,U,!0),tq(e,e._wireframeModelMap,U,!0),O.depthMask(!0),bj(O,A.uTransparent,!1),O.clear(O.DEPTH_BUFFER_BIT),e._swapLineMap(),O.disable(O.BLEND),e._95I(O,A,U,!1,!0),tq(e,e._polylineModelMap),tq(e,e._wireframeModelMap),O.enable(O.BLEND),bj(O,A.uTransparent,!0),O.depthMask(!1),e._95I(O,A,U,!0,!0),tq(e,e._polylineModelMap,U,!0),tq(e,e._wireframeModelMap,U,!0),O.depthMask(!0),bj(O,A.uTransparent,!1),e._swapLineMap(),O.disable(O.DEPTH_TEST),O.disable(O.BLEND),e._32O._42(O,A),e._30O._42(O,A),e._highlightHelper._42(O,A),O.enable(O.DEPTH_TEST);yp(O,U),Qm(O,U)},n=!1,G=k*Q,y=F*Q,f=e.vr;f.enable&&f._42(O,G,y,l)&&(n=!0);var g=e.envRenderer;g&&g.enable&&g._42(O,G,y,l)&&(n=!0);var Z=e._postProcessing;Z._42(O,G,y,l,o)&&(n=!0),n||(e.setViewport(O,0,0,k*Q,F*Q),l()),e._33Q=!1,e.drawFilter||e.countFrame(),e._doBufferGC(O)}}},enablePostProcessing:function(W,O){return this._postProcessing.enableModule(W,O)},getPostProcessingModule:function(c){return this._postProcessing.getModule(c)},setViewport:function(i,Q,U,r,B){this._viewport=[Q,U,r,B],i.viewport(Q,U,r,B)},getViewport:function(){return this._viewport},setBufferGCInterval:function(V){this._bufferGCInterval=V},_doBufferGC:function(V,J){var y,R,D=V._bufPool,t=0,v=0,K=V._renderInfo.frame,h=this._bufferGCInterval||10;for(y in D)t++,R=D[y],R&&(J||K-R._fid>h?(V.deleteBuffer(R._buf),R._buf=null,D[y]=null):v++);if(t/2>v&&t>128){var G={};for(y in D)D[y]&&(G[y]=D[y]);V._bufPool=G}V._validBufCount=v},_swapLineMap:function(){var q=this;S=q._polylineModelMap,q._polylineModelMap=q._polylineModelMapSwap,q._polylineModelMapSwap=S,S=q._wireframeModelMap,q._wireframeModelMap=q._wireframeModelMapSwap,q._wireframeModelMapSwap=S,S=q._polylineIndexMap,q._polylineIndexMap=q._polylineIndexMapSwap,q._polylineIndexMapSwap=S,S=q._wireframeIndexMap,q._wireframeIndexMap=q._wireframeIndexMapSwap,q._wireframeIndexMapSwap=S},_updateSkyBox:function(t){if(this._skyBox&&t){var x=t.property,C=!1,e=this._skyBox;if("eye"===x||"forceUpdate"===x){var G=this._eye;e.p3(G[0],G[1],G[2]),C=!0}if("near"===x||"far"===x||"forceUpdate"===x){var r=this._near,R=this._far,V=e.getFinalScale3d();if(V[0]/=2,V[1]/=2,V[2]/=2,V[0]<=r||V[0]>=R||V[1]<=r||V[1]>=R||V[2]<=r||V[2]>=R){var o=2*r*R/(r+R),A=Math.min(V[0],V[1],V[2]),E=o/A,P=e.getScale3d();e.setScale3d(P[0]*E,P[1]*E,P[2]*E),C=!0}}C&&this.invalidateData(e)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(b){var m=this._skyBox;m&&(this._skyBoxStyleMap&&m.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&m.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&m.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=b,this.ump(this._updateSkyBox,this),b&&(b.dm()&&b.dm().remove(b),this._skyBoxStyleMap=o.Default.clone(b.getStyleMap()),this._skyBoxAnchor3d=b.getAnchor3d(),b.setAnchor3d(.5,.5,.5),this._skyBoxP3=b.p3().slice(0),b.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",m,b)},drawSky:function(X,E,W){var Y=this,$=Y._skyBox;if($){var r=Y._headlightIntensity,w=Tk(Y._headlightColor),E=Y._prg;1!==r&&(w=[w[0]*r,w[1]*r,w[2]*r]),bj(X,E.uHeadlightColor,[w[0],w[1],w[2],1]);var G=Y.getData3dUI($);G&&G._42(X,E,W,function(){return!0}),X.clear(X.DEPTH_BUFFER_BIT),bj(X,E.uHeadlightColor,[w[0],w[1],w[2],Y._headlightDisabled?1:0])}},_95I:function(j,G,J,S,e){function d(R){if(!!R.s("shape3d.alwaysOnTop")==!!e&&C.isVisible(R)&&(!M||q)){if(!J&&C.isTransparentMask(R))return;var g=C.getData3dUI(R);g&&g._42(j,G,J,f)}}var C=this,f=function(B){return S?B:!B};C.sky&&j.clear(j.DEPTH_BUFFER_BIT);var Q=C.drawFilter;Q?C.dm().each(function(y){Q(y)||d(y)}):C.dm().each(function(c){d(c)})},getLogicalPoint:function(R){return Qj(R,this._canvas)},isRectOverlapping:function(R){var z=this.getData3dUI(R);return z._rectOverlapping},getHitFaceInfo:function(S){S.target&&(S=this.lp(S));var t=this.getDataInfoAt(S);if(t){var n=this._1o.face(t.data,en(S.x,S.y));if(n)return{data:t.data,face:n}}return U},unproject:function(x,W){var o=this,v=o.getWidth(),N=o.getHeight(),_=x.target?o.lp(x):x,l=_.x-v/2,r=_.y-N/2,z=2*(l/v),M=2*(-1*r/N);W=W||0;var A=vk(),m=ai(o),C=wh(o);Wq(A,m,C),ig(A);var F=zq([z,M,W,1],A);return[F[0]/F[3],F[1]/F[3],F[2]/F[3]]},getDataAt:function(t){var _=this.getDataInfoAt(t);return _?_.data:U},getDataInfoAt:function(H,c){return H.target&&(H=this.lp(H)),this._1o.get(en(H.x,H.y,c),!0)},getDatasInRect:function(j){return this._1o.get(j)},setEditable:function(V){var A=this,x=A._editable;A._editable=V,this.fp(qn,x,V)},isEditable:function(I){var W=this;return W._editable?_h(I)?I.s("3d.editable")?W._editableFunc?W._editableFunc(I):!0:!1:!1:!1},isSelectable:function(t){return t.s("3d.selectable")&&this.sm().isSelectable(t)},isMovable:function(I){var v=this;return nr(I)&&I.getStyle(Zq)!==Vm?!1:I.s("3d.movable")?v._movableFunc?v._movableFunc(I):!0:!1},isSizeEditable:function(T){return _h(T)?this._sizeEditableFunc?this._sizeEditableFunc(T):!0:!1},isRotationEditable:function(S){return _h(S)&&S.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(S):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(w){this.setZoom(bp,w)},zoomOut:function($){this.setZoom(1/bp,$)},setZoom:function(L,M){if(1!==L){var V=this;if(V._ortho)return V.setOrthoZoom(L,M),void 0;V._14o&&V._14o.stop(!0);var r=1/L,O=V._eye,E=V._center,Y=E[0]+(O[0]-E[0])*r-O[0],I=E[1]+(O[1]-E[1])*r-O[1],v=E[2]+(O[2]-E[2])*r-O[2];if(!(Pq(O,E)<V._moveStep&&1>r)){if(M=Em(M)){var F=Cn(O);return M.action=function(A){V.fi({kind:V._zooming?"betweenZoom":"beginZoom"}),V._zooming=1,O[0]=F[0]+Y*A,O[1]=F[1]+I*A,O[2]=F[2]+v*A,V.fp(Ee,U,O)},M._37o=function(){delete V._14o,delete V._zooming,V.fi({kind:"endZoom"}),V.onZoomEnded()},V._14o=Dh(M)}O[0]+=Y,O[1]+=I,O[2]+=v,V.fp(Ee,U,O)}}},setOrthoZoom:function(p,z){if(1!==p){var f=this;f._14o&&f._14o.stop(!0);var e=f._orthoWidth,K=e/p-e;if(!(e<f._moveStep&&p>1))return(z=Em(z))?(z.action=function(Y){f.fi({kind:f._zooming?"betweenZoom":"beginZoom"}),f._zooming=1,f.setOrthoWidth(e+K*Y)},z._37o=function(){delete f._14o,delete f._zooming,f.fi({kind:"endZoom"}),f.onZoomEnded()},f._14o=Dh(z)):(f.setOrthoWidth(e/p),void 0)}},getPositionInfo:function(n){var G=this,r=G._eye,k=G._center,d=G.getAspect(),j=n?pe(pd(k,r,!0),pd(n,r)):Pq(r,k);if(G._ortho){var i=G._orthoWidth;return{length:j,height:i/d,width:i}}var O=2*w(G._fovy/2)*j;return{length:j,height:O,width:O*d}},getCenterInfo:function(){var v=this;return v._81O||(v._81O=v.getPositionInfo()),Cn(v._81O)},rotate:function(O,n,l,b){var u=this;if(O||n){b==U&&(b=u._firstPersonMode),u._88O&&u._88O.stop(!0);var w=u._center,y=u._eye,I=u.getCenterInfo().length,o=b?w:y,B=b?y:w,q=pd(o,B),m=i(q[0],q[2]),c=i(P(q[0]*q[0]+q[2]*q[2]),q[1]),F=b?fs:Ee;return b&&(n=-n),(l=Em(l))?(l.action=function(b){u.fi({kind:u._rotating?"betweenRotate":"beginRotate"}),u._rotating=1;var M=m+O*b,e=c+n*b;e=kb(e),q[0]=I*G(e)*G(M),q[1]=I*R(e),q[2]=I*G(e)*R(M),o[0]=B[0]+q[0],o[1]=B[1]+q[1],o[2]=B[2]+q[2],u.fp(F,U,o)},l._37o=function(){delete u._88O,delete u._rotating,u.fi({kind:"endRotate"}),u.onRotateEnded()},u._88O=Dh(l)):(m+=O,c+=n,c=kb(c),q[0]=I*G(c)*G(m),q[1]=I*R(c),q[2]=I*G(c)*R(m),o[0]=B[0]+q[0],o[1]=B[1]+q[1],o[2]=B[2]+q[2],u.fp(F,U,o),void 0)}},pan:function(b,u,d,o){if(b||u){var T=this;o==U&&(o=T._firstPersonMode),T._89O&&T._89O.stop(!0);var e=wh(T),j=[e[0]*b,e[4]*b,e[8]*b],f=[e[1]*u,e[5]*u,e[9]*u],t=j[0]+f[0],i=j[1]+f[1],D=j[2]+f[2],I=T._center,S=T._eye;if(o){var n=Ah(T.getBoundaries(),S[0],S[2],S[0]+t,S[2]+D,P(t*t+D*D));t=n[0],D=n[1]}if(d=Em(d)){var y=Cn(S),g=Cn(I);return d.action=function(K){T.fi({kind:T._panning?"betweenPan":"beginPan"}),T._panning=1,I[0]=g[0]+t*K,I[1]=g[1]+i*K,I[2]=g[2]+D*K,S[0]=y[0]+t*K,S[1]=y[1]+i*K,S[2]=y[2]+D*K,T.fp(Ee,U,S),T.fp(fs,U,I)},d._37o=function(){delete T._89O,delete T._panning,T.fi({kind:"endPan"}),T.onPanEnded()},T._89O=Dh(d)}I[0]+=t,I[1]+=i,I[2]+=D,S[0]+=t,S[1]+=i,S[2]+=D,T.fp(Ee,U,S),T.fp(fs,U,I)}},walk:function(l,I,W){if(l){var z=this;W==U&&(W=z._firstPersonMode),z._90O&&z._90O.stop(!0);var x=z._center,J=z._eye,V=pd(x,J,!0);if(W){var e=Ah(z.getBoundaries(),J[0],J[2],J[0]+V[0]*l,J[2]+V[2]*l,v(l));if(l=Pq(e),!l)return;V=[e[0]/l,0,e[1]/l]}if(I=Em(I)){var h=Cn(J),r=Cn(x);return I.action=function(C){z.fi({kind:z._walking?"betweenWalk":"beginWalk"}),z._walking=1;var d=l*C;J[0]=h[0]+V[0]*d,J[1]=h[1]+V[1]*d,J[2]=h[2]+V[2]*d,x[0]=r[0]+V[0]*d,x[1]=r[1]+V[1]*d,x[2]=r[2]+V[2]*d,z.fp(Ee,U,J),z.fp(fs,U,x)},I._37o=function(){delete z._90O,delete z._walking,z.fi({kind:"endWalk"}),z.onWalkEnded()},z._90O=Dh(I)}J[0]+=V[0]*l,J[1]+=V[1]*l,J[2]+=V[2]*l,x[0]+=V[0]*l,x[1]+=V[1]*l,x[2]+=V[2]*l,z.fp(Ee,U,J),z.fp(fs,U,x)}},handleScroll:function(n,g){n.preventDefault();var u=this,P=u._moveStep,q=u.getDataInfoAt(n);
if(q){var R=q.data,W=u.intersectObject(n,R);if(W){var b=W.part,k=Dl(R.s(b+".image")||R.s("shape3d."+b+".image")||R.s("all.image")||R.s("shape3d.image"));if(k&&ws(k.scrollable,R,u))return}}u.isFirstPersonMode()?u.isPannable()&&u.pan(0,g>0?P:-P):u.isZoomable()&&u.setZoom(0>g?1/$k:$k)},handlePinch:function(_,K){this.isZoomable()&&this.setZoom(K>_?1/Eh:Eh)},reset:function(){this.setCenter(u.graph3dViewCenter),this.setEye(u.graph3dViewEye),this.setUp(u.graph3dViewUp)},moveSelection:function(L,Q,R){var Y=this;Y.dm().beginTransaction(),xq(this.sm().toSelection(this.isMovable,this),L,Q,R),Y.dm().endTransaction()},getMoveMode:function(n,p){var V=p.s("3d.move.mode");if(V)return V;var L="88",R="89",y="90";return Cl(n)||mf[L]&&mf[R]&&mf[y]?"xyz":mf[L]&&mf[R]?"xy":mf[L]&&mf[y]?"xz":mf[R]&&mf[y]?"yz":mf[L]?"x":mf[R]?"y":mf[y]?"z":"xz"},handleTick:function(){var F=this,Q=!1,u=F._moveStep,S=u,l=!1,G=!0,W=F._rotateStep*(G?-1:1);if(F.isWalkable()||(S=0),F.isPannable()||(u=0),F.isRotatable()||(W=0),F._32Q){var f=(Zc()-F._32Q)/50;S*=f,u*=f,W*=f}F._31Q&&(Ed(F._31Q),delete F._31Q,delete F._32Q),Jb()&&(Q=!0,F.pan(-u,0,l,G)),Gd()&&(Q=!0,F.pan(u,0,l,G)),Jo()&&(Q=!0,Cl()?F.pan(0,u,l,G):F.walk(S,l,G)),bl()&&(Q=!0,Cl()?F.pan(0,-u,l,G):F.walk(-S,l,G)),pf()&&(Q=!0,F.rotate(-W,0,l,G)),wf()&&(Q=!0,F.rotate(W,0,l,G)),jl()&&(Q=!0,F.rotate(0,-W/2,l,G)),Lr()&&(Q=!0,F.rotate(0,W/2,l,G)),Q&&(F._32Q=Zc(),F._31Q=Sk(F.handleTick,F))},handleKeyDown:function(c){var Q=this;!ds(c)&&wi[c.keyCode]?Q.handleTick():Co(c)?Q.selectAll():Jc(c)?Q.handleDelete(c):Lo(c)&&this.isResettable()&&Q.reset()},checkDoubleClickOnNote:function(t,J,$){var B=this;if($===Hq){if(J.s("note.toggleable"))return J.s(yr,!J.s(yr)),B.fi({kind:"toggleNote",event:t,data:J,part:$}),!0}else if($===Xi&&J.s("note2.toggleable"))return J.s(As,!J.s(As)),B.fi({kind:"toggleNote2",event:t,data:J,part:$}),!0;return!1},checkDoubleClickOnRotation:function(q,w,c){return c===ql?(w.setRotationX(0),!0):c===Pr?(w.setRotationY(0),!0):c===Up?(w.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(R){var A=this;if(A.isOrtho())return A.getWidth()/A.getOrthoWidth();var Z=A.getCenter(),w=A.getHeight(),W=A.getEye(),x=[Z[0]-W[0],Z[1]-W[1],Z[2]-W[2]],j=[R[0]-W[0],R[1]-W[1],R[2]-W[2]],K=Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2]),H=1/Math.tan(A.getFovy()/2);return w*K*H/(j[0]*x[0]+j[1]*x[1]+j[2]*x[2])},inViewSpace:function(B){var b,z=this,d=z._transformPointToViewSpace(B),I=z.getAspect(),f=z.getNear(),x=z.getFar();return-d[2]<f||-d[2]>x?!1:z.isOrtho()?(b=z.getOrthoWidth()/2,Math.abs(d[0])<=b&&Math.abs(d[1]*I)<=b):(b=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2])*Math.tan(z.getFovy()/2),Math.abs(d[1]<=b)&&Math.abs(d[0])<=b*I)},toViewPosition:function(v){var C=this,H=C.getWidth()/2,y=C.getHeight()/2,t=C._18Q;return t&&t._wh===H/y||(t=ai(C),C._18Q=Wq(t,t,wh(C)),C._18Q._wh=H/y),v=zq([v[0],v[1],v[2],1],t),{x:H+H*v[0]/v[3],y:y-y*v[1]/v[3]}},getHitPosition:function(C,h,Q){var F=this,k=F.getWidth(),f=F.getHeight(),I=C.target?F.lp(C):C,g=I.x-k/2,X=I.y-f/2,Y=F.getCenterInfo(),m=wh(F);h=h?h:[0,0,0],Q=Q?Q:[0,1,0],g=g/k*Y.width,X=-1*X/f*Y.height;var l=[m[0]*g,m[4]*g,m[8]*g],D=[m[1]*X,m[5]*X,m[9]*X],$=[l[0]+D[0],l[1]+D[1],l[2]+D[2]],B=F.getCenter(),p=pn(F,h,Q,[$[0]+B[0],$[1]+B[1],$[2]+B[2]]);return p?p:[0,0,0]},intersectObject:function(q,p){return this._raycaster.intersectObject(q,p)},intersectObjects:function(w,Z,h){return this._raycaster.intersectObjects(w,Z,h)},getLineLength:function(B){this.validate();var E=this.getData3dUI(B);if(E&&E.getCache){var I=E.getCache();if(I)return I[I.length-1].length}return 0},getLineOffset:function(H,M){var F=this.getData3dUI(H);if(F&&F.getCache){var Z=F.getCache();if(Z)return Qh(Z,M)}return U},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(o,x,Y){var Z=this,K=Z.getEye();K=[K[0],K[1],K[2]];var g=Z.getCenter();if(g=[g[0],g[1],g[2]],o||(o=K),x||(x=g),Z._flyAnim&&Z._flyAnim.stop(!0),Y=Em(Y),!Y)return Z.setEye(o[0],o[1],o[2]),Z.setCenter(x[0],x[1],x[2]),delete Z._flyAnim,!0;var r=[o[0]-K[0],o[1]-K[1],o[2]-K[2]],c=[x[0]-g[0],x[1]-g[1],x[2]-g[2]];return Y.action=function(o){Z.setCenter(g[0]+c[0]*o,g[1]+c[1]*o,g[2]+c[2]*o),Z.setEye(K[0]+r[0]*o,K[1]+r[1]*o,K[2]+r[2]*o)},Y._37o=function(){delete Z._flyAnim},Z._flyAnim=Dh(Y)},flyTo:function(){function f(f,_,M){if(M instanceof o.Node){d.fromArray(Nn(M,_.getMat(M)));var p=M.getAnchor3d();f.push((new sc).set(0-p.x,0-p.y,0-p.z).applyMatrix4(d)),f.push((new sc).set(0-p.x,0-p.y,1-p.z).applyMatrix4(d)),f.push((new sc).set(0-p.x,1-p.y,0-p.z).applyMatrix4(d)),f.push((new sc).set(0-p.x,1-p.y,1-p.z).applyMatrix4(d)),f.push((new sc).set(1-p.x,0-p.y,0-p.z).applyMatrix4(d)),f.push((new sc).set(1-p.x,0-p.y,1-p.z).applyMatrix4(d)),f.push((new sc).set(1-p.x,1-p.y,0-p.z).applyMatrix4(d)),f.push((new sc).set(1-p.x,1-p.y,1-p.z).applyMatrix4(d))}}var K=new sc,e=new sc,F=new sc,R=new sc,d=new qm,Y=new o.Math.Quaternion,W=new di;return function(d,p,u){var r=this;if(u!==g)p={animation:p,ratio:u};else{var _=typeof p;("boolean"===_||"object"===_&&p.duration)&&(p={animation:p})}p=p||{},K.fromArray(r.getEye()),e.fromArray(r.getCenter());var M,D,P=[],h=p.center,t=p.distance===g;if(h&&F.fromArray(h),d instanceof o.Node)h||F.fromArray(d.p3()),t&&(f(P,r,d),M=P.length);else{if(d||(d=r.dm().getDatas()),!d.length)return;if((t||!h)&&(P=[],d.forEach(function(l){f(P,r,l)}),M=P.length),!M)return;if(!h){for(F.set(0,0,0),D=0;M>D;D++)F.add(P[D]);F.multiplyScalar(1/M)}}if(r.setCenter(F.x,F.y,F.z),R.subVectors(K,e),p.direction||p.worldDirection){!p.worldDirection&&d instanceof o.Node?Y.setFromEuler(W.set(d.r3(),d.getRotationMode(),!0)):Y.set(0,0,0,1);var O=R.length();R.fromArray(p.worldDirection||p.direction).applyQuaternion(Y).setLength(O)}if(t){for(var Z,E,w,c,H,S=r.getNear(),T=10,u=p.ratio||.8;T--;){for(r._eye[0]=R.x+F.x,r._eye[1]=R.y+F.y,r._eye[2]=R.z+F.z,Z=ai(r),Wq(Z,Z,wh(r)),c=!0,H=-1/0,D=0;M>D;D++){if(w=P[D],E=zq([w.x,w.y,w.z,1],Z),E[3]<S&&T){R.multiplyScalar(2),c=!1;break}H=Math.max(H,Math.max(Math.abs(E[0]),Math.abs(E[1]))/u-E[3])}if(c)break}R.setLength(H+R.length()).add(F)}else R.setLength(p.distance).add(F);r._flyAnim&&r._flyAnim.stop(!0);var b=Em(p.animation);if(b){r.setEye(K.x,K.y,K.z),r.setCenter(e.x,e.y,e.z);var V=(new sc).subVectors(R,K),I=(new sc).subVectors(F,e),n=new sc,z=new sc;return b.action=function(W){n.copy(K).addScaledVector(V,W),z.copy(e).addScaledVector(I,W),r.setCenter(z.x,z.y,z.z),r.setEye(n.x,n.y,n.z)},b._37o=function(){delete r._flyAnim},{lastEye:K,lastCenter:e,eye:R,center:F,animation:r._flyAnim=Dh(b)}}return r.setEye(R.x,R.y,R.z),delete r._flyAnim,{lastEye:K,lastCenter:e,eye:R,center:F}}}(),getBoundingBox:function(){function h(V,l,o){u.fromArray(Nn(o,l.getMat(o)));var b=o.getAnchor3d();V.push((new sc).set(0-b.x,0-b.y,0-b.z).applyMatrix4(u)),V.push((new sc).set(0-b.x,0-b.y,1-b.z).applyMatrix4(u)),V.push((new sc).set(0-b.x,1-b.y,0-b.z).applyMatrix4(u)),V.push((new sc).set(0-b.x,1-b.y,1-b.z).applyMatrix4(u)),V.push((new sc).set(1-b.x,0-b.y,0-b.z).applyMatrix4(u)),V.push((new sc).set(1-b.x,0-b.y,1-b.z).applyMatrix4(u)),V.push((new sc).set(1-b.x,1-b.y,0-b.z).applyMatrix4(u)),V.push((new sc).set(1-b.x,1-b.y,1-b.z).applyMatrix4(u))}var u=new qm;return function(X){if(X=X||this.sm().getSelection(),X instanceof o.Node&&(X=[X]),0===X.length)return U;var I=[];X.forEach(function(k){h(I,this,k)},this);var Y=[1/0,1/0,1/0],P=[-1/0,-1/0,-1/0];return I.forEach(function(q){Y[0]=Math.min(q.x,Y[0]),Y[1]=Math.min(q.y,Y[1]),Y[2]=Math.min(q.z,Y[2]),P[0]=Math.max(q.x,P[0]),P[1]=Math.max(q.y,P[1]),P[2]=Math.max(q.z,P[2])}),{min:Y,max:P}}}()}),gf.RenderEnv=function(X){this.gv=X,this.enable=!1},Z.defineProperties(gf.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(e){this._debugOn=e,this.capture&&this.capture()}}}),Z.assign(gf.RenderEnv.prototype,{renderEnvToCube:function(X,P,f,n){var z=this,A=z.gv;if(!X||!P||!f)return z.enable=!1,z._42=null,void 0;z.enable=!0;var J=Math.floor(n/X*P),G=A.getGL(),i=z._renderTargets;i?i.length<f&&(i=z._renderTargets=i.concat(new Array(f-i.length))):i=z._renderTargets=new Array(f);for(var j=0;f>j;j++)i[j]?i[j].setSize(G,n,J):i[j]=new gf.RenderTarget(A,G,n,J);var t=!1;z.capture=function(){t=!0,A._42(),t=!1};var r=new sc,k=new sc,m=new sc,D=new sc,Q=(new sc).setY(0),N=2*Math.PI/f,e=X/2/Math.tan(Math.PI/f),s=2*Math.atan2(P/2,e),o=X/P;z._42=function($,S,M,W){var v=z._debugOn;if(!t&&!v)return!1;r.copy(A.getEye()),D.copy(A.getCenter()).sub(r);var R=Math.atan2(D.z,D.x),X=A.getNear(),H=A.getFovy(),B=A.getAspect();k.copy(A.getCenter());for(var Y,l=0;f>l;l++)if(Y=i[l],Q.setZ(Math.cos(R)).setX(Math.sin(R)).multiplyScalar(e),R-=N,m.addVectors(r,Q),A.setNear(e),A.setCenter([m.x,m.y,m.z]),A.setFovy(s),A.setAspect(o),v){var u=Math.round(S/f);$.viewport(u*l,0,u,M),W()}else We($,Y.frame),$.viewport(0,0,Y.width,Y.height),$.clear($.COLOR_BUFFER_BIT),W(),wp($),Y.assureTexture();return A.setNear(X),A.setCenter([k.x,k.y,k.z]),A.setFovy(H),A.setAspect(B),!0},z.capture()},getTextureInfo:function(p){var d=this._renderTargets;if(!d)return null;var e=this._renderTargets[p];return e?{index:p,texture:e.texture,textureName:e.uuid}:null}}),Z.assign(gf.Graph3dView.prototype,{renderEnvToCube:function(U,D,q,x){var Q=this;Q.envRenderer||(Q.envRenderer=new gf.RenderEnv(Q)),Q.envRenderer.renderEnvToCube(U,D,q,x)}}),gf.RenderTarget=function(p,r,A,t,K){var j=this;K=K||{},j.uuid=o.Math.generateUUID(),j.gv=p,j.init(p,r,K),j.setSize(r,A,t)},Z.assign(gf.RenderTarget.prototype,{init:function(H,X,e){var M=this,c=M.texture=X.createTexture();X.activeTexture(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,c),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MIN_FILTER,e.minFilter||X.LINEAR),X.texParameteri(X.TEXTURE_2D,X.TEXTURE_MAG_FILTER,e.magFilter||X.LINEAR),X.bindTexture(X.TEXTURE_2D,null),M.render=X.createRenderbuffer(),M.frame=X.createFramebuffer(),H._2O[M.uuid]=c},assureTexture:function(){var n=this,B=n.uuid,W=n.gv._2O;W[B]||(W[B]=n.texture)},setSize:function(u,n,I){var $=this;if($.width!==n||$.height!==I){var g=u.RGBA,Q=u.TEXTURE_2D,d=u.RENDERBUFFER,K=u.FRAMEBUFFER;Pc(u,$.texture),u.texImage2D(Q,0,g,n,I,0,g,u.UNSIGNED_BYTE,U),u.bindRenderbuffer(d,$.render),u.renderbufferStorage(d,u.DEPTH_COMPONENT16,n,I),We(u,$.frame),u.framebufferTexture2D(K,u.COLOR_ATTACHMENT0,Q,$.texture,0),u.framebufferRenderbuffer(K,u.DEPTH_ATTACHMENT,d,$.render),Pc(u,U),u.bindRenderbuffer(d,U),wp(u),$.width=n,$.height=I}},toCanvas:function(){var c=this,m=c.gv.getGL();We(m,c.frame);var q=c.width,J=c.height,_=new Uint8Array(4*q*J);m.readPixels(0,0,q,J,m.RGBA,m.UNSIGNED_BYTE,_),wp(m);var k=z.createElement("canvas");k.width=q,k.height=J;var P=k.getContext("2d"),K=P.createImageData(q,J);return K.data.set(_),P.putImageData(K,0,0),k}});var jm=gf.Interactor=function(u){this.gv=u};lf("Interactor",Z,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var bk=gf.DefaultInteractor=function(A){Sc(bk,this,[A])};lf("DefaultInteractor",jm,{handle_contextmenu:function(t){td(t)},handle_mousewheel:function(x){this.gv.handleScroll(x,x.wheelDelta/40)},handle_DOMMouseScroll:function(t){2===t.axis&&this.gv.handleScroll(t,-t.detail)},handle_keydown:function(O){this.gv.handleKeyDown(O)},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(j){td(j);var h=this,T=h.gv,u=lk(j),Z=T.getDataInfoAt(j),f=Z?Z.data:U,O=Z?Z.part:U,o=T.sm(),E=_j(j),S=Xh(j);T.setFocus(j)&&(h._62O=U,h._57I=U,f?ds(j)?o.co(f)?o.rs(f):o.as(f):o.co(f)||o.ss(f):u&&(ds(j)?T.isRectSelectable()&&(h._62O=um):h._57I=Zg(j)),h._31Q&&(Ed(h._31Q),delete h._31Q,delete h._32Q),h._62O||(T.isFirstPersonMode()&&(Cl(j)||S>2?h._62O="pan":T.isMouseRoamable()||$d?(h._62O="roaming",h.foward=E&&lk(j),h._32Q=Zc(),h._31Q=Sk(h.tick,h)):u||(h._62O="roaming")),h._62O||(u&&E&&Ri[O]?(h._62O=O,h.p3=f.p3()):u&&E&&_h(f)&&T.isSelected(f)?T.isMovable(f)?(h._62O="move",h.p3=f.p3(),h.movedata=f):T.isInteractive(f)&&(h._62O="none"):$d&&(S>2?h._62O="pan":2===S&&(h.dist=yi(j),h._62O="pinch")))),h.point=T.lp(j),Ti(h,j),qc(j)?T.handleDoubleClick(j,f,O):T.handleClick(j,f,O))},tick:function(){var e=this,U=e.gv,F=U._moveStep;e.point&&U.isWalkable()&&(e._32Q&&(F*=(Zc()-e._32Q)/50),U.walk(e.foward?F:-F),e._32Q=Zc(),e._31Q=Sk(e.tick,e))},handle_mouseup:function(T){this.handle_touchend(T)},handle_touchend:function(k){var C=this._57I;C&&(Pq(C,Zg(k))<=1&&this.gv.sm().cs(),this._57I=U)},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(K){var $,O,J=this,n=J.gv,g=J._62O,w=J.point,N=n.dm(),R=n.lp(K),G=R.x-w.x,o=R.y-w.y,f=n.getWidth(),l=n.getHeight();if(f&&l){var e=-E*G/f,j=-E*o/l;if("roaming"===g)J.rotate(K,e/2,j/2);else if(g===ql||g===Pr||g===Up)n._86O||N.beginTransaction(),n.fi({kind:n._86O?"betweenEditRotation":"beginEditRotation",event:K}),n._86O=1,n.sm().each(function(i){if(_h(i)&&n.isRotationEditable(i)){var o=v(e)>v(j)?e:j;g===ql?i.setRotationX(i.getRotationX()+o):g===Pr?i.setRotationY(i.getRotationY()+o):g===Up&&i.setRotationZ(i.getRotationZ()+o)}});else if("move"===g||Ri[g]){g===kf||g===Df||g===Cd?(n._87O||N.beginTransaction(),n.fi({kind:n._87O?"betweenEditScale":"beginEditScale",event:K}),n._87O=1):(n._moving||N.beginTransaction(),n.fi({kind:n._moving?"betweenMove":"beginMove",event:K}),n._moving=1);var S,b=J.p3,P=n.getPositionInfo(b),D=wh(n);S=g===Rk?"x":g===vp?"y":g===md?"z":g===kf?"sx":g===Df?"sy":g===Cd?"sz":n.getMoveMode(K,J.movedata),G=G/f*P.width,o=-1*o/l*P.height;var V,Q,A=[D[0]*G,D[4]*G,D[8]*G],i=[D[1]*o,D[5]*o,D[9]*o],c=A[0]+i[0],H=A[1]+i[1],F=A[2]+i[2],z=[b[0]+c,b[1]+H,b[2]+F],h=pd(n.getEye(),z,!0);if("xyz"===S?(V=z,n.moveSelection(c,H,F)):"xz"===S?(V=pn(n,b,[0,1,0],z),V&&n.moveSelection(V[0]-b[0],0,V[2]-b[2])):"xy"===S?(V=pn(n,b,[0,0,1],z),V&&n.moveSelection(V[0]-b[0],V[1]-b[1],0)):"yz"===S?(V=pn(n,b,[1,0,0],z),V&&n.moveSelection(0,V[1]-b[1],V[2]-b[2])):"x"===S||"sx"===S?(h[0]=0,V=pn(n,b,h,z),V&&(Q=V[0]-b[0],"x"===S?n.moveSelection(Q,0,0):n.sm().each(function(q){_h(q)&&n.isSizeEditable(q)&&($=q.getScaleX()+Q/100,O=$/q.getScaleX(),q.setScaleX($),Cl(K)&&(q.setScaleY(q.getScaleY()*O),q.setScaleTall(q.getScaleTall()*O)))}))):"y"===S||"sy"===S?(h[1]=0,V=pn(n,b,h,z),V&&(Q=V[1]-b[1],"y"===S?n.moveSelection(0,Q,0):n.sm().each(function(W){_h(W)&&n.isSizeEditable(W)&&($=W.getScaleTall()+Q/100,O=$/W.getScaleTall(),W.setScaleTall($),Cl(K)&&(W.setScaleY(W.getScaleY()*O),W.setScaleX(W.getScaleX()*O)))}))):("z"===S||"sz"===S)&&(h[2]=0,V=pn(n,b,h,z),V&&(Q=V[2]-b[2],"z"===S?n.moveSelection(0,0,Q):n.sm().each(function(g){_h(g)&&n.isSizeEditable(g)&&($=g.getScaleY()+Q/100,O=$/g.getScaleY(),g.setScaleY($),Cl(K)&&(g.setScaleX(g.getScaleX()*O),g.setScaleTall(g.getScaleTall()*O)))}))),!V)return;J.p3=V}else if(g===um){var d=J.div;d||(d=J.div=rr(),Uo(J.getView(),d),d.op=w,d.style.background=n.getRectSelectBackground()),n.fi({kind:n._rectSelecting?"betweenRectSelect":"beginRectSelect",event:K}),n._rectSelecting=1,d.rect=Pb(d.op,R),yk(d,d.rect)}else if("pinch"===g&&2===Xh(K)){n.fi({kind:n._pinching?"betweenPinch":"beginPinch",event:K}),n._pinching=1;var Q=yi(K);n.handlePinch(Q,J.dist),J.dist=Q}else"pan"===g||Cl(K)?J.pan(K,G,o):"none"===g||n.isFirstPersonMode()||(lk(K)?J.rotate(K,e,j):(J.pan(K,G,0),n.isWalkable()&&(n.fi({kind:n._walking?"betweenWalk":"beginWalk",event:K}),n._walking=1,n.walk(o/n.getHeight()*n.getCenterInfo().height))));J.point=R}},pan:function(I,H,k){var j=this.gv;if(j.isPannable()){var y=j.getWidth(),A=j.getHeight();if(!y||!A)return;var W=j.getCenterInfo(),U=H/y*W.width,e=-1*k/A*W.height;j.fi({kind:j._panning?"betweenPan":"beginPan",event:I}),j._panning=1,j.pan(-U,-e)}},rotate:function(M,F,H){var R=this.gv;R.isRotatable()&&(R.fi({kind:R._rotating?"betweenRotate":"beginRotate",event:M}),R._rotating=1,R.rotate(F,H))},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(t){var r=this,Y=r.gv,k=Y.dm(),M=r.div;if(M){var b=Y.getDatasInRect(M.rect);if(!b.isEmpty()){var H=Y.sm(),D=H.toSelection();b.each(function(s){H.co(s)?D.remove(s):D.add(s)}),H.ss(D)}Gp(M)}Y._moving&&(delete Y._moving,Y.fi({kind:"endMove",event:t}),Y.onMoveEnded(),k.endTransaction()),Y._panning&&(delete Y._panning,Y.fi({kind:"endPan",event:t}),Y.onPanEnded()),Y._rotating&&(delete Y._rotating,Y.fi({kind:"endRotate",event:t}),Y.onRotateEnded()),Y._86O&&(delete Y._86O,Y.fi({kind:"endEditRotation",event:t}),k.endTransaction()),Y._87O&&(delete Y._87O,Y.fi({kind:"endEditScale",event:t}),k.endTransaction()),Y._pinching&&(delete Y._pinching,Y.fi({kind:"endPinch",event:t}),Y.onPinchEnded()),Y._rectSelecting&&(delete Y._rectSelecting,Y.fi({kind:"endRectSelect",event:t}),Y.onRectSelectEnded()),Y._walking&&(delete Y._walking,Y.fi({kind:"endWalk",event:t}),Y.onWalkEnded()),r.dist=r.point=r._62O=r.p3=r.movedata=r.div=r._57I=r._32Q=r._31Q=r.foward=U}});var sb=gf.MapInteractor=function(f){Sc(sb,this,[f]),this._minPhi=0,this._maxPhi=5*D/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};lf("MapInteractor",jm,{handle_contextmenu:function(U){td(U)},handle_mousewheel:function(v){this.gv.handleScroll(v,v.wheelDelta/40)},handle_DOMMouseScroll:function(C){2===C.axis&&this.gv.handleScroll(C,-C.detail)},handle_keydown:function(R){this.gv.handleKeyDown(R)},handle_mousedown:function(X){this.handle_touchstart(X)},handle_touchstart:function(e){td(e);var F=this,p=F.gv;if(p.setFocus(e)){p.lp(e);var n=p.getDataInfoAt(e),s=n?n.data:U,W=n?n.part:U;if(!s||!p.isInteractive(s)){var Y=F.editing={point:p.lp(e)};$d?Y.touch=!0:(Y.touch=!1,Y.pan="left"===this.panButton===lk(e)),Ti(F,e)}qc(e)?p.handleDoubleClick(e,s,W):p.handleClick(e,s,W)}},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(){},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowTouchMove:function(Q){var O=this,R=O.gv,q=O.editing;if(q){var V=R.lp(Q),n=q.point,Z=V.x-n.x,a=V.y-n.y;if(!q.moved){if(Math.abs(Z)<O.threshold&&Math.abs(a)<O.threshold&&!(Q.touches&&Q.touches.length>1))return;q.moved=!0}if(q.point=V,q.touch){var $=Q.touches.length;if(2!==$)O.pan(Q,Z,a);else{if(1>=$)return;var I=Q.touches,k={x:I[0].clientX,y:I[0].clientY},K={x:I[1].clientX,y:I[1].clientY},G={x:K.x-k.x,y:K.y-k.y},H=q.lastCenter,A=Math.atan2(G.y,G.x),e=q.theta,P=0;e==U?e=q.theta=A:(P=A-e,q.thetaStarted||Math.abs(P)>O.touchRotateThreshold?(q.thetaStarted=!0,q.theta=A):P=0);var y=D*(k.y+K.y)/2/R.getHeight(),L=q.phi,Y=0;L==U?L=q.phi=y:(Y=y-L,q.phiStarted||Math.abs(Y)>O.touchRotateThreshold?(q.phiStarted=!0,q.phi=y):Y=0);var c,f=Math.sqrt(G.x*G.x+G.y*G.y),m=q.vlen;if(m){var N=k.x-H.x,s=k.y-H.y,F=K.x-H.x,W=K.y-H.y,v=Math.sqrt(N*N+s*s),C=Math.sqrt(F*F+W*W),o=m/2,B=O._sign2(v-o),_=O._sign2(C-o);0>B*_||0===B&&0===_?(c=1,q.vlen=f):(c||(c=f/m),q.scaleStarted||Math.abs(c-1)>O.touchScaleThreshold?(q.vlen=f,q.scaleStarted=!0):c=1)}else m=q.vlen=f,c=1;1!==c&&R.setZoom(c),(Y||P)&&O.rotate(Q,P,-Y),q.lastCenter={x:(K.x+k.x)/2,y:(K.y+k.y)/2}}}else if(q.pan)O.pan(Q,Z,a);else{var d=R.getWidth(),T=R.getHeight();if(!d||!T)return;var x=-E*Z/d,M=-E*a/T;O.rotate(Q,x,M)}}},_sign2:function(q){return Math.abs(q)<this._touchScaleCheckAccuracy?0:q>0?1:-1},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(I){var h=this,R=h.editing;if(h.editing=null,R){var y=h.gv;if(!R.moved&&R.pan){var W=y.getDataAt(I);W?y.sm().setSelection([W]):y.sm().clearSelection()}else y._panning=null,y._rotating=null,y.fi({kind:R.pan?"endPan":"endRotate",event:I})}},pan:function(n,c,G){var a=this,E=a.gv;if(E.isPannable()){var R=E.getWidth(),N=E.getHeight();if(R&&N){var I=E.getCenterInfo(),Q=-c/R*I.width,t=1*G/N*I.height;E.fi({kind:E._panning?"betweenPan":"beginPan",event:n}),E._panning=1;var h=a.keepHorizon,i=a.editing.touch;if((i&&n.touches&&n.touches.length>1||!i&&Cl(n))&&(h=!h),!h)return E.pan(Q,t);if(Q||t){var T=wh(E),l=[T[0]*Q,T[4]*Q,T[8]*Q],Z=[T[1],0,T[9]],u=Math.sqrt(Z[0]*Z[0]+Z[2]*Z[2]);u&&(Z=[Z[0]/u*t,0,Z[2]/u*t]);var g=l[0]+Z[0],w=l[1]+Z[1],Y=l[2]+Z[2],X=E._center,d=E._eye;X[0]+=g,X[1]+=w,X[2]+=Y,d[0]+=g,d[1]+=w,d[2]+=Y,E.fp(Ee,U,d),E.fp(fs,U,X)}}}},rotate:function(p,U,j){var H=this,Z=H.gv;if(Z.isRotatable()){var o=Z._center,t=Z._eye,f=pd(t,o),d=i(P(f[0]*f[0]+f[2]*f[2]),f[1]),e=d+j;e=Math.max(H.minPhi,Math.min(H.maxPhi,e)),j=e-d,Z.fi({kind:Z._rotating?"betweenRotate":"beginRotate",event:p}),Z._rotating=1,Z.rotate(U,j)}}}),Z.defineProperties(sb.prototype,{panButton:{get:function(){return this._panButton},set:function(q){this._panButton=q}},minPhi:{get:function(){return this._minPhi},set:function(s){this._minPhi=s}},maxPhi:{get:function(){return this._maxPhi},set:function(y){this._maxPhi=y}},keepHorizon:{get:function(){return this._keepHorizon},set:function(f){this._keepHorizon=f}},threshold:{get:function(){return this._threshold},set:function(k){this._threshold=k}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(z){this._touchScaleThreshold=z}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(Q){this._touchRotateThreshold=Q}}});var Od=function(Y){this.gv=Y};ob(Od,Z,{_iv:!0,iv:function(){this._iv=!0},face:function(R,S){var Y=this,P=Y.gv.getGL();if(!P||!_h(R))return U;var z=S.x,$=S.width,B=S.height,Q=Y.height-S.y-B,o=d($/2),y=new Uint8Array(4*$*B),_=0;for(Y.iv(),Y.validate(R),We(P,Y.frame),P.readPixels(z,Q,$,B,P.RGBA,P.UNSIGNED_BYTE,y),wp(P),Y.iv();o>=_;_++)for(var K=o-_,W=o+_,N=K;W>=N;N++)for(var E=K;W>=E;E++)if(N===K||N===W||E===K||E===W){var f=Dr.m[y[4*(N*$+E)]];if(f)return f}},get:function(q,z){this.validate();var a=this,C=a.gv.getGL();if(!C)return U;var Q,f,p=q.x,t=q.width,c=q.height,h=a.height-q.y-c,Z=d(t/2),g=new Uint8Array(4*t*c),R=0,E=g.length,o=z?U:new vc,T=z?U:{};if(We(C,a.frame),C.readPixels(p,h,t,c,C.RGBA,C.UNSIGNED_BYTE,g),wp(C),z){for(;Z>=R;R++)for(var A=Z-R,j=Z+R,$=A;j>=$;$++)for(var G=A;j>=G;G++)if(($===A||$===j||G===A||G===j)&&(Q=a.info(g,4*($*t+G))))return Q}else for(;E>R;R+=4)Q=a.info(g,R),Q&&(f=Q.data,T[f._id]||(o.add(f),T[f._id]=f));return o},info:function(p,W){return this.colorMap[(p[W]<<16)+(p[W+1]<<8)+p[W+2]+((127&p[W+3])<<24)]},validate:function(J){var O=this,R=O.gv,h=R.getGL();if(h){var w=R.getWidth(),m=R.getHeight(),g=h.RGBA,V=h.TEXTURE_2D,t=h.RENDERBUFFER,G=h.FRAMEBUFFER;O.texture||(O.texture=xi(h),O.render=h.createRenderbuffer(),O.frame=h.createFramebuffer()),(O.width!==w||O.height!==m)&&(Pc(h,O.texture),h.texImage2D(V,0,g,w,m,0,g,h.UNSIGNED_BYTE,U),ne(h,h.TEXTURE_MIN_FILTER,h.LINEAR),h.bindRenderbuffer(t,O.render),h.renderbufferStorage(t,h.DEPTH_COMPONENT16,w,m),We(h,O.frame),h.framebufferTexture2D(G,h.COLOR_ATTACHMENT0,V,O.texture,0),h.framebufferRenderbuffer(G,h.DEPTH_ATTACHMENT,t,O.render),Pc(h,U),h.bindRenderbuffer(t,U),wp(h),O.width=w,O.height=m),O._iv&&(O._iv=!1,We(h,O.frame),R._42(J||(O.colorMap={}),1),wp(h))}}});var ls=function(m){this.gv=m};ob(ls,Z,{gap:0,size:0,_42:function(f,y){var b=this,F=b.gv,I=F._gridGap,J=F._gridSize;if(F._gridVisible){if(b.gap!==I||b.size!==J){for(var z=[],X=F._gridSize/2,d=I*X,V=0;2*X+1>V;V++){var i=6*V,K=6*(2*X+1)+i;z[i]=-d,z[i+1]=0,z[i+2]=-d+V*I,z[i+3]=d,z[i+4]=0,z[i+5]=-d+V*I,z[K]=-d+V*I,z[K+1]=0,z[K+2]=-d,z[K+3]=-d+V*I,z[K+4]=0,z[K+5]=d}b.vs=new Nm(z),b.gap=I,b.size=J}zr(F),xg(f,y),Nr(f),kr(f,y,1,F._gridColor,F._buffer.vs,b.vs),mh(f,0,b.vs.length/3,f.LINES),zj(f),fl(f,y)}else b.vs=b.gap=b.size=U}});var jj=function(r){this.gv=r};ob(jj,Z,{_42:function(_,J){var e=this.gv,m=e._buffer.vs,v=e._axisXColor,w=e._axisYColor,V=e._axisZColor,u=e._originAxisVisible,Q=e._centerAxisVisible;if(u||Q){var c=F?_.TRIANGLES:_.TRIANGLE_FAN,D=_.LINES;if(zr(e),xg(_,J),Nr(_),u){var Y=e.getCenterInfo(),S=s(Y.width,Y.height)/5,z=.8*S,I=.05*S;kr(_,J,1.5,v,m,new Nm([0,0,0,S,0,0,z,I,0,z,0,I,z,-I,0,z,0,-I,z,I,0,0,0,0,0,S,0,I,z,0,0,z,I,-I,z,0,0,z,-I,I,z,0,0,0,0,0,0,S,I,0,z,0,I,z,-I,0,z,0,-I,z,I,0,z])),mh(_,0,2,D),mh(_,1,6,c),kr(_,J,U,w),mh(_,7,2,D),mh(_,8,6,c),kr(_,J,U,V),mh(_,14,2,D),mh(_,15,6,c)}if(Q){var W=e._center,k=W[0],P=W[1],h=W[2],Y=e.getPositionInfo(W);S=s(Y.width,Y.height)/20,kr(_,J,1.5,v,m,new Nm([k,P,h,k+S,P,h,k,P,h,k,P+S,h,k,P,h,k,P,h+S])),mh(_,0,2,D),kr(_,J,U,w),mh(_,2,2,D),kr(_,J,U,V),mh(_,4,2,D)}zj(_),fl(_,J)}}});var Wd=function(Q){this.gv=Q,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Wd.Mode.Disable};Wd.Mode={Disable:0,Selection:1,MouseOver:2},ob(Wd,Z,{onMouseOver:function(a){u.preventDefault(a);var J=this.gv.getDataAt(a);J!==this.mouseOverData&&(this.mouseOverData=J,this.gv.iv())},setFetchTargetFunc:function(J){this.fetchTargetFunc=J},_42:function(s,p){var $,R=this,Q=R._mode;if(Q!==Wd.Mode.Disable&&(Q===Wd.Mode.Selection?$=R.gv.sm().getSelection().toArray(function(g){return g.s("highlight.visible")}):Q===Wd.Mode.MouseOver&&R.mouseOverData&&R.mouseOverData.s("highlight.visible")&&($=[R.mouseOverData]),R.fetchTargetFunc&&($=R.fetchTargetFunc($)),$&&$.length)){var C=R.gv,h=C.vr.isPresenting(),E=C.getWidth();if(h){var t=C.getWidth;E/=2,C.getWidth=function(){return E};var Z=C.getViewport()}var o,F=C.getDevicePixelRatio(),i=E*F,U=C.getHeight()*F;(o=R._renderTarget)?o.setSize(s,i,U):R._renderTarget=o=new gf.RenderTarget(C,s,i,U),We(s,o.frame),C.drawFilter=function(G){return $.indexOf(G)<0?!0:void 0},C._42({}),C.drawFilter=null,wp(s),h&&(C.getWidth=t,C.setViewport(s,Z[0],Z[1],Z[2],Z[3])),R.shader||(R.shader=new gc.Shader(s,kp.vs,kp.fs));var _=R.shader;if(R.shader.bind(),s.enable(s.BLEND),s.activeTexture(s.TEXTURE0+0),s.bindTexture(s.TEXTURE_2D,o.texture),_.uniforms.image=0,_.uniforms.textureSize=[i,U],_.uniforms.edgeWidth=V["highlight.width"],R.highlightColor!==V["highlight.color"]){var w=Pj(R.highlightColor=V["highlight.color"]);R.highlightColorData=[w[0]/255,w[1]/255,w[2]/255,w[3]/255]}_.uniforms.edgeColor=R.highlightColorData,R.ibuffer?(R.ibuffer.upload(),R.vbuffer.upload()):(R.ibuffer=gc.Buffer.createIndexBuffer(s,new Uint16Array([0,2,1,1,2,3])),R.vbuffer=gc.Buffer.createVertexBuffer(s,new Float32Array([0,0,1,0,0,1,1,1]))),_.attributes.pos.pointer(R.vbuffer),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),s.disable(s.BLEND),s.bindTexture(s.TEXTURE_2D,null),s.useProgram(p)}}}),Z.defineProperties(Wd.prototype,{mode:{get:function(){return this._mode},set:function(P){var L=this._mode;P!==L&&(this._mode=P,P===Wd.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):L===Wd.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var kp={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},ac=function(f){this.gv=f},Rk="edit_tx",vp="edit_ty",md="edit_tz",ql="edit_rx",Pr="edit_ry",Up="edit_rz",kf="edit_sx",Df="edit_sy",Cd="edit_sz",Ri={};Ri[Rk]=1,Ri[vp]=1,Ri[md]=1,Ri[ql]=1,Ri[Pr]=1,Ri[Up]=1,Ri[kf]=1,Ri[Df]=1,Ri[Cd]=1,ob(ac,Z,{_42:function(I,a,f){var p=this,Y=p.gv,X=Y.sm().ld();if(X&&Y.isEditable(X)&&!Y.isEditHelperDisabled()&&_h(X)&&(!Y.isFirstPersonMode()||!Y.isMouseRoamable()&&!$d)){zr(Y);var v,g,S=Y.isMovable(X),H=Y.isRotationEditable(X),s=Y.isSizeEditable(X),D=Y._axisXColor,J=Y._axisYColor,m=Y._axisZColor,F=Y._editSizeColor,l=X.p3(),L=Pq(Y.getEye(),l)/10,r=L/(f?5:10),d=.7*L,C=.4*d,B=l[0],Q=l[1],P=l[2];v=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],S&&p._17O(I,a,X,f,Rk,D,v,[B,Q-r,P,B+d,Q-r,P,B+d,Q,P,B+d,Q,P,B,Q,P,B,Q-r,P,B,Q-r,P+r,B+d,Q-r,P+r,B+d,Q-r,P,B+d,Q-r,P,B,Q-r,P,B,Q-r,P+r]),g=B+d,s&&p._17O(I,a,X,f,kf,F,v,[g,Q-r,P,g+C,Q-r,P,g+C,Q,P,g+C,Q,P,g,Q,P,g,Q-r,P,g,Q-r,P+r,g+C,Q-r,P+r,g+C,Q-r,P,g+C,Q-r,P,g,Q-r,P,g,Q-r,P+r]),g+=C,H&&p._17O(I,a,X,f,ql,D,v,[g,Q-r,P,g+C,Q-r,P,g+C,Q,P,g+C,Q,P,g,Q,P,g,Q-r,P,g,Q-r,P+r,g+C,Q-r,P+r,g+C,Q-r,P,g+C,Q-r,P,g,Q-r,P,g,Q-r,P+r]),v=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],S&&p._17O(I,a,X,f,vp,J,v,[B,Q,P,B,Q+d,P,B-r,Q+d,P,B-r,Q+d,P,B-r,Q,P,B,Q,P,B,Q,P,B,Q,P-r,B,Q+d,P-r,B,Q+d,P-r,B,Q+d,P,B,Q,P]),g=Q+d,s&&p._17O(I,a,X,f,Df,F,v,[B,g,P,B,g+C,P,B-r,g+C,P,B-r,g+C,P,B-r,g,P,B,g,P,B,g,P,B,g,P-r,B,g+C,P-r,B,g+C,P-r,B,g+C,P,B,g,P]),g+=C,H&&p._17O(I,a,X,f,Pr,J,v,[B,g,P,B,g+C,P,B-r,g+C,P,B-r,g+C,P,B-r,g,P,B,g,P,B,g,P,B,g,P-r,B,g+C,P-r,B,g+C,P-r,B,g+C,P,B,g,P]),v=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],S&&p._17O(I,a,X,f,md,m,v,[B,Q,P,B,Q,P+d,B,Q-r,P+d,B,Q-r,P+d,B,Q-r,P,B,Q,P,B,Q-r,P,B-r,Q-r,P,B-r,Q-r,P+d,B-r,Q-r,P+d,B,Q-r,P+d,B,Q-r,P]),g=P+d,s&&p._17O(I,a,X,f,Cd,F,v,[B,Q,g,B,Q,g+C,B,Q-r,g+C,B,Q-r,g+C,B,Q-r,g,B,Q,g,B,Q-r,g,B-r,Q-r,g,B-r,Q-r,g+C,B-r,Q-r,g+C,B,Q-r,g+C,B,Q-r,g]),g+=C,H&&p._17O(I,a,X,f,Up,m,v,[B,Q,g,B,Q,g+C,B,Q-r,g+C,B,Q-r,g+C,B,Q-r,g,B,Q,g,B,Q-r,g,B-r,Q-r,g,B-r,Q-r,g+C,B-r,Q-r,g+C,B,Q-r,g+C,B,Q-r,g])}},_17O:function(u,Y,N,z,C,$,o,T){var K=this.gv._buffer;$p(u,Y,z,!0,N,C),Db(u,Y,U,!0,U,!0,U,!1),bj(u,Y.uDiffuse,$),yp(u,K.vs,new Nm(T),Y.aPosition),yp(u,K.ns,new Nm(o),Y.aNormal),Nr(u),mh(u,0,12),zj(u),ze(u,Y)}});var gi=o.Raycaster=function(k){this.gv=k,this.maxTriangleTest=1/0};oi("Raycaster",Z,{intersect:function(o){var E=this,N=E.gv,W=N.getDataAt(o);return W?E.intersectObject(o,W):null},intersectObjects:function(g,c,l){var n,F,P,K,D=this,J=1/0,S=g.origin||(new sc).fromArray(D.gv.getEye()),Q=D.maxTriangleTest,s=[];return c.forEach(function(m){l&&l(m)===!1||m.s("intersect")!==!1&&s.push(m)}),s.sort(function(O,A){return S.distanceToSquared2(O.p3())-S.distanceToSquared2(A.p3())}),D.countTriangles=0,s.forEach(function(N){D.countTriangles>Q||(n=D.intersectObject(g,N),n&&(F=S.distanceToSquared(n.world),J>F&&(P=N,K=n,J=F)))}),D.countTriangles=0,{data:P,intersect:K}},intersectObject:function(M,x){if(M instanceof vi)return this._intersectObjectImpl(M,x);var E,T,s=this,p=s.gv;T=p.unproject(M);var U=p.getEye();p.isOrtho()?(E=pd(p.getCenter(),U),E[0]+=E[0],E[1]+=E[1],E[2]+=E[2]):E=U,E=new sc(E);var i=new sc(T).sub(E).normalize(),B=new o.Math.Ray(E,i);return s._intersectObjectImpl(B,x)},_intersectObjectImpl:function(){function j(){var M=new sc;return M.subVectors(d,v),C.subVectors(S,v),M.cross(C).normalize(),M}function y(e,S,h,f,x,J,a){return Mq.barycoordFromPoint(e,S,h,f,z),x.multiplyScalar(z.x),J.multiplyScalar(z.y),a.multiplyScalar(z.z),x.add(J).add(a),x.clone()}var N=new qm,A=new qm,Y=new vi,I=new sc,b=new sc,H=new sc,P=new sc,Z=new sc,S=new sc,v=new sc,d=new sc,B=new po,Q=new po,r=new po,C=new sc,_={vs:dh,is:vr,uv:ar},z=new sc;return function(C,z){var m=this.gv.getData3dUI(z),O=z.mat||m.mat;if(O){N.fromArray(O),A.getInverse(N),Y.copy(C).applyMatrix4(A);var x,f,s="body",K=m.shapeModel;if(K||(K=xc(m)),K||(z instanceof o.Node&&!(z instanceof o.Shape)?(x=!0,K=_):(f=!0,K=[m.left,m.front,m.right,m.back,m.top,m.bottom])),!K)return console.log("Can not find shape model."),null;zc(K)||(K=[K]);var W,R,u,q,T,F,a,J,V,g,t,D,w,c,L,e,n=1/0,E=["","top_","bottom_"],$=!1;for(W=0,R=K.length;R>W;W++)if(w=K[W])for(u=0,q=E.length;q>u;u++)if(c=E[u],a=w[c+"vs"],J=w[c+"is"],V=w[c+"uv"]||w[c+"tuv"],a){if(L=w[c+"boundingBox"]){var t=Y.intersectBox(L);
if(!t)continue;if(Y.origin.distanceTo(t)>n)continue;e=!1}else w[c+"boundingBox"]=L=new o.Math.Box3,e=!0;for(T=0,F=J?J.length:a.length/3;F>T;T+=3)this.countTriangles++,J?(b.fromArray(a,3*J[T]),H.fromArray(a,3*J[T+1]),P.fromArray(a,3*J[T+2])):(b.fromArray(a,3*T),H.fromArray(a,3*(T+1)),P.fromArray(a,3*(T+2))),e&&(L.expandByPoint(b),L.expandByPoint(H),L.expandByPoint(P)),g=Y.intersectTriangle(b,H,P,!0,I),g&&(D=Y.origin.distanceTo(g),n>D&&(n=D,Z.copy(g),S.copy(b),v.copy(H),d.copy(P),""!==c?s=c.slice(0,-1):x?s=Cp[Math.floor(T/6)]:f&&(s=Cp[W]),V&&($=!0,J?(B.fromArray(V,2*J[T]),Q.fromArray(V,2*J[T+1]),r.fromArray(V,2*J[T+2])):(B.fromArray(V,2*T),Q.fromArray(V,2*(T+1)),r.fromArray(V,2*(T+2))))))}if(!isFinite(n))return null;var i,U=Z.clone().applyMatrix4(N);$&&(i=y(Z,S,v,d,B,Q,r));var k=j(S,v,d),X=j(S.applyMatrix4(N),v.applyMatrix4(N),d.applyMatrix4(N)),h=Y.direction.dot(k);return h>0&&(k.multiplyScalar(-1),X.multiplyScalar(-1)),{world:U,local:Z.clone(),worldNormal:X,normal:k,uv:i,part:s}}}}()});var Wm=function(Z,Y){this.gv=Z,this.s=function(y,a,s){return a==U&&(a=s),a==U?Y.getStyle(y):ws(a,Y,Z)},this.data=Y};ob(Wm,Z,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(y,M,I,A){var B=this,r=B.data;if(!(r instanceof Vf)){var K,O,i,S,o,q,Q,D=B.gv,n=r._id,e=B.s("shape3d.alwaysOnTop")?null:B.s("batch"),w=D._batchIndexMap,F=D._batchModelMap,z=D.isSelectable(r),l=D.getBrightness(r),k=l!=U&&1!==l;if(B.needValidate(y)){if(i=ap(w,F,r,e),B.validate(i,e?Mk[e]||dg:U),i&&(S=w[n],o=S.size=i.vs.length/3-S.begin,Q=i.rs))for(l=k?l:1,q=0;o>q;q++)Q.push(l);if(_h(r)){var t=D.getWireframeGeometry(r);if(t)fr(D,r,t);else{var X=D.getWireframe(r);X&&fr(D,r,X)}}B.labelInfo=B.label2Info=B.noteInfo=B.note2Info=B._38o=U,B._24O(Fd,"getLabel"),B._24O(Le,"getLabel2"),B._26O(Hq,"getNote"),B._26O(Xi,"getNote2"),B._15O(),B.interactiveInfo=D.isInteractive(r)?{}:U,B._iv=!1}k&&bj(y,M.uBrightness,l),bj(y,M.uAlphaTest,B.s("alphaTest")),bj(y,M.uUseEnvMap,r.s("envmap")?!0:!1),bj(y,M.uReflectivity,r.s("envmap")||.01),O=$p(y,M,I,z,r,zd),O&&(eg(O,w[n],F),eg(O,D._polylineIndexMap[n],D._polylineModelMap),eg(O,D._wireframeIndexMap[n],D._wireframeModelMap)),w[n]||B._80o(y,M,A),D.isLabelVisible(r)&&((K=B.labelInfo)&&($p(y,M,I,z,r,Fd),B._28O(K,Fd,A)),(K=B.label2Info)&&($p(y,M,I,z,r,Le),B._28O(K,Le,A))),D.isNoteVisible(r)&&((K=B.noteInfo)&&($p(y,M,I,z,r,Hq),B._29O(K,Hq,A)),(K=B.note2Info)&&($p(y,M,I,z,r,Xi),B._29O(K,Xi,A))),(K=B._38o)&&B._99O(y,M,K,I,z,A),k&&bj(y,M.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Mp},_80o:function(){},dispose:function(){},_calcAnchorMat:function(B){if(B.hasOwnProperty("_anchor")||B.hasOwnProperty("_anchorElevation")){var V=B.getAnchor3d(),J={x:V.x-.5,y:V.y-.5,z:V.z-.5},t=vk();return hk(t,[-J.x,-J.y,-J.z]),t}},getBodyColor:function(d){var F=this.data,Z=this.gv.getBodyColor(F);return Z?Z:d?F.getStyle(d):U},_24O:function(P,G){var o=this,g=o.data,R=o.gv,f=o.s,E=R[G](g);if(E!=U){var F=f(P+".scale"),B=f(P+".max"),y=o[P+"Info"]={label:E,textureScale:f(P+".texture.scale"),color:R[G+"Color"](g),font:f(P+".font"),align:f(P+".align"),background:R[G+"Background"](g)},i=y.rect=Bj(y,E);B>0&&B<i.width&&(y.labelWidth=i.width,i.width=B),i.x=i.y=0,i.width*=F,i.height*=F,y.mat=o._16O(f(P+".autorotate"),f(P+".position"),i,f(P+".face"),f(P+".t3"),f(P+".r3"),f(P+".rotationMode"));var $=i.width/2,q=i.height/2;y.vs=new Nm([-$,q,0,-$,-q,0,$,-q,0,$,q,0]),i.width/=F,i.height/=F}},_26O:function(S,n){var Z=this,d=Z.data,b=Z.gv,i=Z.s,f=b[n](d);if(f!=U){var g=i(S+".scale"),C=this[S+"Info"]={note:f,textureScale:i(S+".texture.scale"),expanded:i(S+".expanded"),font:i(S+".font"),color:i(S+".color"),align:i(S+".align"),borderWidth:i(S+".border.width"),borderColor:i(S+".border.color"),background:b[n+"Background"](d)};if(C.expanded){var W=i(S+".max"),x=Bj(C,f);x.width+=6,x.height+=2,W>0&&W<x.width&&(C.labelWidth=x.width,x.width=W);var $={x:-x.width/2,y:-8-x.height,width:x.width,height:x.height+8}}else $={x:-6,y:-18,width:12,height:18};C.mat=Z._16O(i(S+".autorotate"),i(S+".position"),U,i(S+".face"),i(S+".t3"),i(S+".r3"),i(S+".rotationMode")),C.rect=$,1!==g&&($=Cn($),$.x*=g,$.height*=g,$.y=-$.height,$.width*=g);var F=$.x,O=$.y,E=$.width,k=$.height;C.vs=new Nm([F,-O,0,F,-O-k,0,F+E,-O-k,0,F+E,-O,0])}},_28O:function(z,q,k){if(k(this.s(q+".transparent"))){var W=z.rect,D=z.textureScale,I=W.width*D,L=W.height*D;if(I>=1&&L>=1){var u=hn(I,L);1!==D&&(u.translate(u,W.x,W.y),u.scale(D,D),u.translate(u,-W.x,-W.y)),Nf(u,z),u.restore(),Rc(this,q,z.mat,z.vs,!0)}}},_29O:function(j,i,f){if(f(this.s(i+".transparent"))){var N=j.rect,O=j.textureScale,u=N.x,o=N.y,w=N.width*O,v=N.height*O;if(w>=1&&v>=1){N.x=N.y=0;var G=hn(w,v);1!==O&&G.scale(O,O),Vh(G,j),G.restore(),N.x=u,N.y=o,Rc(this,i,j.mat,j.vs,!1)}}},_99O:function(z,q,l,D,b,$){if(l){var B=this,p=B.gv,V=B.data,L=p._buffer,t=p._1O,J=l.icons;for(var Y in J){var _=J[Y],F=l.rects[Y];if(F&&$(ws(_.transparent,V,p))){$p(z,q,D,b,V,Y);var g=ws(_.shape3d,V,p),s=g?[g]:ws(_.names,V,p),n=s?s.length:0,i=ws(_.textureScale,V,p)||1,O=ws(_.light,V,p);O==U&&(O=g?!0:!1),Db(z,q,ws(_.blend,V,p),O,ws(_.opacity,V,p),ws(_.reverseFlip,V,p),ws(_.reverseColor,V,p),ws(_.reverseCull,V,p));for(var f=0;n>f;f++){var K=s[f],T=F[f];if(xp(B,T.mat),g)Ab(p,V,xc(B,g),B);else{var j=Dl(K);if(j){var o=T.width*i,X=T.height*i;if(o>=1&&X>=1){var S=hn(o,X);Dj(S,j,ws(_.stretch,V,p),0,0,o,X,V,p),S.restore(),xi(z,Tl,t),Nr(z,q,t,ws(_.discardSelectable,V,p),L.uv,Qe),yp(z,L.vs,T.vs,q.aPosition),Pl(z,L.ns,Yi,q.aNormal),yl(z,L.is,pl),bd(z,0,pl.length),zj(z,q,t)}}}Gn(p)}ze(z,q)}}}}});var xb=function(g,p){Sc(xb,this,[g,p])};ob(xb,Wm,{_16O:function(u,p,o,e,T,l,Q,m,S){var J=this.data,Y=J.getFinalScale3d(),w=Bs(p,Y,o,e,m,S);if(J.hasOwnProperty("_anchor")||J.hasOwnProperty("_anchorElevation")){var V=J.getAnchor3d();w[0]-=(V.x-.5)*Y[0],w[1]-=(V.y-.5)*Y[1],w[2]-=(V.z-.5)*Y[2]}return Zp(vk(),w,J.p3(),e,T,l,Q,u,J.getFinalRotation3d(),J.getRotationMode())},clear:function(){var A=this;A.faceMat=A.mat=A.shapeModel=A.left=A.right=A.front=A.back=A.top=A.bottom=A.csg=U},needValidate:function(x){if(this._iv)return this._validateFrameId=x._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var h=x._renderInfo.frame;if(this._validateFrameId!==h)return this._validateFrameId=h,!0}return!1},validate:function(s,r){var W=this,o=W.gv,H=W.data,q=W.shapeName=W.s(Hg),d=xc(W,q);W._updateAutoRotation(),W._updateFixSize2d(),W._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(pq(o,H,"_wireframeModelMap","_wireframeIndexMap"),pq(o,H,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var R=Nn(H,o.getMat(H),d?W.s("shape3d.scaleable"):!0),w=W._calcAnchorMat(H);if(w&&Wq(R,R,w),H.mat=R,W.clear(),d||q==U)if(s){var X=[];d?$b(o,H,d,W,W.getBodyColor(),[R],s,X):(Lq(o,H,s,r,R,Qg,X,If),Lq(o,H,s,r,R,Td,X,cb),Lq(o,H,s,r,R,Ij,X,ec),Lq(o,H,s,r,R,Lb,X,Fc),Lq(o,H,s,r,R,nd,X,Gr),Lq(o,H,s,r,R,Rd,X,zo)),X.length&&(Je(s.vs,X),Je(s.ns,_p(X)))}else W.mat=R,(W.shapeModel=d)||(W._cubeUvs=null,W.vf(Qg,0),W.vf(Td,16),W.vf(nd,8),W.vf(Rd,24),W.vf(Ij,32),W.vf(Lb,40))},_updateAutoRotation:function(){var V=new di;return function(){var P=this,v=P.data,Z=P.s("shape3d.autorotate");if(!Z)return v._dynamicRotation&&delete v._dynamicRotation,void 0;var m,U=P.gv;m="string"==typeof Z?[Z.indexOf("x")<0?U._eye[0]:U._center[0],Z.indexOf("y")<0?U._eye[1]:U._center[1],Z.indexOf("z")<0?U._eye[2]:U._center[2]]:U._eye;var j=U._center,h=v.p3(),p=qk([h[0]+m[0]-j[0],h[1]+m[1]-j[1],h[2]+m[2]-j[2]],h,U._up),D=v.r3();V.set(0,0,0,v.getRotationMode(),!0).setFromRotationMatrix(p),Math.abs(D[0]-V.x)<1e-5&&Math.abs(D[1]-V.y)<1e-5&&Math.abs(D[2]-V.z)<1e-5||(v._dynamicRotation=[V.x,V.y,V.z])}}(),_updateFixSize2d:function(){var m=this,p=m.data,k=m.s("shape3d.fixSizeOnScreen");if(!k)return p._dynamicScale3d&&delete p._dynamicScale3d,void 0;var E=m.gv;p.getFinalScale3d();var g=Nn(p,E.getMat(p)),s=jf([0,0,0],g),c=E.toViewPosition(s);if(!isNaN(c.x)&&!isNaN(c.y)){var y=jf([1,0,0],g),N=E.toViewPosition(y),$=jf([0,1,0],g),G=E.toViewPosition($),l=N.x-c.x,C=G.y-c.y;if(l&&C){var O=p._dynamicScale3d||[1,1,1],r=Dl(p.s("shape3d.image")),R=k[0]>0?k[0]:r?Zb(r,p):20,o=k[1]>0?k[1]:r?Qk(r,p):20,T=Math.abs(l/R),L=Math.abs(C/o);Math.abs(T-1)<.001&&Math.abs(L-1)<.001||(p._dynamicScale3d=[O[0]/T,O[1]/L,O[2]])}}},_updateOverlapping:function(){var a=this,j=a.s("hide.overlapping.group");if(!j)return a._rectOverlapping&&(a._rectOverlapping=g),void 0;var l,B,V,x=a.gv,S=a.data,i=Nn(S,x.getMat(S)),T=1/0,u=1/0,Y=-1/0,$=-1/0,F=S.getAnchor3d(),_=F.x,e=F.y,y=F.z;for(l=0;8>l;l++){if(B=jf([(l>>2)-_,(1&l>>1)-e,(1&l)-y],i),V=x.toViewPosition(B),isNaN(V.x)||isNaN(V.y))return;T=Math.min(T,V.x),Y=Math.max(Y,V.x),u=Math.min(u,V.y),$=Math.max($,V.y)}var o={x:T,y:u,w:Y-T,h:$-u};a._rectOverlapping=x.overlappingBox.isOverlapping(j,o)},getVectorDynamicSize:function(){var I,E=this,k=E.s("shape3d"),D=E.data;if("billboard"===k||"plane"===k||(I=D._currentCubeElementId)!=U){var B,f,i=E.gv,Q=Nn(D,i.getMat(D)),t=D.getAnchor3d(),q=.5-t.x,b=.5-t.y,S=.5-t.z,d=E.s("shape3d.vector.dynamic.maxsize"),r=function(y,x){y[0]+=q,y[1]+=b,y[2]+=S,x[0]+=q,x[1]+=b,x[2]+=S;var p=i.toViewPosition(jf(y,Q)),v=i.toViewPosition(jf(x,Q)),B=p.x-v.x,z=p.y-v.y;return Math.min(d,Math.sqrt(B*B+z*z))};if("billboard"===k)B=r([-.5,0,0],[.5,0,0]),f=r([0,-.5,0],[0,.5,0]);else if("plane"===k)B=r([-.5,0,0],[.5,0,0]),f=r([0,0,-.5],[0,0,.5]);else if(D._currentCubeElementId!=U){var W=3*vr[I+1],T=3*vr[I],M=3*vr[I+2];B=r([dh[W],dh[W+1],dh[W+2]],[dh[M],dh[M+1],dh[M+2]]),f=r([dh[W],dh[W+1],dh[W+2]],[dh[T],dh[T+1],dh[T+2]])}return[B,f]}},getCachedTexture:function(){var n=this,o=n.data,d=o._currentCubeElementId;return d!=U?n._cubeCachedImage?n._cubeCachedImage[d]:null:n._shape3dCachedImage},setCachedTexture:function(z){var v=this,u=v.data,I=u._currentCubeElementId;if(I!=U){if(!v._cubeCachedImage)return v._cubeCachedImage={};v._cubeCachedImage[I]=z}else v._shape3dCachedImage=z},invalidateCachedTexture:function(n){var S,c,j,b=this;if((j=b._shape3dCachedImage)&&(n.deleteTexture(j),b._shape3dCachedImage=null),c=b._cubeCachedImage){for(S in c)n.deleteTexture(c[S]);b._cubeCachedImage=null}},vf:function(U,c){var P=this;if(P.gv.getFaceVisible(P.data,U)){var u=wj(P,U);u.mat&&(P.faceMat=!0);var f=u.uv;if(f){var e=P._cubeUvs;e||(e=P._cubeUvs=new Nm([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var W=0;8>W;W++)e[c+W]=f[W]}return u}},_80o:function(T,L,Z){var J=this;if(J._rectOverlapping)return!0;var k=J.shapeModel;if(k||J.shapeName==U){var h=J.gv,O=J.data,e=h._cube;zr(h,J.mat),k?Ab(h,O,k,J,J.getBodyColor(),Z):(yp(T,e.vs,U,L.aPosition),yp(T,e.ns,U,L.aNormal),Qm(T,e.is),J._18O(T,L,J.left,0,Z),J._18O(T,L,J.front,6,Z),J._18O(T,L,J.right,12,Z),J._18O(T,L,J.back,18,Z),J._18O(T,L,J.top,24,Z),J._18O(T,L,J.bottom,30,Z)),Gn(h),J.faceMat&&(J._18O(T,L,J.left,0,Z,!0),J._18O(T,L,J.front,6,Z,!0),J._18O(T,L,J.right,12,Z,!0),J._18O(T,L,J.back,18,Z,!0),J._18O(T,L,J.top,24,Z,!0),J._18O(T,L,J.bottom,30,Z,!0))}},_18O:function(o,w,d,$,K,C){if(d){if(!K(d.transparent))return;if(C&&!d.mat||!C&&d.mat)return;var y=this.data.s("polygonOffset");y&&Bc(o,y),C&&zr(this.gv,d.mat);var p=this,b=p.data;b._currentCubeElementId=$;var Z=p.gv,I=Z.getTexture(d.texture,b),m=d.uv,T=d.uvScale,f=d.uvOffset,g=d.discardSelectable;I?m?Nr(o,w,I,g,Z._buffer.uv,p._cubeUvs,f,T):Nr(o,w,I,g,Z._cube.uv,U,f,T):Nr(o),Db(o,w,d.blend,d.light,d.opacity,d.reverseFlip,d.reverseColor,d.reverseCull),bj(o,w.uDiffuse,d.color||V["color.empty"]),bd(o,$,6),ze(o,w),zj(o,w,I),C&&Gn(Z),y&&Ad(o),b._currentCubeElementId=null}}});var Qr=function(g,v){Sc(Qr,this,[g,v])};ob(Qr,Wm,{_25Q:1,validate:function(J){var B=this,$=B.gv,Y=B.data,y=B.s,M=y("edge.width"),T=Y._40I,A=Y._41I;if(B.shapeModel=B.info=U,T&&A){var K,j,z,q,o,R,C,L,n,W,h=Y.isLooped(),k=y(Zq),S=u.getEdgeType(k);if(S){var E=S(Y,Tq(B,$,Y,h,k),$,B._19Q);if(!E.points||E.points.isEmpty())return;R=B.info={},C=E.segments,o=E.points,L=o.size();for(var e=T.getElevation(),P=A.getElevation(),I=0;L>I;I++){var p=o.get(I);p.e==U&&(p.e=e+(P-e)*I/(L-1))}n=zm(o.get(0)),W=zm(o.get(L-1));var Z=L%2;0===Z?(R.c1=zm(o.get(L/2-1)),R.c2=zm(o.get(L/2))):R.p3=zm(o.get((L-Z)/2)),R.s1=n,R.s2=zm(o.get(1)),R.t1=zm(o.get(L-2)),R.t2=W}else{o=new vc,R=B.info={};var X=y("edge.offset"),x=y("edge.center"),g=y("edge.source.t3"),t=y("edge.target.t3"),m=T.p3(),O=A.p3();if(g&&(m[0]+=g[0],m[1]+=g[1],m[2]+=g[2]),t&&(O[0]+=t[0],O[1]+=t[1],O[2]+=t[2]),k===Vm){C=y("edge.segments");var N=R.points=y(er)||zg;if(L=N.size()){n=zm(N.get(0)),W=zm(N.get(L-1)),!x&&X&&(z=pd(n,m,!0),X=s(X,Pq(m,n)),m=[m[0]+z[0]*X,m[1]+z[1]*X,m[2]+z[2]*X],z=pd(O,W,!0),X=s(X,Pq(W,O)),O=[O[0]-z[0]*X,O[1]-z[1]*X,O[2]-z[2]*X]);var Z=L%2;0===Z?(K=zm(N.get(L/2-1)),j=zm(N.get(L/2))):R.p3=zm(N.get((L-Z)/2)),R.s1=m,R.s2=n,R.t1=W,R.t2=O}else!x&&X&&(z=pd(O,m,!0),q=Pq(m,O),X=un(X,q),m=[m[0]+z[0]*X,m[1]+z[1]*X,m[2]+z[2]*X],O=[O[0]-z[0]*X,O[1]-z[1]*X,O[2]-z[2]*X]),K=m,j=O;o.add({x:m[0],y:m[2],e:m[1]}),o.addAll(N),o.add({x:O[0],y:O[2],e:O[1]})}else{var l=Tq(B,$,Y,h,k);if(B._19Q||(l=-l),h){var f=m[0],G=m[1],v=m[2],D=T.getTall()/2+l;K=[f-l,G+D,v],j=[f+l,G+D,v],o.add({x:f-l,y:v,e:G}),o.add({x:f-l,y:v,e:G+D}),o.add({x:f+l,y:v,e:G+D}),o.add({x:f+l,y:v,e:G})}else{z=pd(O,m,!0),q=Pq(m,O);var c={x:m[0],y:m[2]},F={x:O[0],y:O[2]},w=Kc(U,c,F,l),b=w.x-c.x,V=w.y-c.y;X=un(X,q),z[0]*=X,z[1]*=X,z[2]*=X,K=[m[0]+z[0]+b,m[1]+z[1],m[2]+z[2]+V],j=[O[0]-z[0]+b,O[1]-z[1],O[2]-z[2]+V],x?(o.add({x:m[0],y:m[2],e:m[1]}),o.add({x:K[0],y:K[2],e:K[1]}),o.add({x:j[0],y:j[2],e:j[1]}),o.add({x:O[0],y:O[2],e:O[1]})):(o.add({x:K[0],y:K[2],e:K[1]}),o.add({x:j[0],y:j[2],e:j[1]}))}}R.c1=K,R.c2=j}R.list=y(Hg)===ab?B.createTubeModel(o,C,M/2,J):B.createLineModel(o,C,M,"edge","edge.dash")}}});var rc=function(h,Y){Sc(rc,this,[h,Y])};ob(rc,xb,{_80o:function(T,Y,O){var e=this,F=e.gv,U=e.shapeModel;zr(F,e.mat),U?Ab(F,e.data,U,e,e.getBodyColor(),O):(qq(e,T,Y,e.left,O),qq(e,T,Y,e.front,O),qq(e,T,Y,e.right,O),qq(e,T,Y,e.back,O),qq(e,T,Y,e.top,O),qq(e,T,Y,e.bottom,O)),Gn(F)},validate:function(n,h){var D,r,o=this,O=o.s,x=o.data,m=x.p3(),P=x._thickness/2,_=x.isClosePath(),T=x.getPoints(),I=x.getSegments(),t=O(Er),X=n&&n.uv;if(o.clear(),0>P)r=o.shapeModel=mc(T,I,O(Yj),O(Pn),t,O(ph),x.getTall(),x.getShapeElevation(),_),O(lc)?O("shape3d.image")||delete r.uv:(delete r.vs,delete r.ns,delete r.uv),O("shape3d.top.image")||delete r.top_uv,O("shape3d.bottom.image")||delete r.bottom_uv;else if(O(Hg)===ab)D=Wl(T,I,t,_),r=o.shapeModel={vs:[]},O("shape3d.image")&&(r.uv=[],r.sum=O(ph)||Lm(D)||1,r.len=0),O(Yj)&&!_&&(r.top_vs=[],O("shape3d.top.image")&&(r.top_uv=[])),O(Pn)&&!_&&(r.bottom_vs=[],O("shape3d.bottom.image")&&(r.bottom_uv=[])),o._12O(D,P);else{var d,Q,c,V,s,H,G,R,w,W;if(D=Wl(T,I,t,_),s=o.vf(nd,X,!1,h),P&&(H=o.vf(Rd,X,!1,h),G=_?U:o.vf(Qg,X,!1,h),R=_?U:o.vf(Td,X,!1,h),w=o.vf(Ij,X,!1,h),W=o.vf(Lb,X,!1,h)),P){for(var g=0,M=D.length;M>g;g++)D[g]=o._tryRemoveBezierPoints(D[g],P);o._12O(D,P)}else s&&D.forEach(function(U){if(V=U.length,V>0)for(d=U[0],c=1;V>c;c++)Q=U[c],o.addV(s.vs,d,Q),d=Q});o._20Q(D),n||(s&&(s.ns=_p(s.vs),Vc(s,"vs"),Vc(s,hf)),P&&(H&&(H.ns=_p(H.vs),Vc(H,"vs"),Vc(H,hf)),G&&(G.ns=_p(G.vs),Vc(G,"vs"),Vc(G,hf)),R&&(R.ns=_p(R.vs),Vc(R,"vs"),Vc(R,hf)),w&&(w.ns=_p(w.vs),Vc(w,"vs"),Vc(w,hf)),W&&(W.ns=_p(W.vs),Vc(W,"vs"),Vc(W,hf))))}var l=o.mat=vk();hk(l,m),xe(l,x.getFinalRotation3d(),x.getRotationMode());var C=x.getScale3d(),b=x._dynamicScale3d;b&&(C[0]*=b[0],C[1]*=b[1],C[2]*=b[2]),si(l,C),hk(l,Tg(m)),n&&(Ol(o,l,n,r),o.clear())},_20Q:function(r){var g,u,p,i,l,s,a,M=this,N=M.front,x=M.back,C=M.top,R=M.bottom,V=N?N.tuv:U,K=x?x.tuv:U,f=C?C.tuv:U,F=R?R.tuv:U,D=0;(V||K||f||F)&&(g=M.s(ph)||Lm(r)||1,r.forEach(function(F){if(u=F.length,u>0)for(s=F[0],p=1;u>p;p++)a=F[p],i=D/g,D+=Pq(s,a),l=D/g,M._14O(N,i,l),M._14O(x,1-l,1-i),M._14O(C,i,l),M._14O(R,i,l),s=a}))},_14O:function(E,W,h){if(E){var S=E.uv,L=E.tuv;if(L){if(S)var D=S[0]+(S[6]-S[0])*W,v=S[1]+(S[7]-S[1])*W,J=S[2]+(S[4]-S[2])*W,c=S[3]+(S[5]-S[3])*W,l=S[2]+(S[4]-S[2])*h,U=S[3]+(S[5]-S[3])*h,k=S[0]+(S[6]-S[0])*h,V=S[1]+(S[7]-S[1])*h;else D=W,v=0,J=W,c=1,l=h,U=1,k=h,V=0;L.push(J,c,l,U,k,V,k,V,D,v,J,c)}}},_13O:function(k){var m=k.uv,f=k.tuv;f&&(m?f.push(m[2],m[3],m[4],m[5],m[6],m[7],m[6],m[7],m[0],m[1],m[2],m[3]):f.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(u,E){var j=u.length;if(4>j)return u;var g,M,D,n,R,s,K=!1,Q=function(A){return u[A]},v=function(t){return u[j-1-t]};for(R=0;1>=R;R++)for(s=R?v:Q,M=s(0),D=s(1),g=2;j-1>g;g++)if(n=s(g),!n.remove)if(n.b){var L=Kc(M,D,n,E);L.adjust?(n.remove=!0,K=!0):(M=D,D=n)}else M=D,D=n;if(!K)return u;var Z=[];for(g=0;j>g;g++)u[g].remove||Z.push(u[g]);return Z},_12O:function(g,z){var b,n,c,x,L,P=this;g.forEach(function(h){if(L=h.length,L>0)for(b={p:h[0],n:!0},x=1;L>x;x++)n=h[x],c=L-1>x?h[x+1]:U,P.addPoint(b,n,c,z,h)})},addPoint:function(X,x,m,N,f){var h,Y,l,$,t,A,r,a,v,w=this,R=X.p,E=X.f,g=X.b,O=w.s("shape3d.side")||Mb,q=w.s("shape3d.start.angle"),I=w.s("shape3d.sweep.angle"),p=w.shapeModel,B=w.data.isClosePath();if(X.n&&(X.n=!1,E=B&&f.length>2?Kc(f[f.length-2],R,x,N):Kc(U,R,x,N),g=Dk(R,E),p?p.top_vs&&w._10O(g,E,O,q,I,p.top_vs,p.top_uv):(h=w.left)&&(w.addV(h.vs,g,E),w._13O(h))),Y=m?Kc(R,x,m,N):B&&f.length>2?Kc(R,x,f[1],N):Kc(R,x,U,N),l=Dk(x,Y),p){var L,s,Q=p.vs,c=p.uv,o=p.sum;for(c&&(L=p.len/o,p.len+=Pq(R,x),s=p.len/o),A=w._9O(g,E,O,q,I),r=w._9O(l,Y,O,q,I),a=0;O>a;a++)v=a+1,Je(Q,A[v]),Je(Q,r[a]),Je(Q,A[a]),Je(Q,r[a]),Je(Q,A[v]),Je(Q,r[v]),c&&($=a/O,t=v/O,c.push(L,t,s,$,L,$,s,$,L,t,s,t));!m&&p.bottom_vs&&w._10O(l,Y,O,q,I,p.bottom_vs,p.bottom_uv,!0)}else!m&&(h=w.right)&&(w.addV(h.vs,Y,l),w._13O(h)),(h=w.front)&&w.addV(h.vs,E,Y),(h=w.back)&&w.addV(h.vs,l,g),(h=w.top)&&w.addH(h.vs,E,Y,l,g,!0),(h=w.bottom)&&w.addH(h.vs,g,l,Y,E);X.p=x,X.f=Y,X.b=l},_10O:function(r,i,L,s,O,V,m,B){var Q,W,A=this,l=A.data,f=A._9O(r,i,L,s,O),h=(r.x+i.x)/2,u=(r.y+i.y)/2,I=l.getShapeElevation(),z=0;for(z=0;L>z;z++)B?(Je(V,f[z]),Je(V,f[z+1])):(Je(V,f[z+1]),Je(V,f[z])),Je(V,[h,I,u]),m&&(B?(Q=E*(z+1)/L+s,W=E*z/L+s):(Q=E*z/L+s,W=E*(z+1)/L+s),m.push(.5-.5*R(W),.5-.5*G(W),.5-.5*R(Q),.5-.5*G(Q),.5,.5))},_9O:function(o,p,y,L,u){var M,W,X=this,w=X.data,P=[],e=(o.x+p.x)/2,v=(o.y+p.y)/2,x=w.getTall()/2,V=w.getShapeElevation(),m=0;for(u=u||E;y>=m;m++)M=u*m/y+L,W=R(M),P.push([e+(o.x-e)*W,V+x*G(M),v+(o.y-v)*W]);return P},addV:function(S,W,I){var m=W.x,N=W.y,n=I.x,y=I.y,k=this.data,J=k.getShapeElevation(),D=k.getTall()/2;S.push(m,J-D,N,n,J-D,y,n,J+D,y,n,J+D,y,m,J+D,N,m,J-D,N)},addH:function(s,m,u,n,V,G){var E=this.data,c=E.getTall()/2,B=E.getShapeElevation()+(G?c:-c);s.push(m.x,B,m.y,u.x,B,u.y,n.x,B,n.y,n.x,B,n.y,V.x,B,V.y,m.x,B,m.y)},vf:function(X,o,M,D){var $,F=this,r=F.gv.getFaceVisible(F.data,X);return(M||r)&&($=wj(F,X,D),$.vs=[],$.tuv=r&&($.texture||o)?[]:U,$.visible=r),$}});var mk=function(q,A){Sc(mk,this,[q,A])};ob(mk,Wm,{_25Q:1,validate:function(o){var l=this,C=l.data,$=l.s,Y=C.getPoints(),e=Y.size();if(l.shapeModel=l.info=U,e>1){var p=l.info={},k=C.getSegments(),n=C.getThickness(),G=zm(Y.get(0)),q=zm(Y.get(e-1)),a=e%2;0===a?(p.c1=zm(Y.get(e/2-1)),p.c2=zm(Y.get(e/2))):p.p3=zm(Y.get((e-a)/2)),p.s1=G,p.s2=zm(Y.get(1)),p.t1=zm(Y.get(e-2)),p.t2=q,p.list=$(Hg)===ab?l.createTubeModel(Y,k,n/2,o):l.createLineModel(Y,k,n,"shape.border","shape.dash")}var r=C.p3(),w=l.mat=vk();hk(w,r),xe(w,C.getFinalRotation3d(),C.getRotationMode());var K=C.getScale3d(),Q=C._dynamicScale3d;Q&&(K[0]*=Q[0],K[1]*=Q[1],K[2]*=Q[2]),si(w,K),hk(w,Tg(r))},_80o:function(n,J,I){var E=this,v=E.shapeModel;if(v){var _=E.gv;zr(_,E.mat),Ab(_,E.data,v,E,E.getBodyColor(),I),Gn(_)}}});var ym=o.graph3d.VR=function(N){var C=this;C.gv=N,C._controllers=[],C.switch=new ao(C),C._enable=!1,C._defaultCallLater=o.Default.callLater,C._defaultCancelLater=Ed,"undefined"!=typeof _&&"VRFrameData"in _&&(C._frameData=new _.VRFrameData),C.measureOflength=1,C.eyesOffset=[0,0,0],C._orientation=new o.Math.Quaternion,C._lastHeadPose=[0,0,0],C._offsetToBeAdd=[0,0,0],C._fpsInfo={time:0,fps:0,frames:0}};ob(ym,Z,{ms_fire:!0,_42:function(T,K,P,Q){var q=this,f=q.gv;if(!f.drawFilter&&q._deviceInAction){var u=q._device;if(u){var b=q._measureOflength;u.depthNear=f.getNear()*b,u.depthFar=f.getFar()*b;var $=q._offsetToBeAdd;if(q.eyesOffset[0]+=$[0],q.eyesOffset[1]+=$[1],q.eyesOffset[2]+=$[2],$[0]=0,$[1]=0,$[2]=0,u.isPresenting===!1)return q._controllers.forEach(function(o){o&&o.update()}),f.iv(),!1;var n=q._frameData;u.getFrameData(n);var I=n.pose.position;if(I){var x=q.toViewPosition(I);f.setEye(x),q._orientation.fromArray(n.pose.orientation);var k=new o.Math.Vector3(0,0,-10*q._scaleFactor);k.applyQuaternion(q._orientation),f.setCenter([x[0]+k.x,x[1]+k.y,x[2]+k.z])}q._controllers.forEach(function($){$&&$.update()}),f.setViewport(T,0,0,K/2,P),q._viewMatrix=q._copyViewMatrix(n.leftViewMatrix),q._projectMatrix=q._copyProjectMatrix(n.leftProjectionMatrix),Q(),f.setViewport(T,K/2,0,K/2,P),q._viewMatrix=q._copyViewMatrix(n.rightViewMatrix),q._projectMatrix=q._copyProjectMatrix(n.rightProjectionMatrix),Q(),q._lastViewMatrix=q._viewMatrix,q._lastProjectMatrix=q._projectMatrix,q._viewMatrix=null,q._projectMatrix=null,q.submitFrame();var i=Date.now(),m=q._fpsInfo;return i-m.time>1e3?(m.fps=Math.round(1e3*(m.frames+1)/(i-m.time)),m.time=i,m.frames=0):m.frames++,!0}}},onVRDisplayPresentChange:function(){var E=this.isPresenting();this._injectGraphView(E),this.fp("present",!E,E)},getOrientation:function(){return this._orientation},addController:function(n){n=n||0;var S=this,Z=S.getController(n);return Z?Z:(Z=new gs(S,n),S._controllers.push(Z),Z)},getController:function(C){C=C||0;for(var w=this._controllers,N=0,z=w.length;z>N;N++)if(w[N]&&w[N].id===C)return w[N];return null},removeController:function(T){T=T||0;for(var r=this._controllers,z=0,C=r.length;C>z;z++)if(r[z]&&r[z].id===T)return r.splice(z,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(B,N){var k=this,T=k._scaleFactor,D=k._eyesOffset,d=k._lastHeadPose;return d[0]=B[0]*T,d[1]=B[1]*T,d[2]=B[2]*T,N?(N[0]=d[0]+D[0],N[1]=d[1]+D[1],N[2]=d[2]+D[2],N):[d[0]+D[0],d[1]+D[1],d[2]+D[2]]},addEyesOffset:function(b,H,S){var i=this._offsetToBeAdd;i[0]+=b,i[1]+=H,i[2]+=S},_copyViewMatrix:function(g){var v=this.dup(g),i=this._scaleFactor;v[12]*=i,v[13]*=i,v[14]*=i;var S=this._eyesOffset;if(S&&(S[0]||S[1]||S[2])){var L=S[0],V=S[1],r=S[2];v[12]-=v[0]*L+v[4]*V+v[8]*r,v[13]-=v[1]*L+v[5]*V+v[9]*r,v[14]-=v[2]*L+v[6]*V+v[10]*r}return v},shutdown:function(){var J=this._device;J&&J.isPresenting&&J.exitPresent()},isPresenting:function(){var F=this._device;return F&&F.isPresenting},_copyProjectMatrix:function(s){var A=this.dup(s),W=this._scaleFactor;return A[14]*=W,A},dup:function(y,O){for(var L=y.length,s=O||new Array(L);L--;)s[L]=y[L];return s},getViewMatrix:function(c){var M=this._viewMatrix;return M?this.dup(M,c):void 0},getProjectMatrix:function(){var f=this._projectMatrix;return f?this.dup(f):void 0},submitFrame:function(){var r=this;if(r._enable&&r._deviceInAction){var R=r._device;R&&R.isPresenting&&(R.submitFrame(),r.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(N){var E=this.gv;return E.intersectObjects(N,E.dm().getDatas())},setDevice:function(f){var x=this;x._device=f},_injectGraphView:function(){var b,z,G;return function(c){var J=this.gv;if(!c)return b&&(J.getWidth=b,J.getHeight=z,J.getDevicePixelRatio=G),void 0;var R=this._device,a=R.getEyeParameters("left"),$=a.renderWidth,I=a.renderHeight;b=J.getWidth,z=J.getHeight,G=J.getDevicePixelRatio,J.getWidth=function(){return 2*$},J.getHeight=function(){return I},J.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(X){var O=this;if(!X)return Sk=o.Default.callLater=O._defaultCallLater,Ed=o.Default.cancelLater=O._defaultCancelLater,void 0;var O=this;Sk=o.Default.callLater=function(n,T,$,X){var E=O._device;return E&&E.isPresenting?X?l(function(){Sk(n,T,$)},X):E.requestAnimationFrame(function(){O._deviceInAction=!0,n.apply(T,$),O._deviceInAction=!1}):O._defaultCallLater(n,T,$,X)},Ed=o.Default.cancelLater=function(B,q){var W=O._device;return W&&W.isPresenting?q?t(B):W.cancelAnimationFrame(B):O._defaultCancelLater(B,q)}}}),Z.defineProperties(ym.prototype,{enable:{get:function(){return this._enable},set:function(V){var A=this;A._enable!==V&&(A._enable=V,V?(A.switch.showButton(),A._injectCallLaterFunc(!0)):(A.shutdown(),A.switch.hideButton(),A._injectCallLaterFunc(!1)),A.fp("enable",!V,V))}},measureOflength:{get:function(){return this._measureOflength},set:function(A){this._measureOflength=A;var x=this._scaleFactor=1/A;this._controllers.forEach(function(s){s&&s._setScaleFactor(x)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(w){this._eyesOffset=w}},controllerModel:{get:function(){return this._controllerModel},set:function(T){var W;"object"==typeof T?(W=T.mtl,T=T.obj):(W=T+".mtl",T+=".obj");var D=this,z=D._controllerModel;z&&z.obj===T&&z.mtl===W||(z=D._controllerModel={obj:T,mtl:W},u.loadObj(T,W,{finishFunc:function(j,t){D._controllerModel===z&&u.setShape3dModel("vrControllerModel",t)}}))}},interactive:{get:function(){return!!this._interactive},set:function(X){!!X!=!!this._interactive&&(this._interactive=X,X&&this.addController(0),this.gv.getCoreInteractor().enableVR(X))}}});var gs=function(L,s){function D(K){var h=navigator.getGamepads&&navigator.getGamepads();if(h)for(var s=0,D=0,j=h.length;j>s;s++){var l=h[s];if(l){var L=l.id;if("OpenVR Gamepad"===L||"OpenVR Controller"===L||0===L.indexOf("Oculus Touch")||0===L.indexOf("Spatial Controller")){if(D===K)return l;D++}}}}function n(n,F,j){return Math.abs(n[0]-F[0])<j&&Math.abs(n[1]-F[1])<j&&Math.abs(n[2]-F[2])<j?!0:!1}var y=this;y.vr=L,y.id=s;var U,w,o=[0,0],z=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],t=new Dq;t.s("shape3d","vrControllerModel"),t.isController=!0,t.s("intersect",!1),y.getGamepad=function(){return w},y.isButtonPressed=function(l){for(var G,q=0,C=z.length;C>q;q++)if(G=z[q],G.id===l)return G.pressed;return!1},y.getNode=function(){return t};var Q=.003;y.setRotationEpsilon=function(u){Q=u};var x=5e-4,j=x;y.setPositionEpsilon=function(t){x=t,j=t*y.vr._scaleFactor},y._setScaleFactor=function(R){t.s3(R,R,R),j=x*R},y._setScaleFactor(y.vr._scaleFactor);var T,A=new yd,B=new qm,h=[0,0,0],V=[0,0,0],P=new di,m=new sc,E=new vi;y.getRay=function(){return T?(E.origin.fromArray(h),E.direction.copy(m),T=!1,E):E},y.update=function(){if(U=w,w=D(s),U!=w&&console.log("gamepad changed",w),!w||w.pose===g)return w=null,t.s("3d.visible",!1),void 0;if(u.getShape3dModel("vrControllerModel")){t.dm()||L.gv.dm().add(t),t.s("3d.visible",!0);var H=w.pose;if(null!==H){H.position&&(y.vr.toViewPosition(H.position,h),n(t.p3(),h,j)||(T=!0,t.p3(h))),H.orientation&&(A.fromArray(H.orientation),m.set(0,0,-1).applyQuaternion(A).normalize(),B.makeRotationFromQuaternion(A),P.set(0,0,0,t.getRotationMode(),!0).setFromRotationMatrix(B),V[0]=P.x,V[1]=P.y,V[2]=P.z,n(t.r3(),V,Q)||(T=!0,t.r3(V))),T&&L.fp("gamepad.pose",null,{position:h,rotation:V,id:s});var x=w.axes;(o[0]!==x[0]||o[1]!==x[1])&&(o=[x[0],x[1]],L.fp("gamepad.axes",null,{id:s,axes:o}));var J,X,Y,i,p=w.buttons;for(J=0,X=p.length;X>J;J++)if(Y=p[J],i=Y.pressed,i!==z[J].pressed){z[J].pressed=i;var $={id:s},R="state";$[R]=$._62O=i?"down":"up",L.fp("gamepad.button."+z[J].id,null,$)}}}}},ao=function(S){this.vr=S,this._button=null};ob(ao,Z,{showButton:function(){var l=this.assureButton();if(!l.parentNode){var z=this.vr.gv,N=z.getView();z._79O?N.insertBefore(l,z._79O):N.appendChild(l)}},hideButton:function(){var U=this._button;U&&U.parentNode&&U.parentNode.removeChild(U)},assureButton:function(){var J=this._button;return J?J:this._button=this.createButton(this.vr.gv)},createButton:function(G){function U(F,_){F.textContent=_&&_.isPresenting?" VR ":" VR "}function P(S){m.style.display="",m.style.cursor="pointer",m.style.left="calc(50% - 50px)",m.style.width="100px",U(m,S),m.onmouseenter=function(){m.style.opacity="1.0"},m.onmouseleave=function(){m.style.opacity="0.5"},m.onclick=function(){S.isPresenting?S.exitPresent():S.requestPresent([{source:G.getCanvas()}])},G.vr.setDevice(S)}function S(){m.style.display="",m.style.cursor="auto",m.style.left="calc(50% - 75px)",m.style.width="150px",U(m,null),m.onmouseenter=null,m.onmouseleave=null,m.onclick=null,G.vr.setDevice(null)}function Q(Z){Z.style.position="absolute",Z.style.bottom="20px",Z.style.padding="12px 6px",Z.style.border="1px solid #fff",Z.style.borderRadius="4px",Z.style.color="#000",Z.style.font="normal 13px sans-serif",Z.style.textAlign="center",Z.style.opacity="0.5",Z.style.outline="none",Z.style.zIndex="999"}if("getVRDisplays"in navigator){var m=this._button=z.createElement("button");return m.style.display="none",Q(m),_.addEventListener("vrdisplayconnect",function(O){P(O.display)},O),_.addEventListener("vrdisplaydisconnect",function(){S()},O),_.addEventListener("vrdisplaypresentchange",function(O){U(m,O.display),G.vr.onVRDisplayPresentChange()},O),navigator.getVRDisplays().then(function(h){h.length>0?P(h[0]):S()}),m}var l=z.createElement("a");return l.href="https://webvr.info",l.innerHTML=" webvr",l.style.left="calc(50% - 90px)",l.style.width="180px",l.style.textDecoration="none",Q(l),l}}),Z.defineProperties(ao.prototype,{});var tn=o.graph3d.PostProcessing=function(n){function H(){if(!K){var L=n.getGL();K=new gf.RenderTarget(n,L),V=new gc.Shader(L,Y.vs,Y.fs),t=gc.Buffer.createIndexBuffer(L,new Uint16Array([0,2,1,1,2,3])),C=gc.Buffer.createVertexBuffer(L,new Float32Array([0,0,1,0,0,1,1,1]))}}var K,V,t,C,A=this,_={},x=!1;!function(){Z.keys(tn).forEach(function(j){_[j]=new tn[j](n)})}(),A.getModule=function(j){return j?_[j]:_},A.getModuleList=function(){return Z.keys(_)},A.handleDataModleChange=function(k,R){k&&(k.setPostProcessingData(A.serialize()),k.removeSerializeListener(A.onDataModelSerialize,A)),R&&(R.addSerializeListener(A.onDataModelSerialize,A),A.deserialize(R.getPostProcessingData()))},A.onDataModelSerialize=function(W){"serialize"===W.type?n.dm()._postProcessingData=A.serialize():"deserialize"===W.type&&A.deserialize(n.dm().getPostProcessingData())},A.serialize=function(){var S,c,M,L={};for(S in _)c=_[S],L[S]={enable:c.enable},M=c.serializeProperties,M&&M.forEach(function(C){L[S][C]=c[C]});return L},A.deserialize=function(T){if(T){var j,Y,Q,K;for(j in T)if(Y=_[j]){Q=T[j],A.enableModule(j,Q.enable);for(K in Q)"enable"!==K&&(Y[K]=Q[K])}}else{var j,Y;for(j in _)Y=_[j],Y.enable=!1,Y.resetProperties&&Y.resetProperties()}},A.enableModule=function(b,Q){var M,r,a,d=b.split(",");for(M=0,r=d.length;r>M;M++)a=d[M].trim(),_[a]&&(_[a].enable=Q);x=!1;for(a in _)if(_[a].enable){x=!0;break}x&&H()};var Y={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};A._42=function(s,A,P,q,e){if(x&&!e){K.setSize(s,A,P),We(s,K.frame),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),n.setViewport(s,0,0,A,P),q();var U,Q=K;for(U in _)Q=_[U]._42(s,Q)||Q;return wp(s),n.setViewport(s,0,0,A,P),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),V.bind(),s.activeTexture(s.TEXTURE0+0),s.bindTexture(s.TEXTURE_2D,Q.texture),V.uniforms.image=0,t.upload(),C.upload(),V.attributes.pos.pointer(C),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0),s.bindTexture(s.TEXTURE_2D,null),s.useProgram(n._prg),!0}}},qg=o.graph3d.PostProcessing.Bloom=function(M){function $(){var p=M.getWidth(),F=M.getHeight();if(p&&F){s=[p,F],c=!0;var U,E=M.getGL(),b=Math.round(s[0]/2),h=Math.round(s[1]/2);for(N=new gf.RenderTarget(M,E,b,h),U=0;A>U;U++)k.push(new gf.RenderTarget(M,E,b,h)),x.push(new gf.RenderTarget(M,E,b,h)),b=Math.round(b/2),h=Math.round(h/2);L=new gc.Shader(E,qg.highPassShader.vs,qg.highPassShader.fs);for(var U=0;A>U;U++)W[U]=new gc.Shader(E,qg.blurShader.vs,qg.blurShader.fs.replace(/DEFINE_VALUE/g,w[U]));B=new gc.Shader(E,qg.compositeShader.vs,qg.compositeShader.fs.replace(/NUM_MIPS/g,A)),S=new gc.Shader(E,qg.finalShader.vs,qg.finalShader.fs),r=gc.Buffer.createIndexBuffer(E,new Uint16Array([0,2,1,1,2,3])),j=gc.Buffer.createVertexBuffer(E,new Float32Array([0,0,1,0,0,1,1,1]))
}}var v,K,z,r,j,E=this,V=!1,c=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){v=1.5,K=.55,z=.4},Z.defineProperties(E,{enable:{get:function(){return V},set:function(e){!!V!=!!e&&(V=e,e&&!c&&$())}},strength:{get:function(){return v},set:function(x){v=x}},threshold:{get:function(){return K},set:function(q){K=q}},radius:{get:function(){return z},set:function(W){z=W}}}),this.resetProperties();var N,L,B,S,s=[256,256],k=[],x=[],A=5,w=[3,5,7,9,11],W=[];E._42=function(f,R){function G(o,C,X,Z){We(f,C.frame),M.setViewport(f,0,0,C.width,C.height),Z?Z(f):f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT),H!==o&&o.bind();var Q=0;for(var b in X){var N=X[b];N instanceof WebGLTexture&&(f.activeTexture(f.TEXTURE0+Q),f.bindTexture(f.TEXTURE_2D,N),N=Q,Q++),o.uniforms[b]=N}for(H!==o&&(r.upload(),j.upload(),o.attributes.pos.pointer(j),H=o),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0);Q--;)f.activeTexture(f.TEXTURE0+Q),f.bindTexture(f.TEXTURE_2D,null);wp(f)}if(V){c||$();var H;G(L,N,{smoothWidth:.01,luminosityThreshold:K,tDiffuse:R.texture});var C,D=N,T=Math.round(s[0]/2),n=Math.round(s[1]/2);for(C=0;A>C;C++)G(W[C],k[C],{colorTexture:D.texture,direction:[1,0],texSize:[T,n]}),G(W[C],x[C],{colorTexture:k[C].texture,direction:[0,1],texSize:[T,n]}),T=Math.round(T/2),n=Math.round(n/2),D=x[C];return G(B,k[0],{blurTexture1:x[0].texture,blurTexture2:x[1].texture,blurTexture3:x[2].texture,blurTexture4:x[3].texture,blurTexture5:x[4].texture,bloomStrength:v,bloomRadius:z,bloomTintColor:[1,1,1]}),G(S,R,{image:k[0].texture},function(b){b.enable(b.BLEND),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.SRC_ALPHA,b.ONE)}),f.blendEquationSeparate(f.FUNC_ADD,f.FUNC_ADD),f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA),R}}};qg.highPassShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D tDiffuse;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},qg.blurShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D colorTexture;","uniform vec2 texSize;","uniform vec2 direction;","#define KERNEL_RADIUS DEFINE_VALUE","#define SIGMA DEFINE_VALUE","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float fSigma = float(SIGMA);","float weightSum = gaussianPdf(0.0, fSigma);","vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;","for( int i = 1; i < KERNEL_RADIUS; i ++ ) {","float x = float(i);","float w = gaussianPdf(x, fSigma);","vec2 uvOffset = direction * invSize * x;","vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;","vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;","diffuseSum += (sample1 + sample2) * w;","weightSum += 2.0 * w;","}","gl_FragColor = vec4(diffuseSum/weightSum, 1.0);","}"].join("\n")},qg.compositeShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D blurTexture1;","uniform sampler2D blurTexture2;","uniform sampler2D blurTexture3;","uniform sampler2D blurTexture4;","uniform sampler2D blurTexture5;","uniform sampler2D dirtTexture;","uniform float bloomStrength;","uniform float bloomRadius;","uniform vec3 bloomTintColor;","float lerpBloomFactor(const in float factor) {","float mirrorFactor = 1.2 - factor;","return mix(factor, mirrorFactor, bloomRadius);","}","void main() {","gl_FragColor = bloomStrength * ( lerpBloomFactor(1.0) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture1, vUv) + ","lerpBloomFactor(0.8) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture2, vUv) + ","lerpBloomFactor(0.6) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture3, vUv) + ","lerpBloomFactor(0.4) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture4, vUv) + ","lerpBloomFactor(0.2) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture5, vUv) );","}"].join("\n")},qg.finalShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")},Pk(u,{accordionViewExpandIcon:bi(mo),accordionViewCollapseIcon:bi(mo,!0),accordionViewLabelColor:hi,accordionViewLabelFont:Lh,accordionViewTitleBackground:ef,accordionViewSelectBackground:Ke,accordionViewSelectWidth:3,accordionViewSeparatorColor:g,splitViewDividerSize:1,splitViewDividerBackground:ef,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:fn,rect:[2,2,12,12],background:mo}]},propertyViewLabelColor:Jq,propertyViewLabelSelectColor:hi,propertyViewLabelFont:Lh,propertyViewExpandIcon:bi(zn),propertyViewCollapseIcon:bi(zn,!0),propertyViewBackground:to,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Rr,propertyViewColumnLineColor:Rr,propertyViewSelectBackground:Ke,listViewLabelColor:Jq,listViewLabelSelectColor:hi,listViewLabelFont:Lh,listViewRowLineVisible:!1,listViewRowLineColor:Rr,listViewSelectBackground:Ke,treeViewLabelColor:Jq,treeViewLabelSelectColor:hi,treeViewLabelFont:Lh,treeViewExpandIcon:bi(Of),treeViewCollapseIcon:bi(Of,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Rr,treeViewSelectBackground:Ke,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Jq,tableViewLabelSelectColor:hi,tableViewLabelFont:Lh,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Rr,tableViewColumnLineColor:Rr,tableViewSelectBackground:Ke,treeTableViewLabelColor:Jq,treeTableViewLabelSelectColor:hi,treeTableViewLabelFont:Lh,treeTableViewExpandIcon:bi(Of),treeTableViewCollapseIcon:bi(Of,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Rr,treeTableViewColumnLineColor:Rr,treeTableViewSelectBackground:Ke,tableHeaderLabelColor:Jq,tableHeaderLabelFont:Lh,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Kl,tableHeaderBackground:to,tableHeaderMoveBackground:Mg,tableHeaderInsertColor:Ke,tableHeaderSortDescIcon:Vn(zn,!0),tableHeaderSortAscIcon:Vn(zn),tabViewTabGap:1,tabViewLabelColor:hi,tabViewLabelFont:Lh,tabViewTabBackground:ef,tabViewSelectWidth:3,tabViewSelectBackground:Ke,tabViewMoveBackground:Mg,tabViewInsertColor:Ke,toolbarLabelColor:Jq,toolbarLabelSelectColor:hi,toolbarLabelFont:Lh,toolbarBackground:to,toolbarSelectBackground:Ke,toolbarItemGap:8,toolbarSeparatorColor:Lg},!0);var ld={translateX:1,sortColumn:1},Bi={sortable:1,sortOrder:1,sortFunc:1},ib={focusData:1},Ok={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},$l={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Lk=function(f,R){R.add(f),f.hasChildren()&&f.eachChild(function(b){Lk(b,R)})},Sj=function(a,V,o,d,q,E,v,m,H,y,f){var i,N=o.getValueType(y),_=o.getAlign(y);if(o.getEnumValues(y)){var g=o.toEnumLabel(V,y),x=Rj||0,K=0,Y=E,I=u.getTextSize(d,g).width;return i=Dl(o.toEnumIcon(V,y)),i&&(K=E+Rj/2,"center"===_?K+=(m-(x+I))/2:"right"===_&&(K=K+m-(x+I)),Jr(a,i,K,v+H/2,y,f),Y=K+Rj/2),g!=U&&(i?ss(a,g,d,q,Y,v,m-(Y-E),H):ss(a,g,d,q,E,v,m,H,_)),void 0}return V=o.formatValue(V),V!=U?N===hb?(No(a,E,v,m,H,V),void 0):N===Ni||!N&&br(V)?(i=Dl(V?Zh:tr),Jr(a,i,E+m/2,v+H/2,y,f),void 0):(ss(a,V,d,q,E,v,m,H,_),void 0):void 0},zi=function(M,c){var g=c.view,F=Fj(M),Y=c.column||c.property;g.getDataModel().beginTransaction(),c.editor=M,M.info=c,g.setCurrentEditor(M),g.getView().insertBefore(F,g._79O),yk(M,c.editorRect),M.setFocus?M.setFocus():Jp(M),M.commitValue=function(G,e){M._17Q&&(M=M._17Q),e||g.setValue(c.data,Y,M.getValue?M.getValue():M.value),M.close&&M.close(),Gp(F)},Y.onEditorCreated&&Y.onEditorCreated(c)},Xn=function(v,$,C,b,d){var X=Zm(v,C),s=$.value,y=$.view,P=d.getValueType($.data);return X.onblur=X.onchange=function(){y.endEditing()},"input"===v?(s=d.formatValue(s),s!=U&&(X.value=s),X.onkeydown=function(Q){Hh(Q)?y.endEditing():ip(Q)&&y.endEditing(!0)},(P===vg||P===kl)&&X.addEventListener(Pm,u.numberListener,O)):v===um&&b.forEach(function(M){var p=z.createElement("option");p.innerHTML=d.toEnumLabel(M),p.value=M,d.isEnumEqual(s,M)&&(p.selected=!0),Uo(X,p)}),zi(X,$),X},yq=o.widget={},qh=function(s,u,i){ob(m+".widget."+s,u,i)};Pk(kq,{ms_value:function(X){X.getValue=function(j){var c=this.getItemById(j),q=c.element;return Do(q)?q:q?q.getValue?q.getValue():q.value:c.selected},X.setValue=function(C,s){var K=this.getItemById(C);if(K){var O=K.element;O&&!Do(O)?O.setValue?O.setValue(s):O.value=s:br(s)?(K.selected=s,this.iv()):(K.element=s,this.iv())}},X.v=function($,G){var S=this;if(2===arguments.length)S.setValue($,G);else{if(!Bf($))return S.getValue($);for(var a in $)S.setValue(a,$[a])}return S}},_46o:function(n){n._icon=U,n._accessType=U,n._valueType=U,n._editable=!1,n._batchEditable=!0,n._align=Qg,n._nullable=!0,n._emptiable=!1,n.setParent=Xc,n.formatValue=function(F){var x=this,c=x._valueType;return x.getEnumValues()?x.toEnumLabel(F):c===Ni?!!F:F!=U&&c===vg?$(F):F},n.setEnum=function(L,Z,Y,q,x,W,M){var r=this;L&&!zc(L)&&L.values&&(q=L.editable,Y=L.icons,Z=L.labels,x=L.strict,W=L.maxHeight,M=L.dropDownWidth,L=L.values),Wh(L)&&(L=L._as),Wh(Z)&&(Z=Z._as),Wh(Y)&&(Y=Y._as),r._enumValues=L,r._enumLabels=Z,r._enumIcons=Y,r._enumEditable=q,r._enumStrict=x==U?!0:x,r._enumMaxHeight=W,r._enumDropDownWidth=M,L&&L.length&&Rm(L[0])&&(r._valueType=kl),r.fp("enum",!1,!0)},n.getEnumDropDownWidth=function(){return this._enumDropDownWidth},n.getEnumMaxHeight=function(){return this._enumMaxHeight},n.isEnumEditable=function(){return this._enumEditable},n.getEnumValues=function(){return this._enumValues},n.getEnumLabels=function(){return this._enumLabels},n.getEnumIcons=function(){return this._enumIcons},n.isEnumStrict=function(){return this._enumStrict},n.isEnumEqual=function(x,Z){return this._enumStrict?x===Z:x==Z},n.toEnumLabel=function(x,M){var U=this,q=U.getEnumValues(M),g=U.getEnumLabels(M);if(q&&g)for(var V=0;V<q.length;V++)if(U.isEnumEqual(x,q[V]))return g[V];return x},n.toEnumIcon=function(j,u){var v=this,y=v.getEnumValues(u),h=v.getEnumIcons(u);if(y&&h)for(var Z=0;Z<y.length;Z++)if(v.isEnumEqual(j,y[Z]))return h[Z];return g}},_45o:function(D){D._87o=function(f,D,u,K,H,w){if(f){var T=this,t=T._90I,C=rr(1);T._columnLineVisible&&(H-=1),T._rowLineVisible&&(w-=1),0>=H||0>=w||(T._90I||(t=T._90I={}),t[D]||(t[D]=new vc),yk(C,T.tx()+u,T.ty()+K,H,w),Uo(C,f),T._view.insertBefore(C,T._79O),f.onParentAdded&&f.onParentAdded(C),t[D].add(C))}},D._76o=function(){var a=this,l=a._90I;if(l){for(var $ in l)l[$].each(function(V){Gp(V)});delete a._90I}},D._77o=function(y){var r=this;if(r._90I){var O=r._90I[y];O&&(O.each(function(k){Gp(k)}),delete r._90I[y])}}},_47o:function(x){x.getValue=function(t,f){return f.getValue?f.getValue(t,f,this):$h(t,f.getAccessType(),f.getName())},x.setValue=function(s,u,R){if(u.isEmptiable(s)||""!==R||(R=g),u.isNullable(s)||R!=U){var O=this,Q=u.getName(s),M=u.getAccessType(s),J=u.getValueType(s);J===vg&&Do(R)?R=X(R):J===kl&&Do(R)?R=parseFloat(R):J===Ni&&Do(R)&&(R="true"===R),O._batchEditable&&u._batchEditable&&O.isSelected(s)?O.sm().each(function(K){u.setValue?u.setValue(K,u,R,O):Fh(K,M,Q,R)}):u.setValue?u.setValue(s,u,R,O):Fh(s,M,Q,R)}},x.setCurrentEditor=function(u){this.endEditing(),this._currentEditor=u,this.redraw()},x.isEditing=function(g,a){var p=this,X=p._currentEditor;if(!X)return!1;if(a){var m=X.info;return m?(m.column||m.property)===a&&m.data===g:!1}return!0},x.endEditing=function(V){var W=this,w=W._currentEditor;w&&(delete W._currentEditor,w.commitValue&&w.commitValue(w.info,V),W.redraw(),W.getDataModel().endTransaction())},x.beginEditing=function(i){this.endEditing();var f=this,n=i.column||i.property;if(n.beginEditing)n.beginEditing(i);else{var Y=i.data,D=i.value,e=f.getSelectBackground(Y),C=n.getEnumValues(Y),r=n.getSlider(Y),g=n.getColorPicker(Y);if(r){var x=qf(yq.Slider,r);return x.setValue(D),x.getView().onblur=function(){f.endEditing()},x.isInstant()&&(x.onValueChanged=function(){f.setValue(Y,n,x.getValue())}),zi(x,i),void 0}if(g||n.getValueType(Y)===hb){var u=qf(yq.ColorPicker,g);return u.setValue(D),u.onClosed=function(){f.endEditing()},u.isInstant()&&(u.onValueChanged=function(r,Z){f.setValue(Y,n,Z)}),zi(u,i),u.open(),void 0}if(C){if(yq.ComboBox){var s=new yq.ComboBox;s.setValue(D),s.setValues(C),s.setLabels(n.getEnumLabels(Y)),s.setIcons(n.getEnumIcons(Y)),s.setEditable(n.isEnumEditable(Y)),s.setStrict(n.isEnumStrict(Y)),s.setMaxHeight(n.getEnumMaxHeight(Y)),s.setDropDownWidth(n.getEnumDropDownWidth(Y)),s.onClosed=function(){f.endEditing()},zi(s,i),s.open()}else Xn(um,i,e,C,n);return}var T=n.getValueType(Y);if(T===Ni||br(D))return f.setValue(Y,n,!D),void 0;if(n.getItemEditor(Y)){var H=Ir(n.getItemEditor(Y)),K=new H(Y,n,f,i),q=K.getView();return q._17Q=K,K.setValue(D),He(q),zi(q,i),K.editBeginning&&K.editBeginning(),void 0}Xn("input",i,e,U,n)}}},_44o:function(Q){Q.init=function(U){var P=this,y=P.th=new sq(U),F=P._view=wm(1,P);P.tv=P._tableView=U,Uo(F,y.getView()),Uo(F,U.getView()),y.mp(function(h){h.property===ko&&P.iv()}),P.iv()},Q.getTableView=function(){return this.tv},Q.getTableHeader=function(){return this.th},Q.getDataModel=function(){return this.tv.dm()},Q.getColumnModel=function(){return this.tv.getColumnModel()},Q.setColumns=function(b){this.tv.setColumns(b)},Q.addColumns=function(_){this.tv.addColumns(_)},Q.endEditing=function(){this.tv.endEditing()},Q.validateImpl=function(){var F=this,T=F.th,g=Hp(T),I={x:0,y:0,width:F.getWidth(),height:g};yk(T,I),I.y=g,I.height=N(0,F.getHeight()-g),yk(F.tv,I)}},ms_vs:function(h){h._41o=function(){return this._29I.height<this._59I},h._43o=function(){var B=this;B._41o()&&(B._58I||(l(function(){B._94O()},Ck),B.iv()),B._58I=new Date)},h._94O=function(){var P=this;if(P._58I){var d=new Date;d.getTime()-P._58I.getTime()>=Ck?(delete P._58I,P.iv()):l(function(){P._94O()},Ck)}},h._93I=function(){var x=this,Y=x._27I;if(x._58I||!x._autoHideScrollBar){Y||Uo(x._79O,Y=x._27I=rr());var y=x._29I,K=y.height,M=x._59I,I=x.getScrollBarSize(),e=y.width-I-2,V=K*(-x.ty()/M),u=K*(K/M),g=Y.style;M>K?(Af>u&&(V=V+u/2-Af/2,0>V&&(V=0),V+Af>K&&(V=K-Af),u=Af),g.visibility=Sp,g.background=x.getScrollBarColor(),g.borderRadius=I/2+Wg,yk(Y,e,V,I,u)):g.visibility=El}else Y&&(Y.style.visibility=El)}},ms_hs:function(K){K._40o=function(){return this._29I.width<this._91I},K._42o=function(){var C=this;C._40o()&&(C._95O||(l(function(){C._94I()},Ck),C.iv()),C._95O=new Date)},K._94I=function(){var I=this;if(I._95O){var e=new Date;e.getTime()-I._95O.getTime()>=Ck?(delete I._95O,I.iv()):l(function(){I._94I()},Ck)}},K._92I=function(){var d=this,Z=d._28I;if(d._95O||!d._autoHideScrollBar){Z||Uo(d._79O,Z=d._28I=rr());var A=d._29I,f=A.width,l=d._91I,e=d.getScrollBarSize(),p=A.height-e-2,w=f*(-d.tx()/l),L=f*(f/l),i=Z.style;l>f?(Af>L&&(w=w+L/2-Af/2,0>w&&(w=0),w+Af>f&&(w=f-Af),L=Af),i.visibility=Sp,i.background=d.getScrollBarColor(),i.borderRadius=e/2+Wg,yk(Z,w,p,L,e)):i.visibility=El}else Z&&(Z.style.visibility=El)}}}),nk(Zh,pg(16,16,[{type:Ui,rect:[1,1,14,14],background:Ke},{type:Xe,rect:[1,1,14,14],width:1,color:Vp},{type:wr,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),nk(tr,pg(16,16,{type:Xe,rect:[1,1,14,14],width:1,color:Vp})),nk(Mn,pg(16,16,[{type:Fb,rect:[2,2,12,12],borderWidth:1,borderColor:Vp,background:"#FFF"},{type:Fb,rect:[4,4,8,8],background:Ke}])),nk(ti,pg(16,16,{type:Fb,rect:[2,2,12,12],borderWidth:1,borderColor:Vp})),kq._15Q=function(D){D._29I=Ng,D._59I=0,D._91I=0,D._5o=function(J){var d=this;d._30I=new vc,d._rows=new vc,d._rowMap={},d._31I=0,d._14I=0,d._view=wm(1,d),d._canvas=Aj(d._view),Uo(d._view,d._79O=rr()),d.dm(J?J:new Ch)},D.getCheckIcon=function(i){var v=this.sm(),X=v.co(i);return v.sg()?Dl(X?Mn:ti):Dl(X?Zh:tr)},D.checkData=function(Y){var L=this.sm(),S=L.co(Y);L.sg()&&S||(this._32o=1,S?L.rs(Y):L.as(Y),delete this._32o)},D.getDataAt=function(w){w.target&&(w=this.lp(w));var D=d(w.y/this._rowHeight),f=this._rows;return 0>D||D>=f.size()?U:f.get(D)},D.onDataDoubleClicked=function(){},D.onDataClicked=function(){},D.adjustTranslateX=function(){return 0},D.adjustTranslateY=function(Q){var h=this.getHeight()-this._59I;return h>Q&&(Q=h),Q>0?0:$(Q)},D.onPropertyChanged=function(V){var p=this,B=V.property;Ok[B]?p.ivm():ib[B]||p.redraw(),B===Hk?p._42o():B===Hc&&p._43o()},D.getLabel=function(Y){return Y.toLabel()},D.getLabelFont=function(){return this._labelFont},D.getLabelColor=function(H){var K=this;if(K.isCheckMode()){if(K._focusData===H)return K._labelSelectColor}else if(K.isSelected(H))return K._labelSelectColor;return K._labelColor},D.getStartRowIndex=function(){return this._31I},D.getEndRowIndex=function(){return this._14I},D.getRowDatas=function(){return this._rows},D.getRowIndex=function(R){return this._rowMap[R._id]},D.getRowSize=function(){return this._rows.size()},D.getViewRect=function(){return Cn(this._29I)},D.isVisible=function(r){return this._visibleFunc?this._visibleFunc(r):!0},D.getCurrentSortFunc=function(){return this._sortFunc},D.setDataModel=function(z){var w=this,y=w._dataModel,D=w._selectionModel;y!==z&&(y&&(y.umm(w.handleDataModelChange,w),y.umd(w.handleDataPropertyChange,w),y.umh(w.handleHierarchyChange,w),D||y.sm().ums(w.handleSelectionChange,w)),w._dataModel=z,z.mm(w.handleDataModelChange,w),z.md(w.handleDataPropertyChange,w),z.mh(w.handleHierarchyChange,w),D?D._21I(z):z.sm().ms(w.handleSelectionChange,w),w.fp("dataModel",y,z))},D.validateModel=function(){var G=this;G._rows.clear(),G._rowMap={},G.buildChildren(G._dataModel._roots);var k=G._rows=G._rows.toList(G.isVisible,G),d=0,S=G.getCurrentSortFunc(),B=k.size();for(S&&k.sort(S);B>d;d++)G._rowMap[k.get(d)._id]=d},D.buildChildren=function(v){var m=this;v.each(function(U){m._rows.add(U),m.buildChildren(U._children)})},D.handleDataModelChange=function(){this.ivm()},D.handleDataPropertyChange=function($){"parent"===$.property?this.ivm():this.invalidateData($.data)},D.handleHierarchyChange=function(){this.ivm()},D.handleSelectionChange=function(y){y.datas.each(this.invalidateData,this),this.onSelectionChanged(y)},D.onSelectionChanged=function(u){var l=this,c=l.sm();!l.isAutoMakeVisible()||1!==c.size()||"set"!==u.kind&&"append"!==u.kind||l._32o||l.makeVisible(c.ld())},D.handleBackgroundClick=function($){lk($)&&!this.isCheckMode()&&this.sm().cs()},D.makeVisible=function(I){I&&(this._23I=I,this.iv())},D.scrollToIndex=function(M){var D=this,s=D._29I,d=s.height,H=D._rowHeight,f=H*M;M>=0&&M<D._rows.size()&&d>0&&(f+H>s.y+d?D.ty(-f+d-H):f<s.y&&D.ty(-f))},D.autoScroll=function(E,S){var i=this,f=i._rowHeight,t=f,C=f/4,J=i._29I,a=i.lp(E),z={x:i.tx(),y:i.ty()};return f>0&&J&&(a.x-J.x<t?i.translate(C,0):J.x+J.width-a.x<t&&i.translate(-C,0),a.y-J.y<t?i.translate(0,C):J.y+J.height-a.y<t&&i.translate(0,-C)),z.x=i.tx()-z.x,z.y=i.ty()-z.y,S&&(S.x+=z.x,S.y+=z.y),z},D.getTopRowOrderSelection=function(){var A=this.sm().getTopSelection(),E={},g=new vc;return A.each(function(Z){E[Z._id]=Z}),this._rows.each(function(U){E[U._id]&&g.add(U)}),g},D.getRowOrderSelection=function(){var c=new vc;return this._rows.each(function(Q){this.isSelected(Q)&&c.add(Q)},this),c},D.ivm=function(){this.invalidateModel()},D.invalidateModel=function(){var X=this;X._96I||(X._96I=1,X._32I=1,delete X._24I),X.iv()},D.redraw=function(){var m=this;m._32I||(m._32I=1,delete m._24I,m.iv())},D.invalidateData=function(V){var h=this;C?h.redraw():h._32I||(h._24I||(h._24I={}),h._24I[V._id]=V,h.iv())},D.getFocusData=function(){return this._focusData},D.setFocusDataById=function(d){this.setFocusData(this.dm().getDataById(d))},D.setFocusData=function(w){var U=this,o=U._focusData;o!==w&&(U._focusData=w,U.fp("focusData",o,w),o&&U.invalidateData(o),w&&(U.invalidateData(w),U.isAutoMakeVisible()&&U.makeVisible(w)))},D.drawRowBackground=function(w,W,y,N,j,B,p){var _=this,P=_.isCheckMode();(W===_._focusData&&P||y&&!P)&&No(w,N,j,B,p,_.getSelectBackground(W))},D.drawData=function(L,Z,F){var W=this,G=W._rowHeight,N=G*F,o=W._29I,R=o.x,S=o.width;L.save(),L.beginPath(),L.rect(R,N,S,G),L.clip(),W._87o(W.drawRow(L,Z,W.isSelected(Z),R,N,S,G),F,R,N,S,G),L.restore(),W._rowLineVisible&&No(L,R,N+G-1,S,1,W._rowLineColor)},D._12I=function(P){var H=this,U=H._31I,J=H._29I,N=J.x,h=J.y,s=J.width,F=J.height;for(P.beginPath(),P.rect(N,h,s,F),P.clip(),P.clearRect(N,h,s,F),H._76o(),H._93db(P);U<H._14I;U++)H.drawData(P,H._rows.get(U),U);H._92db(P)},D._13I=function(f){for(var G,W=this,Q=W._rowHeight,e=W._29I,O=e.x,A=e.width,U=W._31I,l=W._30I;U<W._14I;U++)G=W._rows.get(U),W._24I[G._id]&&l.add({data:G,index:U});l.isEmpty()||(f.beginPath(),l.each(function(X){f.rect(O,X.index*Q,A,Q)}),f.clip(),l.each(function(e){f.clearRect(O,e.index*Q,A,Q)}),l.each(function(A){W._77o(A.index)}),W._93db(f),l.each(function(C){W.drawData(f,C.data,C.index)}),W._92db(f),l.clear())},D.preValidateModel=function(){this.endEditing&&this.endEditing()},D.validateImpl=function(){var v=this,A=v._canvas,Y=v.getWidth(),P=v.getHeight(),u=v._rowHeight,H=v._32I;(Y!==A.clientWidth||P!==A.clientHeight)&&(gl(A,Y,P),H=1);var Z=M&&!q;v._96I&&!Z&&(v.preValidateModel(),v.validateModel());var j=v._29I,V={x:-v.tx(),y:-v.ty(),width:Y,height:P},w=v._rows.size(),z=kc(A),T=v._23I;H||uk(V,j)||(H=1),v._29I=V,v._59I=w*u+v.getScrollBarSize(),v._31I=d(V.y/u),v._14I=e((V.y+V.height)/u),v._31I<0&&(v._31I=0),v._14I>w&&(v._14I=w),v._99I&&H&&v._99I(),_f(z,v.tx(),v.ty(),1),H?v._12I(z):v._24I&&v._13I(z),v._93I(),v._92I(),z.restore(),v._32I=v._24I=v._96I=U,T&&(v.scrollToIndex(v.getRowIndex(T)),delete v._23I),v.tx(v.tx()),v.ty(v.ty())}},kq._48o=function(T){T._rootVisible=!0,T._rootData=U,T._35o=function(){this._expandMap={},this._levelMap={}},T.validateModel=function(){var S=this,D=S._rootData;S._rows.clear(),S._levelMap={},S._rowMap={},S._currentLevel=0,D?S._rootVisible?S.isVisible(D)&&S.buildData(D):S.buildChildren(D):S.buildChildren(),delete S._currentLevel},T.buildData=function(t){var C=this,g=t._id,x=C._rows;C._rowMap[g]=x.size(),x.add(t),C._levelMap[g]=C._currentLevel,C.isExpanded(t)&&(C._currentLevel++,C.buildChildren(t),C._currentLevel--)},T.buildChildren=function(O){var h=this,z=O?O._children:h._dataModel._roots,o=h.getCurrentSortFunc();o&&h.isChildrenSortable(O)?z.toList(h.isVisible,h).sort(o).each(h.buildData,h):z.each(function(y){h.isVisible(y)&&h.buildData(y)})},T.getLevel=function(x){return this._levelMap[x._id]},T.getToggleIcon=function(b){var L=this,v=L._loader,O=L._collapseIcon;return v&&!v.isLoaded(b)?O:b.hasChildren()?L.isExpanded(b)?L._expandIcon:O:U},T.isCheckMode=function(){return this._checkMode!=U},T.isChildrenSortable=function(){return!0},T.handleDataModelChange=function(p){var e=this;p.kind===Se?delete e._expandMap[p.data._id]:p.kind===sg&&(e._expandMap={}),e.ivm()},T.toggle=function(p){var x=this;x.isExpanded(p)?x.collapse(p):x.expand(p)},T.isExpanded=function(U){return 1===this._expandMap[U._id]},T.expand=function(Y){var Z=this,E=Z._loader;Z.isExpanded(Y)||(E&&!E.isLoaded(Y)&&E.load(Y),Z._expandMap[Y._id]=1,Z.ivm(),Z.onExpanded(Y))},T.onExpanded=function(){},T.collapse=function(Q){var d=this;d.isExpanded(Q)&&(delete d._expandMap[Q._id],d.ivm(),d.onCollapsed(Q))},T.onCollapsed=function(){},T.expandAll=function(r){if(r)this.expand(r),r.eachChild(function(J){this.expandAll(J)},this);else{var I=this;I._dataModel.each(function(q){q.hasChildren()&&(I._expandMap[q._id]=1)}),I.ivm()}},T.collapseAll=function(){this._expandMap={},this.ivm()},T.makeVisible=function(N){if(N){var L=this;if(!L._rootData||N.isDescendantOf(L._rootData)){for(var H=N._parent;H;)L.expand(H),H=H._parent;L._23I=N,L.iv()}}},T.checkData=function(P){var T,u=this,D=u._checkMode,M=u.sm(),h=M.co(P);if(!M.sg()||!h){if(u._32o=1,D===Yh)h?M.rs(P):M.as(P);else if(D===Jn)T=new vc(P),T.addAll(P._children);else if("descendant"===D)T=new vc,Lk(P,T);else if("all"===D&&(T=new vc,Lk(P,T),!h))for(var O=P._parent;O;)T.add(O),O=O._parent;T&&(h?M.rs(T):M.as(T)),delete u._32o}},T._97I=function(W,d,t,G,u,S,H){var j=this,Y=j._indent,I=j._levelMap[d._id],L=j.getIconWidth(d),p=Dl(j.getToggleIcon(d));p?(G+=Y*I,Jr(W,p,G+Y/2,u+H/2,d,j),G+=Y):G+=Y*(I+1),j._checkMode&&(Jr(W,j.getCheckIcon(d),G+Y/2,u+H/2,d,j),G+=Y),j.drawIcon(W,d,G,u,L,H),j.drawLabel(W,d,G+L,u,H)}},kq._14Q=function(I){I.getIcon=function(Z){return Z.getIcon()},I.getIconWidth=function(I){return this.getIcon(I)?this._indent:0},I.drawIcon=function(w,t,m,G,H,z){if(H){var h=this,J=h.getBodyColor(t),P=Dl(h.getIcon(t),J);P&&(z-=h.isRowLineVisible()?1:0,Dj(w,P,pk,m,G,H,z,t,h,J),Ko(w,h.getBorderColor(t),m,G,H,z))}},I.drawLabel=function(q,E,v,n,w){var A=this;ss(q,A.getLabel(E),A.getLabelFont(E),A.getLabelColor(E),v,n,0,w)}},kq._50o=function(p){p._98I=function(){var u=this,l=u._39o=new Ch;u._60I=new vc,l.mm(u._17o,u),l.md(u._18o,u),l.mh(u._19o,u)},p.setColumns=function(d){this._39o.clear(),this.addColumns(d)},p.addColumns=function(j){var i=this._39o;j.forEach(function(n){if(!(n instanceof Bg)){var U=Ir(n.className);n=qf(U?U:Bg,n)}i.add(n)})},p.onColumnClicked=function(){},p.onCheckColumnClicked=function(){},p._3Q=function(f){for(var W,N=0,m=this._60I,D=m.size();D>N;N++)if(W=m.get(N),W.column===f)return W;return U},p.getColumnAt=function(z){var i=this._4Q(z);return i?i.column:U},p._4Q=function(E){for(var P=this,V=E.target?P.lp(E).x:E.x,p=P._60I,f=0;f<p.size();f++){var z=p.get(f),t=z.startX;if(V>=t&&V<t+z.column.getWidth())return z}return U},p.getToolTip=function(V){var h=this,H=h.getDataAt(V),R=h.getColumnAt(V);return H&&R?R.getToolTip(H,h):U},p.adjustTranslateX=function(X){var e=this.getWidth()-this._91I;return e>X&&(X=e),X>0?0:$(X)},p._99I=function(){var h=this,g=h._29I,i=h._60I;i.clear(),h._91I=0,h._39o._roots.each(function(I){if(I.isVisible()){var f=h._91I+I.getWidth();h._91I<=g.x+g.width&&f>=g.x&&i.add({column:I,startX:h._91I}),h._91I=f}}),h._91I+=h.getScrollBarSize()},p.drawData=function(o,z,j){var s=this,k=s._rowHeight,Q=k*j,J=s.isSelected(z),m=s._29I,r=m.x,b=m.width;s.drawRowBackground(o,z,J,r,Q,b,k),s._60I.each(function(m){var $=m.column,g=m.startX,D=$.getWidth();D>0&&!s.isEditing(z,$)&&(o.save(),o.beginPath(),o.rect(g,Q,D,k),o.clip(),s._87o(s.drawCell(o,z,J,$,g,Q,D,k),j,g,Q,D,k),s._columnLineVisible&&No(o,g+D-1,Q,1,k,s._columnLineColor),o.restore())}),s._rowLineVisible&&No(o,r,Q+k-1,b,1,s._rowLineColor)},p.drawCell=function(g,x,C,b,f,M,_,G){var k=this;if(b.drawCell)return b.drawCell(g,x,C,b,f,M,_,G,k);var l=k.getValue(x,b);Sj(g,l,b,k.getLabelFont(x,b,l),k.getLabelColor(x,b,l),f,M,_,G,x,k)},p.getColumnModel=function(){return this._39o},p._17o=function(){this.redraw()},p._18o=function(B){var p=this;B.data===p._sortColumn&&Bi[B.property]?p.ivm():(p._42o(),p.redraw())},p._19o=function(){this.redraw()},p.getCurrentSortFunc=function(){var A=this,i=A._sortColumn;if(i&&i.isSortable()){var d=i.getSortFunc(),n=Fn===i.getSortOrder()?1:-1;return d||(d=ps),function(E,I){return d.call(A,A.getValue(E,i),A.getValue(I,i),E,I)*n}}return A._sortFunc},p.isCellEditable=function(D,L,x){return L.isEditable()&&this.isEditable()?L.isCellEditable?L.isCellEditable(D,L,x,this):!0:!1},p._37O=function(C,B){if(lk(B))for(var A=this,T=A.lp(B),v=A._60I,l=A._rowHeight,f=A._29I,t=f.x,M=f.y,S=f.width,z=f.height,K=0;K<v.size();K++){var g=v.get(K),_=g.startX,V=g.column,i=V.getWidth();if(V!==A._31o&&V!==A._4o&&T.x>=_&&T.x<_+i&&A.isCellEditable(C,V,B)){var r={x:_,y:A.getRowIndex(C)*l,width:i,height:l},b={x:r.x+A.tx(),y:r.y+A.ty(),width:r.width,height:r.height},s=0,U=0;return r.x<t?s=r.x-t:r.x+r.width>t+S&&(s=r.x+r.width-t-S),s&&(A.tx(A.tx()-s),b.x-=s),r.y<M?U=r.y-M:r.y+l>M+z&&(U=r.y+l-M-z),U&&(A.ty(A.ty()-U),b.y-=U),A.beginEditing({data:C,column:V,value:A.getValue(C,V),event:B,rect:r,editorRect:b,view:A}),void 0}}}},yq.BaseItemEditor=function(_,M,O,A){this._data=_,this._column=M,this._master=O,this._editInfo=A},qh("BaseItemEditor",Z,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Md=o.Tab=function(){Sc(Md,this)};oi("Tab",Ej,{ms_ac:["view","closable","disabled"],_icon:U,_closable:!1,_disabled:!1,setParent:Xc});var Bg=o.Column=function(){Sc(Bg,this)};oi("Column",Ej,{_46o:1,ms_ac:["accessType","valueType",Sp,qn,lr,ke,"align",hb,"sortOrder",kh,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Fn,_sortFunc:U,_sortable:!0,_clickable:!0,setWidth:function(B){16>B&&(B=16);var W=this._width;this._width=B,this.fp(ke,W,B)},getToolTip:function(r,o){return this.formatValue(o.getValue(r,this))}});var Gl=o.Property=function(){Sc(Gl,this)};oi("Property",Ej,{_46o:1,ms_ac:["accessType","valueType",qn,lr,"categoryName",hb,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:U,getToolTip:function(T,M,k){var J=this;return M?J.formatValue(k.getValue(T,J)):k.getPropertyName(J)}}),yq.AccordionView=function(){var s=this;s._20o={},s._21o=new vc,s._10o=U,s._9o=U,s._11o=U,s._view=wm(0,s),s.iv()},qh("AccordionView",Z,{ms_v:1,ms_fire:1,ms_ac:[Tf,tl,"titleHeight",Yk,jk,"titleBackground","selectWidth",Qd,"orientation","separatorColor"],_expandIcon:u.accordionViewExpandIcon,_collapseIcon:u.accordionViewCollapseIcon,_titleHeight:Tc,_labelColor:u.accordionViewLabelColor,_labelFont:u.accordionViewLabelFont,_titleBackground:u.accordionViewTitleBackground,_selectBackground:u.accordionViewSelectBackground,_selectWidth:u.accordionViewSelectWidth,_orientation:"v",_separatorColor:u.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(J,n,D,Q){var V=this,_=rr();if(V._20o[J])throw J+" already exists";_.onmousedown=td,_.style.cursor=Ih,_.addEventListener($d?wq:Ig,function(N){td(N)},O),_.addEventListener($d?tp:df,function(D){td(D),lk(D)&&(V._10o===J?V.collapse():V.expand(J))},O),Uo(V._view,_),V._20o[J]={content:n,div:_,canvas:Aj(_),icon:Q},V._21o.add(J),D&&V.expand(J),V.iv()},remove:function(k){var v=this,V=v._20o[k];V&&(Gp(V.div),delete v._20o[k],v._21o.remove(k),v.iv())},clear:function(){var K=this;K._21o.toArray().forEach(K.remove,K),K._20o={},K._21o.clear(),K.iv()},isExpanded:function(Y){return this._10o===Y},expand:function(N){var v=this;v._20o[N]&&v._10o!==N&&(v._10o=N,v.onExpanded(N),v.iv())},onExpanded:function(){},collapse:function(){var C=this;C._10o&&(C.onCollapsed(C._10o),delete C._10o,C.iv())},onCollapsed:function(){},initCanvas:function(G,L,A){gl(G,L,A);var Z=kc(G);return _f(Z,0,0,1),Z.clearRect(0,0,L,A),Z},drawTitle:function(F,H,U,h,D){var k=this,T=Dl(D.icon),V=k.isExpanded(H),P=k._titleHeight,E=k._titleBackground,A=k._selectWidth,t=k._separatorColor,K=Dl(V?k._expandIcon:k._collapseIcon),i=A+4;No(F,0,0,U,h,E),V&&A&&No(F,0,0,A,h,k._selectBackground),(V||k._21o.get(k._21o.size()-1)!==H)&&No(F,0,h-1,U,1,t?t:ul(E)),T&&(Jr(F,T,i+Zb(T)/2,P/2),i+=Zb(T)+2),ss(F,H,k.getLabelFont(H),k.getLabelColor(H),i,0,0,P),K&&Jr(F,K,U-Zb(K)/2-4,P/2)},validateImpl:function(){var G=this,K=G._view,C=0,Z=0,a=G.getWidth(),u=G.getHeight(),e=G._titleHeight,b=G._21o.size()*e,y=G._11o,t=G._9o;delete G._11o,delete G._9o,G._21o.each(function(n){var o,q,m=G._20o[n],U=m.content,F=G._10o===n;Nj(G)?(yk(m.div,C,0,e,u),o=G.initCanvas(m.canvas,e,u),Jh(o,0,u),Xk(o,-j),G.drawTitle(o,n,u,e,m),o.restore(),F?(q=N(0,a-b),U&&(G._11o=U,G._9o=Fj(U),yk(U,C+e,0,q,u)),C+=e+q):C+=e):(yk(m.div,0,Z,a,e),o=G.initCanvas(m.canvas,a,e),G.drawTitle(o,n,a,e,m),o.restore(),F?(q=N(0,u-b),U&&(G._11o=U,G._9o=Fj(U),yk(U,0,Z+e,a,q)),Z+=e+q):Z+=e)
});var H=G._9o;y&&y!==G._11o&&y.endEditing&&y.endEditing(),H&&H!==t&&Uo(K,H),t&&t!==H&&Gp(t)}}),yq.SplitView=function(p,h,V,S){var M=this,x=M._dividerDiv=rr(),T=M._60O=Aj(),c=M._61O=Aj(),g=T.style,q=c.style;M._view=wm(1,M),Uo(M._view,x),g.msTouchAction=Fk,g.pointerEvents=Fk,g.cursor=Ih,q.msTouchAction=Fk,q.pointerEvents=Fk,q.cursor=Ih,p&&M.setLeftView(p),h&&M.setRightView(h),V&&M.setOrientation(V),S!=U&&M.setPosition(S),M.setStatus(bq),new Wn(M)},qh("SplitView",Z,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:u.splitViewDividerSize,_dividerBackground:u.splitViewDividerBackground,_dragOpacity:u.splitViewDragOpacity,_toggleIcon:u.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(n,C){var r=this,T=r._position;isNaN(n)||(C||(r._82O=0>n?-1:n>1?1:0),r._position=n,r.fp(_l,T,n))},getLeftView:function(){return this._leftView},setLeftView:function(j){var P=this,z=P._leftView,o=P._view;if(P._leftView!==j){if(z&&z!==P._rightView){var V=Fj(z);V.parentNode===o&&Gp(V)}if(P._leftView=j,j){var S=Fj(j);S.parentNode!==o&&o.insertBefore(S,P._dividerDiv)}P.fp("leftView",z,j)}},getRightView:function(){return this._rightView},setRightView:function(z){var Q=this,x=Q._rightView,t=Q._view;if(Q._rightView!==z){if(x&&x!==Q._leftView){var o=Fj(x);o.parentNode===t&&Gp(o)}if(Q._rightView=z,z){var d=Fj(z);d.parentNode!==t&&t.insertBefore(d,Q._dividerDiv)}Q.fp("rightView",x,z)}},validateImpl:function(){var M=this,S=M._draggable,A=M._position,d=M.getWidth(),b=M.getHeight(),U=M._dividerSize,t=M._dividerBackground,Q=$d?18:8,m=M._dividerDiv,w=M._82O,u=M._60O,L=M._61O,P=M._toggleIcon,h=M._status,r=m.style,E=null,i=$d?20:4,Y=P.comps[0];U>=Q||0===U?M._coverDiv&&(Gp(M._coverDiv),delete M._coverDiv):M._coverDiv||(M._coverDiv=rr(),F&&(M._coverDiv.style.background=cm),Uo(m,M._coverDiv)),M._togglable?u.parentNode||(Uo(m,u),Uo(m,L)):(Gp(u),Gp(L));var J=M._coverDiv,K=M._leftView,O=M._rightView;if(Nj(M)){if(U>d&&(U=d),h===bq)if(1===w)var x=s(A,d),l=N(0,d-U-x);else-1===w?(l=s(-A,d),x=N(0,d-U-l)):(x=$((d-U)*A),l=N(0,d-U-x));else"cl"===h?(x=0,l=N(0,d-U)):"cr"===h&&(l=0,x=N(0,d-U));K&&yk(K,0,0,x,b),O&&yk(O,x+U,0,l,b),yk(m,x,0,U,b),M._22o=x,J&&(yk(J,U/2-Q/2,0,Q,b),J.style.cursor=S?Vb:""),m.style.cursor=S?Vb:"";var c=m.clientHeight/2,R=m.clientWidth;gl(u,R,R),yk(u,0,c-R-i,R,R),E=kc(u),_f(E,0,0,1),Y.rotation=-j,lm(E,P,0,0,R,R),E.restore(),gl(L,R,R),yk(L,0,c+i,R,R),E=kc(L),_f(E,0,0,1),Y.rotation=j,lm(E,P,0,0,R,R),E.restore()}else{if(U>b&&(U=b),h===bq)if(1===w)var e=s(A,b),Z=N(0,b-U-e);else-1===w?(Z=s(-A,b),e=N(0,b-U-Z)):(e=$((b-U)*A),Z=N(0,b-U-e));else"cl"===h?(e=0,Z=N(0,b-U)):"cr"===h&&(Z=0,e=N(0,b-U));K&&yk(K,0,0,d,e),O&&yk(O,0,e+U,d,Z),yk(m,0,e,d,U),M._22o=e,J&&(yk(J,0,U/2-Q/2,d,Q),J.style.cursor=S?Sf:""),r.cursor=S?Sf:"";var p=m.clientWidth/2,R=m.clientHeight;gl(u,R,R),yk(u,p-R-i,0,R,R),E=kc(u),_f(E,0,0,1),Y.rotation=0,lm(E,P,0,0,R,R),E.restore(),gl(L,R,R),yk(L,p+i,0,R,R),E=kc(L),_f(E,0,0,1),Y.rotation=D,lm(E,P,0,0,R,R),E.restore()}r.background=t}});var Wn=function(K){this.sv=K,this.addListeners()};ob(Wn,Z,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(d){var P=this,I=P.sv,Z=I._dividerDiv,y=I._60O,Y=I._61O,W=I._status,b=d.target;if(b===y)W===bq?I.setStatus("cl"):"cr"===W&&I.setStatus(bq);else if(b===Y)W===bq?I.setStatus("cr"):"cl"===W&&I.setStatus(bq);else if(_j(d)&&(b===Z||b===I._coverDiv)&&(td(d),I.isDraggable())){I.getLeftView(),I.getRightView();var e=P.maskDiv=rr();if(e.style.left=0,e.style.top=0,e.style.width=I.getWidth()+"px",e.style.height=I.getHeight()+"px",I.getView().appendChild(e),!I.isContinuousLayout()){var R=P.resizeDiv=rr();R.style.left=Z.style.left,R.style.top=Z.style.top,R.style.width=Z.style.width,R.style.height=Z.style.height,R.style.opacity=I.getDragOpacity(),R.style.background=I.getDividerBackground(),Uo(P.getView(),R)}P._lastAbsPosition=I._22o,P._86o=Nj(I)?Zg(d).x:Zg(d).y,Ti(P,d)}},handleWindowTouchMove:function(z){_j(z)&&this.update(z,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(V){var L=this;L.update(V,!0),L.sv.setStatus(bq),L.maskDiv&&Gp(L.maskDiv),L.resizeDiv&&Gp(L.resizeDiv),L.maskDiv=L.resizeDiv=U},handle_mousedown:function(C){lk(C)&&this.handle_touchstart(C)},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},update:function(J,N){var a=this,b=a.sv,n=Nj(b)?b.getWidth():b.getHeight(),x=b._dividerSize,S=a._lastAbsPosition-a._86o;Nj(b)?(S+=Zg(J).x,S>n-x&&(S=n-x),0>S&&(S=0),a.resizeDiv&&(a.resizeDiv.style.left=S+Wg)):(S+=Zg(J).y,S>n-x&&(S=n-x),0>S&&(S=0),a.resizeDiv&&(a.resizeDiv.style.top=S+Wg)),N&&n!==x&&(1===b._82O?b.setPosition(S,1):-1===b._82O?b.setPosition(S-n+x,1):b.setPosition(S/(n-x),1))}}),yq.TabView=function(){var W=this,$=W._view=wm(1,W),F=W._91O=rr(1),w=W._tabModel=new Ch,O=w.sm(),_=W.invalidate;W._7o=new vc,W._canvas=Aj(F),Uo($,F),Uo($,W._92O=rr(1)),O.setSelectionMode($o),O.ms(W.handleSelectionChange,W),w.mm(_,W),w.md(_,W),w.mh(_,W),W._interactor=new Aq(W),W.iv()},qh("TabView",Z,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Yk,jk,"tabBackground","selectWidth",Qd,"moveBackground","insertColor"],_tabPosition:Ij,_tabHeight:Tc,_tabGap:u.tabViewTabGap,_labelColor:u.tabViewLabelColor,_labelFont:u.tabViewLabelFont,_tabBackground:u.tabViewTabBackground,_selectWidth:u.tabViewSelectWidth,_selectBackground:u.tabViewSelectBackground,_moveBackground:u.tabViewMoveBackground,_insertColor:u.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(K,q,X){var Z,s=this._tabModel;return K instanceof Md?(Z=K,q&&Z.setView(q)):(Z=new Md,Z.setName(K),Z.setView(q)),s.add(Z),X&&s.sm().ss(Z),Z},getLabel:function(L){return L.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(Z){this._23o=Z,this.iv()},get:function(X){var R=this,u=R._tabModel;if(Rm(X))return u._roots.get(X);if(Do(X)){var b;return u.each(function(d){X===R.getLabel(d)&&(b=d)}),b}return X instanceof Md?X:U},select:function(Y){this._tabModel.sm().ss(this.get(Y))},remove:function(f){var g=this;if(f=g.get(f)){var G=g._tabModel,R=G._roots.indexOf(f);g._tabModel.remove(f),g.selectByIndex(--R)}},getCurrentTab:function(){return this._8o},hideTabView:function(i,r){r.parentNode===this._92O&&(ch(r)?(r.style.display=De,r._tab_=i):Gp(r),vf())},showTabView:function(I,n){ch(n)&&(n.style.display="block",n._tab_=I),n.parentNode!==this._92O&&(Uo(this._92O,n),vf())},_24o:function(){var $,t=this,f=t._8o,s=t._9o,S=t._tabModel.sm().ld();S&&($=Fj(S.getView())),$!==s&&(s&&(f.getView()&&f.getView().endEditing&&f.getView().endEditing(),t.hideTabView(f,s)),$&&t.showTabView(S,$)),t._8o=S,t._9o=$,f!==S&&t.onTabChanged(f,S)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(A,l){this.selectByIndex(--l)},selectByIndex:function(n){var V=this,L=V._tabModel,f=L.size();if(f&&!L.sm().ld()){n==U&&(n=0),n>=f&&(n=f-1),0>n&&(n=0);for(var m=n;m>=0;m--){var e=V.get(m);if(!e.isDisabled())return V.select(e),e}for(m=n+1;f>m;m++)if(e=V.get(m),!e.isDisabled())return V.select(e),e}},getTabWidth:function(X){var R=4,k=Dl(X.getIcon());k&&(R+=Zb(k,X)+4);var g=this.getLabel(X);return g&&(R+=Go(this.getLabelFont(X),g).width+4),X.isClosable()&&(R+=10),R},drawTab:function(E,m,x,h,g,M,z){var N,s=this,C=s._tabPosition,W=x+4,t=s._selectWidth,y=Dl(m.getIcon()),G=m.isDisabled(),l=s.getLabelColor(m),I=s.getLabelFont(m),O=s.getLabel(m),P=s._selectBackground,w=C===Qg+"-vertical",K=C===Td+"-vertical";(w||K)&&(W=h+4),G&&(E.globalAlpha=fc),No(E,x,h,g,M,z),m===s._8o&&t&&(C===Ij?No(E,x,h+M-t,g,t,P):C===Qg?No(E,x+g-t,h,t,M,P):C===Td?No(E,x,h,t,M,P):w?No(E,x+g-t,h,t,M,P):K?No(E,x,h,t,M,P):No(E,x,h,g,t,P));var L=g/2;if(w&&(Jh(E,L,h+M/2),Xk(E,D),Jh(E,-L,-h-M/2)),y){var v=Qk(y,m),B=Zb(y,m);if(w||K){var T=x+g/2,p=W+v/2;Jh(E,T,p),Xk(E,j),Jh(E,-T,-p),Jr(E,y,x+g/2,W+v/2,m,s),Jh(E,T,p),Xk(E,-j),Jh(E,-T,-p),W+=v+4}else Jr(E,y,W+B/2,h+M/2,m,s),W+=B+4}return w||K?(Jh(E,g/2,W+g/2),Xk(E,j),Jh(E,-g/2,-W-g/2),ss(E,O,I,l,x,W,M,g),Jh(E,g/2,W+g/2),Xk(E,-j),Jh(E,-g/2,-W-g/2)):ss(E,O,I,l,W,h,g,M),w&&(Jh(E,L,h+M/2),Xk(E,-D),Jh(E,-L,-h-M/2)),m.isClosable()&&(N=K?{x:x+g-12,y:h+M-12,width:12,height:12}:{x:x+g-12,y:h+2,width:12,height:12},this.drawCloseIcon(m,E,l,N)),G&&(E.globalAlpha=1),N},drawCloseIcon:function(E,H,X,l){var L=l.x,q=l.y;H.strokeStyle=X,H.lineWidth=1,H.beginPath(),H.moveTo(L+2,q+8),H.lineTo(L+8,q+2),H.moveTo(L+8,q+8),H.lineTo(L+2,q+2),H.stroke()},getTabAt:function($){var b=this._interactor._8Q($);return b?b.tab:null},validateImpl:function(){var v=this;v._24o();var T,J=v._canvas,c=v._tabPosition,r=v._91O,D=v._92O,W=v._tabModel,e=v.getWidth(),C=v.getHeight(),k=v._tabHeight,A=v._7o,$=v._tabGap,u=c===Ij,w=c===Qg,Y=c===Td,K=c===Qg+"-vertical",j=c===Td+"-vertical",L=v._23o,U=0;if((w||Y)&&W._roots.each(function(P){U=N(v.getTabWidth(P),U)}),u?(yk(r,0,0,e,k),T={x:0,y:k,width:e,height:N(0,C-k)}):w?(yk(r,0,0,U,C),T={x:U,y:0,width:N(0,e-U),height:C}):Y?(yk(r,e-U,0,U,C),T={x:0,y:0,width:N(0,e-U),height:C}):K?(yk(r,0,0,k,C),T={x:k,y:0,width:N(0,e-k),height:C}):j?(yk(r,e-k,0,k,C),T={x:0,y:0,width:N(0,e-k),height:C}):(yk(r,0,C-k,e,k),T={x:0,y:0,width:e,height:N(0,C-k)}),yk(D,T),K||j){v._9o&&(T.x=0,yk(v._8o.getView(),T)),gl(J,k,C);var h=kc(J),E=0;if(_f(h,0,v.ty(),1),h.clearRect(0,0,k,C),A.clear(),W._roots.each(function(T){var Z,t=v.getTabWidth(T);L&&L.tab===T||(Z=v.drawTab(h,T,0,E,k,t,v._tabBackground)),A.add({_75o:Z,tab:T,startY:E,endY:E+t,height:t}),E+=t+$}),v._23Q=N(0,E-$),L){var Z=L.position;v.drawTab(h,L.tab,0,L.startY,k,L.height,v._moveBackground),No(h,0,Z,k,1,v._insertColor)}if(h.restore(),v._selectionChanged){v._selectionChanged=!1;for(var f=v.ty(),n=0;n<A.size();n++){var o=A.get(n);if(o.tab===v._8o){if(o.endY+f<0){v.ty(-o.startY);break}if(o.startY+f>C){v.ty(C-o.endY);break}}}}v.ty(v.ty())}else if(w||Y){v._9o&&(T.x=0,yk(v._8o.getView(),T)),gl(J,U,C);var h=kc(J),E=0;if(_f(h,0,v.ty(),1),h.clearRect(0,0,U,C),A.clear(),W._roots.each(function(N){var j;L&&L.tab===N||(j=v.drawTab(h,N,0,E,U,k,v._tabBackground)),A.add({_75o:j,tab:N,startY:E,endY:E+k,height:k}),E+=k+$}),v._23Q=N(0,E-$),L){var Z=L.position;v.drawTab(h,L.tab,0,L.startY,U,L.height,v._moveBackground),No(h,0,Z,U,1,v._insertColor)}if(h.restore(),v._selectionChanged){v._selectionChanged=!1;for(var f=v.ty(),n=0;n<A.size();n++){var o=A.get(n);if(o.tab===v._8o){if(o.endY+f<0){v.ty(-o.startY);break}if(o.startY+f>C){v.ty(C-o.endY);break}}}}v.ty(v.ty())}else{v._9o&&(T.y=0,yk(v._8o.getView(),T)),gl(J,e,k);var h=kc(J),P=0;if(_f(h,v.tx(),0,1),h.clearRect(0,0,e,k),A.clear(),W._roots.each(function(W){var g,x=v.getTabWidth(W);L&&L.tab===W||(g=v.drawTab(h,W,P,0,x,k,v._tabBackground)),A.add({_75o:g,tab:W,startX:P,endX:P+x,width:x}),P+=x+$}),v._64I=N(0,P-$),L){var Z=L.position;v.drawTab(h,L.tab,L.startX,0,L.width,k,v._moveBackground),Cq(h,v._insertColor,Z,0,k)}if(h.restore(),v._selectionChanged){v._selectionChanged=!1;for(var I=v.tx(),n=0;n<A.size();n++){var o=A.get(n);if(o.tab===v._8o){if(o.endX+I<0){v.tx(-o.startX);break}if(o.startX+I>e){v.tx(e-o.endX);break}}}}v.tx(v.tx())}for(var M=[],S=D.children,n=0;n<S.length;n++){var t=S[n],l=t._tab_;l&&!W.contains(l)&&M.push(t)}M.forEach(function(b){D.removeChild(b)})}});var Aq=function(Z){this.tv=Z,this.addListeners()};ob(Aq,Z,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(y){this.handleScroll(y,10*(y.wheelDelta/40))},handle_DOMMouseScroll:function(x){this.handleScroll(x,10*-x.detail)},handleScroll:function(W,V){td(W);var P=this.tv,E=P._tabPosition;!P._40o()||E!==Ij&&E!==Lb||P.tx(this.tv.tx()+V),!P._41o()||E!==Qg&&E!==Td&&E!==Qg+"-vertical"&&E!==Td+"-vertical"||P.ty(this.tv.ty()+V)},_8Q:function(q){var W,x,y=this.tv,c=y._tabPosition,E=y._7o;if(c===Ij||c===Lb){var V=y.lp(q).x;for(W=0;W<E.size();W++)if(x=E.get(W),x.startX<=V&&V<=x.endX)return x}else if(c===Qg||c===Td||c===Qg+"-vertical"||c===Td+"-vertical"){var S=y.lp(q).y;for(W=0;W<E.size();W++)if(x=E.get(W),x.startY<=S&&S<=x.endY)return x}return U},isClickable:function(D){var M=this.tv,T=M._tabPosition,o=this._73o=this._8Q(D);return!M._40o()||T!==Ij&&T!==Lb?!M._41o()||T!==Qg&&T!==Td&&T!==Qg+"-vertical"&&T!==Td+"-vertical"?o&&(!o.tab.isDisabled()||M.isMovable()):!0:!0},handle_mousemove:function(p){var I=this;Hf?I._74o=I._8Q(p):I.getView().style.cursor=I.isClickable(p)?Ih:""},handle_mousedown:function(b){this.handle_mousemove(b),this.handle_touchstart(b)},handle_touchstart:function(K){var V=this,f=V.tv,G=f._tabPosition;td(K),lk(K)&&V.isClickable(K)&&(G===Ij||G===Lb?(V.x=Zg(K).x,V.lp=f.lp(K),V.tx=f.tx()):(V.y=Zg(K).y,V.lp=f.lp(K),V.ty=f.ty()),Ti(V,K))},handleWindowMouseMove:function(h){this.handleWindowTouchMove(h)},handleWindowTouchMove:function(o){var k,P=this,u=P.tv,b=u._tabPosition,A=P._73o;if(b===Ij||b===Lb){if(k=Zg(o).x-P.x,!P._25o&&!P.moving&&v(k)>2&&(u._40o()&&!ds(o)?P._25o=1:A&&u.isMovable()&&(P.moving=1)),P._25o)u.tx(P.tx+k);else if(P.moving){var w=P.lp.x+k,m=u._tabGap/2;u._7o.each(function(e){var q=e.endX,Z=w-e.startX<q-w;w>=e.startX&&q>=w&&u._7Q({tab:A.tab,startX:A.startX+k,width:A.width,front:Z,insertTab:e.tab,position:Z?N(0,e.startX-m):s(u._64I,q+m)})})}}else if(k=Zg(o).y-P.y,!P._25o&&!P.moving&&v(k)>2&&(u._41o()&&!ds(o)?P._25o=1:A&&u.isMovable()&&(P.moving=1)),P._25o)u.ty(P.ty+k);else if(P.moving){var L=P.lp.y+k,m=u._tabGap/2;u._7o.each(function(G){var q=G.endY,T=L-G.startY<q-L;L>=G.startY&&q>=L&&u._7Q({tab:A.tab,startY:A.startY+k,height:A.height,front:T,insertTab:G.tab,position:T?N(0,G.startY-m):s(u._23Q,q+m)})})}},handleWindowMouseUp:function(N){this.handleWindowTouchEnd(N)},handleWindowTouchEnd:function(){var Q=this,D=Q.tv,v=D._tabPosition,M=D.getTabModel(),k=M._roots,q=Q._73o;if(Q.moving){var $=D._23o;if($&&$.insertTab!==$.tab){var C=$.tab,c=k.remove(C),z=k.indexOf($.insertTab);z>=0&&($.front||z++,z<=k.size()&&(k.add(C,z),M._38I(C,c,z)))}D._7Q(U),delete Q.moving}else if(!Q._25o&&q){C=q.tab;var X=Q._74o;if(!X||X.tab===C)if(!C.isDisabled()&&ce(q._75o,Q.lp)){var n=function(){var w=k.indexOf(C);M.remove(C),D.onTabClosed(C,w)};D.onTabClosing(C,n)&&n()}else C.isDisabled()||D._8o===C||M.sm().ss(C)}Q._25o=Q._73o=Q._74o=v===Ij||v===Lb?Q.x=Q.lp=Q.tx=U:Q.y=Q.lp=Q.ty=U}}),yq.PropertyView=function(s){var M=this;M._view=wm(1,M),M._canvas=Aj(M._view),Uo(M._view,M._79O=rr()),M._rows=new vc,M._28o=new vc,M._26o={},M._26Q={};var v=M._propertyModel=new Ch,X=M.ivm;v.mm(X,M),v.md(X,M),v.mh(X,M),M.dm(s?s:new Ch),new $n(M)},qh("PropertyView",Z,{ms_ac:[Yk,aq,jk,qn,lr,"categorizable",Hd,kh,ve,Tf,tl,iq,Yo,bf,"selectRowIndex",Qd,"background",am,Ld,xo,_b,uh],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Ng,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Rj,_background:u.propertyViewBackground,_expandIcon:u.propertyViewExpandIcon,_collapseIcon:u.propertyViewCollapseIcon,_scrollBarColor:Rb,_scrollBarSize:Gc,_autoHideScrollBar:jh,_selectBackground:u.propertyViewSelectBackground,_rowHeight:Mh,_rowLineVisible:u.propertyViewRowLineVisible,_rowLineColor:u.propertyViewRowLineColor,_10I:.5,_columnLineVisible:u.propertyViewColumnLineVisible,_columnLineColor:u.propertyViewColumnLineColor,_labelColor:u.propertyViewLabelColor,_labelSelectColor:u.propertyViewLabelSelectColor,_labelFont:u.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(v){0>v&&(v=0),v>1&&(v=1);var K=this,Q=K._10I;K._10I=v,K.fp("columnPosition",Q,v)},getPropertyName:function($){return $.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(f,A,i){return i===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(o,i){return i===this._selectRowIndex?this._labelSelectColor:o.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(e){var a=this.getHeight()-this._59I;return a>e&&(e=a),e>0?0:$(e)},isExpanded:function($){if(!$)return!0;var o=this._26o[$];return o?o.isExpanded:!(this._26Q[$]===!1)},toggle:function(a){var v=this;v.isExpanded(a)?v.collapse(a):v.expand(a)},expandAll:function(){this.validate();for(var M in this._26o)this.expand(M)},expand:function(C){if(C&&C!==De){var W=this,B=W._26o[C];B&&!B.isExpanded&&(B.isExpanded=!0,W.onExpanded(C),W.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var v in this._26o)this.collapse(v)},collapse:function(C){if(C&&C!==De){var y=this,O=y._26o[C];O&&O.isExpanded&&(O.isExpanded=!1,y.onCollapsed(C),y.ivm())}},onCollapsed:function(){},getCategoryName:function(X){if(!this.isCategorizable())return De;var d=X.getCategoryName();return d?d:De},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(f){var n=this,B=n._dataModel;B!==f&&(B&&(B.umd(n.handlePropertyChange,n),n._selectionModel||B.sm().ums(n.handleSelectionChange,n)),n._dataModel=f,f.md(n.handlePropertyChange,n),n._selectionModel?n._selectionModel._21I(f):f.sm().ms(n.handleSelectionChange,n),n.fp(Og,B,f))},isVisible:function(V){return this._visibleFunc?this._visibleFunc(V):!0},onPropertyChanged:function(C){var E=this,m=C.property;$l[m]?E.ivm():E.iv(),m===Hc&&E._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:zg},handlePropertyChange:function(Z){this._27o===Z.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var V=this;V._96I||(V.setSelectRowIndex(-1),V._96I=1,V.iv())},redraw:function(){this.iv()},validateModel:function(){var T=this,s=T._rows,K=T._28o,O={},m=new vc,e=T._27o;T.updateCurrentData(),e!==T._27o&&T.endEditing(),s.clear(),K.clear(),T.getRawProperties().each(function(l){if(T.isVisible(l)){m.add(l);var w=T.getCategoryName(l);O[w]||(K.add(w,w===De?0:g),O[w]={isExpanded:T.isExpanded(w),properties:new vc})}}),T._sortFunc&&m.sort(T._sortFunc);for(var N in T._26o)T._26Q[N]=T.isExpanded(N);T._26o=O,K.each(function(x){x!==De&&s.add(x);var i=O[x];i.isExpanded&&m.each(function(a){T.getCategoryName(a)===x&&(i.properties.add(a),s.add({property:a,data:T._27o}))},T)})},validateImpl:function(){var k=this;k._76o(),k._96I&&(k.validateModel(),delete k._96I);var E=k._canvas,G=k.getWidth(),P=k.getHeight(),r=-k.ty(),t=k._rowHeight,J=k._indent,h=G-J,I=k._rows,n=I.size(),l=k._9I=J+h*k._10I,$=k._59I=n*t;gl(E,G,P),k._29I={x:0,y:r,width:G,height:P},k._31I=d(r/t),k._14I=e((r+P)/t),k._31I<0&&(k._31I=0),k._14I>n&&(k._14I=n);var H,A=kc(E),K=k._background;_f(A,0,-r,1),A.beginPath(),A.rect(0,r,G,P),A.clip(),A.clearRect(0,r,G,P),k._93db(A),K&&No(A,0,0,J,$,K);for(var j=k._31I;j<k._14I;j++){var s=I.get(j),r=t*j;if(Do(s))K&&No(A,J,r,h,t,K),H=Dl(k.isExpanded(s)?k._expandIcon:k._collapseIcon),H&&Dj(A,H,pk,0,r,J,t),A.save(),A.beginPath(),A.rect(J,r,h,t),A.clip(),k.drawCategoryName(A,s,j,J,r,h,t),A.restore();else{var V=s.property,p=s.data,H=Dl(V.getIcon()),Y=k._selectRowIndex===j?k.getSelectBackground():U;if(H&&Dj(A,H,pk,0,r,J,t),Y&&No(A,J,r,h,t,Y),A.save(),A.beginPath(),A.rect(J,r,l-J,t),A.clip(),k.drawPropertyName(A,V,j,J,r,l-J,t),A.restore(),!k.isEditing(p,V)){var c=l+1,w=G-l-1;A.save(),A.beginPath(),A.rect(c,r,w,t),A.clip(),k._87o(k.drawPropertyValue(A,V,k.getValue(p,V),j,c,r,w,t,p),j,c,r,w,t),A.restore()}}k._rowLineVisible&&No(A,J,r+t-1,h,1,k._rowLineColor)}k._columnLineVisible&&(No(A,l,0,1,$,k._columnLineColor),No(A,G-1,0,1,$)),k._92db(A),k._93I(),A.restore(),k.ty(k.ty())},drawCategoryName:function(M,L,U,D,b,u,l){ss(M,L,this.getCategoryFont(L),this.getCategoryColor(L),D,b,u,l)},drawPropertyName:function(y,q,K,E,p,I,B){return q.drawPropertyName?(q.drawPropertyName(y,q,K,E,p,I,B,this),void 0):(ss(y,this.getPropertyName(q),this.getPropertyFont(q,K),this.getPropertyColor(q,K),E,p,I,B),void 0)},drawPropertyValue:function(j,X,O,l,Q,c,L,I,C){return X.drawPropertyValue?X.drawPropertyValue(j,X,O,l,Q,c,L,I,C,this):(Sj(j,O,X,this.getLabelFont(X,O,l),this.getLabelColor(X,O,l),Q,c,L,I,C,this),void 0)},isPropertyEditable:function(G){return G.isEditable()&&this.isEditable()},setProperties:function(H){this._propertyModel.clear(),this.addProperties(H)},addProperties:function(x){if(x){var W=this._propertyModel;x.forEach(function(r){if(!(r instanceof Gl)){var u=Ir(r.className);r=qf(u?u:Gl,r)}W.add(r)})}},getRowIndexAt:function(T){var J=this,F=d(J.lp(T).y/J._rowHeight);return F>=0&&F<J._rows.size()?F:-1},getPropertyAt:function(t){var n=this,B=n.getRowIndexAt(t);return B>=0?n._rows.get(B).property:U},getToolTip:function(Q){var h=this,A=h.getPropertyAt(Q),O=h._27o;return A&&O?A.getToolTip(O,h._9I<h.lp(Q).x,h):U}});var $n=function(f){this.pv=f,this.addListeners()};ob($n,Z,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(c){this.getView().style.cursor=c},clear:function(){var M=this;M._62O=M.cp=M.ty=M.p=U,M.setCursor(Yh)},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(s){var P=this,H=P.pv;td(s),H.setFocus(s)&&(lk(s)?(P.cp=Zg(s),P.ty=H.ty(),P.p=H.getColumnPosition(),P.handle_touchmove(s)):H.setSelectRowIndex(H.getRowIndexAt(s)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(D){this.handle_touchend(D)},handle_touchend:function(n){var V=this;if(V.cp&&!V._62O){var M=V.pv,G=M.lp(n),y=G.x,Z=G.y,Q=M._indent,e=M.getRowIndexAt(n),E=M._9I;if(e>=0){var D=M._rowHeight,H=D*e,P=M._rows.get(e),R=P.property;if(Do(P))Dl(M.isExpanded(P)?M._expandIcon:M._collapseIcon)&&y>=0&&Q>=y&&Z>=H&&H+D>=Z?M.toggle(P):qc(n)&&M.toggle(P);else if(y>E&&M.isPropertyEditable(R,n)){var f={x:E+1,y:H,width:M.getWidth()-E-1,height:D},A={x:f.x+M.tx(),y:f.y+M.ty(),width:f.width,height:f.height},$=0,h=M._29I;f.y<h.y?$=f.y-h.y:f.y+D>h.y+h.height&&($=f.y+D-h.y-h.height),$&&(M.ty(M.ty()-$),A.y-=$),M.beginEditing({data:P.data,property:R,value:M.getValue(P.data,R),event:n,rect:f,editorRect:A,view:M})}}M.setSelectRowIndex(e)}V.clear()},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(u){var W=this,n=W.pv,r=W.ty,i=W.cp,p=Zg(u),c=W._62O;if("p"===c)n.setTranslateY(r+p.y-i.y);else if("c"===c){var M=n.getWidth()-n._indent;if(M>16){var x=W.p-(i.x-p.x)/M,V=16/M;V>x&&(x=V),x>1-V&&(x=1-V),n.setColumnPosition(x)}}else"s"===c&&n.setTranslateY(r+(i.y-p.y)*n._59I/n._29I.height)},handle_mousemove:function(b){this.handle_touchmove(b)},handle_touchmove:function(G){if(!Hf&&lk(G)){var b=this,f=b.pv,p=v(f.lp(G).x-f._9I)<=($d?8:3);b.cp?b._62O||(p?(b._62O="c",Ti(b)):v(Zg(G).y-b.cp.y)>=2&&(b._62O=b.isV(G)?"s":"p",Ti(b))):(p?b.setCursor(Vb):b.setCursor(Yh),b.isV(G)&&f._43o())}},isV:function(r){var U=this.pv,j=U._29I;return U._41o()&&j.x+j.width-U.lp(r).x<cp},handle_mousewheel:function(g){this.handleScroll(g,g.wheelDelta/40)},handle_DOMMouseScroll:function(v){2===v.axis&&this.handleScroll(v,-v.detail)},handleScroll:function(Z,m){var d=this.pv;td(Z),d.endEditing(),d.translate(0,m*d.getRowHeight())},handle_keydown:function(Z){var w=this.pv,y=w._rows.size(),h=w._selectRowIndex+(jl(Z)?-1:1);(jl(Z)||Lr(Z))&&(0>h&&(h=0),h>=y&&(h=y-1),w.setSelectRowIndex(h))}}),yq.ListView=function(G){this._5o(G),new gj(this)},qh("ListView",Z,{ms_ac:[Yk,aq,jk,am,Hd,Ld,xo,kh,ve,iq,Yo,bf,ol,Qd],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Rj,_rowHeight:Mh,_rowLineVisible:u.listViewRowLineVisible,_rowLineColor:u.listViewRowLineColor,_scrollBarColor:Rb,_scrollBarSize:Gc,_autoMakeVisible:ok,_autoHideScrollBar:jh,_selectBackground:u.listViewSelectBackground,_labelColor:u.listViewLabelColor,_labelSelectColor:u.listViewLabelSelectColor,_labelFont:u.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(l){var Y=this,H=Y._checkMode;Y._checkMode=l,Y.fp(Ob,H,l)},drawRow:function(c,V,h,r,b,R,i){var z=this,y=0,P=z._indent,a=z.getIconWidth(V);z.drawRowBackground(c,V,h,r,b,R,i),z._checkMode&&(Jr(c,Dl(z.getCheckIcon(V)),y+P/2,b+i/2,V,z),y+=P),z.drawIcon(c,V,y,b,a,i),z.drawLabel(c,V,y+a,b,i)}});var gj=function(K){this.list=K,this._lastSelectDataTime=Zc(),this.addListeners()};ob(gj,Z,{ms_listener:1,getView:function(){return this.list._view},clear:function(g){var l=this,A=l.list;g&&"d"===l._62O&&!l.dragCancel&&A.handleDragAndDrop(g,"end"),A.draggingData&&(A.draggingData=null,A.redraw()),l.dragCancel=l._62O=l._isV=l._isH=l.cp=l.tx=l.ty=U},handle_mousedown:function(C){this.handle_touchstart(C)},handle_touchstart:function(t){var b=this,C=b.list;if(td(t),C.setFocus(t)){var e=C.getDataAt(t);b.cp=Zg(t),b.tx=C.tx(),b.ty=C.ty(),lk(t)?e&&C.handleDragAndDrop&&!b.isV(t)&&!b.isH(t)&&(C.draggingData=e,C.redraw(),C.handleDragAndDrop(t,"prepare")):(e&&b._33o(t,e),b.clear(t))}},handleWindowMouseUp:function(f){this.clear(f)},handleWindowTouchEnd:function(U){this.clear(U)},handle_mouseup:function(M){this.handle_touchend(M)},handle_touchend:function(K){var f=this,F=f.list;if(!f._isV&&!f._isH&&f.cp&&!f._62O){var Q=F.getDataAt(K);Q?(F.isCheckMode()?f._34o(K,Q):f._33o(K,Q),qc(K)?F.onDataDoubleClicked(Q,K):F.onDataClicked(Q,K)):F.handleBackgroundClick(K)}f.clear(K)},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(c){var d=this,_=d.list,Y=d._62O,T=d.tx,b=d.ty,t=d.cp,h=Zg(c),S=_._29I;"p"===Y?_.setTranslate(T+h.x-t.x,b+h.y-t.y):"v"===Y?_.ty(b+(t.y-h.y)*_._59I/S.height):"h"===Y?_.tx(T+(t.x-h.x)*_._91I/S.width):"d"===Y&&(d.dragCancel||_.handleDragAndDrop(c,"between"))},handle_mousemove:function(F){this.handle_touchmove(F)},handle_touchmove:function(Z){if(!Hf&&lk(Z)){var o=this,L=o.list;if(o._isV=o.isV(Z),o._isH=o.isH(Z),o.cp){if(!o._62O){if(Pq(Zg(Z),o.cp)<2)return;o._isV?o._62O="v":o._isH?o._62O="h":L.draggingData&&!this.dragCancel?(o._62O="d",L.handleDragAndDrop(Z,"begin")):o._62O="p",o._62O&&"d"!==o._62O&&L.draggingData&&(L.draggingData=null,L.redraw()),Ti(o)}}else o._isV&&L._43o(),o._isH&&L._42o()}},isV:function(B){var l=this.list,q=l._29I;return l._41o()&&q.x+q.width-l.lp(B).x<cp},isH:function(e){var g=this.list,n=g._29I;return g._40o()&&n.y+n.height-g.lp(e).y<cp},handle_mousewheel:function(H){this.handleScroll(H,H.wheelDelta/40,H.wheelDelta!==H.wheelDeltaX)},handle_DOMMouseScroll:function(o){this.handleScroll(o,-o.detail,1)},handleScroll:function(i,y,s){var r=this.list;td(i),r.endEditing&&r.endEditing(),s&&r._41o()?r.translate(0,y*r.getRowHeight()):r._40o()&&r.translate(10*y,0)},handle_keydown:function(Y){if(!u.isInput(Y.target)){var R,H=this.list,V=H.sm(),G=H._rows,S=G.size();if(Co(Y))H.selectAll();else if(Jc(Y))H.handleDelete&&H.handleDelete(Y);else if(ip(Y))"d"!==this._62O||this.dragCancel||(H.handleDragAndDrop(Y,"cancel"),this.dragCancel=!0);else if(Lo(Y))H.isCheckMode()&&(R=H.getFocusData(),R&&H.checkData(R));else if(jl(Y)||Lr(Y)){var B=H.isCheckMode();if(R=B?H.getFocusData():V.ld()){var W=H.getRowIndex(R);W>=0&&(jl(Y)?0!==W&&(R=G.get(W-1),B?H.setFocusData(R):V.ss(R)):W!==S-1&&(R=G.get(W+1),B?H.setFocusData(R):V.ss(R)))}else S>0&&(R=G.get(0),B?H.setFocusData(R):V.ss(R))}}},_34o:function(Q,F){var B=this.list,v=B.lp(Q).x;return v>=0&&v<=B._indent?(B.checkData(F),void 0):(B.setFocusData(F),void 0)},_33o:function(p,B){var d=this.list,i=d.sm(),b=i.ld();if(ds(p))d.isSelected(B)?i.rs(B):i.as(B);else if(Cl(p))if(b)for(var l=d.getRowIndex(b),C=d.getRowIndex(B);l!==C;)l+=C>l?1:-1,i.as(d._rows.get(l));else i.ss(B);else if(lk(p)){var P=Zc();if(i.contains(B)){var o=P-this._lastSelectDataTime;d.handleDataDoubleSelect&&o>500&&1500>o&&d.handleDataDoubleSelect(p,B)}i.ss(B),this._lastSelectDataTime=P}else i.contains(B)||i.ss(B)}}),yq.TreeView=function(R){var P=this;P._35o(),P._5o(R),new np(P)},qh("TreeView",Z,{ms_ac:[Yk,aq,jk,"rootVisible",Ob,"rootData",kh,ve,iq,Yo,bf,Hd,am,Ld,xo,Tf,tl,ol,Qd,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:U,_indent:Rj,_rowHeight:Mh,_rowLineVisible:u.treeViewRowLineVisible,_rowLineColor:u.treeViewRowLineColor,_scrollBarColor:Rb,_scrollBarSize:Gc,_autoHideScrollBar:jh,_expandIcon:u.treeViewExpandIcon,_collapseIcon:u.treeViewCollapseIcon,_autoMakeVisible:ok,_selectBackground:u.treeViewSelectBackground,_labelColor:u.treeViewLabelColor,_labelSelectColor:u.treeViewLabelSelectColor,_labelFont:u.treeViewLabelFont,_doubleClickToToggle:u.treeViewDoubleClickToToggle,drawRow:function(_,U,q,y,G,Z,l){var Y=this;Y.drawRowBackground(_,U,q,y,G,Z,l),Y._97I(_,U,q,0,G,Z,l)},isOnToggleIcon:function(l){var I=this.getDataAt(l);if(I){var O=this.getIndent(),e=this.lp(l).x;if(Dl(this.getToggleIcon(I))){var f=O*this.getLevel(I);if(e>=f&&f+O>=e)return!0}}return!1}});var np=function(V){Sc(np,this,[V])};ob(np,gj,{toggle:function(p,q,w,d){var Y=this.list,S=Y.lp(p).x;if(Dl(Y.getToggleIcon(q))){var G=w*d;if(S>=G&&G+w>=S)return Y.toggle(q),!0}return Y.isDoubleClickToToggle()&&qc(p)?(Y.toggle(q),!0):!1},_34o:function(y,Q){var v=this.list,u=v.lp(y).x,c=v._levelMap[Q._id],T=v._indent,B=T*(c+1);return u>=B&&B+T>=u?(v.checkData(Q),void 0):(this.toggle(y,Q,T,c)||v.setFocusData(Q),void 0)},_33o:function(k,m){var h=this,H=h.list;h.toggle(k,m,H._indent,H.getLevel(m))||np.superClass._33o.call(h,k,m)},handle_keydown:function(T){if(pf(T)||wf(T)){var z=this.list,Z=z._rows,S=z.isCheckMode(),C=z.sm(),b=S?z.getFocusData():C.ld();b?b.hasChildren()&&(pf(T)?z.collapse(b):z.expand(b)):Z.size()>0&&(b=Z.get(0),S?z.setFocusData(b):C.ss(b))}else np.superClass.handle_keydown.call(this,T)}});var Oe=yq.TableView=function(v){this._98I(),this._5o(v),new Zn(this)};qh("TableView",Z,{ms_ac:[Yk,aq,jk,"sortMode",qn,lr,am,Ld,xo,_b,uh,"sortColumn",kh,ve,iq,Yo,bf,ol,Qd],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Bb,_editable:!0,_batchEditable:!1,_rowHeight:Mh,_rowLineVisible:u.tableViewRowLineVisible,_rowLineColor:u.tableViewRowLineColor,_columnLineVisible:u.tableViewColumnLineVisible,_columnLineColor:u.tableViewColumnLineColor,_scrollBarColor:Rb,_scrollBarSize:Gc,_autoHideScrollBar:jh,_autoMakeVisible:ok,_selectBackground:u.tableViewSelectBackground,_labelColor:u.tableViewLabelColor,_labelSelectColor:u.tableViewLabelSelectColor,_labelFont:u.tableViewLabelFont,getCheckColumn:function(){var G=this;if(!G._31o){var M=G._31o=new Bg;M.setEditable(!0),M.setWidth(40),M.getValue=G.getCheckColumValue,M.drawCell=G.drawCheckColumnCell}return G._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(Y){var X=this,f=X._39o,e=X.getCheckColumn();Y!==X.isCheckMode()&&(Y?f.add(e,0):f.remove(e),X.fp(Ob,!Y,Y))},getCheckColumValue:function(P,a,h){return h.isSelected(P)},drawCheckColumnCell:function(x,F,n,g,U,N,G,T,P){Jr(x,P.getCheckIcon(F),U+G/2,N+T/2,F,P)}});var Zn=function(R){Sc(Zn,this,[R])};ob(Zn,gj,{_34o:function(s,$){var D=this.list,c=D._31o;if(D.isCellEditable($,c,s)){var C=D._3Q(c),b=D.lp(s).x;if(C&&b>=C.startX&&b<C.startX+c.getWidth())return D.checkData($),void 0}D._37O($,s),D.setFocusData($)},_33o:function(j,c){this.list._37O(c,j),Zn.superClass._33o.apply(this,arguments)}});var ro=yq.TreeTableView=function(j){var c=this,G=c._4o=new Bg;c._35o(),c._98I(),c._5o(j),G.setDisplayName("Name"),G.setEditable(!0),G.setWidth(180),G.drawCell=sj,G.getValue=Wj,c._39o.add(G),new jo(c)},sj=function(t,Y,A,n,m,Z,u,U,R){R._97I(t,Y,A,m,Z,u,U)},Wj=function(J,q,Q){return Q.getLabel(J)};qh("TreeTableView",Z,{ms_ac:[Yk,aq,jk,"sortMode",qn,lr,Hd,Ob,"rootData","rootVisible",kh,ve,"sortColumn",Tf,tl,iq,Yo,bf,ol,xo,am,Ld,_b,uh,Qd,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Bb,_checkMode:U,_editable:!0,_batchEditable:!1,_indent:Rj,_rowHeight:Mh,_rowLineVisible:u.treeTableViewRowLineVisible,_rowLineColor:u.treeTableViewRowLineColor,_columnLineVisible:u.treeTableViewColumnLineVisible,_columnLineColor:u.treeTableViewColumnLineColor,_expandIcon:u.treeTableViewExpandIcon,_collapseIcon:u.treeTableViewCollapseIcon,_scrollBarColor:Rb,_scrollBarSize:Gc,_autoHideScrollBar:jh,_autoMakeVisible:ok,_selectBackground:u.treeTableViewSelectBackground,_labelColor:u.treeTableViewLabelColor,_labelSelectColor:u.treeTableViewLabelSelectColor,_labelFont:u.treeTableViewLabelFont,getTreeColumn:function(){return this._4o
}});var jo=function(u){Sc(jo,this,[u])};ob(jo,gj,{_34o:function(r,j){var q=this.list,Z=q._4o,d=q._3Q(Z),D=q.lp(r).x;if(d){var i=q._indent,B=d.startX+i*q.getLevel(j);if(Dl(q.getToggleIcon(j))&&D>=B&&B+i>=D)return q.toggle(j),void 0;if(q.isCellEditable(j,Z)&&(B+=i,D>=B&&B+i>=D))return q.checkData(j),void 0}q._37O(j,r),q.setFocusData(j)},_33o:function(T,x){var f=this.list,Q=f.lp(T).x;if(Dl(f.getToggleIcon(x))){var o=f._3Q(f._4o);if(o){var h=f._indent,p=o.startX+h*f.getLevel(x);if(Q>=p&&p+h>=Q)return f.toggle(x),void 0}}f._37O(x,T),jo.superClass._33o.apply(this,arguments)}});var sq=yq.TableHeader=function(l){var o=this,s=o._view=wm(1,o),M=o._39o=l.getColumnModel(),D=o.iv;o.tv=o._tableView=l,o._60I=new vc,o._canvas=Aj(s),s.style.background=u.tableHeaderBackground||"",s.style.height=pp+Wg,M.mm(D,o),M.md(D,o),M.mh(D,o),l.mp(function(f){ld[f.property]&&o.iv()},o),new qe(o),o.iv()};qh("TableHeader",Z,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Yk,jk,Hd,"moveBackground","insertColor",_b,uh,"resizable","movable"],_checkIcon:tr,_movable:!0,_resizable:!0,_labelColor:u.tableHeaderLabelColor,_labelFont:u.tableHeaderLabelFont,_columnLineColor:u.tableHeaderColumnLineColor,_columnLineVisible:u.tableHeaderColumnLineVisible,_sortDescIcon:u.tableHeaderSortDescIcon,_sortAscIcon:u.tableHeaderSortAscIcon,_moveBackground:u.tableHeaderMoveBackground,_insertColor:u.tableHeaderInsertColor,_indent:Rj,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(p){return p.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(F){return F.getColor()||this._labelColor},getLabelAlign:function(j){return j._align},onPropertyChanged:function(){this.iv()},_5Q:function(Q){this._61I=Q,this.iv()},getLogicalPoint:function(z){return Qj(z,this._canvas,this.tv.tx())},validateImpl:function(){var P=this,u=P._canvas,F=P.getWidth(),U=P.getHeight(),H=P.tv,L=P._60I,E=P._61I,M=-H.tx(),s=0;(F!==u.clientWidth||U!==u.clientHeight)&&gl(u,F,U),L.clear(),P._39o._roots.each(function(o){if(o.isVisible()){var l=s+o.getWidth();M+F>=s&&l>=M&&L.add({column:o,startX:s}),s=l}});var T=kc(u);if(_f(T,-M,0,1),T.beginPath(),T.rect(M,0,F,U),T.clip(),T.clearRect(M,0,F,U),L.each(function(x){var l=x.column,G=x.startX,s=l.getWidth();s>0&&(T.save(),T.beginPath(),T.rect(G,0,s,U),T.clip(),E&&E.column===l||P.drawColumn(T,l,G,0,s,U),P._columnLineVisible&&No(T,G+s-1,0,1,U,P._columnLineColor),T.restore())}),E){var y=E.column,s=E.startX,q=E.position,J=y.getWidth();T.save(),T.beginPath(),T.rect(s,0,J,U),T.clip(),T.fillStyle=P._moveBackground,T.fill(),P.drawColumn(T,y,s,0,J,U),T.restore(),Cq(T,P._insertColor,q,0,U)}T.restore()},_6Q:function(z){var D=this.tv;return D._31o===z&&D.sm().getSelectionMode()===$f},drawColumn:function(n,J,r,C,d,l){var w=this,$=w.tv,q=Dl(J.getIcon()),V=w.getLabelAlign(J);if(w._6Q(J)){var A=Dl(w._checkIcon);Jr(n,A,r+d/2,C+l/2,J,w)}else{var G=w.getLabel(J),x=w.getLabelFont(J),v=w.getLabelColor(J),P=Go(x,G).width,j=q?w._indent:0;V===Qg?(q&&Dj(n,q,pk,r,C,j,l),ss(n,G,x,v,r+j,C,d,l,Qg)):V===Td?(q&&Dj(n,q,pk,r+d-P-j,C,j,l),ss(n,G,x,v,r,C,d,l,Td)):(q&&Dj(n,q,pk,r+(d-P-j)/2,C,j,l),ss(n,G,x,v,r+(d-P+j)/2,C,0,l,Qg))}if(J.isSortable()&&$.getSortColumn()===J&&(q=Dl(J.getSortOrder()===Fn?w._sortAscIcon:w._sortDescIcon))){var T=Zb(q,J)/2+2;Jr(n,q,V===Td?r+T:r+d-T,C+l/2,J,$)}}});var qe=function(g){var a=this;a.th=g,a.tv=g._tableView,a.addListeners()};ob(qe,Z,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(u){this.getView().style.cursor=u},handle_mousemove:function(c){if(!Hf){var $=this;delete $._29o,$.setCursor(Yh);for(var p=$.th,a=p._60I,L=p.lp(c).x,d=a.size()-1;d>=0;d--){var e=a.get(d),A=e.column,_=e.startX+A.getWidth();if(p.isResizable()&&v(_-L)<=($d?10:3))return $._29o=e,$.setCursor(Vb),void 0;L>e.startX&&_>L&&($._29o=e),(A.isClickable()||A.isSortable()||p.isMovable()||$.tv.getCheckColumn&&A===$.tv.getCheckColumn())&&L>e.startX&&_>L&&$.setCursor(Ih)}}},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function($){var Y=this;td($),Y.tv.endEditing(),Y.handle_mousemove($),Y._29o&&(Y.x=Zg($).x,Y.lx=Y.th.lp($).x,Y.w=Y._29o.column.getWidth(),Ti(Y,$))},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function($){var Q=this,a=Q.th,E=Q.getView().style.cursor,t=Q._29o,F=Zg($).x-Q.x;if(Q.resizing||Q.moving||(E===Vb?Q.resizing=1:a.isMovable()&&E===Ih&&v(F)>2&&(Q.moving=1)),Q.resizing)t.column.setWidth(Q.w+F);else if(Q.moving){var m=Q.lx+F;a._60I.each(function(C){var s=C.startX,K=s+C.column.getWidth();if(m>=s&&K>=m){var u={column:t.column,startX:t.startX+F,front:K-m>m-s,insertColumn:C.column};u.position=u.front?s:K,a._5Q(u)}})}},_16Q:function(V,f){var O=this,I=O.tv,g=O.th,z=g._checkIcon;if(g._6Q(V)){var d=Dl(z),D=O.lx,m=V.getWidth(),h=Zb(d,V);if(D>=f+m/2-h&&f+m/2+h>=D){g.setCheckIcon(z===Zh?tr:Zh);var u=I.sm(),G=I._rows;return z===Zh?u.rs(G):u.ss(G),I.onCheckColumnClicked(V),!0}}return!1},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(b){var Q=this,Y=Q.tv,w=Q.th,Z=Q._29o;if(Q.moving){var G=w._61I;if(G&&G.insertColumn!==G.column){var e=G.column,P=Y.getColumnModel()._roots,O=P.remove(e),q=P.indexOf(G.insertColumn);q>=0&&(G.front||q++,q<=P.size()&&(P.add(e,q),Y.getColumnModel()._38I(e,O,q)))}w._5Q(U),delete Q.moving}else if(!Q.resizing&&Z){e=Z.column;var L=w.lp(b).x,B=Z.startX,C=!0;if(w.onColumnClicked){var l=w.onColumnClicked(e,b,B);l===!1&&(C=!1)}if(C&&L>=B&&L<=B+e.getWidth()&&!Q._16Q(e,B)){if(e.isSortable()){var v=Y.getSortMode(),W=e.getSortOrder();v===Bb?Y.getSortColumn()===e?(W===rn&&Y.setSortColumn(U),e.setSortOrder(W===Fn?rn:Fn)):Y.setSortColumn(e):"bistate"===v&&(Y.getSortColumn()===e?e.setSortOrder(W===Fn?rn:Fn):Y.setSortColumn(e))}Y.onColumnClicked(e,b,B)}}Q._29o=Q.resizing=Q.x=Q.lx=Q.w=U}}),yq.TablePane=function(Q){this.init(new Oe(Q))},qh("TablePane",Z,{ms_v:1,_44o:1}),yq.TreeTablePane=function(L){this.init(new ro(L))},qh("TreeTablePane",Z,{ms_v:1,_44o:1}),yq.Toolbar=function(b){var B=this,T=B._view=wm(1,B),Z=T.style;Z.background=u.toolbarBackground||"",Z.height=Tc+Wg,B._canvas=Aj(T),B._30o=new vc,B._90I=new vc,B.setItems(b||[]),T.handleGroupSelectedChanged=function(g){if(g.isSelected()){var $=g.getGroupId();null!=$&&B._items.forEach(function(N){var n=N.element;n&&n!==g&&n.setSelected&&n.getGroupId&&n.getGroupId()===$&&n.setSelected(!1)})}},new al(B)},qh("Toolbar",Z,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Qb,Yk,jk,aq,Qd,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:u.toolbarLabelColor,_labelSelectColor:u.toolbarLabelSelectColor,_labelFont:u.toolbarLabelFont,_selectBackground:u.toolbarSelectBackground,_itemGap:u.toolbarItemGap,_separatorColor:u.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(O){var B=this.getItemInfoAt(O);return B?B.item.toolTip:U},getLabelColor:function(Y){return Y&&Y.selected&&Y.type!==Zh&&Y.type!==Ar?this._labelSelectColor:this._labelColor},onPropertyChanged:function(m){this.iv(),m.property===Qb&&this._items.forEach(function(g){Xq(g)})},redraw:function(){this.iv()},addItem:function(e,I){var h=this._items;I==U?h.push(e):h.splice(I,0,e),this.fp(Qb,U,h)},removeItem:function(S){if(S)for(var v=this._items,d=0;d<v.length;d++)S===v[d]&&(v.splice(d,1),this.fp(Qb,U,v))},removeItemById:function(I){if(I!=U)for(var $=this._items,u=0;u<$.length;u++)if(I===$[u].id){var X=$.splice(u,1)[0];return this.fp(Qb,U,$),X}},getItemById:function(G){if(G!=U)for(var N=this._items,c=0;c<N.length;c++){var g=N[c];if(G===g.id)return g}},setItemVisible:function(n,w){var A=this.getItemById(n);A&&(A.visible=w)},getItemInfos:function(){return this._30o},getItemInfoAt:function(d){var C=this,H=0,a=C._30o,F=C.lp(d),Q=F.x,e=F.y;if(e>=0&&e<=C.getHeight())for(;H<a.size();H++){var X=a.get(H);if(X.startX<=Q&&Q<=X.endX)return X}return U},drawItem:function(y,N,m,L,o){if(N.visible===!1)return 0;if(tf(N.visible)&&!N.visible())return 0;var s=this,j=N.disabled;j&&(y.globalAlpha=fc);var M=s.drawItemImpl(y,N,m,L,o),U=s._itemGap;return j&&(y.globalAlpha=1),this._currentItem!==N||"separator"===N||N.separator===!0||N.unfocusable||Ko(y,s._separatorColor,m-U/2,0,M+U,L),M},drawItemImpl:function(u,V,w,J,n){var P=this,z=P._view,R=P._itemGap,D=J/2,N=V.type,f=V.element,r=V.label;Do(f)&&(r=f,f=U);var y,W=P.getLabelFont(V),K=P.getLabelColor(V),g=V.selected,h=Dl(V.icon),k=Zb(h,V),s=0,d=k+(r?Go(W,r).width:0);if("separator"===V||V.separator===!0)return Cq(u,P._separatorColor,w,J/4,D),1;if(f){h&&Jr(u,h,w+k/2,D,V,P),ss(u,r,W,K,w+k,0,0,J);var L=Fj(f);n||P._90I.add(L),L.parentNode!==z&&Uo(z,L),f.iv&&f.iv(),f.validate&&f.validate();var l=L.getBoundingClientRect(),B=l.width,I=L.style;return He(L),I.left=P.tx()+w+d+Wg,I.top=(J-l.height)/2+Wg,d+B}return N===Ar?y=Dl(g?Mn:ti):N===Zh&&(y=Dl(g?Zh:tr)),y?(s=Zb(y,V),Jr(u,y,w+s/2,D,V,P),w+=s,d+=s):g&&No(u,w-R/2,0,d+R,J,P.getSelectBackground(V)),h&&Jr(u,h,w+k/2,D,V,P),ss(u,r,W,K,w+k,0,0,J),d},validateImpl:function(){var l=this,B=l._canvas,k=l.getWidth(),m=l.getHeight(),b=l._30o,g=l._items;gl(B,k,m);var O=kc(B),w=l._itemGap,o=w/2;_f(O,l.tx(),0,1),O.clearRect(0,0,k,m);var J=l._90I;l._90I=new vc,b.clear(),g.forEach(function(v){var X=l.drawItem(O,v,o,m);b.add({item:v,startX:o,endX:o+X,width:X}),X&&(o+=X+w)}),J.each(function(I){l._90I.contains(I)||Gp(I)});var K=l._64I;l._64I=N(0,o),O.restore(),l._stickToRight?(l._65O=0,O=kc(B),o=k-l._64I+w,_f(O,0,0,1),O.clearRect(0,0,k,m),b.clear(),g.forEach(function(T){var r=l.drawItem(O,T,o,m,!0);b.add({item:T,startX:o,endX:o+r,width:r}),r&&(o+=r+w)}),O.restore()):l.tx(l.tx()),K!==l._64I&&l.onSumWidthChanged(K,l._64I)},onSumWidthChanged:function(){},handleClick:function(n,X){var K=this,l=n.type,e=n.action,_=n.groupId,B=n.selected;n.disabled||(_!=U?B||(n.selected=!0,this._items.forEach(function(Z){Z.groupId===_&&n!==Z&&(Z.selected=!1)}),e&&n.action(n,K,X)):l===Zh||"toggle"===l?(n.selected=!B,e&&n.action(n,K,X)):e&&n.action(n,K,X)),vf(),K.iv()}});var al=function(I){this.tb=I,this.addListeners()};ob(al,Z,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(Y){this.handleScroll(Y,10*(Y.wheelDelta/40))},handle_DOMMouseScroll:function(Z){this.handleScroll(Z,10*-Z.detail)},handleScroll:function(r,E){td(r);var Q=this.tb;Q.isScrollable()&&!Q._stickToRight&&(Q.tx(Q.tx()+E),Hn())},handle_mousemove:function(W){var h=this;Hf||h.setItem(W)},handle_mouseout:function(y){var R=this;y.target===R.getView()?R.tb.setCurrentItem(U):R.handle_mousemove(y)},handle_mousedown:function(h){this.handle_mousemove(h),this.handle_touchstart(h)},handle_touchstart:function(R){var n=this,$=n.tb,u=R.target;lk(R)&&(u===n.getView()||u===$._canvas)&&(td(R),$.setFocus(R)&&(this.setItem(R,!0),($.isScrollable()||n.info&&!n.info.item.disabled)&&(n.x=Zg(R).x,n.tx=$.tx(),Ti(n,R))))},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(E){var u=this,V=u.tb;if(!V._stickToRight){var _=Zg(E).x-u.x;!u._25o&&v(_)>2&&V.isScrollable()&&(u._25o=1),u._25o&&V.tx(u.tx+_)}},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},handleWindowTouchEnd:function(I){var B=this,F=B.tb,f=B.info,V=B.tb.getItemInfoAt(I);if(!B._25o&&f){var p=f.item;V&&V.item===p&&F.handleClick(p,I)}B._25o=B.x=B.tx=U,B.setItem()},setItem:function($,O){var W=this,P=W.tb,A=W.info=$?P.getItemInfoAt($):U,Z=A?A.item:U;P.setCurrentItem(Z),O&&Z&&tf(Z.onDown)&&Z.onDown($)}}),yq.BorderPane=function(){this._view=wm(1,this),this.iv()},qh("BorderPane",Z,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(m,s){this._12o("leftView",m),s!=U&&this.setLeftWidth(s)},getRightView:function(){return this._rightView},setRightView:function(d,m){this._12o("rightView",d),m!=U&&this.setRightWidth(m)},getTopView:function(){return this._topView},setTopView:function(T,c){this._12o("topView",T),c!=U&&this.setTopHeight(c)},getBottomView:function(){return this._bottomView},setBottomView:function(V,q){this._12o("bottomView",V),q!=U&&this.setBottomHeight(q)},getCenterView:function(){return this._centerView},setCenterView:function(f){this._12o("centerView",f)},_12o:function(y,Z){var o=this,J="_"+y,t=o._view,W=o[J];W!==Z&&(W&&(W.getView?Gp(W.getView()):Gp(W)),o[J]=Z,Z&&(Z.getView?Uo(t,Z.getView(),1):Uo(t,Z,1)),o.fp(y,W,Z))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var x=this,t=x._topView,R=x._bottomView,A=x._leftView,K=x._rightView,f=x._centerView,c=x.getWidth(),b=x.getHeight(),M=0,B=0,d=c,D=b,i=0,G=0,z=0,H=0;t&&(i=x._topHeight==U?Hp(t):x._topHeight,B=i),R&&(G=x._bottomHeight==U?Hp(R):x._bottomHeight,D=b-G),A&&(z=x._leftWidth==U?qj(A):x._leftWidth,M=z),K&&(H=x._rightWidth==U?qj(K):x._rightWidth,d=c-H);var W=N(0,d-M),u=N(0,D-B);t&&yk(t,0,0,c,i),R&&yk(R,0,D,c,G),A&&yk(A,0,B,z,u),K&&yk(K,d,B,H,u),f&&yk(f,M,B,W,u)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);